@&#MAIN-TITLE@&#Optimal single machine scheduling of products with components and changeover cost

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study scheduling products with subassemblies on a single machine.


                        
                        
                           
                           We derive structural results that characterize optimal schedules.


                        
                        
                           
                           We show that optimal schedules can be derived from a recurrent sequence of schedules.


                        
                        
                           
                           These optimal schedules can be implemented before total demand is known.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Scheduling

Single machine

Components

Flow time

Changeover cost

@&#ABSTRACT@&#


               
               
                  We consider the problem of scheduling products with components on a single machine, where changeovers incur fixed costs. The objective is to minimize the weighted sum of total flow time and changeover cost. We provide properties of optimal solutions and develop an explicit characterization of optimal sequences, while showing that this characterization has recurrent properties. Our structural results have interesting implications for practitioners, primarily that the structure of optimal sequences is robust to changes in demand.
               
            

@&#INTRODUCTION@&#

The problem of scheduling products with changeovers on a common resource, like a single machine, exists in many manufacturing settings. For instance, a machine processes different types of circuit boards by inserting components (cf. Coffman, Nozari, & Yannakakis, 1989), or a paper machine is capable of producing different grades of paper (cf. Magnanti & Vachani, 1990). One common feature of these problems is that products of the same type are often grouped to form batches. A changeover is incurred whenever the machine is switched over to process a different batch of products. The resulting sequencing and batching decisions are then made based on a number of possible criteria, including for example, total flow time, total changeover cost, number of late products, etc.

This paper considers a setting where a manufacturer fabricates multiple types of components on a single machine that are ultimately assembled into identical products. A fixed cost is incurred whenever there is a changeover from one component to another. A component is immediately available for assembly after its completion. Our objective is to determine an optimal sequence (involving both sequencing and batching decisions) that minimizes the weighted sum of total flow time and changeover cost.

We show that there exists a series of recurrent optimal sequences, and we obtain closed-form solutions for the integer batch sizes in these sequences. Based on the proven properties and the existence of the recurrent optimal sequences, we provide an explicit characterization of optimal sequences for any size problem. We also show that when there is a changeover cost, rather than a changeover time, the optimal sequence exhibits a constant-batch-size pattern. This result is especially interesting given that the algorithms of Coffman et al. (1989), who consider the same setting but use changeover time rather than cost, lead to non-increasing batch sizes in the optimal sequences.

The rest of the paper is organized as follows. In Section 2, we review the related literature. In Section 3, we introduce the formulation of the problem. Section 4 describes the major results about the properties and a characterization of optimal sequences. Managerial implications of our solution are discussed in Section 5.

@&#LITERATURE REVIEW@&#

There has been extensive research on changeover scheduling problems with batching; we refer the reader to the surveys by Potts and Kovalyov (2000) and Allahverdi, Ng, Cheng, and Kovalyov (2008). Many of these papers refer to setups instead of changeovers, although both terms can be used interchangeably. To avoid confusion and maintain consistency, we use the term changeover throughout the paper.

The existing literature on changeover scheduling with batching can be divided into two main streams depending on whether or not the products are composed of components of multiple types. The first research stream studies batching and/or sequencing decisions for products without components. Most of the work in this stream is conducted under a single machine setting. For instance, Santos and Magazine (1985) and Dobson, Karmarkar, and Rummel (1987) independently started this research stream by proposing the same single-machine batching problem to minimize the total flow time of one product. In both papers, a constant changeover time is needed before the machine can process a different batch of products. Dobson et al. (1987) also provide heuristics for the multi-product case. Cheng and Kovalyov (2001) consider a single-machine scheduling problem for multiple products with deadlines. A changeover cost is incurred when the machine is switched to produce another product. The objective is to minimize total changeover costs. A few papers address more complex manufacturing environments. Cheng, Kovalyov, and Chakhlevich (2004) and Lin and Cheng (2005), for example, minimize the makespan of a two-stage flowshop. The two papers differ in how they model the second stage of production (dedicated machines or single flexible machine) and where batching operations are performed (at the first stage or the second stage).

The second research stream, which is more relevant to our work, focuses on scheduling products with multiple component types. A product is not completed until all of its components are finished, which adds to the complexity of the problem. One set of papers in this stream considers the problem of processing components on parallel dedicated machines. In some cases, there is a subsequent assembly stage, in which all of the components are assembled into a final product. This problem is sometimes referred to as the assembly scheduling problem with batching operations. For instance, Kovalyov, Potts, and Strusevich (2004) study a two-stage assembly scheduling problem minimizing the makespan. In other cases, the assembly stage is ignored. For instance, Lin and Cheng (2011) consider a batch scheduling model in a concurrent open shop where operations of each product are independently performed on their parallel dedicated machines. They consider minimizing the maximum lateness, weighted number of tardy products and total weighted completion time. In this paper, we focus on the problem of scheduling products with components on a single bottleneck machine. We assume that there is ample capacity at other resources, such as for example an assembly stage, and we thus do not explicitly capture these non-bottleneck resources in our model.

A second set of papers in this stream study the scheduling of products with multiple component types on a single flexible machine. Papers in this set assume each product consists of two components; one component is common to all products and the other one is unique to each product. The assumption of changeover time leads to a batching of the common components, but has no effect on the unique components. Baker (1988) and Vickson, Magazine, and Santos (1993) consider the same batching problem on a single machine to minimize flow time, but use different assumptions regarding the calculation of flow time for each product. Gerodimos, Glass, and Potts (2000) and Lin (2002) study the same model as Baker (1988) and Vickson et al. (1993) but consider two due-date related objectives, minimizing the maximum lateness and the number of late products. These papers also differ in how flow time is computed. A similar model for a more complex environment is studied by Cheng and Wang (1999) where they show minimizing the makespan for a two-stage flowshop is NP-complete.

Finally, a third set of papers study the scheduling of products with multiple component types, all of which are common to all products. This is the single machine problem we address in this paper. Both batching and sequencing decisions are needed for these different common components and thus this problem is quite complex. Coffman et al. (1989) started this research stream by considering the problem of scheduling identical products with two common component types on a single machine to minimize flow time. A fixed changeover time is incurred whenever the machine is switched to process a batch of components of a different type. They provide efficient algorithms to obtain optimal sequences. Cheng, Ng, and Yuan (2008) consider a model of scheduling products with multiple operations on a single machine with the objective of minimizing the total completion time. The operations of each product belong to different families. Each family of operations can be grouped as a batch which requires a changeover time. They provide some complexity results for the problem and show that some special cases are solvable in polynomial time.

Most papers of these research streams assume changeovers incur a time delay, but a few papers do consider the case where changeovers could result in costs. As pointed out by Magnanti and Vachani (1990), considering changeover cost instead of time may be more appropriate in some settings, where changeovers can be executed after the regular production hours without consuming resource time or when changeover time is small.

To the best of our knowledge, only Kella (1991) and Gim and Han (1997) have studied the problem of scheduling products with multiple common components on a single machine taking into account changeover cost. Both of these papers assume an infinite horizon problem setting. Kella (1991) studies a setting where a machine sequentially produces two types of fluid components which are mixed to produce a final product. A fixed changeover cost is incurred whenever the machine is switched from producing one type of fluid component to the other. An optimal cyclic policy is provided to minimize the long-run average cost that includes both inventory holding cost and changeover cost. Gim and Han (1997) address a variant of this problem by assuming N different types of components are processed on a single machine and then assembled into identical products. Both changeover time and cost are incurred when the machine is switched to produce a different component. They develop a heuristic based on a repetitive sequence for an infinite horizon problem to minimize total production cost, which consists of changeover cost, inventory cost and other costs. Our model can be viewed as a discrete optimization version of Kella (1991). While Kella (1991) studies an infinite horizon continuous optimization problem in which there is no sequencing decision, we derive solutions for both the finite and the infinite horizon problem, including the sequencing of the components.

Our finding that there exists a series of recurrent optimal sequences is consistent with the optimality of a stationary periodic policy suggested by Kella (1991). We find that when there is a changeover cost, rather than a changeover time, the optimal sequence exhibits a constant-batch-size pattern. This structural insight of non-increasing optimal batch sizes has also been supported in Santos and Magazine (1985), Dobson et al. (1987), Coffman and Yannakakis (1990), Mosheiov and Oron (2008), all of which consider changeover time. This result is especially interesting given that the algorithms of Coffman et al. (1989), who consider the same setting but use changeover time rather than cost, lead to non-increasing batch sizes in the optimal sequences.

There are n identical products that need to be produced on a single machine. While our structural results and related insights extend to the case with more than two components (see Appendix B), for expositional clarity throughout the main part of the paper, we assume that each product is composed of two components. Specifically, each product requires one component of type A with processing time a
                     >0 and one component of type B with processing time b
                     >0. For convenience, define T
                     =
                     b/a. Without loss of generality, we assume that a
                     ⩽
                     b, such that T
                     ⩾1. The n products can be produced in any sequence of the n type-A and n type-B components.

In any given n-product sequence σ
                     
                        n
                     , a fixed changeover cost c′>0 is incurred for every switch between the two types of components. Let β(σ
                     
                        n
                     ) denote the number of changeovers in σ
                     
                        n
                     , and note that β
                     ∈[1,2n
                     −1]. Let F
                     
                        i
                     (σ
                     
                        n
                     ) denote the flow time for product i
                     =1,…,
                     n.

A component becomes available for assembly instantly after its completion. Once all components are produced, a final product is immediately assembled and shipped. We assume the assembly stage has sufficient capacity, such that scheduling decisions at this non-bottleneck resource are of negligible importance. We use (AB)
                        s
                      to denote a block, or sequence, of s type-A components followed by an equal number of type-B components. For example, σ
                     4
                     =
                     AAABBBBA
                     =(AB)3(BA)1. Thus product completions occur after the first three B and after the last A, yielding 
                        
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 4
                              
                           
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                           (
                           
                              
                                 σ
                              
                              
                                 4
                              
                           
                           )
                           =
                           (
                           3
                           a
                           +
                           b
                           )
                           +
                           (
                           3
                           a
                           +
                           2
                           b
                           )
                           +
                           (
                           3
                           a
                           +
                           3
                           b
                           )
                           +
                           (
                           4
                           a
                           +
                           4
                           b
                           )
                           =
                           13
                           a
                           +
                           10
                           b
                        
                      and β(σ
                     4)=2. In another sequence, like ABBAABBA
                     =(AB)1(BA)1(AB)1(BA)1, the total flow time becomes (a
                     +
                     b)+(2a
                     +2b)+(3a
                     +3b)+(4a
                     +4b)=10a
                     +10b. Apparently, changeovers help to reduce the flow time of products but also incur some costs.

Flow time is an important criterion in production scheduling because it represents the lead time of customer orders and also directly relates to work-in-process (WIP) inventory cost. As seen from the above examples, flow time can often be reduced by using more changeovers, but these changeovers are costly. Therefore, the manufacturer needs to decide the appropriate number of changeovers so as to minimize the total production cost, which includes both the cost of changeovers and the costs associated with longer flow times (for example, work-in-process inventory costs). The objective thus is to find a sequence that minimizes the weighted sum of total flow time and changeover cost. Specifically, using w
                     >0 to denote the weight of the changeover cost relative to the total flow time,
                        
                           (1)
                           
                              
                                 
                                    σ
                                 
                                 
                                    n
                                 
                                 
                                    ∗
                                 
                              
                              =
                              arg
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                              
                              C
                              (
                              
                                 
                                    σ
                                 
                                 
                                    n
                                 
                              
                              )
                              =
                              arg
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             n
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             wc
                                          
                                          
                                             ′
                                          
                                       
                                       β
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                 
                              
                              .
                           
                        
                     For expositional convenience, we use c
                     =
                     w c′ in the remainder of this paper.

Similar to Coffman et al. (1989), it is easy to confirm that there is always an optimal sequence which is normal form, i.e., one that is a concatenation of the 
                        
                           
                              
                                 (
                                 AB
                                 )
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       p
                                    
                                 
                              
                           
                        
                      (p
                     =1,2,…) and 
                        
                           
                              
                                 (
                                 BA
                                 )
                              
                              
                                 
                                    
                                       k
                                    
                                    
                                       q
                                    
                                 
                              
                           
                        
                      (q
                     =1,2,…), where the AB blocks occur in every other sequence position interleaved with the BA blocks. Thus, normal-form sequences are of the form 
                        
                           
                              
                                 (
                                 AB
                                 )
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              
                                 (
                                 BA
                                 )
                              
                              
                                 
                                    
                                       k
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              
                                 (
                                 AB
                                 )
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 (
                                 BA
                                 )
                              
                              
                                 
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           …
                        
                      or 
                        
                           
                              
                                 (
                                 BA
                                 )
                              
                              
                                 
                                    
                                       k
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              
                                 (
                                 AB
                                 )
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              
                                 (
                                 BA
                                 )
                              
                              
                                 
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 (
                                 AB
                                 )
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           …
                        
                     . The sequence AAABBABB is not normal form because it is not composed of blocks. Similarly, the sequence AAABBBAB is not normal form because it is a concatenation of two sequential AB blocks. In the remainder of the paper, without loss of generality, we only consider normal-form sequences.

For notational convenience, we use s
                     
                        p
                      and k
                     
                        q
                      to denote the size (number of products) of the pth AB block and the size of the qth BA block, respectively. We omit the subscripts p and q when no confusion might arise.

In general, the ith product in σ
                     
                        n
                      must belong to either an AB or a BA block. If it is the jth product in an s-size AB block, then F
                     
                        i
                     (σ
                     
                        n
                     )=
                     i(a
                     +
                     b)+(s
                     −
                     j)a. Similarly, if it is the jth product in a k-size BA block, then F
                     
                        i
                     (σ
                     
                        n
                     )=
                     i(a
                     +
                     b)+(k
                     −
                     j)b. Using m to denote the number of AB blocks in σ
                     
                        n
                     , we have
                        
                           (2)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    σ
                                 
                                 
                                    n
                                 
                              
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              n
                              (
                              n
                              +
                              1
                              )
                              (
                              a
                              +
                              b
                              )
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    s
                                 
                                 
                                    p
                                 
                              
                              (
                              
                                 
                                    s
                                 
                                 
                                    p
                                 
                              
                              -
                              1
                              )
                              a
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       q
                                       =
                                       1
                                    
                                    
                                       β
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             n
                                          
                                       
                                       )
                                       -
                                       m
                                    
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    k
                                 
                                 
                                    q
                                 
                              
                              (
                              
                                 
                                    k
                                 
                                 
                                    q
                                 
                              
                              -
                              1
                              )
                              b
                              .
                           
                        
                     
                  

The following three theorems allow us to characterize optimal sequences for various values of n given the parameters a, b, and c. Theorems 1 and 2 prove the recurring form and provide the integer sizes of the recurring blocks, while Theorem 3 describes how to derive optimal sequences for problems where the number of products cannot be expressed through this recurring form. Some of the proofs of the results provided in this section are based on the technical results in Lemmas 1–3, which are given in Appendix A.
                        Theorem 1
                        
                           There exists a pair of integers (s
                           ∗
                           ,
                           
                           k
                           ∗
                           ) which minimize
                           
                              
                                 (3)
                                 
                                    G
                                    (
                                    s
                                    ,
                                    k
                                    )
                                    =
                                    
                                       
                                          s
                                          (
                                          s
                                          -
                                          1
                                          )
                                          a
                                          +
                                          k
                                          (
                                          k
                                          -
                                          1
                                          )
                                          b
                                          +
                                          4
                                          c
                                       
                                       
                                          2
                                          (
                                          s
                                          +
                                          k
                                          )
                                       
                                    
                                    ,
                                 
                              
                           
                           so that for 
                           
                              
                                 n
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                                 +
                                 θ
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                                 ,
                                 
                                 θ
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                              
                            
                           must have the form {s
                           ∗
                           k
                           ∗
                           s
                           ∗
                           k
                           ∗
                           ,
                           …
                           ,
                           
                           s
                           ∗
                           k
                           ∗
                           s
                           ∗}.
                        

We first show that for any θ
                           =0, 1, 2,…, there exist (s
                           ∗,k
                           ∗) such that for n
                           
                              θ
                           
                           =
                           s
                           ∗
                           +
                           θ (s
                           ∗
                           +
                           k
                           ∗) products, an optimal sequence is 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             θ
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 …
                                 
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                                 }
                              
                           .

By Lemma 1(c), the number of AB blocks in 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                              
                            is m
                           =
                           m′+
                           m″, where m′ is the number of 
                              
                                 
                                    
                                       (
                                       AB
                                       )
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                            blocks, m″ is the number of 
                              
                                 
                                    
                                       (
                                       AB
                                       )
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ″
                                          
                                       
                                    
                                 
                              
                            blocks, and ∣s′−
                           s″∣=1 or 0. A similar conclusion holds for BA blocks, which include l′ number of 
                              
                                 
                                    
                                       (
                                       BA
                                       )
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                            blocks, l″ number of 
                              
                                 
                                    
                                       (
                                       BA
                                       )
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ″
                                          
                                       
                                    
                                 
                              
                            blocks, and ∣k′−
                           k″∣=0 or 1. By Lemma 3, there exist a θ
                           
                              o
                            and an n
                           
                              o
                           , such that
                              
                                 
                                    β
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                
                                                
                                                   ∗
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          m
                                       
                                       
                                          o
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          m
                                       
                                       
                                          o
                                       
                                       
                                          ″
                                       
                                    
                                    +
                                    
                                       
                                          l
                                       
                                       
                                          o
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          l
                                       
                                       
                                          o
                                       
                                       
                                          ″
                                       
                                    
                                    ,
                                    
                                       max
                                    
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   o
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   m
                                                
                                                
                                                   o
                                                
                                                
                                                   ″
                                                
                                             
                                          
                                       
                                    
                                    >
                                    
                                       
                                          θ
                                       
                                       
                                          o
                                       
                                    
                                    +
                                    1
                                    ,
                                    
                                    and
                                    
                                    
                                       max
                                    
                                    
                                       
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   o
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   l
                                                
                                                
                                                   o
                                                
                                                
                                                   ″
                                                
                                             
                                          
                                       
                                    
                                    >
                                    
                                       
                                          θ
                                       
                                       
                                          o
                                       
                                    
                                    .
                                 
                              
                           Using the indicator function 1(·), we can let
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          o
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          o
                                       
                                       
                                          ′
                                       
                                    
                                    1
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   o
                                                
                                                
                                                   ′
                                                
                                             
                                             ⩾
                                             
                                                
                                                   m
                                                
                                                
                                                   o
                                                
                                                
                                                   ″
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          s
                                       
                                       
                                          o
                                       
                                       
                                          ″
                                       
                                    
                                    1
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   o
                                                
                                                
                                                   ″
                                                
                                             
                                             >
                                             
                                                
                                                   m
                                                
                                                
                                                   o
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          k
                                       
                                       
                                          o
                                       
                                    
                                    =
                                    
                                       
                                          k
                                       
                                       
                                          o
                                       
                                       
                                          ′
                                       
                                    
                                    1
                                    
                                       
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   o
                                                
                                                
                                                   ′
                                                
                                             
                                             ⩾
                                             
                                                
                                                   l
                                                
                                                
                                                   o
                                                
                                                
                                                   ″
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          k
                                       
                                       
                                          o
                                       
                                       
                                          ″
                                       
                                    
                                    1
                                    
                                       
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   o
                                                
                                                
                                                   ″
                                                
                                             
                                             >
                                             
                                                
                                                   l
                                                
                                                
                                                   o
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           Now, using Lemma 2, remove AB and BA blocks from 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             o
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                              
                            until there remain θ
                           
                              o
                           
                           +1 
                              
                                 
                                    
                                       (
                                       AB
                                       )
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             o
                                          
                                       
                                    
                                 
                              
                            blocks and θ
                           
                              o
                            
                           
                              
                                 
                                    
                                       (
                                       BA
                                       )
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             o
                                          
                                       
                                    
                                 
                              
                            blocks. The resulting sequence {s
                           
                              o
                           
                           k
                           
                              o
                           
                           s
                           
                              o
                           
                           k
                           
                              o
                           ,…,
                           s
                           
                              o
                           
                           k
                           
                              o
                           
                           s
                           
                              o
                           } is optimal for the remaining s
                           
                              o
                           
                           +
                           θ
                           
                              o
                           (s
                           
                              o
                           
                           +
                           k
                           
                              o
                           ) products. Finally, Lemma 2(a) indicates that the form of {s
                           
                              o
                           
                           k
                           
                              o
                           
                           s
                           
                              o
                           
                           k
                           
                              o
                           
                           …
                           s
                           
                              o
                           
                           k
                           
                              o
                           
                           s
                           
                              o
                           } is also optimal for s
                           
                              o
                           
                           +
                           θ(s
                           
                              o
                           
                           +
                           k
                           
                              o
                           ) products, where θ
                           ⩽
                           θ
                           
                              o
                           . That implies we can identify (s
                           ∗,
                           k
                           ∗) for any θ
                           =0,1,2,….

We next justify that (s
                           ∗,
                           k
                           ∗) must minimize G(s,
                           k). For any (s,
                           k), consider n
                           =
                           s
                           ∗
                           +(s
                           +
                           k)(s
                           ∗
                           +
                           k
                           ∗) products. The optimal sequence is 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 …
                                 
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                                 }
                              
                           . An alternative sequence is σ
                           
                              n
                           
                           ={s k s k,…,
                           s k s
                           ∗}. We know that 
                              
                                 C
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                                 ⩽
                                 C
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                           . After removing the last 
                              
                                 
                                    
                                       (
                                       AB
                                       )
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                            block from 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                              
                            and σ
                           
                              n
                           , we get two sequences for n′=(s
                           +
                           k)(s
                           ∗
                           +
                           k
                           ∗) products: 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       a
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 …
                                 
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 }
                              
                            and 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       b
                                    
                                 
                                 =
                                 {
                                 sksk
                                 …
                                 sk
                                 }
                              
                           . From (2) and (1), we know 
                              
                                 C
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 ⩽
                                 C
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       b
                                    
                                 
                                 )
                              
                            and 
                              
                                 
                                    
                                       C
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             a
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       C
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             b
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           , so
                              
                                 
                                    
                                       
                                          C
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          c
                                          β
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    1
                                    )
                                    (
                                    a
                                    +
                                    b
                                    )
                                    +
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          [
                                          
                                             
                                                s
                                             
                                             
                                                ∗
                                             
                                          
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                ∗
                                             
                                          
                                          -
                                          1
                                          )
                                          a
                                          +
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                          (
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                          -
                                          1
                                          )
                                          b
                                          ]
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ∗
                                             
                                          
                                          +
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          2
                                          c
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ∗
                                             
                                          
                                          +
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           Hence, we have
                              
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ∗
                                             
                                          
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                ∗
                                             
                                          
                                          -
                                          1
                                          )
                                          a
                                          +
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                          (
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                          -
                                          1
                                          )
                                          b
                                          +
                                          4
                                          c
                                       
                                       
                                          2
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                ∗
                                             
                                          
                                          +
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                    
                                    ⩽
                                    
                                       
                                          s
                                          (
                                          s
                                          -
                                          1
                                          )
                                          a
                                          +
                                          k
                                          (
                                          k
                                          -
                                          1
                                          )
                                          b
                                          +
                                          4
                                          c
                                       
                                       
                                          2
                                          (
                                          s
                                          +
                                          k
                                          )
                                       
                                    
                                    ,
                                 
                              
                           which concludes our proof.□

While the function in (3) is not necessarily well-behaved, the following result provides closed-form expressions for the integer sizes of the recurring blocks that form an optimal sequence.
                        Theorem 2
                        
                           Suppose 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                t
                                             
                                             
                                                o
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                t
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                              
                            
                           are (positive) integer minimizers of 
                           
                              (3)
                           
                           , and 
                           
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                    
                                       o
                                    
                                 
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       1
                                    
                                    
                                       o
                                    
                                 
                                 ⩽
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                    
                                       o
                                    
                                 
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       2
                                    
                                    
                                       o
                                    
                                 
                                 ⩽
                                 …
                                 ⩽
                                 
                                    
                                       s
                                    
                                    
                                       t
                                    
                                    
                                       o
                                    
                                 
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       t
                                    
                                    
                                       o
                                    
                                 
                              
                           
                           , then 
                           
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                              
                           
                           . More specifically,
                           
                              
                                 (a)
                                 
                                    k
                                    ∗
                                    
                                    =
                                    ⌈K⌉ or ⌊K
                                    
                                    +
                                    
                                    (1
                                    
                                    +
                                    
                                    1/T) ⌋,
                                 


                                    where 
                                    
                                       
                                          K
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            -
                                                            (
                                                            1
                                                            +
                                                            3
                                                            T
                                                            )
                                                            a
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        1
                                                                        +
                                                                        3
                                                                        T
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  +
                                                                  4
                                                                  (
                                                                  4
                                                                  c
                                                                  -
                                                                  a
                                                                  )
                                                                  (
                                                                  
                                                                     
                                                                        T
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  +
                                                                  T
                                                                  )
                                                                  a
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                            T
                                                            (
                                                            T
                                                            +
                                                            1
                                                            )
                                                            a
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                    .
                                 


                                    s
                                    ∗
                                    
                                    =
                                    ⌊X
                                    −
                                    k
                                    ∗⌋ or ⌈X
                                    −
                                    k
                                    ∗⌉,
                                 


                                    where 
                                    
                                       
                                          X
                                          =
                                          
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                (
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                +
                                                1
                                                )
                                                +
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                (
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                -
                                                1
                                                )
                                                T
                                                +
                                                
                                                   
                                                      4
                                                      c
                                                   
                                                   
                                                      a
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 

We assume, w.l.o.g., t
                           =2, and denote 
                              
                                 
                                    
                                       X
                                    
                                    
                                       r
                                    
                                 
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       r
                                    
                                    
                                       o
                                    
                                 
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       r
                                    
                                    
                                       o
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 G
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                r
                                             
                                             
                                                o
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                r
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                              
                           , for r
                           =1, 2. In an optimal sequence, by Lemma 1(c), the AB and BA blocks must satisfy the balancing conditions (s
                           −1)a
                           ⩽
                           kb and sa
                           ⩾(k
                           −1)b, implying that 
                              
                                 
                                    
                                       s
                                    
                                    
                                       r
                                    
                                    
                                       o
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                r
                                             
                                          
                                          -
                                          1
                                          )
                                          
                                             
                                                b
                                             
                                             
                                                a
                                                +
                                                b
                                             
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       k
                                    
                                    
                                       r
                                    
                                    
                                       o
                                    
                                 
                                 =
                                 1
                                 +
                                 
                                    
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                r
                                             
                                          
                                          -
                                          1
                                          )
                                          
                                             
                                                a
                                             
                                             
                                                a
                                                +
                                                b
                                             
                                          
                                       
                                    
                                 
                              
                           . Clearly, if X
                           1
                           =
                           X
                           2, then 
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                             
                                                o
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                2
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                              
                           .

For X
                           1
                           <
                           X
                           2, we have 
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                    
                                       o
                                    
                                 
                                 ⩽
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                    
                                       o
                                    
                                 
                              
                           . It suffices to prove that if 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                             
                                                o
                                             
                                          
                                          
                                             
                                                k
                                             
                                             
                                                2
                                             
                                             
                                                o
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                             
                                                o
                                             
                                          
                                          …
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                             
                                                o
                                             
                                          
                                          
                                             
                                                k
                                             
                                             
                                                2
                                             
                                             
                                                o
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                              
                            is optimal for 
                              
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                    
                                       o
                                    
                                 
                              
                            products, then 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                          …
                                          
                                             
                                                s
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                              
                            is also optimal for 
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                    
                                       o
                                    
                                 
                              
                            products.

If 
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                    
                                       o
                                    
                                 
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                    
                                       o
                                    
                                 
                              
                           , then both 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                            are optimal, since their corresponding costs are equal due to (2), (1), and 
                              
                                 G
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                                 =
                                 G
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                             
                                                o
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                2
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                              
                           . Hence, we can let 
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                              
                           .

If 
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                    
                                       o
                                    
                                 
                                 <
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                    
                                       o
                                    
                                 
                              
                           , we can remove 
                              
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                    
                                       o
                                    
                                 
                                 -
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                    
                                       o
                                    
                                 
                              
                            products from the last AB block in 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                            to get 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                             
                                                o
                                             
                                          
                                          
                                             
                                                k
                                             
                                             
                                                2
                                             
                                             
                                                o
                                             
                                          
                                          …
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                             
                                                o
                                             
                                          
                                          
                                             
                                                k
                                             
                                             
                                                2
                                             
                                             
                                                o
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                              
                           . Again, based on (2), (1), and the fact that 
                              
                                 G
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                                 =
                                 G
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                             
                                                o
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                2
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       G
                                    
                                    
                                       ∗
                                    
                                 
                              
                           , we know
                              
                                 
                                    C
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    )
                                    =
                                    C
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    1
                                    )
                                    (
                                    a
                                    +
                                    b
                                    )
                                    +
                                    
                                       
                                          X
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          G
                                       
                                       
                                          ∗
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                       
                                          o
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                                
                                                   o
                                                
                                             
                                             -
                                             1
                                          
                                       
                                    
                                    a
                                    +
                                    c
                                    .
                                 
                              
                           For n
                           2 products, we compare 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           , whose cost can be expressed in term of the cost of 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                              
                            as
                              
                                 
                                    C
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    )
                                    =
                                    C
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   2
                                                
                                                
                                                   o
                                                
                                             
                                             -
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                                
                                                   o
                                                
                                             
                                          
                                       
                                    
                                    [
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    1
                                    )
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                    (
                                    a
                                    +
                                    b
                                    )
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   2
                                                
                                                
                                                   o
                                                
                                             
                                             -
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                                
                                                   o
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                                
                                                   o
                                                
                                             
                                             +
                                             
                                                
                                                   s
                                                
                                                
                                                   2
                                                
                                                
                                                   o
                                                
                                             
                                             -
                                             1
                                          
                                       
                                    
                                    a
                                    ,
                                 
                              
                           with 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                          …
                                          
                                             
                                                s
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                          …
                                          
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           , which has 
                              
                                 
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          1
                                          -
                                          
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            
                           
                              
                                 
                                    
                                       (
                                       AB
                                       )
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             1
                                          
                                          
                                             o
                                          
                                       
                                    
                                 
                              
                            blocks, 
                              
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                             
                                                o
                                             
                                          
                                          -
                                          
                                             
                                                s
                                             
                                             
                                                1
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       (
                                       AB
                                       )
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             1
                                          
                                          
                                             o
                                          
                                       
                                       +
                                       1
                                    
                                 
                              
                            blocks, and X
                           2 
                           
                              
                                 
                                    
                                       (
                                       BA
                                       )
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                          
                                             o
                                          
                                       
                                    
                                 
                              
                            blocks, so
                              
                                 
                                    C
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    =
                                    C
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   2
                                                
                                                
                                                   o
                                                
                                             
                                             -
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                                
                                                   o
                                                
                                             
                                          
                                       
                                    
                                    [
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    1
                                    )
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                    (
                                    a
                                    +
                                    b
                                    )
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   2
                                                
                                                
                                                   o
                                                
                                             
                                             -
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                                
                                                   o
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                       
                                          o
                                       
                                    
                                    a
                                    .
                                 
                              
                           Since 
                              
                                 C
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 C
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                           , comparison of these two expressions and the fact that 
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                    
                                       o
                                    
                                 
                                 <
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                    
                                       o
                                    
                                 
                              
                            imply 
                              
                                 C
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 C
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 )
                              
                           . Hence, if 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                            is optimal, then 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                              
                            is also optimal, so that 
                              
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                    
                                       o
                                    
                                 
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                    
                                       o
                                    
                                 
                                 +
                                 1
                              
                            and n
                           2
                           =
                           n
                           1
                           +1.

We now show that 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                            is also optimal. If not, by Lemma 3 and Theorem 1, the optimality of 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                              
                            and the fact that 
                              
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 =
                                 β
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 2
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 1
                              
                            imply that there exists an optimal sequence 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                              
                            such that either 
                              
                                 β
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                                 =
                                 2
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                              
                            or 
                              
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 1
                              
                           , since n
                           1
                           =
                           n
                           2
                           −1. We can infer from Lemma 1(c) that if 
                              
                                 β
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                                 =
                                 2
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                              
                           , then 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                              
                            must have either 
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                    
                                       o
                                    
                                 
                                 
                                 
                                    
                                       (
                                       AB
                                       )
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             2
                                          
                                          
                                             o
                                          
                                       
                                    
                                 
                              
                            blocks or 
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                    
                                       o
                                    
                                 
                                 
                                 
                                    
                                       (
                                       BA
                                       )
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                          
                                             o
                                          
                                       
                                       +
                                       1
                                    
                                 
                              
                            blocks, and if 
                              
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 1
                              
                           , then 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                              
                            must have either 
                              
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 
                                 
                                    
                                       (
                                       AB
                                       )
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             2
                                          
                                          
                                             o
                                          
                                       
                                    
                                 
                              
                            blocks or 
                              
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 
                                 
                                    
                                       (
                                       BA
                                       )
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                          
                                             o
                                          
                                       
                                       +
                                       1
                                    
                                 
                              
                            blocks. However, in both cases, there exists at least one 
                              
                                 
                                    
                                       (
                                       AB
                                       )
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             1
                                          
                                          
                                             o
                                          
                                       
                                    
                                 
                              
                            block. Increasing its size to 
                              
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                    
                                       o
                                    
                                 
                              
                           , the resulting sequence has n
                           2 products, and the corresponding cost is 
                              
                                 C
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 a
                                 +
                                 b
                                 )
                                 +
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                    
                                       o
                                    
                                 
                                 a
                                 <
                                 C
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 a
                                 +
                                 b
                                 )
                                 +
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                    
                                       o
                                    
                                 
                                 a
                                 =
                                 C
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                           . This is a contradiction to the assumed optimality of 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                              
                           .

To prove parts (a) and (b), consider the derivative of G(s,
                           k) in (3) with respect to s,
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    s
                                    ,
                                    k
                                    )
                                    =
                                    a
                                    -
                                    
                                       
                                          k
                                          (
                                          k
                                          +
                                          1
                                          )
                                          a
                                          +
                                          k
                                          (
                                          k
                                          -
                                          1
                                          )
                                          b
                                          +
                                          4
                                          c
                                       
                                       
                                          
                                             
                                                (
                                                s
                                                +
                                                k
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           which is increasing in s. Hence, given k
                           ∗, by the first-order condition, we know that part (b) holds.

Due to the balance between AB and BA block sizes, we know (k
                           ∗
                           −1)T
                           ⩽
                           s
                           ∗
                           ⩽
                           k
                           ∗
                           T
                           +1, so a necessary condition for a specific k to be optimal is
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    kT
                                    +
                                    1
                                    ,
                                    k
                                    )
                                    ⩾
                                    0
                                    
                                    and
                                    
                                    
                                       
                                          G
                                       
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    kT
                                    -
                                    T
                                    ,
                                    k
                                    )
                                    ⩽
                                    0
                                    .
                                 
                              
                           Straightforward algebra then shows:
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    
                                       
                                          k
                                       
                                       
                                          ∗
                                       
                                    
                                    T
                                    +
                                    1
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                    ⩾
                                    0
                                    ⇒
                                    
                                       
                                          k
                                       
                                       
                                          ∗
                                       
                                    
                                    ⩾
                                    K
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      -
                                                      (
                                                      1
                                                      +
                                                      3
                                                      T
                                                      )
                                                      a
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  (
                                                                  1
                                                                  +
                                                                  3
                                                                  T
                                                                  )
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            4
                                                            (
                                                            4
                                                            c
                                                            -
                                                            a
                                                            )
                                                            (
                                                            
                                                               
                                                                  T
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            T
                                                            )
                                                            a
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                      T
                                                      (
                                                      T
                                                      +
                                                      1
                                                      )
                                                      a
                                                   
                                                
                                             
                                          
                                       
                                       
                                          +
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    
                                       
                                          k
                                       
                                       
                                          ∗
                                       
                                    
                                    T
                                    -
                                    T
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                    ⩽
                                    0
                                    ⇒
                                    
                                       
                                          k
                                       
                                       
                                          ∗
                                       
                                    
                                    ⩽
                                    
                                       
                                          (
                                          2
                                          
                                             
                                                T
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          T
                                          +
                                          1
                                          )
                                          a
                                          +
                                          
                                             
                                                
                                                   
                                                      (
                                                      1
                                                      +
                                                      3
                                                      T
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                4
                                                (
                                                4
                                                c
                                                -
                                                a
                                                )
                                                (
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                T
                                                )
                                                a
                                             
                                          
                                       
                                       
                                          2
                                          T
                                          (
                                          T
                                          +
                                          1
                                          )
                                          a
                                       
                                    
                                    .
                                 
                              
                           Hence, 
                              
                                 K
                                 ⩽
                                 
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 ⩽
                                 K
                                 +
                                 
                                    
                                       1
                                       +
                                       T
                                    
                                    
                                       T
                                    
                                 
                              
                           , so part (a) follows.□

According to Theorems 1 and 2, we can explicitly characterize optimal sequences for all problems where the number of products can be expressed as n
                     =
                     s
                     ∗
                     +
                     θ(s
                     ∗
                     +
                     k
                     ∗), which are recurrent optimal sequences. When the planning horizon is infinite, it is straightforward to conclude that the optimal sequence is exactly recurrent, like {s
                     ∗
                     k
                     ∗
                     s
                     ∗
                     k
                     ∗
                     s
                     ∗
                     …}.

The following result specifies the general structure of optimal sequences (i.e., the number of changeovers, the sizes of AB and BA blocks) for other n, i.e., s
                     ∗
                     +
                     θ (s
                     ∗
                     +
                     k
                     ∗)<
                     n
                     <
                     s
                     ∗
                     +(θ
                     +1)(s
                     ∗
                     +
                     k
                     ∗). The determination of these optimal intermediate sequences is mainly based on the fact established in Lemma 1(c), which tells us that the sizes of AB and BA blocks in an optimal sequence need to be balanced, i.e., any pair of AB and BA blocks in an optimal sequence is composed of either v or v
                     −1 products. Let θ
                     
                        v
                      denote the number of pairs with v products. For a given number of changeovers, this balance of block sizes must be maintained when the number of products is increased or decreased.
                        Theorem 3
                        
                           Define N
                           
                           =
                           
                           s
                           ∗
                           
                           +
                           
                           θ(s
                           ∗
                           
                           +
                           
                           k
                           ∗
                           ), where θ
                           
                           =
                           
                           0,
                           
                           1,
                           …
                           . There exist two thresholds n
                           
                              1
                            
                           and n
                           
                              2
                            
                           satisfying N
                           ⩽
                           n
                           
                              1
                           
                           ⩽
                           n
                           
                              2
                           
                           ⩽
                           N
                           
                           +
                           
                           (s
                           ∗
                           
                           +
                           
                           k
                           ∗
                           ), so that
                           
                              
                                 (a)
                                 
                                    The optimal number of changeovers for n products, β
                                    ∗
                                    (n), is determined as follows:
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ∗
                                                
                                             
                                             (
                                             n
                                             )
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               2
                                                               θ
                                                               +
                                                               1
                                                               ,
                                                            
                                                            
                                                               if
                                                               
                                                               N
                                                               <
                                                               n
                                                               ⩽
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               2
                                                               θ
                                                               +
                                                               2
                                                               ,
                                                            
                                                            
                                                               if
                                                               
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               <
                                                               n
                                                               <
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               2
                                                               θ
                                                               +
                                                               3
                                                               ,
                                                            
                                                            
                                                               if
                                                               
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ⩽
                                                               n
                                                               <
                                                               N
                                                               +
                                                               (
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 


                                    The optimal sequence for n products is characterized in 
                                    
                                       Table 1
                                    
                                    , where the parameters v, s, and k satisfy (v
                                    −
                                    s
                                    −
                                    k)(v
                                    −
                                    s
                                    −
                                    k
                                    −
                                    1)
                                    
                                    =
                                    
                                    0.
                                 

The existence of n
                           1 and n
                           2 is guaranteed by Theorem 1 and Lemma 3, so we focus on proving part (b). According to Lemma 1(c), any pair of AB block and BA block in the optimal sequence can make either v or v
                           −1 number of products.

Suppose there are v products generated by a given pair of AB block and BA block, and denote s as the optimal size of the AB block, then s must minimize 
                              
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 s
                                 (
                                 s
                                 -
                                 1
                                 )
                                 a
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 v
                                 -
                                 s
                                 )
                                 (
                                 v
                                 -
                                 s
                                 -
                                 1
                                 )
                                 b
                              
                           . Straightforward algebra shows 
                              
                                 s
                                 =
                                 
                                    
                                       
                                          
                                             
                                                (
                                                v
                                                -
                                                1
                                                )
                                                b
                                             
                                             
                                                a
                                                +
                                                b
                                             
                                          
                                       
                                    
                                 
                              
                           , and the optimal size of the BA block is
                              
                                 
                                    v
                                    -
                                    s
                                    =
                                    
                                       
                                          
                                             v
                                             -
                                             
                                                
                                                   (
                                                   v
                                                   -
                                                   1
                                                   )
                                                   b
                                                
                                                
                                                   a
                                                   +
                                                   b
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   v
                                                   -
                                                   1
                                                   )
                                                   a
                                                
                                                
                                                   a
                                                   +
                                                   b
                                                
                                             
                                          
                                       
                                    
                                    +
                                    1
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   v
                                                   -
                                                   1
                                                   )
                                                   a
                                                
                                                
                                                   a
                                                   +
                                                   b
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

Similarly, suppose there are v
                           −1 products generated, and denote k as the optimal size of the BA block, then we get 
                              
                                 k
                                 =
                                 
                                    
                                       
                                          
                                             
                                                (
                                                v
                                                -
                                                2
                                                )
                                                a
                                             
                                             
                                                a
                                                +
                                                b
                                             
                                          
                                       
                                    
                                 
                              
                           , and the optimal size of the AB block is 
                              
                                 v
                                 -
                                 1
                                 -
                                 k
                                 =
                                 
                                    
                                       
                                          
                                             
                                                (
                                                v
                                                -
                                                2
                                                )
                                                b
                                             
                                             
                                                a
                                                +
                                                b
                                             
                                          
                                       
                                    
                                 
                              
                           .

Note that it is easy to check that either s
                           =
                           v
                           −1−
                           k or k
                           =
                           v
                           −
                           s.

(a) When N
                           <
                           n
                           ⩽
                           n
                           1, β
                           ∗(n)=2θ
                           +1. There are θ
                           +1 number of AB blocks and θ number of BA blocks. It is easy to see that v can be determined by either 
                              
                                 
                                    
                                       
                                          
                                             
                                                n
                                                -
                                                s
                                             
                                             
                                                θ
                                             
                                          
                                       
                                    
                                 
                                 =
                                 v
                              
                            or 
                              
                                 
                                    
                                       
                                          
                                             
                                                n
                                                -
                                                (
                                                v
                                                -
                                                1
                                                -
                                                k
                                                )
                                             
                                             
                                                θ
                                             
                                          
                                       
                                    
                                 
                                 =
                                 v
                              
                           . Note that
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   n
                                                   -
                                                   s
                                                
                                                
                                                   θ
                                                
                                             
                                          
                                       
                                    
                                    =
                                    v
                                    ⇒
                                    v
                                    -
                                    1
                                    <
                                    
                                       
                                          n
                                          -
                                          s
                                       
                                       
                                          θ
                                       
                                    
                                    ⩽
                                    v
                                    ⇒
                                    n
                                    -
                                    θ
                                    v
                                    ⩽
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   v
                                                   -
                                                   1
                                                   )
                                                   b
                                                
                                                
                                                   a
                                                   +
                                                   b
                                                
                                             
                                          
                                       
                                    
                                    <
                                    n
                                    -
                                    θ
                                    (
                                    v
                                    -
                                    1
                                    )
                                    ⇒
                                    n
                                    -
                                    1
                                    -
                                    θ
                                    <
                                    (
                                    v
                                    -
                                    1
                                    )
                                    
                                       
                                          
                                             θ
                                             +
                                             
                                                
                                                   b
                                                
                                                
                                                   a
                                                   +
                                                   b
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    n
                                    -
                                    1
                                    ⇒
                                    
                                       
                                          (
                                          n
                                          -
                                          1
                                          )
                                          (
                                          a
                                          +
                                          b
                                          )
                                          +
                                          b
                                       
                                       
                                          θ
                                          (
                                          a
                                          +
                                          b
                                          )
                                          +
                                          b
                                       
                                    
                                    <
                                    v
                                    ⩽
                                    
                                       
                                          (
                                          n
                                          -
                                          1
                                          )
                                          (
                                          a
                                          +
                                          b
                                          )
                                       
                                       
                                          θ
                                          (
                                          a
                                          +
                                          b
                                          )
                                          +
                                          b
                                       
                                    
                                    +
                                    1
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   n
                                                   -
                                                   (
                                                   v
                                                   -
                                                   1
                                                   -
                                                   k
                                                   )
                                                
                                                
                                                   θ
                                                
                                             
                                          
                                       
                                    
                                    =
                                    v
                                    ⇒
                                    n
                                    -
                                    θ
                                    v
                                    ⩽
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   v
                                                   -
                                                   2
                                                   )
                                                   b
                                                
                                                
                                                   a
                                                   +
                                                   b
                                                
                                             
                                          
                                       
                                    
                                    <
                                    n
                                    -
                                    θ
                                    (
                                    v
                                    -
                                    1
                                    )
                                    ⇒
                                    n
                                    -
                                    1
                                    -
                                    2
                                    θ
                                    <
                                    (
                                    v
                                    -
                                    2
                                    )
                                    
                                       
                                          
                                             θ
                                             +
                                             
                                                
                                                   b
                                                
                                                
                                                   a
                                                   +
                                                   b
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    n
                                    -
                                    1
                                    -
                                    θ
                                    ⇒
                                    
                                       
                                          (
                                          n
                                          -
                                          1
                                          )
                                          (
                                          a
                                          +
                                          b
                                          )
                                          +
                                          2
                                          b
                                       
                                       
                                          θ
                                          (
                                          a
                                          +
                                          b
                                          )
                                          +
                                          b
                                       
                                    
                                    <
                                    v
                                    ⩽
                                    
                                       
                                          (
                                          n
                                          -
                                          1
                                          )
                                          (
                                          a
                                          +
                                          b
                                          )
                                          +
                                          b
                                       
                                       
                                          θ
                                          (
                                          a
                                          +
                                          b
                                          )
                                          +
                                          b
                                       
                                    
                                    +
                                    1
                                    .
                                 
                              
                           Hence, from either 
                              
                                 
                                    
                                       
                                          
                                             
                                                n
                                                -
                                                s
                                             
                                             
                                                θ
                                             
                                          
                                       
                                    
                                 
                                 =
                                 v
                              
                            or 
                              
                                 
                                    
                                       
                                          
                                             
                                                n
                                                -
                                                (
                                                v
                                                -
                                                1
                                                -
                                                k
                                                )
                                             
                                             
                                                θ
                                             
                                          
                                       
                                    
                                 
                                 =
                                 v
                              
                           , we conclude 
                              
                                 
                                    
                                       (
                                       n
                                       -
                                       1
                                       )
                                       (
                                       a
                                       +
                                       b
                                       )
                                       +
                                       b
                                    
                                    
                                       θ
                                       (
                                       a
                                       +
                                       b
                                       )
                                       +
                                       b
                                    
                                 
                                 <
                                 v
                                 ⩽
                                 
                                    
                                       (
                                       n
                                       -
                                       1
                                       )
                                       (
                                       a
                                       +
                                       b
                                       )
                                       +
                                       b
                                    
                                    
                                       θ
                                       (
                                       a
                                       +
                                       b
                                       )
                                       +
                                       b
                                    
                                 
                                 +
                                 1
                              
                           , which implies 
                              
                                 v
                                 =
                                 
                                    
                                       
                                          
                                             
                                                (
                                                n
                                                -
                                                1
                                                )
                                                (
                                                a
                                                +
                                                b
                                                )
                                                +
                                                b
                                             
                                             
                                                θ
                                                (
                                                a
                                                +
                                                b
                                                )
                                                +
                                                b
                                             
                                          
                                          +
                                          1
                                       
                                    
                                 
                              
                           .

Furthermore, after excluding an (AB)
                              s
                            block, the remaining n
                           −
                           s products form θ pairs of AB and BA blocks. Denote θ
                           
                              v
                            as the number of pairs which produce v units, then it is straightforward to see that θ
                           
                              v
                           
                           =(n
                           −
                           s)−
                           θ(v
                           −1), and there are θ
                           −
                           θ
                           
                              v
                            pairs generating v
                           −1 units. Hence, the number of (AB)
                              s
                            is θ
                           
                              v
                           
                           +1, and the number of (BA)
                              v−s
                            is θ
                           
                              v
                           , the number of (AB)
                              v−1−k
                            is θ
                           −
                           θ
                           
                              v
                           , the number of (BA)
                              k
                            is θ
                           −
                           θ
                           
                              v
                           .

(b) When n
                           1
                           <
                           n
                           <
                           n
                           2, β
                           ∗(n)=2θ
                           +2. There are θ
                           +1 number of AB blocks and θ
                           +1 number of BA blocks. It is intuitive to know that 
                              
                                 v
                                 =
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                θ
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                            and θ
                           
                              v
                           
                           =
                           n
                           −(θ
                           +1)(v
                           − 1). The numbers of different AB and BA blocks must be the ones shown in Table 1.

(c) When n
                           2
                           ⩽
                           n
                           <
                           N
                           +(s
                           ∗
                           +
                           k
                           ∗), β
                           ∗(n)=2 θ
                           +3. There are θ
                           +2 number of AB blocks and θ
                           +1 number of BA blocks. Follow the logic used in (a), we can verify the desired results.□


                     Theorem 3 characterizes the structure of optimal sequences when n
                     ≠
                     s
                     ∗
                     +
                     θ (k
                     ∗
                     +
                     s
                     ∗). Note that although n
                     1 and n
                     2 are not explicitly specified, the optimal intermediate sequence could be easily obtained by picking the sequence of the three candidate sequences in Table 1 that has the smallest objective value. Furthermore, when the corresponding recurring sequence is significantly long (i.e., θ is large), the size of any AB (BA) block in the optimal intermediate sequence is at most 1 unit different from s
                     ∗(k
                     ∗). This property enables us not only to derive the closed-form expressions for n
                     1 and n
                     2, but also to convert them into the extra unit thresholds x
                     1 and x
                     2 established in Proposition 1, which are independent of θ. (Expressions for these thresholds are derived in the proof of the result.)
                        Proposition 1
                        
                           If n
                           
                           =
                           
                           s
                           ∗
                           
                           +
                           
                           θ(k
                           ∗
                           
                           +
                           
                           s
                           ∗
                           )
                           
                           +
                           
                           x, where θ
                           ⩾
                           (k
                           ∗
                           
                           +
                           
                           s
                           ∗
                           ), 0
                           <
                           x
                           <
                           k
                           ∗
                           
                           +
                           
                           s
                           ∗
                           , an optimal sequence for the problem is characterized in 
                           
                              Table 2
                           
                           , based on the two thresholds x
                           
                              1
                            
                           and x
                           
                              2
                           
                           , which satisfy 0
                           <
                           x
                           
                              1
                           
                           ⩽ 
                           x
                           
                              2
                           
                           <
                           k
                           ∗
                           
                           +
                           
                           s
                           ∗
                           .
                        

The existence of x
                           1 and x
                           2 is guaranteed by Theorem 1 and Lemma 3. Since θ
                           ⩾
                           s
                           ∗
                           +
                           k
                           ∗, for n
                           =
                           s
                           ∗
                           +
                           θ(s
                           ∗
                           +
                           k
                           ∗)+
                           x products, we need to compare the following three sequences:
                              
                                 (i)
                                 The best β-changeover sequence 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                0
                                             
                                          
                                       
                                    . By Lemma 1(c), the extra x products must be evenly distributed to either x AB blocks or x BA blocks. Specifically, (2) indicates that
                                       
                                          (4)
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               a
                                                               ⩽
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               b
                                                               ⇒
                                                               
                                                               increase
                                                               
                                                               AB
                                                               
                                                               block
                                                               ’
                                                               s
                                                               
                                                               size
                                                               
                                                               from
                                                               
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               
                                                               to
                                                               
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               +
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               a
                                                               ⩾
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               b
                                                               ⇒
                                                               
                                                               increase
                                                               
                                                               BA
                                                               
                                                               block
                                                               ’
                                                               s
                                                               
                                                               size
                                                               
                                                               from
                                                               
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               
                                                               to
                                                               
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 

The best β
                                    +1-changeover sequence 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                1
                                             
                                          
                                       
                                    . Still by Lemma 1(c), n′=(θ
                                    +1)(s
                                    ∗
                                    +
                                    k
                                    ∗) implies 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          {
                                          
                                             
                                                s
                                             
                                             
                                                ∗
                                             
                                          
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                          …
                                          
                                             
                                                s
                                             
                                             
                                                ∗
                                             
                                          
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                          }
                                       
                                    . We can derive 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                1
                                             
                                          
                                       
                                     from 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                       
                                    . If x
                                    ⩾
                                    k
                                    ∗, distribute x
                                    −
                                    k
                                    ∗ products to either x
                                    −
                                    k
                                    ∗ 
                                    AB blocks or x
                                    −
                                    k
                                    ∗ 
                                    BA blocks, following (4). If x
                                    ⩽
                                    k
                                    ∗, remove one product each from either k
                                    ∗
                                    −
                                    x AB blocks or k
                                    ∗
                                    −
                                    x BA blocks, according to
                                       
                                          (5)
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               -
                                                               1
                                                               )
                                                               a
                                                               ⩽
                                                               (
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               -
                                                               1
                                                               )
                                                               b
                                                               ⇒
                                                               
                                                               decrease
                                                               
                                                               BA
                                                               
                                                               block
                                                               ’
                                                               s
                                                               
                                                               size
                                                               
                                                               from
                                                               
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               
                                                               to
                                                               
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               -
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               -
                                                               1
                                                               )
                                                               a
                                                               ⩾
                                                               (
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               -
                                                               1
                                                               )
                                                               b
                                                               ⇒
                                                               
                                                               decrease
                                                               
                                                               AB
                                                               
                                                               block
                                                               ’
                                                               s
                                                               
                                                               size
                                                               
                                                               from
                                                               
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               
                                                               to
                                                               
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 

The best β
                                    +2-changeover sequence 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                       
                                    . Based on the optimal sequence for s
                                    ∗
                                    +(θ
                                    +1) (s
                                    ∗
                                    +
                                    k
                                    ∗) products, Lemma 1(c) implies that we remove (s
                                    ∗
                                    +
                                    k
                                    ∗)−
                                    x products from either (s
                                    ∗
                                    +
                                    k
                                    ∗)−
                                    x AB blocks or from (s
                                    ∗
                                    +
                                    k
                                    ∗)−
                                    x BA blocks, according to (5).

We summarize the above discussion on how to add and remove units from a block into three cases: (s
                           ∗
                           −1)a
                           ⩽(k
                           ∗
                           −1)b
                           ⩽
                           s
                           ∗
                           a
                           ⩽
                           k
                           ∗
                           b, (k
                           ∗
                           −1)b
                           ⩽(s
                           ∗
                           −1)a 
                           ⩽
                           s
                           ∗
                           a
                           ⩽
                           k
                           ∗
                           b, and (k
                           ∗
                           −1)b
                           ⩽(s
                           ∗
                           −1)a
                           ⩽
                           k
                           ∗
                           b
                           ⩽
                           s
                           ∗
                           a (the fourth case (s
                           ∗
                           −1)b
                           ⩽(k
                           ∗
                           −1)a
                           ⩽
                           k
                           ∗
                           b
                           ⩽
                           s
                           ∗
                           a is impossible due to a
                           ⩽
                           b). We show how x
                           1 and x
                           2 can be characterized for the first of the three cases, where (s
                           ∗
                           −1)a
                           ⩽(k
                           ∗
                           −1)b
                           ⩽
                           s
                           ∗
                           a
                           ⩽
                           k
                           ∗
                           b. (The other two cases are omitted for conciseness.) Denote 
                              
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 C
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           , i
                           =0, 1, 2. Based on (2), (1), (4) and (5), we have
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    x
                                    )
                                    -
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  ∗
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  ∗
                                                               
                                                            
                                                            -
                                                            1
                                                            )
                                                            b
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      -
                                                      c
                                                      +
                                                      [
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      a
                                                      -
                                                      (
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      -
                                                      1
                                                      )
                                                      b
                                                      ]
                                                      x
                                                   
                                                   
                                                      if
                                                      
                                                      x
                                                      ⩽
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      a
                                                      -
                                                      c
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  ∗
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  ∗
                                                               
                                                            
                                                            -
                                                            1
                                                            )
                                                            b
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      if
                                                      
                                                      x
                                                      ⩾
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    x
                                    )
                                    -
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      -
                                                      1
                                                      )
                                                      b
                                                      -
                                                      c
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                               
                                                               
                                                                  ∗
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  s
                                                               
                                                               
                                                                  ∗
                                                               
                                                            
                                                            -
                                                            1
                                                            )
                                                            a
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      if
                                                      
                                                      x
                                                      ⩽
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      )
                                                      (
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      -
                                                      1
                                                      )
                                                      b
                                                      -
                                                      [
                                                      (
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      -
                                                      1
                                                      )
                                                      b
                                                      -
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      a
                                                      ]
                                                      x
                                                   
                                                
                                                
                                                   
                                                      -
                                                      c
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                               
                                                               
                                                                  ∗
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  s
                                                               
                                                               
                                                                  ∗
                                                               
                                                            
                                                            +
                                                            2
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  ∗
                                                               
                                                            
                                                            -
                                                            1
                                                            )
                                                            a
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      if
                                                      
                                                      x
                                                      ⩾
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    x
                                    )
                                    -
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    [
                                    
                                       
                                          s
                                       
                                       
                                          ∗
                                       
                                    
                                    a
                                    -
                                    (
                                    
                                       
                                          k
                                       
                                       
                                          ∗
                                       
                                    
                                    -
                                    1
                                    )
                                    b
                                    ]
                                    x
                                    +
                                    
                                       
                                          (
                                          2
                                          
                                             
                                                s
                                             
                                             
                                                ∗
                                             
                                          
                                          +
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                          (
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                          -
                                          1
                                          )
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ∗
                                             
                                          
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                ∗
                                             
                                          
                                          -
                                          1
                                          )
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    2
                                    c
                                 
                              
                           Checking the first derivative with respect to x for the above expressions, and noticing that C
                           0(0)=min{C
                           0(0),
                           C
                           1(0),
                           C
                           2(0)} and C
                           2(k
                           ∗
                           +
                           s
                           ∗)=min{C
                           0(k
                           ∗
                           +
                           s
                           ∗), C
                           1(k
                           ∗
                           +
                           s
                           ∗), C
                           2(k
                           ∗
                           +
                           s
                           ∗)}, we determine x
                           1 and x
                           2 as follows: If C
                           2(0)−
                           C
                           1(0)⩽0, then C
                           1(x)⩾
                           C
                           2(x) for all x. Comparing C
                           0(x) and C
                           2(x), 
                              
                                 
                                    
                                       [
                                       
                                          
                                             C
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       x
                                       )
                                       -
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       x
                                       )
                                       ]
                                    
                                    
                                       x
                                    
                                    
                                       ′
                                    
                                 
                                 ⩾
                                 0
                              
                            implies 
                              
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       2
                                       c
                                       +
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                       )
                                       a
                                       /
                                       2
                                       -
                                       
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       (
                                       
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                       )
                                       b
                                       /
                                       2
                                       -
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                       (
                                       
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                       )
                                       b
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                       a
                                       -
                                       (
                                       
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                       )
                                       b
                                    
                                 
                              
                           . If C
                           2(0)−
                           C
                           1(0) >0 then x
                           ⩽
                           k
                           ∗ implies C
                           2(x)>
                           C
                           1(x). Moreover, if C
                           1(k
                           ∗)−
                           C
                           0(k
                           ∗)⩾0, then x
                           ⩾
                           k
                           ∗ implies C
                           1(x)⩾
                           C
                           0(x) and C
                           2(k
                           ∗)>
                           C
                           1(k
                           ∗)⩾
                           C
                           0(k
                           ∗). Hence, due to 
                              
                                 
                                    
                                       [
                                       
                                          
                                             C
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       x
                                       )
                                       -
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       x
                                       )
                                       ]
                                    
                                    
                                       x
                                    
                                    
                                       ′
                                    
                                 
                                 ⩾
                                 0
                              
                           , comparing C
                           0(x) and C
                           2(x), we get 
                              
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       2
                                       c
                                       +
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                       )
                                       a
                                       /
                                       2
                                       -
                                       
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       (
                                       
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                       )
                                       b
                                       /
                                       2
                                       -
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                       (
                                       
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                       )
                                       b
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                       a
                                       -
                                       (
                                       
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                       )
                                       b
                                    
                                 
                              
                           . On the other hand, if C
                           1(k
                           ∗)<
                           C
                           0(k
                           ∗), then x
                           <
                           k
                           ∗ implies that we need to compare C
                           0(x) and C
                           1(x) and x
                           ⩾
                           k
                           ∗ implies that we need to compare
                           C
                           1(x) and C
                           2(x). Thus, 
                              
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       c
                                       -
                                       
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       (
                                       
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                       )
                                       b
                                       /
                                       2
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                       a
                                       -
                                       (
                                       
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                       )
                                       b
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       c
                                       +
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                       )
                                       a
                                       /
                                       2
                                       -
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                       (
                                       
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                       )
                                       b
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                       a
                                       -
                                       (
                                       
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                       )
                                       b
                                    
                                 
                                 +
                                 k
                              
                           .□

@&#CONCLUSION@&#

We study the problem of scheduling identical products with components on a single machine where changeovers incur fixed costs. The objective is to minimize the weighted sum of total flow time and changeover cost. We prove several structural results which ultimately lead to an explicit characterization of optimal sequences for given problem parameters. We show that the optimal sequences are composed of constant batch sizes (i.e., sizes of intermediate batches differ at most by one), except for the beginning and the ending batches. We also show that there exists a series of recurrent optimal sequences, and we obtain closed-form expressions for the integer batch sizes in these recurrent optimal sequences.

The existence of recurrent optimal sequences as well as the constant-batch-size property in the optimal sequence have important practical implications. First, these results are intuitive and easy to implement by production managers. Second, for large problems the optimal sequence is robust with regard to demand changes. For example, imagine a production manager who has to decide a production sequence based on early demand information, which then is updated after production is initiated due to, for example, the arrival of new orders or the cancelation of existing orders. Our results imply that, with the exception of its ending portion where minor adjustments might be required, the original sequence remains optimal even under the finalized demand information. Third, in situations where the machine is required to be continuously running without any interruption for a long time (due to technical constraints or in order to meet predictably high future demand), the optimal production policy that minimizes the weighted sum of flow time and changeover cost is a recurrent sequence with constant batch sizes.


                     
                        Lemma 1
                        For n products, there exists an optimal sequence 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                              
                            which has the following properties:
                              
                                 (a)
                                 
                                    If any two AB (or BA) blocks are exchanged, the resulting sequence is still optimal. Moreover, if 
                                    
                                       
                                          β
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         n
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                          
                                       
                                     
                                    is even, then switching all AB blocks with all BA blocks will result in an optimal sequence.
                                 


                                    If a
                                    ⩽
                                    b, and there are m AB blocks, then 
                                    
                                       
                                          m
                                          =
                                          
                                             
                                                
                                                   β
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  σ
                                                               
                                                               
                                                                  n
                                                               
                                                               
                                                                  ∗
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   /
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    . That is, the number of AB blocks is never less than the number of BA blocks.
                                 


                                    The sizes of the different types of blocks must satisfy (s
                                    −
                                    1)a
                                    ⩽
                                    kb and sa
                                    ⩾
                                    (k
                                    −
                                    1)b, the sizes of the same type of blocks differ at most by 1, and there are at most 3 different block sizes.
                                 


                           
                              
                                 (a)
                                 For any σ
                                    
                                       n
                                    , from (1), 
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                     depends on neither the sequence of the AB blocks, nor the sequence of the BA blocks. If β(σ
                                    
                                       n
                                    ) is even, then switching all of the AB blocks with all of the BA blocks leaves 
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                     unchanged.

For any σ
                                    
                                       n
                                    , each BA block must follow an AB block, so that ∣β
                                    
                                       o
                                    
                                    −2m∣⩽1. If β
                                    
                                       o
                                    
                                    −2m
                                    =1 and a
                                    ⩽
                                    b, then that sequence begins and ends with a BA block, and by (1), its flow time does not increase when changing the last BA block to an AB block, and then interchanging all of the remaining BA blocks with the AB blocks.

Let 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                o
                                             
                                          
                                       
                                     denote a minimum flow-time sequence with β
                                    
                                       o
                                     changeovers, and in 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                o
                                             
                                          
                                       
                                    , consider two different types of blocks, (AB)
                                       s
                                     and (BA)
                                       k
                                    . Because 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                o
                                             
                                          
                                       
                                     is flow-time minimal, (s,
                                    k) must minimize 
                                       
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          s
                                          (
                                          s
                                          -
                                          1
                                          )
                                          a
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          k
                                          (
                                          k
                                          -
                                          1
                                          )
                                          b
                                       
                                    , which requires sa
                                    ⩾(k
                                    −1)b and kb
                                    ⩾(s
                                    −1)a. Suppose there are n
                                    
                                       s
                                     products in the AB blocks and n
                                    
                                       k
                                    
                                    =
                                    n
                                    −
                                    n
                                    
                                       s
                                     products in the BA blocks. It is easy to show, through induction on m, that the minimization problem
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      …
                                                      +
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      p
                                                      =
                                                      1
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   s
                                                
                                                
                                                   p
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   p
                                                
                                             
                                             -
                                             1
                                             )
                                             a
                                          
                                       
                                    is solved by s
                                    
                                       p
                                    
                                    =⌈n
                                    
                                       s
                                    /m⌉, for p
                                    =1,…,
                                    m′, and s
                                    
                                       p
                                    
                                    =⌊n
                                    
                                       s
                                    /m⌋, for p
                                    =
                                    m′+1,…,
                                    m, where m′=(n
                                    
                                       s
                                     mod m). Hence, the sizes of the AB blocks can differ at most by 1. The same logic holds for the BA blocks, so there are at most 4 different block sizes. Assume, w.l.o.g., these block sizes are s and s
                                    −1 for the AB blocks and k and k
                                    −1 for the BA blocks, where s
                                    ≠
                                    k. Since 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                o
                                             
                                          
                                       
                                     is the best β
                                    
                                       o
                                    -changeover sequence, it must have the smallest total flow time, so (2) and (1) imply that 
                                       
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          s
                                          (
                                          s
                                          -
                                          1
                                          )
                                          a
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          k
                                          -
                                          1
                                          )
                                          (
                                          k
                                          -
                                          2
                                          )
                                          b
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          s
                                          -
                                          1
                                          )
                                          (
                                          s
                                          -
                                          2
                                          )
                                          a
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          k
                                          (
                                          k
                                          -
                                          1
                                          )
                                          b
                                       
                                    . Thus, any transformation between (AB)
                                       s
                                    (BA)
                                       k−1 blocks and (AB)
                                       s−1(BA)
                                       k
                                     blocks keeps the sequence’s flow-time optimality, so we can always construct an optimal β
                                    
                                       o
                                    -changeover sequence which has at most 3 different block sizes.□


                           Suppose an optimal sequence 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                              
                            
                           has m AB blocks, and consider 
                           
                              
                                 
                                    
                                       m
                                    
                                    
                                       o
                                    
                                 
                                 ⩽
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 -
                                 m
                              
                           
                           . Then we have the following properties:
                           
                              
                                 (a)
                                 
                                    After removing any m
                                    
                                       o
                                     
                                    AB blocks and any m
                                    
                                       o
                                     
                                    BA blocks and resorting the remaining blocks such that the AB blocks and the BA blocks are alternating (to ensure normal form), the resulting sequence is optimal for the remaining number of products.
                                 


                                    If 
                                    
                                       
                                          β
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         n
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          2
                                          m
                                       
                                    
                                    , then after removing any (m
                                    
                                       o
                                    
                                    −
                                    1) AB blocks and m
                                    
                                       o
                                     
                                    BA blocks and resorting the remaining blocks such that the AB blocks and the BA blocks are alternating, the resulting sequence is optimal for the remaining number of products.
                                 

It suffices to prove that the conclusion holds for m
                           
                              o
                           
                           =1.
                              
                                 (a)
                                 According to Lemma 1(a), we can focus on removing the first two blocks (AB)
                                       s
                                    (BA)
                                       k
                                     in an optimal sequence 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    . The resulting sequence is 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                o
                                             
                                          
                                       
                                    , where n′=
                                    n
                                    −(s
                                    +
                                    k). Lemma 1(a) and (b) suggest that there exists a 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                     starting with an AB block. Correspondingly, putting (AB)
                                       s
                                    (BA)
                                       k
                                     in front of 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    , we get a 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                o
                                             
                                          
                                       
                                    . Clearly, from (2) and (1), we have 
                                       
                                          C
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         n
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          C
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          C
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         n
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          C
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    , implying 
                                       
                                          C
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                o
                                             
                                          
                                          )
                                          ⩽
                                          C
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                    , so that 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                o
                                             
                                          
                                       
                                     must also be optimal.

If 
                                       
                                          β
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         n
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          2
                                          m
                                       
                                    , then Lemma 1(a) and (b) suggest that we can always make the optimal sequence start with a (BA)
                                       k
                                     block. Then, removing this initial block and applying the logic in (a), we can directly verify the conclusion.□


                           If 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                              
                            
                           is an optimal sequence with 
                           
                              
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                              
                            
                           changeovers, then there exists an optimal sequence 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                              
                            
                           such that 
                           
                              
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                              
                           
                           . In addition, 
                           
                              
                                 
                                    
                                       lim
                                    
                                    
                                       n
                                       →
                                       ∞
                                    
                                 
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 =
                                 ∞
                              
                           
                           .
                        

We first prove the monotonicity of 
                              
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                              
                            in n. Based on Lemma 1(c), w.l.o.g., we assume that a 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                              
                            has m′ (AB)
                              s
                            blocks, m″ (AB)
                              s−1 blocks, and 
                              
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 -
                                 (
                                 
                                    
                                       m
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 
                                    
                                       m
                                    
                                    
                                       ″
                                    
                                 
                                 )
                              
                            (BA)
                              k
                            blocks. Denote 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       o
                                    
                                 
                              
                            as the best sequence for n
                           +1 products with 
                              
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                              
                            changeovers. 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       o
                                    
                                 
                              
                            can be constructed from 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                              
                            by adding the extra product to either an AB block or a BA block. If m″=0, the extra product goes to either an (AB)
                              s
                            block when sa
                           ⩽
                           kb or a (BA)
                              k
                            block when sa
                           >
                           kb; otherwise, by Lemma 1(c), the extra product must go to an (AB)
                              s−1 block, implying (s
                           − 1)a
                           ⩽
                           kb.

We now prove the result by contradiction. Take the case where m″>0. Suppose 
                              
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 <
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                              
                           , then 
                              
                                 C
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 <
                                 C
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                              
                           . Let m
                           ∗ denote the total number of AB blocks in sequence 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                              
                            the largest size of all AB blocks, and k
                           ∗ the largest size of all BA blocks. Since Lemma 1(b) shows that m
                           ∗
                           ⩽
                           m′+
                           m″ and 
                              
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       m
                                    
                                    
                                       ∗
                                    
                                 
                                 ⩽
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 -
                                 (
                                 
                                    
                                       m
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 
                                    
                                       m
                                    
                                    
                                       ″
                                    
                                 
                                 )
                              
                           , we can infer from (2) that either s
                           ∗
                           ⩾
                           s or k
                           ∗
                           ⩾
                           k. (i) If s
                           ∗
                           ⩾
                           s, we can remove one product from an 
                              
                                 
                                    
                                       (
                                       AB
                                       )
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                            block in sequence 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                              
                           . Denote the resulting sequence as 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       o
                                    
                                 
                              
                           , then (2), and (1), and s
                           ∗
                           ⩾
                           s imply 
                              
                                 C
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 -
                                 C
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 C
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                                 -
                                 C
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 ⇒
                                 C
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                                 <
                                 C
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                              
                           , which is a contradiction to the assumption of an optimal sequence. (ii) If s
                           ∗
                           <
                           s, then k
                           ∗
                           >
                           k. Remove one product from a 
                              
                                 
                                    
                                       (
                                       BA
                                       )
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                            block in 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                              
                            to get 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       o
                                    
                                 
                              
                           . Then, we have 
                              
                                 
                                    
                                       
                                          C
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         n
                                                         +
                                                         1
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          C
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         n
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          C
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         n
                                                         +
                                                         1
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          C
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         n
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 -
                                 1
                                 )
                                 b
                                 -
                                 (
                                 s
                                 -
                                 1
                                 )
                                 a
                                 <
                                 0
                              
                           , which is a contradiction to m″>0⇒(s
                           −1)a
                           <
                           kb
                           ⇒(k
                           ∗
                           −1)b
                           −(s
                           −1)a
                           >(k
                           ∗
                           −1)b
                           −
                           kb
                           ⩾0. The argument for the case where m″=0 follows similar logic.

We next show that 
                              
                                 
                                    
                                       lim
                                    
                                    
                                       n
                                       →
                                       ∞
                                    
                                 
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 =
                                 ∞
                              
                           . Suppose that there exists an N such that 
                              
                                 n
                                 ⩾
                                 N
                                 ⇒
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 =
                                 β
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                N
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       β
                                    
                                    
                                       N
                                    
                                 
                              
                           , and that there are m
                           
                              N
                            
                           AB blocks and l
                           
                              N
                            
                           BA blocks in 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       N
                                    
                                    
                                       ∗
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                              
                           . Let 
                              
                                 
                                    
                                       s
                                    
                                    
                                       p
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 n
                                 )
                              
                            denote the size of the pth AB block in 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                              
                            and let 
                              
                                 
                                    
                                       k
                                    
                                    
                                       q
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 n
                                 )
                              
                            denote the size of the qth BA block. It is true that 
                              
                                 
                                    
                                       lim
                                    
                                    
                                       n
                                       →
                                       ∞
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       p
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 n
                                 )
                                 =
                                 ∞
                              
                            and 
                              
                                 
                                    
                                       lim
                                    
                                    
                                       n
                                       →
                                       ∞
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       q
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 n
                                 )
                                 =
                                 ∞
                              
                           . Denote 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                            as the best (β
                           
                              N
                           
                           +2)-changeover sequence, then 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 <
                                 2
                                 c
                              
                            must hold for all n
                           ⩾
                           N.

For any n′⩾
                           N, we can create an alternative (β
                           
                              N
                           
                           +2)-changeover sequence 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       ″
                                    
                                 
                              
                            for n(> n′) products from the best (β
                           
                              N
                           
                           +2)-changeover sequence for n′-product 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                              
                            as follows. (i) The sizes of the last AB block and the last BA block are the same as in sequence 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                              
                           , i.e., 
                              
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             N
                                          
                                       
                                       +
                                       1
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 n
                                 )
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             N
                                          
                                       
                                       +
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                            and 
                              
                                 
                                    
                                       k
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             N
                                          
                                       
                                       +
                                       1
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 n
                                 )
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             N
                                          
                                       
                                       +
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                           . (ii) Since both 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                              
                            have β
                           
                              N
                           
                           =
                           m
                           
                              N
                           
                           +
                           l
                           
                              N
                            changeovers, we can adjust the sizes of the first m
                           
                              N
                            
                           AB blocks and the first l
                           
                              N
                            
                           BA blocks according to the difference between 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                              
                           . That is, 
                              
                                 
                                    
                                       s
                                    
                                    
                                       p
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 n
                                 )
                                 -
                                 
                                    
                                       s
                                    
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       p
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 n
                                 )
                                 -
                                 
                                    
                                       s
                                    
                                    
                                       p
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                            and 
                              
                                 
                                    
                                       k
                                    
                                    
                                       q
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 n
                                 )
                                 -
                                 
                                    
                                       k
                                    
                                    
                                       q
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       q
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 n
                                 )
                                 -
                                 
                                    
                                       k
                                    
                                    
                                       q
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                           . Obviously, we must have 
                              
                                 
                                    
                                       lim
                                    
                                    
                                       n
                                       →
                                       ∞
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       p
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 n
                                 )
                                 =
                                 ∞
                              
                            and 
                              
                                 
                                    
                                       lim
                                    
                                    
                                       n
                                       →
                                       ∞
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       q
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 n
                                 )
                                 =
                                 ∞
                              
                           , implying there exists an n″> 
                           n′ such that 
                              
                                 max
                                 
                                    
                                       
                                          
                                             
                                                k
                                             
                                             
                                                q
                                             
                                             
                                                ″
                                             
                                          
                                          (
                                          
                                             
                                                n
                                             
                                             
                                                ″
                                             
                                          
                                          )
                                          |
                                          q
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       k
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             N
                                          
                                       
                                       +
                                       1
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       ″
                                    
                                 
                                 )
                                 +
                                 1
                                 +
                                 
                                    
                                       2
                                       c
                                    
                                    
                                       b
                                    
                                 
                              
                           . Then, according to Lemma 1(c), we can improve sequence 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ″
                                          
                                       
                                    
                                    
                                       ″
                                    
                                 
                              
                            by moving one unit from the largest BA block to the last BA block, and the resulting sequence’s cost must be at least b
                           +2c less than the cost of 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ″
                                          
                                       
                                    
                                    
                                       ″
                                    
                                 
                              
                           . That is, 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ″
                                          
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ″
                                                   
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ″
                                          
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ″
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 >
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ″
                                          
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ″
                                                   
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ″
                                                   
                                                
                                             
                                          
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               ″
                                                            
                                                         
                                                      
                                                      
                                                         ″
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          b
                                          -
                                          2
                                          c
                                       
                                    
                                 
                                 >
                                 2
                                 c
                              
                           . This is a contradiction to the previous conclusion that 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 <
                                 2
                                 c
                              
                            holds for all n
                           ⩾
                           N.

Suppose A
                     1, A
                     2,⋯,
                     A
                     
                        m
                      are the m components of a product and their corresponding processing times satisfy a
                     1
                     ⩽
                     a
                     2
                     ⩽⋯⩽
                     a
                     
                        m
                     . Similar to the 2-component product setting, we use (A
                     
                        u
                     
                     A
                     
                        u+1
                     ⋯
                     A
                     
                        v
                     )
                        n
                      to represent a sequence that produces A
                     
                        u
                     -type to A
                     
                        v
                     -type components ascending in subscripts and each component type by n units, where 1⩽
                     u
                     ⩽
                     v
                     ⩽
                     m.

For expositional simplicity, we consider 2m types of blocks, denoted as (A
                     
                        m−1,
                     A
                     
                        m
                     )
                        u
                      and (A
                     
                        m
                     ,
                     A
                     
                        m−1)
                        u
                     , u
                     =0,1,⋯,
                     m
                     −1. (A
                     
                        m−1,
                     A
                     
                        m
                     )
                        u
                      type (or (A
                     
                        m
                     ,
                     A
                     
                        m−1)
                        u
                      type) blocks have the following features: (1) they start with A
                     
                        m− 1-type (or A
                     
                        m
                     -type) component; (2) all A
                     
                        m
                     -type (or A
                     
                        m− 1-type) components are produced in a single batch; (3) another u types of single-batch produced components are the first u ones in the list excluding A
                     
                        m
                     -type (or A
                     
                        m−1-type); and (4) the remaining (m
                     −
                     u
                     −1) types of components are produced in two batches which are located both before and after A
                     
                        m
                     -type (or A
                     
                        m −1-type) batch. The notation below
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            m
                                                            -
                                                            1
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                u
                                             
                                             
                                                x
                                             
                                          
                                          =
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                s
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ⋯
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      u
                                                   
                                                
                                                )
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      u
                                                      +
                                                      1
                                                   
                                                
                                                ⋯
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      m
                                                      -
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                s
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      m
                                                   
                                                
                                                )
                                             
                                             
                                                s
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      m
                                                   
                                                
                                                )
                                             
                                             
                                                x
                                                -
                                                s
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      u
                                                      +
                                                      1
                                                   
                                                
                                                ⋯
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      m
                                                      -
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                x
                                                -
                                                s
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                x
                                                -
                                                s
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      m
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                u
                                             
                                             
                                                x
                                             
                                          
                                          =
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      m
                                                   
                                                
                                                )
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ⋯
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      u
                                                   
                                                
                                                )
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      u
                                                      +
                                                      1
                                                   
                                                
                                                ⋯
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      m
                                                      -
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                x
                                                -
                                                k
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      u
                                                      +
                                                      1
                                                   
                                                
                                                ⋯
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      m
                                                      -
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                x
                                                -
                                                k
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      m
                                                   
                                                
                                                )
                                             
                                             
                                                x
                                                -
                                                k
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     indicates how x units of products are produced respectively by (A
                     
                        m−1,
                     A
                     
                        m
                     )
                        u
                      and (A
                     
                        m
                     ,
                     A
                     
                        m−1)
                        u
                      type blocks, where the superscript x represents the block size and the superscripts s and k the batch sizes of a corresponding block type. We next explore the important properties of these block types.

First, block types (A
                     
                        m−1,
                     A
                     
                        m
                     )
                        u
                      and (A
                     
                        m
                     ,
                     A
                     
                        m−1)
                        u
                      have the changeovers of (2m
                     −2−
                     u). Hence, corresponding to u
                     =0, 1,⋯,
                     m
                     −1, we have the sequences with the changeovers from (2m
                     −2) to (m
                     −1). If u
                     <
                     m
                     −1, the starting component type is the same as the ending one. If u
                     =
                     m
                     −1, then s
                     =
                     k
                     =
                     x. That is, 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                              
                                 m
                                 -
                                 1
                              
                              
                                 x
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       m
                                       -
                                       1
                                    
                                 
                                 )
                              
                              
                                 x
                              
                           
                           
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 ⋯
                                 
                                    
                                       A
                                    
                                    
                                       m
                                       -
                                       2
                                    
                                 
                                 )
                              
                              
                                 x
                              
                           
                           
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       m
                                    
                                 
                                 )
                              
                              
                                 x
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             m
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                              
                                 m
                                 -
                                 1
                              
                              
                                 n
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       m
                                    
                                 
                                 )
                              
                              
                                 x
                              
                           
                           
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 ⋯
                                 
                                    
                                       A
                                    
                                    
                                       m
                                       -
                                       2
                                    
                                 
                                 )
                              
                              
                                 x
                              
                           
                           
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       m
                                       -
                                       1
                                    
                                 
                                 )
                              
                              
                                 x
                              
                           
                        
                     . The ending component is different from the starting one. It is interesting to notice that block type (A
                     
                        m−1,
                     A
                     
                        m
                     )0 is the combination of the block types (A
                     
                        m−1,
                     A
                     
                        m
                     )
                        m−1 and (A
                     
                        m
                     ,
                     A
                     
                        m−1)
                        m− 1, and that (A
                     
                        m
                     ,
                     A
                     
                        m−1)0 the combination of (A
                     
                        m
                     ,
                     A
                     
                        m− 1)
                        m−1 and (A
                     
                        m−1,
                     A
                     
                        m
                     )
                        m−1.

Second, the total flow time of producing x units by block type.

(A
                     
                        m−1,A
                     
                        m
                     )
                        m−1 or (A
                     
                        m
                     ,A
                     
                        m−1)
                        m−1 includes both basic flow time 
                        
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                           x
                           (
                           x
                           +
                           1
                           )
                           (
                           
                              
                                 Σ
                              
                              
                                 v
                              
                           
                           
                              
                                 a
                              
                              
                                 v
                              
                           
                           )
                        
                      and the flow time penalty
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                m
                                                -
                                                1
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         m
                                                         -
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          x
                                          (
                                          x
                                          -
                                          1
                                          )
                                          (
                                          
                                             
                                                Σ
                                             
                                             
                                                v
                                                ≠
                                                m
                                             
                                          
                                          
                                             
                                                a
                                             
                                             
                                                v
                                             
                                          
                                          )
                                          ,
                                          or
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                m
                                                -
                                                1
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         m
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         m
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          x
                                          (
                                          x
                                          -
                                          1
                                          )
                                          (
                                          
                                             
                                                Σ
                                             
                                             
                                                v
                                                ≠
                                                m
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                a
                                             
                                             
                                                v
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     which bears similarity to the flow time calculation for the 2-component product, if we regard (Σ
                        v≠m
                     
                     a
                     
                        v
                     ) and (Σ
                        v≠m −1
                     a
                     
                        v
                     ) as the processing time of the consolidated components. It is easy to see that 
                        
                           
                              
                                 F
                              
                              
                                 m
                                 -
                                 1
                              
                              
                                 x
                              
                           
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          m
                                          -
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                           
                           ⩽
                           
                              
                                 F
                              
                              
                                 m
                                 -
                                 1
                              
                              
                                 x
                              
                           
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          m
                                          -
                                          1
                                       
                                    
                                 
                              
                           
                        
                     . In fact, it is most cost efficient to consolidate all component types, except for the A
                     
                        m
                      type.

Third, for u
                     =0,1,⋯,
                     m
                     −2, the total flow time of using an (A
                     
                        m−1,
                     A
                     
                        m
                     )
                        u
                      type (or (A
                     
                        m
                     ,
                     A
                     
                        m−1)
                        u
                      type) block to produce x units with a batch size of s (or k) includes again the basic flow time 
                        
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                           x
                           (
                           x
                           +
                           1
                           )
                           (
                           Σ
                           
                              
                                 a
                              
                              
                                 v
                              
                           
                           )
                        
                      and the flow time penalty
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                u
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         m
                                                         -
                                                         1
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          x
                                          (
                                          x
                                          -
                                          1
                                          )
                                          
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         v
                                                         =
                                                         1
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          s
                                          (
                                          s
                                          -
                                          1
                                          )
                                          
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         v
                                                         =
                                                         u
                                                         +
                                                         1
                                                      
                                                      
                                                         m
                                                         -
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          x
                                          -
                                          s
                                          )
                                          (
                                          x
                                          -
                                          s
                                          -
                                          1
                                          )
                                          
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         v
                                                         =
                                                         u
                                                         +
                                                         1
                                                         ,
                                                         v
                                                         ≠
                                                         m
                                                         -
                                                         1
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                          or
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                u
                                             
                                             
                                                x
                                             
                                          
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                m
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                A
                                             
                                             
                                                m
                                                -
                                                1
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          x
                                          (
                                          x
                                          -
                                          1
                                          )
                                          
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         v
                                                         =
                                                         1
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          x
                                          -
                                          k
                                          )
                                          (
                                          x
                                          -
                                          k
                                          -
                                          1
                                          )
                                          
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         v
                                                         =
                                                         u
                                                         +
                                                         1
                                                      
                                                      
                                                         m
                                                         -
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          k
                                          (
                                          k
                                          -
                                          1
                                          )
                                          
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         v
                                                         =
                                                         u
                                                         +
                                                         1
                                                         ,
                                                         v
                                                         ≠
                                                         m
                                                         -
                                                         1
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Hence, we have 
                        
                           
                              
                                 F
                              
                              
                                 u
                              
                              
                                 x
                              
                           
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          m
                                          -
                                          1
                                       
                                       
                                          s
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                           
                           =
                           
                              
                                 F
                              
                              
                                 u
                              
                              
                                 x
                              
                           
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                       
                                          x
                                          -
                                          s
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          m
                                          -
                                          1
                                       
                                    
                                 
                              
                           
                        
                     . That is, the blocks 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                              
                                 u
                              
                              
                                 x
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             m
                                          
                                          
                                             x
                                             -
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                              
                                 u
                              
                              
                                 x
                              
                           
                        
                      are equivalent in terms of total flow time. This implies that the two can be exchanged when necessary. Recall that 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                              
                                 0
                              
                              
                                 x
                              
                           
                        
                      can be decomposed to 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                              
                                 m
                                 -
                                 1
                              
                              
                                 s
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             m
                                          
                                          
                                             x
                                             -
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                              
                                 m
                                 -
                                 1
                              
                              
                                 x
                                 -
                                 s
                              
                           
                        
                     , so the sequence 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                              
                                 0
                              
                              
                                 x
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                              
                                 u
                              
                              
                                 x
                              
                           
                        
                      must also be equivalent to the sequence 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                              
                                 m
                                 -
                                 1
                              
                              
                                 s
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             m
                                          
                                          
                                             x
                                             -
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                              
                                 u
                              
                              
                                 x
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             m
                                          
                                          
                                             x
                                             -
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                              
                                 m
                                 -
                                 1
                              
                              
                                 x
                                 -
                                 s
                              
                           
                        
                      in terms of total flow time. More interestingly, by treating 
                        
                           (
                           
                              
                                 Σ
                              
                              
                                 v
                                 =
                                 u
                                 +
                                 1
                              
                              
                                 m
                                 -
                                 1
                              
                           
                           
                              
                                 a
                              
                              
                                 v
                              
                           
                           )
                        
                      as one consolidated component’s processing time and 
                        
                           
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          v
                                          =
                                          u
                                          +
                                          1
                                          ,
                                          v
                                          ≠
                                          m
                                          -
                                          1
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          a
                                       
                                       
                                          v
                                       
                                    
                                 
                              
                           
                        
                      as another’s, we can apply a logic similar to the one used for the 2-component product to derive the optimal s and k as
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ¯
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         x
                                                         -
                                                         1
                                                         )
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        Σ
                                                                     
                                                                     
                                                                        v
                                                                        =
                                                                        u
                                                                        +
                                                                        1
                                                                        ,
                                                                        v
                                                                        ≠
                                                                        m
                                                                        -
                                                                        1
                                                                     
                                                                     
                                                                        m
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                     
                                                                     
                                                                        v
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        Σ
                                                                     
                                                                     
                                                                        v
                                                                        =
                                                                        u
                                                                        +
                                                                        1
                                                                     
                                                                     
                                                                        m
                                                                        -
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                     
                                                                     
                                                                        v
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        Σ
                                                                     
                                                                     
                                                                        v
                                                                        =
                                                                        u
                                                                        +
                                                                        1
                                                                        ,
                                                                        v
                                                                        ≠
                                                                        m
                                                                        -
                                                                        1
                                                                     
                                                                     
                                                                        m
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                     
                                                                     
                                                                        v
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          and
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ¯
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         x
                                                         -
                                                         1
                                                         )
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        Σ
                                                                     
                                                                     
                                                                        v
                                                                        =
                                                                        u
                                                                        +
                                                                        1
                                                                     
                                                                     
                                                                        m
                                                                        -
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                     
                                                                     
                                                                        v
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        Σ
                                                                     
                                                                     
                                                                        v
                                                                        =
                                                                        u
                                                                        +
                                                                        1
                                                                     
                                                                     
                                                                        m
                                                                        -
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                     
                                                                     
                                                                        v
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        Σ
                                                                     
                                                                     
                                                                        v
                                                                        =
                                                                        u
                                                                        +
                                                                        1
                                                                        ,
                                                                        v
                                                                        ≠
                                                                        m
                                                                        -
                                                                        1
                                                                     
                                                                     
                                                                        m
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                     
                                                                     
                                                                        v
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Hence, we have 
                        
                           
                              
                                 F
                              
                              
                                 u
                              
                              
                                 x
                              
                           
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          m
                                          -
                                          1
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                           
                           =
                           
                              
                                 F
                              
                              
                                 u
                              
                              
                                 x
                              
                           
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          m
                                          -
                                          1
                                       
                                    
                                 
                              
                           
                        
                     .

The Lemma below is established to show that, similar to 2-component product problem, the optimal sequence for an m-component product is also built on some basic blocks according certain rules.
                        Lemma 4
                        
                           For any n units of m-component products, there exists an optimal sequence which has the following properties:
                           
                              
                                 1.
                                 It starts with an A
                                    
                                       m−1-type component.

Its blocks must be in the type of (A
                                    
                                       m−1,
                                    A
                                    
                                       m
                                    )
                                       u
                                    , u
                                    =0, 1,⋯,
                                    m
                                    −1.

The block sizes of (A
                                    
                                       m−1,
                                    A
                                    
                                       m
                                    )
                                       u
                                     and (A
                                    
                                       m−1,
                                    A
                                    
                                       m
                                    )
                                       v
                                     differ at most by 1, where 0⩽
                                    u
                                    ⩽
                                    v
                                    <
                                    m
                                    −1.

The batch sizes of (A
                                    
                                       m−1,
                                    A
                                    
                                       m
                                    )
                                       u
                                     and (A
                                    
                                       m−1,
                                    A
                                    
                                       m
                                    )
                                       v
                                     differ at most by 1, where 0⩽
                                    u
                                    ⩽
                                    v
                                    ⩽
                                    m
                                    −1.

The sequence remains optimal if removing any (A
                                    
                                       m−1,
                                    A
                                    
                                       m
                                    )
                                       u
                                     type block, where 0⩽
                                    u
                                    <
                                    m
                                    −1.

Consider an optimal schedule with a given number of changeovers. The least possible number of changeovers is (m
                           −1), if producing all components of the same type in one single batch. It is easy to check that 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       m
                                       -
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                            must be optimal for (m
                           −1) changeovers. 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       m
                                       -
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                            starts with an A
                           
                              m−1-type component and ends with an A
                           
                              m
                           -type component. By breaking the single batch into two and moving one batch to the end, the resulting sequence has one more changeover. There are at most (m
                           −1) single batches to break, since at least one single batch must remain to bridge those two batches of the same type components. As a result, we can get sequences with m to (2m
                           − 2) changeovers. Straightforward algebra verifies that both 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                       m
                                       -
                                       2
                                       -
                                       β
                                    
                                    
                                       n
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                       m
                                       -
                                       2
                                       -
                                       β
                                    
                                    
                                       n
                                    
                                 
                              
                            are optimal for the changeovers β
                           =
                           m,m
                           +1,⋯,2m
                           −2, where
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               n
                                                               -
                                                               1
                                                               )
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Σ
                                                                           
                                                                           
                                                                              v
                                                                              =
                                                                              2
                                                                              m
                                                                              -
                                                                              1
                                                                              -
                                                                              β
                                                                              ,
                                                                              v
                                                                              ≠
                                                                              m
                                                                              -
                                                                              1
                                                                           
                                                                           
                                                                              m
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              v
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Σ
                                                                           
                                                                           
                                                                              v
                                                                              =
                                                                              2
                                                                              m
                                                                              -
                                                                              1
                                                                              -
                                                                              β
                                                                           
                                                                           
                                                                              m
                                                                              -
                                                                              1
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              v
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Σ
                                                                           
                                                                           
                                                                              v
                                                                              =
                                                                              2
                                                                              m
                                                                              -
                                                                              1
                                                                              -
                                                                              β
                                                                              ,
                                                                              v
                                                                              ≠
                                                                              m
                                                                              -
                                                                              1
                                                                           
                                                                           
                                                                              m
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              v
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                and
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               n
                                                               -
                                                               1
                                                               )
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Σ
                                                                           
                                                                           
                                                                              v
                                                                              =
                                                                              2
                                                                              m
                                                                              -
                                                                              1
                                                                              -
                                                                              β
                                                                           
                                                                           
                                                                              m
                                                                              -
                                                                              1
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              v
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Σ
                                                                           
                                                                           
                                                                              v
                                                                              =
                                                                              2
                                                                              m
                                                                              -
                                                                              1
                                                                              -
                                                                              β
                                                                           
                                                                           
                                                                              m
                                                                              -
                                                                              1
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              v
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Σ
                                                                           
                                                                           
                                                                              v
                                                                              =
                                                                              2
                                                                              m
                                                                              -
                                                                              1
                                                                              -
                                                                              β
                                                                              ,
                                                                              v
                                                                              ≠
                                                                              m
                                                                              -
                                                                              1
                                                                           
                                                                           
                                                                              m
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              v
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Note that the starting component type is the same as the ending one. For 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                       m
                                       -
                                       2
                                       -
                                       β
                                    
                                    
                                       n
                                    
                                 
                              
                           , both are of A
                           
                              m−1-type, and for 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                       m
                                       -
                                       2
                                       -
                                       β
                                    
                                    
                                       n
                                    
                                 
                              
                           , both are of A
                           
                              m
                           -type. For more than 2m
                           −2 changeovers, it is clear that the optimal sequence can be composed by (A
                           
                              m−1,A
                           
                              m
                           )
                              u
                            blocks, where u
                           =0,1,⋯,
                           m
                           − 1. Hence, Results 1 and 2 follow.

In the optimal sequence with (A
                           
                              m−1,
                           A
                           
                              m
                           )
                              u
                            blocks (u
                           =0,1,⋯,
                           m
                           −1), there is at most one (A
                           
                              m−1,
                           A
                           
                              m
                           )
                              m−1 block, which, if it exists, must be at the end of the sequence. The order of the other (A
                           
                              m−1,
                           A
                           
                              m
                           )
                              u
                            blocks (u
                           =0,1,⋯,
                           m
                           −2) does not matter. Without loss the generality, we suppose existence of an (A
                           
                              m−1,
                           A
                           
                              m
                           )
                              m−1 block, as well as of another two blocks (A
                           
                              m−1,
                           A
                           
                              m
                           )
                              u
                            and (A
                           
                              m−1,
                           A
                           
                              m
                           )
                              w
                            with 0⩽
                           u
                           ⩽
                           w
                           <
                           m
                           −1. Suppose further that the block sizes for (A
                           
                              m−1,
                           A
                           
                              m
                           )
                              m−1, (A
                           
                              m−1,
                           A
                           
                              m
                           )
                              u
                            and (A
                           
                              m−1,
                           A
                           
                              m
                           )
                              w
                            are x, y, and z, respectively. Then the batch sizes are x, s
                           
                              y
                           , and s
                           
                              z
                           . It is easy to calculate that the flow time penalty for the last y
                           −
                           s
                           
                              y
                            number of products in 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       u
                                    
                                    
                                       y
                                    
                                 
                              
                            is 
                              
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 y
                                 -
                                 
                                    
                                       s
                                    
                                    
                                       y
                                    
                                 
                                 )
                                 (
                                 y
                                 -
                                 
                                    
                                       s
                                    
                                    
                                       y
                                    
                                 
                                 -
                                 1
                                 )
                                 
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                v
                                                =
                                                1
                                                ,
                                                v
                                                ≠
                                                m
                                                -
                                                1
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                a
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                 
                              
                           , and the flow time penalty for the last z
                           −
                           s
                           
                              z
                            products in 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         z
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       u
                                    
                                    
                                       z
                                    
                                 
                              
                            is 
                              
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 z
                                 -
                                 
                                    
                                       s
                                    
                                    
                                       z
                                    
                                 
                                 )
                                 (
                                 z
                                 -
                                 
                                    
                                       s
                                    
                                    
                                       z
                                    
                                 
                                 -
                                 1
                                 )
                                 
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                v
                                                =
                                                1
                                                ,
                                                v
                                                ≠
                                                m
                                                -
                                                1
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                a
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                 
                              
                           . Hence, optimality requires that y
                           −
                           s
                           
                              y
                            and z
                           −
                           s
                           
                              z
                            differ at most by 1. On the other hand, an equivalent optimal sequence can be created by converting 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       u
                                    
                                    
                                       y
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   z
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             m
                                          
                                       
                                       )
                                    
                                    
                                       w
                                    
                                    
                                       z
                                    
                                 
                              
                            to 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                                
                                                   y
                                                   -
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       u
                                    
                                    
                                       y
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                                
                                                   z
                                                   -
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         z
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       w
                                    
                                    
                                       z
                                    
                                 
                              
                           , and moving them after 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                                
                                                   x
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       m
                                       -
                                       1
                                    
                                    
                                       x
                                    
                                 
                              
                           . Then, by calculating the flow time penalty for the products in 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                                
                                                   x
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       m
                                       -
                                       1
                                    
                                    
                                       x
                                    
                                 
                              
                           , for the last s
                           
                              y
                            products in 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                                
                                                   y
                                                   -
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       u
                                    
                                    
                                       y
                                    
                                 
                              
                            and for the last s
                           
                              z
                            products in 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                                
                                                   z
                                                   -
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         z
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       w
                                    
                                    
                                       z
                                    
                                 
                              
                           , we can similarly get that the difference between x, s
                           
                              y
                           , and s
                           
                              z
                            is at most 1. Correspondingly, we can conclude Results 3 and 4.

Finally, Result 5 can be argued similarly as in 2-component product setting.□

Based on the above lemma, we can show our main conclusion below. The proof for this result closely follows the logic presented for the 2-component product case and thus is omitted.
                        Theorem 4
                        
                           There exists a vector of integers (s
                           ∗
                           ,
                           
                           k
                           ∗
                           ,
                           
                           u
                           ∗
                           )
                           ∈{(s,
                           
                           k,
                           
                           u)∣u
                           
                           =
                           
                           0,
                           
                           1,
                           ⋯
                           ,
                           
                           m
                           −
                           2}, where the pair (s,
                           
                           k) minimizes
                           
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          u
                                       
                                    
                                    (
                                    s
                                    ,
                                    k
                                    )
                                    =
                                    
                                       
                                          s
                                          (
                                          s
                                          -
                                          1
                                          )
                                          (
                                          
                                             
                                                Σ
                                             
                                             
                                                v
                                                ≠
                                                m
                                             
                                          
                                          
                                             
                                                a
                                             
                                             
                                                v
                                             
                                          
                                          )
                                          +
                                          k
                                          (
                                          k
                                          -
                                          1
                                          )
                                          (
                                          
                                             
                                                Σ
                                             
                                             
                                                v
                                                ≠
                                                m
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                a
                                             
                                             
                                                v
                                             
                                          
                                          )
                                       
                                       
                                          2
                                          (
                                          s
                                          +
                                          k
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          2
                                          sk
                                          (
                                          
                                             
                                                Σ
                                             
                                             
                                                v
                                                ⩽
                                                u
                                             
                                          
                                          
                                             
                                                a
                                             
                                             
                                                v
                                             
                                          
                                          )
                                          +
                                          2
                                          (
                                          2
                                          m
                                          -
                                          2
                                          -
                                          u
                                          )
                                          c
                                       
                                       
                                          2
                                          (
                                          s
                                          +
                                          k
                                          )
                                       
                                    
                                    ,
                                 
                              
                           
                           so that either 
                           
                              
                                 θ
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                       +
                                       
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                            
                           blocks make an optimal sequence for θ(s
                           ∗
                           
                           +
                           
                           k
                           ∗
                           ) units of products or θ 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                       +
                                       
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                            
                           blocks plus an 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                   -
                                                   1
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       m
                                       -
                                       1
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                       +
                                       
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                            
                           block make an optimal sequence for s
                           ∗
                           
                           +
                           
                           θ(s
                           ∗
                           
                           +
                           
                           k
                           ∗
                           ) units of products, where θ
                           
                           =
                           
                           0,
                           
                           1,
                           
                           2,
                           ⋯
                           .
                        

@&#REFERENCES@&#

