@&#MAIN-TITLE@&#RAGS: Rational geometric splines for surfaces of arbitrary topology

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A new approach for constructing smooth parametric surfaces is proposed.


                        
                        
                           
                           Bivariate polynomial splines are generalized to rational splines.


                        
                        
                           
                           The genus and order of continuity of the surfaces can be arbitrary.


                        
                        
                           
                           The construction employs linear rational transformations as transition maps.


                        
                        
                           
                           The computational properties of the new splines are similar to those of the classical splines.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Bivariate spline

Piecewise rational function

Unstructured mesh

Arbitrary topological genus

Smooth spline

Linear rational transition map

@&#ABSTRACT@&#


               
               
                  A construction of spline spaces suitable for representing smooth parametric surfaces of arbitrary topological genus and arbitrary order of continuity is proposed. The obtained splines are a direct generalization of bivariate polynomial splines on planar partitions. They are defined as composite functions consisting of rational functions and are parametrized by a single parameter domain, which is a piecewise planar surface, such as a triangulation of a cloud of 3D points. The idea of the construction is to utilize linear rational transformations (or transition maps) to endow the piecewise planar surface with a particular 
                        
                           
                              C
                           
                           
                              ∞
                           
                        
                     -differentiable structure appropriate for defining rational splines.
               
            

@&#INTRODUCTION@&#

The search for effective mathematical representations of smooth shapes suitable for storing and manipulating on a digital computer has been a central research activity in CAGD. For many years, splines or piecewise polynomials in two variables have played a prominent role in this endeavor. Special cases of bivariate splines on triangulations and rectangular partitions in the plane have been used for quite some time in data fitting and the finite element methods. Moreover, rational splines on tensor product meshes – so-called NURBS (Non-Uniform Rational B-Splines) – are employed frequently and are standard in many engineering applications and software packages. In fact, the majority of computer models of surfaces in the CAD/CAM industry today are spline models.

However, despite the effectiveness of the spline methodology, the quest for an optimal construction and representation of general smooth surfaces seems to be far from over. This is imputable to the deficiencies of current spline representations that make them problematic, at least in their current form, for representing smooth surfaces of arbitrary topology. For example, the “NU” in the acronym NURBS has proven to be an oxymoron since the rigid and uniform nature of NURBS surfaces is precisely what stands in the way of their applicability to general surfaces. In particular, NURBS cannot be effectively used with unstructured meshes of general topological genus. Similarly, the bivariate polynomial splines – thought by many as the sine qua non of CAGD – also seem to lack sufficient flexibility to represent arbitrary shapes, for example those of closed surfaces. These drawbacks suggest that the classical spline representation, that is, a piecewise representation of surfaces based on stitching together polynomial or rational patches may not be well suited and powerful enough to tackle the general problem of surface modeling.

Recent research in alternative shape representations seems to support and reinforce this view. In particular, we mention the rich field of the so-called subdivision methods (Warren and Weimer, 2001; Sabin, 2005; Peters and Reif, 2008; Cashman, 2012), T-splines (Sederberg et al., 2003; Li and Qin, 2012), and manifold-based methods (Grimm and Hughes, 1995; Navau and Garcia, 2000; Della Vecchia et al., 2008; Gu et al., 2008; Tosun and Zorin, 2011). While these approaches have certain aspects in common with the spline approach, for example, they offer local constructions of surfaces, there are important differences. The alternative methods typically do not express a surface as a finite collection of polynomial or rational patches and, in fact, in some cases they do not even give rise to an explicit analytic closed-form representation of the surface. It is clear that these alternative methods represent a major shift from the classical spline/NURBS paradigm.

One wonders whether the departure from this paradigm is justified and necessary. It seems an undisputed fact that methods based on polynomial splines, which work well in settings where the modeled surfaces can be parametrized by a planar domain, do not carry over to the case where such parametrization is not possible. For example, the well-known Powell–Sabin macro-element method (Powell and Sabin, 1977) is an elegant means of constructing a 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      piecewise quadratic surface, as long as the surface is homeomorphic to a subset of the plane or the torus. For other surfaces, this method fails, or at least we are not aware of any successful attempts of using Powell–Sabin polynomial splines for modeling surfaces of arbitrary genus, even simple surfaces that are homeomorphic to the sphere. In fact, we are not familiar with any methods based on bivariate (algebraic) piecewise polynomials, either on triangulations or rectangular partitions, that have been successfully implemented for surfaces of arbitrary topology. While there is a plethora of techniques for constructing bivariate splines of smoothness 
                        
                           
                              C
                           
                           
                              1
                           
                        
                     , 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     , or higher, such as conforming finite elements and many other types of splines on planar domains (see for example the recent book by Lai and Schumaker, 2007), when it comes to smooth surfaces of arbitrary genus, researchers resort to entirely new techniques.

This discussion begs the question: Can the existing deficiencies of bivariate splines, which seem to make them inherently ill-suited for the purpose of representing arbitrary shapes, be mitigated or perhaps even redressed? Can the definition of polynomial splines on triangulations and other partitions be tweaked so as to expand their range of applicability to general surfaces, while still preserving most of the attractive features of the original splines? In particular, can this modification be done in such a way that essentially the same surface construction methods that have been devised for the traditional piecewise polynomials will work virtually identically in the more general setting?

The objective of this paper is to point out that in our opinion the above questions can be answered affirmatively and that, indeed, it is possible to appropriately and in fact quite minimally adjust the definition of the piecewise polynomial spaces, thereby making them suitable for representing smooth surfaces of arbitrary topological genus. As it turns out, the modified spline spaces will consist of piecewise rational functions. This is beneficial for several reasons. One, once the decision is made to move away from pure algebraic polynomials, it is natural to consider rational functions, which are similarly well suited for numerical computation. Two, rational functions are comparable to polynomials in terms of their Bézier structure. Namely, they also admit a Bézier representation, a de Casteljau algorithm, and smoothness conditions between rational patches have similar form. Moreover, like polynomials, rational functions are refinable (i.e., can be subdivided), they can be degree-elevated, and one can also define a control (Bézier) net with the convex-hull property. Three, it makes sense to look for splines which are compatible, at least in principle, with NURBS, which are rational themselves. In fact, one of our motivations to define generalized splines as piecewise rational functions was the realization that the “R” in NURBS is hardly ever used in current practice, except in situations when one wants to represent quadric surfaces exactly. It therefore made sense to us to expect that the additional degrees of freedom afforded by the weights (i.e., coefficients in the denominators) of the rational functions could be beneficial for constructing surfaces of general topology, especially when one is willing to consider triangular meshes in addition to uniform quadrilateral meshes.

Before we delve into these issues in more detail, we sketch the main idea behind the construction of the generalized spline spaces. Recall that the classical space of bivariate piecewise polynomials on a planar triangulated domain 
                        Ω
                        ⊂
                        
                           
                              R
                           
                           
                              2
                           
                        
                     , of degree n and smoothness m, is defined as
                        
                           (1)
                           
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                                 
                                    m
                                 
                              
                              (
                              Δ
                              )
                              :
                              =
                              
                                 {
                                 f
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 Ω
                                 )
                                 ;
                                 
                                 f
                                 
                                    
                                       |
                                    
                                    
                                       T
                                    
                                 
                                 ∈
                                 
                                    
                                       π
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                 T
                                 ∈
                                 Δ
                                 }
                              
                              ,
                           
                        
                      where Δ is a given triangulation of Ω and 
                        
                           
                              π
                           
                           
                              n
                           
                        
                      is the space of bivariate polynomials of total degree at most n. Thus, functions in this space are algebraic polynomials on triangles in Δ and are such that their values and values of their derivatives up to order m are identical along the common edge of any pair of neighboring triangles. This guarantees that the spline is globally 
                        
                           
                              C
                           
                           
                              m
                           
                        
                      smooth. We refer the reader to the recent monograph by Lai and Schumaker (2007), for an exhaustive study of such spline spaces.

In this paper we are interested in defining an analog of the above space for the case where the triangles 
                        T
                        ∈
                        Δ
                      are not all lying in a single plane, but form a simplicial complex, whose geometric realization is a continuous piecewise linear surface Ω in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                     , and whose facets are the given triangles in Δ. Thus, the new spline space will be a set of functions parametrized by the triangulated surface Ω. Therefore, the constructed analog of 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        )
                      can still be considered a collection of individual functions, each of which is parametrized by the (planar) triangles T of Δ, i.e., facets of Ω. Since algebraic polynomials seem to be no longer appropriate in this more general setting, the space 
                        
                           
                              π
                           
                           
                              n
                           
                        
                      in definition (1) will be replaced by the space 
                        
                           
                              ρ
                           
                           
                              n
                           
                        
                      of rational functions, which are quotients 
                        
                           
                              p
                           
                           
                              n
                           
                        
                        /
                        
                           
                              q
                           
                           
                              n
                           
                        
                      of two degree-n polynomials. The general idea will be that the polynomials 
                        
                           
                              q
                           
                           
                              n
                           
                        
                      will be fixed to capture the topology of the modeled surface, while the polynomials 
                        
                           
                              p
                           
                           
                              n
                           
                        
                      can be used to control its geometry.

A second needed modification of (1) will be as follows. Since in general the triangles of Δ will no longer lie in a single plane, we need to introduce regular 
                        
                           
                              C
                           
                           
                              ∞
                           
                        
                     -transition maps or local coordinate transformations which will allow us to glue neighboring triangles together, so that it will be possible to define when two functions defined on neighboring triangles join with 
                        
                           
                              C
                           
                           
                              m
                           
                        
                     -continuity. These transformations will in effect equip Ω with a 
                        
                           
                              C
                           
                           
                              ∞
                           
                        
                     -differentiable structure. It will be argued that transformations that make most sense in the above context are linear rational transformations. This is reasonable, in view of our intuition to replace the polynomial space in (1) by rational functions.

As will be discussed later, with these proposed modifications the new spline spaces closely mimic the classical space (1). Of course, the classical space is in fact a special case of such newly defined spaces since, if Ω is planar, the transition transformations can all be chosen to be the identity maps and pure polynomials can be employed instead of rational functions.

For the remainder of the paper, we will assume that Δ is a triangulation, although other polygonal complexes can also be considered, such as quadrilateral complexes. Moreover, we will assume that the surface Ω, obtained as the union of the triangles in Δ, is closed, i.e., it is a compact 2-manifold without a boundary, immersed in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                     . However, all results of this paper readily apply to surfaces with boundary.

To motivate the construction of splines in this paper, we start off with a few heuristic observations concerning the definition of barycentric coordinates on smooth surfaces. Barycentric coordinates (b.c.s, for short) play an important role in the context of generalizing spline spaces of type (1) since products of b.c.s give rise to analogs of polynomials on surface triangles. These in turn can be used to define spline spaces on triangulations of the given surface.

Suppose that a triangulation Γ of a 
                        
                           
                              C
                           
                           
                              ∞
                           
                        
                     -surface Σ is given, where all surface triangles of Γ are closed sets homeomorphic to a disk. Let 
                        T
                        ∈
                        Γ
                      be a triangle with vertices 
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              3
                           
                        
                        ∈
                        Σ
                      and edges 
                        
                           
                              ε
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              ε
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              ε
                           
                           
                              3
                           
                        
                        ⊂
                        Σ
                     , where 
                        
                           
                              ε
                           
                           
                              l
                           
                        
                      is the edge opposite to vertex 
                        
                           
                              u
                           
                           
                              l
                           
                        
                     , see Fig. 1
                     . By 
                        star
                        (
                        T
                        )
                     , we denote the set of all triangles in Γ, sharing a vertex in common with 
                        T
                     . By b.c.s defined on 
                        T
                      we mean a triple 
                        
                           
                              β
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              β
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              β
                           
                           
                              3
                           
                        
                      of real-valued infinitely-differentiable functions on 
                        T
                     , such that
                        
                           (a)
                           the b.c.s satisfy:
                                 
                                    (2)
                                    
                                       
                                          
                                             β
                                          
                                          
                                             l
                                          
                                       
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             l
                                          
                                       
                                       )
                                       =
                                       1
                                       ,
                                       
                                       
                                          
                                             β
                                          
                                          
                                             l
                                          
                                       
                                       (
                                       u
                                       )
                                       =
                                       0
                                       ,
                                       
                                       ∀
                                       u
                                       ∈
                                       
                                          
                                             ε
                                          
                                          
                                             l
                                          
                                       
                                       ,
                                       
                                       l
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       3
                                       ,
                                    
                                 
                               and, in particular, the space 
                                 
                                    
                                       L
                                    
                                    
                                       T
                                    
                                 
                              , the linear span of the b.c.s on 
                                 T
                              , is three dimensional;

any 
                                 f
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       T
                                    
                                 
                               can be uniquely extended as a 
                                 
                                    
                                       C
                                    
                                    
                                       ∞
                                    
                                 
                              -function to 
                                 star
                                 (
                                 T
                                 )
                              , where this extension, also denoted by f, is such that 
                                 f
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              , for all 
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 star
                                 (
                                 T
                                 )
                              ;

if 
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                               is an adjacent surface triangle to 
                                 T
                              , i.e., sharing a common edge 
                                 
                                    
                                       ε
                                    
                                    
                                       3
                                    
                                 
                               with 
                                 T
                              , then the b.c. 
                                 
                                    
                                       β
                                    
                                    
                                       3
                                    
                                 
                              , which vanishes on 
                                 
                                    
                                       ε
                                    
                                    
                                       3
                                    
                                 
                              , is positive on 
                                 T
                                 \
                                 
                                    
                                       ε
                                    
                                    
                                       3
                                    
                                 
                               and negative on 
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                                 \
                                 
                                    
                                       ε
                                    
                                    
                                       3
                                    
                                 
                              .

We note in passing that it is not necessary that b.c.s add up to one, for this condition could be too restrictive. For example, spherical b.c.s do not sum to one (Alfeld et al., 1996a).

The motivation for the above postulates is that the b.c.s can now be used to define spline spaces closely resembling (1). Splines in such spaces can be defined as piecewise functions parametrized by Σ, and such that on each triangle 
                        T
                        ∈
                        Γ
                     , they can be written in the Bernstein–Bézier form (or B-form):
                        
                           (3)
                           
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              :
                              =
                              ∑
                              
                                 
                                    c
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    n
                                 
                              
                              ,
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    n
                                 
                              
                              :
                              =
                              
                                 
                                    n
                                    !
                                 
                                 
                                    i
                                    !
                                    j
                                    !
                                    k
                                    !
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    1
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    2
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    3
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                              i
                              +
                              j
                              +
                              k
                              =
                              n
                              ,
                           
                        
                      where n is the spline degree, 
                        
                           
                              c
                           
                           
                              i
                              j
                              k
                           
                        
                      are scalars or vectors, 
                        
                           
                              B
                           
                           
                              i
                              j
                              k
                           
                           
                              n
                           
                        
                      are analogs of the classical Bernstein basis polynomials, and where the sum is taken over all indices such that 
                        i
                        +
                        j
                        +
                        k
                        =
                        n
                     . One justification for the requirement (2) is that these identities automatically imply that the value of 
                        
                           
                              p
                           
                           
                              n
                           
                        
                      and its derivatives up to order m along an edge of 
                        T
                     , say 
                        
                           
                              ε
                           
                           
                              3
                           
                        
                     , are controlled by B-coefficients near that edge, i.e., the coefficients 
                        
                           
                              c
                           
                           
                              i
                              j
                              k
                           
                        
                     , 
                        k
                        ⩽
                        m
                     , which is a well-known property of ordinary Bernstein–Bézier polynomials (or B-polynomials).

To explain the rationale for (b), let 
                        T
                        ,
                        
                           
                              T
                           
                           
                              ′
                           
                        
                        ∈
                        Γ
                      be adjacent triangles. Then, by (2), the spaces 
                        L
                        :
                        =
                        
                           
                              L
                           
                           
                              T
                           
                        
                        ,
                        
                           
                              L
                           
                           
                              ′
                           
                        
                        :
                        =
                        
                           
                              L
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                           
                        
                      are both 3-dimensional and their dimension drops to two on their common edge 
                        
                           
                              ε
                           
                           
                              3
                           
                        
                     . In order for the sought-for spline space to contain continuous functions along 
                        
                           
                              ε
                           
                           
                              3
                           
                        
                     , ideally the two spaces 
                        L
                        
                           
                              |
                           
                           
                              
                                 
                                    ε
                                 
                                 
                                    3
                                 
                              
                           
                        
                      and 
                        
                           
                              L
                           
                           
                              ′
                           
                        
                        
                           
                              |
                           
                           
                              
                                 
                                    ε
                                 
                                 
                                    3
                                 
                              
                           
                        
                      should be identical, for otherwise it will be impossible to join a function 
                        f
                        ∈
                        L
                      with a function 
                        
                           
                              f
                           
                           
                              ′
                           
                        
                        ∈
                        
                           
                              L
                           
                           
                              ′
                           
                        
                      along 
                        
                           
                              ε
                           
                           
                              3
                           
                        
                     . Similarly, for the spline space to contain functions of higher orders of continuity, the spaces 
                        L
                      and 
                        
                           
                              L
                           
                           
                              ′
                           
                        
                      will have to be interlocked together even more tightly. In particular, it is not hard to see that in order to construct splines of arbitrarily high orders of continuity (by increasing the degree n), the space 
                        L
                      must possess property (b). We will refer to (b) as the continuation property of 
                        L
                     . We note in passing that (b) immediately implies that the space of functions 
                        
                           
                              p
                           
                           
                              n
                           
                        
                      on 
                        T
                      of the form (3) also possesses the continuation property, i.e., for each 
                        
                           
                              p
                           
                           
                              n
                           
                        
                      there exists a unique 
                        
                           
                              p
                           
                           
                              n
                           
                           
                              ′
                           
                        
                      of the form (3) on 
                        
                           
                              T
                           
                           
                              ′
                           
                        
                      such that the two functions join with 
                        
                           
                              C
                           
                           
                              ∞
                           
                        
                     -continuity along 
                        
                           
                              ε
                           
                           
                              3
                           
                        
                     .

Lastly, requirement (c) makes it possible to decide on which side of an edge is a given point of Σ. The importance of this property will become apparent in the sequel. Clearly, (c) is satisfied for the ordinary b.c.s.

The above scenario for constructing spline spaces on surfaces is in principle plausible. In fact, this general approach of defining splines has been carried out successfully for the case where Σ is the 2-sphere in Alfeld et al. (1996a, 1996b), where it is demonstrated that well-established data fitting methods for the classical splines can be adapted in a straightforward way to work equally well in the spherical setting.

However, it is not clear whether the above recipe can be realized in practice for general surfaces (see, for example, the discussion on this topic in Neamtu, 2002). First, most often a smooth initial surface Σ is not given, let alone in an explicit analytic form. In fact, frequently the reason for the need of an appropriate spline space is to find an unknown smooth surface, for example approximating a set of scattered points, and not vice versa. Second, even if Σ were given explicitly, it is not obvious in general how to construct matching sets of b.c.s on Σ, unless the surface is relatively simple, such as a sphere. This prompts us to suggest an alternative approach to building splines.

In addition to the triangulation Γ on Σ, we will next consider a triangulation Δ, consisting of planar triangles, which is combinatorially equivalent to Γ. Thus Δ, viewed as a surface, say Ω, is homeomorphic to Σ. For example, Δ could be the piecewise linear interpolant to the vertices of Γ. Assuming, as before, that b.c.s are defined for all triangles of Γ, these give rise to a bijection of Σ onto the piecewise linear surface Ω. In particular, let 
                        T
                        ∈
                        Γ
                      and 
                        T
                        ∈
                        Δ
                      be two corresponding triangles, with vertices 
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              3
                           
                        
                      and 
                        
                           
                              v
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              3
                           
                        
                     , respectively (see Fig. 2
                     ). The bijection can now be defined as:
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    T
                                 
                              
                              :
                              u
                              ↦
                              v
                              :
                              =
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    3
                                 
                              
                              :
                              =
                              
                                 
                                    
                                       β
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          β
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          β
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    
                                       β
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          β
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          β
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    
                                       β
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          β
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          β
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    3
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              β
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              β
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              β
                           
                           
                              3
                           
                        
                      are the b.c.s of u w.r.t. 
                        T
                      and where 
                        
                           
                              b
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              b
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              b
                           
                           
                              3
                           
                        
                      are the standard planar b.c.s of v w.r.t. T. We note that this map is well defined since by property (c), 
                        
                           
                              β
                           
                           
                              1
                           
                        
                        +
                        
                           
                              β
                           
                           
                              2
                           
                        
                        +
                        
                           
                              β
                           
                           
                              3
                           
                        
                        >
                        0
                      on 
                        T
                     . In fact, by continuity of the b.c.s and property (b), 
                        
                           
                              σ
                           
                           
                              T
                           
                        
                      is well defined in an (open) neighborhood 
                        U
                        ⊂
                        Σ
                      of 
                        T
                     . Thus, denoting by 
                        
                           aff
                        
                        (
                        T
                        )
                      the affine hull of T, the set 
                        U
                        :
                        =
                        
                           
                              σ
                           
                           
                              T
                           
                        
                        (
                        U
                        )
                        ⊂
                        
                           aff
                        
                        (
                        T
                        )
                      is a neighborhood of T in the relative topology of 
                        
                           aff
                        
                        (
                        T
                        )
                     .

Let us now focus on two adjacent triangles, 
                        T
                        ,
                        
                           
                              T
                           
                           
                              ′
                           
                        
                        ∈
                        Γ
                     , the corresponding pair of adjacent triangles 
                        T
                        ,
                        
                           
                              T
                           
                           
                              ′
                           
                        
                        ∈
                        Δ
                     , and associated pairs of neighborhoods 
                        U
                        ,
                        
                           
                              U
                           
                           
                              ′
                           
                        
                      and 
                        U
                        ,
                        
                           
                              U
                           
                           
                              ′
                           
                        
                      (Fig. 3
                     ). Consider a function φ defined on 
                        E
                        :
                        =
                        U
                        ∩
                        
                           
                              U
                           
                           
                              ′
                           
                        
                     , which can be reparametrized as a function f on 
                        E
                        :
                        =
                        
                           
                              σ
                           
                           
                              T
                           
                        
                        (
                        E
                        )
                      or as a function 
                        
                           
                              f
                           
                           
                              ′
                           
                        
                      on 
                        
                           
                              E
                           
                           
                              ′
                           
                        
                        :
                        =
                        
                           
                              σ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                           
                        
                        (
                        E
                        )
                     , where
                        
                           
                              f
                              (
                              v
                              )
                              :
                              =
                              φ
                              ∘
                              
                                 
                                    σ
                                 
                                 
                                    T
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              v
                              )
                              ,
                              
                              v
                              ∈
                              E
                              ,
                              
                              
                                 
                                    f
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                              :
                              =
                              φ
                              ∘
                              
                                 
                                    σ
                                 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                              ,
                              
                              
                                 
                                    v
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    E
                                 
                                 
                                    ′
                                 
                              
                              .
                           
                        
                      Thus, f and 
                        
                           
                              f
                           
                           
                              ′
                           
                        
                      can be identified with each other, given that they correspond to the same function φ. This is equivalent to the property that 
                        
                           
                              f
                           
                           
                              ′
                           
                        
                      and 
                        f
                        ∘
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      are identical on 
                        
                           
                              E
                           
                           
                              ′
                           
                        
                     , where
                        
                           (4)
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    T
                                 
                              
                              :
                              =
                              
                                 
                                    σ
                                 
                                 
                                    T
                                 
                              
                              ∘
                              
                                 
                                    σ
                                 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              :
                              
                                 
                                    E
                                 
                                 
                                    ′
                                 
                              
                              →
                              E
                              ,
                           
                        
                      or, also, that f and 
                        
                           
                              f
                           
                           
                              ′
                           
                        
                        ∘
                        
                           
                              ϕ
                           
                           
                              T
                              ,
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                           
                        
                      are identical on E, with 
                        
                           
                              ϕ
                           
                           
                              T
                              ,
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                           
                        
                        :
                        =
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                           
                              −
                              1
                           
                        
                        =
                        
                           
                              σ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                           
                        
                        ∘
                        
                           
                              σ
                           
                           
                              T
                           
                           
                              −
                              1
                           
                        
                     .

The maps 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      are usually called transition maps or reparametrizations. They can be used to determine whether two spaces of functions defined on adjacent triangles T, 
                        
                           
                              T
                           
                           
                              ′
                           
                        
                      can be identified with each other in the aforementioned sense. Moreover, using these maps one can also define when two functions 
                        f
                        ,
                        
                           
                              f
                           
                           
                              ′
                           
                        
                      join smoothly along their common edge.


                     
                        Definition 1
                        Let 
                              f
                              ,
                              
                                 
                                    f
                                 
                                 
                                    ′
                                 
                              
                            be defined on adjacent triangles 
                              T
                              ,
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                           . We say that they join with 
                              
                                 
                                    C
                                 
                                 
                                    m
                                 
                              
                           -continuity, 
                              m
                              ⩾
                              0
                           , if 
                              
                                 
                                    f
                                 
                                 
                                    ′
                                 
                              
                            and 
                              f
                              ∘
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    T
                                 
                              
                           , and all their partial derivatives up to and including order m, are equal along the common edge of T and 
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                           .

Note that the above-defined 
                        
                           
                              C
                           
                           
                              m
                           
                        
                     -continuity is sometimes referred to as geometric continuity, or 
                        
                           
                              G
                           
                           
                              m
                           
                        
                     -continuity, w.r.t. map 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      (Peters, 2002b). We should point out that since 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      has been defined using b.c.s on a 
                        
                           
                              C
                           
                           
                              ∞
                           
                        
                     -surface and since the b.c.s themselves were assumed infinitely differentiable, the transition maps are also 
                        
                           
                              C
                           
                           
                              ∞
                           
                        
                     -maps. Moreover, if 
                        
                           
                              e
                           
                           
                              3
                           
                        
                      is the common edge of T and 
                        
                           
                              T
                           
                           
                              ′
                           
                        
                     , 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      maps 
                        
                           
                              E
                           
                           
                              ′
                           
                        
                     , which is an open neighborhood of 
                        
                           
                              e
                           
                           
                              3
                           
                        
                      in 
                        aff
                        (
                        
                           
                              T
                           
                           
                              ′
                           
                        
                        )
                     , bijectively onto E, which is an open neighborhood of 
                        
                           
                              e
                           
                           
                              3
                           
                        
                      in 
                        aff
                        (
                        T
                        )
                     . In fact, 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      is a 
                        
                           
                              C
                           
                           
                              ∞
                           
                        
                      diffeomorphism on 
                        
                           
                              E
                           
                           
                              ′
                           
                        
                     . Also, by (c), 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      maps points in 
                        
                           
                              E
                           
                           
                              ′
                           
                        
                      that are interior to 
                        
                           
                              T
                           
                           
                              ′
                           
                        
                      to points outside of T and vice versa (cf. Hahn, 1989).

The above definition suggests that instead of constructing a spline space using an unknown smooth surface Σ, one could construct smooth functions and surfaces by parametrizing them by the piecewise linear surface Ω. The sought-for space of such spline functions, generalizing (1), will be denoted as 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        )
                     , where Φ stands for the collection of all transition maps associated with Δ, i.e.,
                        
                           
                              Φ
                              :
                              =
                              
                                 {
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       T
                                    
                                 
                                 ;
                                 
                                 T
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 Δ
                                  are adjacent
                                 }
                              
                              .
                           
                        
                      Thus, a spline in 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        )
                      will be a collection 
                        
                           
                              {
                              
                                 
                                    f
                                 
                                 
                                    T
                                 
                              
                              }
                           
                           
                              T
                              ∈
                              Δ
                           
                        
                      of appropriately defined (scalar or vector) functions, such that functions corresponding to neighboring triangles are joined with a prescribed order of continuity in the sense of Definition 1. Consequently, the fact that maps 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      have been constructed using hypothetical b.c.s becomes irrelevant. However, while there are ways of defining these maps without relying on the existence of b.c.s, we will see in the next section that this existence will motivate our choice of the transition maps.

After appropriate transition maps have been selected, splines in 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        )
                      can be used to model 
                        
                           
                              C
                           
                           
                              m
                           
                        
                     -surfaces that are homeomorphic to Ω. In particular, functions 
                        
                           
                              f
                           
                           
                              T
                           
                        
                      can be chosen as three-dimensional vector functions and, as a result, the graph of the spline will be a surface consisting of surface patches of the form 
                        {
                        
                           
                              f
                           
                           
                              T
                           
                        
                        (
                        v
                        )
                        ,
                        
                        v
                        ∈
                        T
                        }
                     . These patches will then give rise to a composite 
                        
                           
                              C
                           
                           
                              m
                           
                        
                     -surface, because neighboring surface patches in this collection will join together smoothly in the usual parametric sense after one patch has been reparametrized using the reparametrization 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                     . Note that a reparametrization of a surface does not change its physical shape in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                     .

We point out that the above idea of using transition maps or reparametrizations in connection with building smooth surfaces is not new. Therefore, a few historical remarks on other existing methods that employ the same general construction principle are given in Section 6.

As is clear from the previous section, our approach to generalizing splines has two main ingredients: the construction of transition maps 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      and the selection of an appropriate analog 
                        
                           
                              ρ
                           
                           
                              n
                           
                        
                      of the space of polynomials 
                        
                           
                              π
                           
                           
                              n
                           
                        
                     . In this section we address the first problem.

It turns out that the mapping 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      defined by (4) can be expressed explicitly. To this end, we coordinatize the planes 
                        aff
                        (
                        T
                        )
                      and 
                        aff
                        (
                        
                           
                              T
                           
                           
                              ′
                           
                        
                        )
                      by representing their points in terms of the planar b.c.s, 
                        b
                        =
                        
                           
                              (
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                              
                              )
                           
                           
                              t
                           
                        
                      and 
                        
                           
                              b
                           
                           
                              ′
                           
                        
                        =
                        
                           
                              (
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                           
                              t
                           
                        
                     , w.r.t. triangles T and 
                        
                           
                              T
                           
                           
                              ′
                           
                        
                     . Consequently, 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      can be viewed as a mapping from the affine plane 
                        A
                        :
                        =
                        {
                        (
                        
                           
                              b
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              b
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              b
                           
                           
                              3
                           
                        
                        )
                        ∈
                        
                           
                              R
                           
                           
                              3
                           
                        
                        |
                        
                           
                              b
                           
                           
                              1
                           
                        
                        +
                        
                           
                              b
                           
                           
                              2
                           
                        
                        +
                        
                           
                              b
                           
                           
                              3
                           
                        
                        =
                        1
                        }
                      into itself. We will abuse notation and use the symbol 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      to mean both a mapping of type 
                        aff
                        (
                        
                           
                              T
                           
                           
                              ′
                           
                        
                        )
                        →
                        aff
                        (
                        T
                        )
                     , but also 
                        A
                        →
                        A
                     . The common edge, 
                        
                           
                              e
                           
                           
                              3
                           
                        
                     , of T and 
                        
                           
                              T
                           
                           
                              ′
                           
                        
                     , corresponds to the line segment 
                        a
                        :
                        =
                        {
                        (
                        
                           
                              b
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              b
                           
                           
                              2
                           
                        
                        ,
                        0
                        )
                        |
                        
                           
                              b
                           
                           
                              1
                           
                        
                        +
                        
                           
                              b
                           
                           
                              2
                           
                        
                        =
                        1
                        ,
                        
                        
                           
                              b
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              b
                           
                           
                              2
                           
                        
                        ⩾
                        0
                        }
                        ⊂
                        A
                     . When 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      is viewed as a mapping from 
                        A
                      to itself, then this mapping is the identity on a. We next show that 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      has a particular form.


                     
                        Proposition 1
                        
                           The transition map 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    T
                                 
                              
                            
                           defined by 
                           (4) 
                           is a linear rational transformation of the form
                           
                              
                                 (5)
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          T
                                       
                                    
                                    :
                                    
                                       
                                          b
                                       
                                       
                                          ′
                                       
                                    
                                    ↦
                                    b
                                    =
                                    
                                       
                                          
                                             
                                                Λ
                                             
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ,
                                                T
                                             
                                          
                                          
                                             
                                                b
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          1
                                          
                                             
                                                Λ
                                             
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ,
                                                T
                                             
                                          
                                          
                                             
                                                b
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                            
                           where 
                           
                              1
                              :
                              =
                              (
                              1
                              ,
                              1
                              ,
                              1
                              )
                           
                           ,
                           
                              
                                 (6)
                                 
                                    
                                       
                                          Λ
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          T
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                            
                           and where 
                           
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                              
                            
                           are real numbers, with 
                           
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                              
                              <
                              0
                           
                           .
                        

Before proving the result, we make a few preliminary remarks. The condition 
                        
                           
                              λ
                           
                           
                              3
                           
                        
                        <
                        0
                      is crucial since it means that the interior of the triangle 
                        
                           
                              T
                           
                           
                              ′
                           
                        
                      is mapped to a region exterior to T. We also note that the above mapping is always well defined, bijective, and regular in an open neighborhood 
                        
                           
                              E
                           
                           
                              ′
                           
                        
                      of the common edge 
                        
                           
                              e
                           
                           
                              3
                           
                        
                     , i.e., in a strip 
                        {
                        (
                        
                           
                              b
                           
                           
                              1
                           
                           
                              ′
                           
                        
                        ,
                        
                           
                              b
                           
                           
                              2
                           
                           
                              ′
                           
                        
                        ,
                        
                           
                              b
                           
                           
                              3
                           
                           
                              ′
                           
                        
                        )
                        |
                        
                           
                              b
                           
                           
                              1
                           
                           
                              ′
                           
                        
                        +
                        
                           
                              b
                           
                           
                              2
                           
                           
                              ′
                           
                        
                        +
                        
                           
                              b
                           
                           
                              3
                           
                           
                              ′
                           
                        
                        =
                        1
                        ,
                        
                        
                           
                              b
                           
                           
                              1
                           
                           
                              ′
                           
                        
                        ,
                        
                           
                              b
                           
                           
                              2
                           
                           
                              ′
                           
                        
                        >
                        −
                        δ
                        ,
                        
                        
                           
                              b
                           
                           
                              3
                           
                           
                              ′
                           
                        
                        ∈
                        (
                        −
                        δ
                        ,
                        δ
                        )
                        }
                        ⊂
                        A
                     , for some 
                        δ
                        >
                        0
                     , containing the line segment a.


                     
                        Proof of Proposition 1
                        To derive formula (5), consider again spaces 
                              L
                            and 
                              
                                 
                                    L
                                 
                                 
                                    ′
                                 
                              
                           , the linear spans of hypothetical b.c.s on triangles 
                              T
                              ,
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                            of Σ. One can show that for each 
                              ℓ
                              ∈
                              L
                           ,
                              
                                 (7)
                                 
                                    ℓ
                                    (
                                    u
                                    )
                                    =
                                    
                                       
                                          β
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    u
                                    )
                                    ℓ
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          β
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    u
                                    )
                                    ℓ
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          β
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    u
                                    )
                                    ℓ
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          3
                                       
                                    
                                    )
                                    ,
                                    
                                    u
                                    ∈
                                    T
                                    .
                                 
                              
                           
                        

Given that 
                              
                                 
                                    β
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    3
                                 
                              
                            form a basis for 
                              L
                           , one has 
                              ℓ
                              =
                              
                                 
                                    β
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    β
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    β
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    3
                                 
                              
                           , for some 
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    3
                                 
                              
                              ∈
                              R
                           . Thus (7) follows from
                              
                                 (8)
                                 
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    ,
                                    
                                    i
                                    ,
                                    j
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                    .
                                 
                              
                           
                        

Assuming the continuation property of functions in 
                              L
                           , any 
                              ℓ
                              ∈
                              L
                            has a unique 
                              
                                 
                                    C
                                 
                                 
                                    ∞
                                 
                              
                           -extension to 
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                            as a function of 
                              
                                 
                                    L
                                 
                                 
                                    ′
                                 
                              
                            and hence, we can also think of ℓ as an element of 
                              
                                 
                                    L
                                 
                                 
                                    ′
                                 
                              
                           . More precisely, if we use the same notation for the extension of ℓ to 
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                           , we have 
                              ℓ
                              
                                 
                                    |
                                 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              ∈
                              
                                 
                                    L
                                 
                                 
                                    ′
                                 
                              
                           . In particular, the b.c.s 
                              
                                 
                                    β
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    3
                                 
                              
                            can be viewed as elements of 
                              
                                 
                                    L
                                 
                                 
                                    ′
                                 
                              
                           , and therefore, by (7) (applied to triangle 
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                            instead of 
                              T
                           ), we have
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          l
                                       
                                    
                                    (
                                    u
                                    )
                                    =
                                    
                                       
                                          β
                                       
                                       
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    u
                                    )
                                    
                                       
                                          β
                                       
                                       
                                          l
                                       
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          β
                                       
                                       
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    u
                                    )
                                    
                                       
                                          β
                                       
                                       
                                          l
                                       
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          β
                                       
                                       
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    u
                                    )
                                    
                                       
                                          β
                                       
                                       
                                          l
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    u
                                    ∈
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                    l
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                    ,
                                 
                              
                            or, taking into account (8) and recalling that 
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                            belong to the common edge of 
                              T
                            and 
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                            (see Fig. 3),
                              
                                 
                                    β
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      3
                                                   
                                                
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    :
                                    
                                       (
                                       
                                          
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          Λ
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          T
                                       
                                    
                                    
                                       
                                          β
                                       
                                       
                                          ′
                                       
                                    
                                    .
                                 
                              
                            The fact that 
                              b
                              =
                              β
                              /
                              1
                              β
                            and 
                              
                                 
                                    b
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    β
                                 
                                 
                                    ′
                                 
                              
                              /
                              1
                              
                                 
                                    β
                                 
                                 
                                    ′
                                 
                              
                            readily gives formula (5), where 
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                              
                              =
                              
                                 
                                    β
                                 
                                 
                                    3
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                              )
                              <
                              0
                           , by property (c) of Section 2.  □

Identity (5) is crucial in our considerations since it compels us to choose the reparametrizations 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      as linear rational transformations. Although, as we have seen above, our motivation for considering such transformations came from the idea of b.c.s on surfaces (and, in particular, the spherical b.c.s on the 2-sphere), this fact will be largely immaterial in the following. Indeed, there are other important reasons, described below, why linear rational transformations are appropriate and why they seem to fit perfectly our objective of finding a meaningful generalization of the spline space (1).

Let us first elaborate in more detail on conditions for triples 
                        
                           
                              λ
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              λ
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              λ
                           
                           
                              3
                           
                        
                     , guaranteeing the existence of linear rational transformations for the entire triangulation Δ. There is one such triple for each edge of Δ. These triples must be such that the associated transformations 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      satisfy:
                        
                           (A)
                           in the vicinity of the common edge 
                                 
                                    
                                       e
                                    
                                    
                                       3
                                    
                                 
                              , 
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       T
                                    
                                 
                               is a regular map of the form (5), for all pairs 
                                 T
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 Δ
                               of neighboring triangles, i.e., 
                                 
                                    
                                       λ
                                    
                                    
                                       3
                                    
                                 
                                 <
                                 0
                              ;

if 
                                 T
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       ″
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       (
                                       l
                                       )
                                    
                                 
                               are the triangles of Δ sharing a common vertex 
                                 
                                    
                                       v
                                    
                                    
                                       ¯
                                    
                                 
                               (ordered counterclockwise), then the composition 
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       T
                                    
                                 
                                 ∘
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ″
                                          
                                       
                                       ,
                                       
                                          
                                             T
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ∘
                                 ⋯
                                 ∘
                                 
                                    
                                       ϕ
                                    
                                    
                                       T
                                       ,
                                       
                                          
                                             T
                                          
                                          
                                             (
                                             l
                                             )
                                          
                                       
                                    
                                 
                               is the identity in a neighborhood N of 
                                 
                                    
                                       v
                                    
                                    
                                       ¯
                                    
                                 
                              ;

for all 
                                 v
                                 ∈
                                 N
                                 \
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       ¯
                                    
                                 
                                 }
                              , the sum of the angles between pairs of consecutive line segments from the set 
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       ¯
                                    
                                 
                                 v
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ¯
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ¯
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       (
                                       l
                                       )
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ¯
                                    
                                 
                                 v
                                 }
                               is 2π, where 
                                 
                                    
                                       v
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             (
                                             k
                                             −
                                             1
                                             )
                                          
                                       
                                       ,
                                       
                                          
                                             T
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       (
                                       k
                                       −
                                       1
                                       )
                                    
                                 
                              , 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 l
                              , with 
                                 
                                    
                                       v
                                    
                                    
                                       (
                                       0
                                       )
                                    
                                 
                                 :
                                 =
                                 v
                              , 
                                 
                                    
                                       T
                                    
                                    
                                       (
                                       0
                                       )
                                    
                                 
                                 :
                                 =
                                 T
                              .

One reason why linear rational transformations constitute a good choice of transition maps is that transformations satisfying conditions (A)–(C) are guaranteed to exist for any triangulation Δ. This follows from the well-known fact that all surfaces can be equipped with a real projective structure. It is also a consequence of a familiar result that all surfaces can be endowed with a homogeneous geometry, i.e. either hyperbolic, spherical, or affine, for which the transition functions are known to be linear rational.

A special case of such rational transformations are affine transformations. Note that if affine transformations exist for Δ, then any two adjacent triangles 
                        T
                        ,
                        
                           
                              T
                           
                           
                              ′
                           
                        
                        ∈
                        Δ
                      can be thought of as being coplanar and hence generalizing (1) is straightforward. However, a closed surface in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                      cannot be equipped with an affine structure unless it is a torus or a Klein bottle. On the other hand, it is known that by merely removing a single vertex from the triangulation, such affine transition maps can be found. This suggests that one does not have to go too far in generalizing affine transformations to be able to handle general surfaces. Clearly, linear rational transition maps are the next best thing to affine maps and so it is natural to consider them. In addition to the fact that such transformations can always be found, linear rational transformations will also offer more freedom than affine transformations to select appropriate parameters 
                        
                           
                              λ
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              λ
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              λ
                           
                           
                              3
                           
                        
                     . Note that a transformation of type (5) is affine if 
                        
                           
                              λ
                           
                           
                              1
                           
                        
                        +
                        
                           
                              λ
                           
                           
                              2
                           
                        
                        +
                        
                           
                              λ
                           
                           
                              3
                           
                        
                        =
                        1
                     . Thus, by removing this condition, one gains an extra degree of freedom for each edge of Δ.

Using rational reparametrizations also makes sense from the point of view of our advertised hope that the appropriate generalization of splines will employ piecewise rational functions. In particular, suppose that the restrictions of such generalized splines to adjacent triangles 
                        T
                        ,
                        
                           
                              T
                           
                           
                              ′
                           
                        
                      are rational functions of type 
                        n
                        /
                        n
                     , i.e. of the form 
                        
                           
                              p
                           
                           
                              n
                           
                        
                        /
                        
                           
                              q
                           
                           
                              n
                           
                        
                      and 
                        
                           
                              p
                           
                           
                              n
                           
                           
                              ′
                           
                        
                        /
                        
                           
                              q
                           
                           
                              n
                           
                           
                              ′
                           
                        
                     , where 
                        
                           
                              p
                           
                           
                              n
                           
                        
                        ,
                        
                           
                              q
                           
                           
                              n
                           
                        
                        ,
                        
                           
                              p
                           
                           
                              n
                           
                           
                              ′
                           
                        
                        ,
                        
                           
                              q
                           
                           
                              n
                           
                           
                              ′
                           
                        
                        ∈
                        
                           
                              π
                           
                           
                              n
                           
                        
                     . By the continuation property, each rational function of the form 
                        f
                        =
                        
                           
                              p
                           
                           
                              n
                           
                        
                        /
                        
                           
                              q
                           
                           
                              n
                           
                        
                      on T can be uniquely extended to 
                        
                           
                              T
                           
                           
                              ′
                           
                        
                      and this extension is of the form 
                        
                           
                              f
                           
                           
                              ′
                           
                        
                        =
                        
                           
                              p
                           
                           
                              n
                           
                           
                              ′
                           
                        
                        /
                        
                           
                              q
                           
                           
                              n
                           
                           
                              ′
                           
                        
                     . Thus, f composed with 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      must be equal to 
                        
                           
                              f
                           
                           
                              ′
                           
                        
                     , at least in a neighborhood of the common edge. Clearly, there are no better candidates for 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      than linear rational transformations, which are of type 1/1, since composing a rational function of type 
                        n
                        /
                        n
                      with a function of type 1/1 is again of type 
                        n
                        /
                        n
                     .

The remainder of this section will be devoted to yet another justification for utilizing transformations (5). It will be argued that linear rational transformations are in fact an inevitable consequence of two assumptions made previously: that the sought-for splines are locally parametrized by planar triangles and that the spline space should closely resemble the space 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        )
                      in (1). Namely, locally the generalized splines should belong to a space 
                        
                           
                              ρ
                           
                           
                              n
                           
                        
                     , which is analogous to 
                        
                           
                              π
                           
                           
                              n
                           
                        
                      in that functions in 
                        
                           
                              ρ
                           
                           
                              n
                           
                        
                      should admit a B-representation with respect to any given triangle. Because of this property of 
                        
                           
                              π
                           
                           
                              n
                           
                        
                     , it is possible to subdivide splines in 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        )
                      by refining Δ and by expressing individual polynomial pieces in the B-form w.r.t. the refined triangulation. It turns out that this property limits the available choices for 
                        
                           
                              ρ
                           
                           
                              n
                           
                        
                      considerably.

Let us first consider the case 
                        n
                        =
                        1
                     . In order for elements of 
                        
                           
                              ρ
                           
                           
                              1
                           
                        
                      to admit a B-representation for any given triangle, 
                        
                           
                              ρ
                           
                           
                              1
                           
                        
                      has to contain b.c.s with respect to that triangle. In particular, for any edge e of the triangle, the space 
                        
                           
                              ρ
                           
                           
                              1
                           
                        
                      has to contain a nonzero function vanishing on e. Thus, 
                        
                           
                              ρ
                           
                           
                              1
                           
                        
                      has to be such that for any straight line in 
                        A
                      (which is used to parametrize 
                        aff
                        (
                        T
                        )
                     , for any given 
                        T
                        ∈
                        Δ
                     ) there exists a nontrivial function in 
                        
                           
                              ρ
                           
                           
                              1
                           
                        
                      vanishing along that line. One can show that any such space 
                        
                           
                              ρ
                           
                           
                              1
                           
                        
                      has to have the form 
                        h
                        
                           
                              π
                           
                           
                              1
                           
                        
                     , where h is a scalar function on 
                        A
                     . This means that a space 
                        
                           
                              ρ
                           
                           
                              1
                           
                        
                      with the above property is unique up to a multiplicative factor.

Next suppose that 
                        T
                        ,
                        
                           
                              T
                           
                           
                              ′
                           
                        
                      are adjacent triangles in Δ and that 
                        f
                        ∈
                        
                           
                              ρ
                           
                           
                              1
                           
                           
                              T
                           
                        
                      is defined on T, where 
                        
                           
                              ρ
                           
                           
                              1
                           
                           
                              T
                           
                        
                      denotes a copy of 
                        
                           
                              ρ
                           
                           
                              1
                           
                        
                      associated with T. By the continuation property, f can be extended to 
                        
                           
                              T
                           
                           
                              ′
                           
                        
                     . If 
                        
                           
                              f
                           
                           
                              ′
                           
                        
                        ∈
                        
                           
                              ρ
                           
                           
                              1
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                           
                        
                      is this extension, then, as we know already, 
                        f
                        =
                        
                           
                              f
                           
                           
                              ′
                           
                        
                        ∘
                        
                           
                              ϕ
                           
                           
                              T
                              ,
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                           
                        
                     . We now claim that the mapping 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      must map lines to lines since if this were not the case then there would be a line 
                        
                           
                              e
                           
                           
                              ′
                           
                        
                        ⊂
                        A
                      mapped to a set 
                        e
                        ⊂
                        A
                     , containing at least three points that are not collinear. Let 
                        
                           
                              T
                           
                           
                              ¯
                           
                        
                        ⊂
                        aff
                        (
                        T
                        )
                      be the triangle whose vertices are these three points. Consider now a specific nonzero function 
                        
                           
                              f
                           
                           
                              ′
                           
                        
                        ∈
                        
                           
                              ρ
                           
                           
                              1
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                           
                        
                     , which vanishes along 
                        
                           
                              e
                           
                           
                              ′
                           
                        
                     . Hence 
                        f
                        ∈
                        
                           
                              ρ
                           
                           
                              1
                           
                           
                              T
                           
                        
                      is not identically zero and vanishes on e, and therefore also at the vertices of 
                        
                           
                              T
                           
                           
                              ¯
                           
                        
                     . Consequently, 
                        
                           
                              ρ
                           
                           
                              1
                           
                           
                              T
                           
                        
                      does not admit a B-representation on 
                        
                           
                              T
                           
                           
                              ¯
                           
                        
                     . For otherwise there would exist b.c.s for 
                        
                           
                              T
                           
                           
                              ¯
                           
                        
                      and thus any function from 
                        
                           
                              ρ
                           
                           
                              1
                           
                           
                              T
                           
                        
                     , vanishing at its vertices, would have to be identically zero, which would contradict that f is nonzero.

The above shows that 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                      maps lines to lines and therefore it is a collineation. As is well known, collineations are projective transformations and, as a result, they are linear rational transformations. This shows that such transformations are the only mappings that qualify for constructing adequate analogs of (1).

Another consequence of the above discussion is that since 
                        
                           
                              ρ
                           
                           
                              n
                           
                        
                      is obtained as the linear span of products of functions in 
                        
                           
                              ρ
                           
                           
                              1
                           
                        
                      (given that we assume that functions in 
                        
                           
                              ρ
                           
                           
                              n
                           
                        
                      admit a B-representation), the space 
                        
                           
                              ρ
                           
                           
                              n
                           
                        
                      has the form:
                        
                           (9)
                           
                              
                                 
                                    ρ
                                 
                                 
                                    n
                                 
                              
                              =
                              
                                 
                                    h
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    n
                                 
                              
                              ,
                              
                              n
                              ⩾
                              1
                              .
                           
                        
                     
                  

Assume that a collection Φ of linear rational transition maps of type (5) has been determined for a given triangulation Δ, satisfying conditions (A)–(C) of the previous section. To define splines for Δ, we will require that they are piecewise rational functions and such that, when restricted to any triangle of Δ, they belong to the space
                        
                           
                              
                                 
                                    ρ
                                 
                                 
                                    n
                                 
                              
                              :
                              =
                              
                                 {
                                 
                                    
                                       r
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       
                                          p
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                 
                                 ;
                                 
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 ∈
                                 
                                    
                                       π
                                    
                                    
                                       n
                                    
                                 
                                 }
                              
                              .
                           
                        
                      Consequently, each such function on a triangle 
                        T
                        ∈
                        Δ
                      can be expressed in the B-form:
                        
                           
                              
                                 
                                    r
                                 
                                 
                                    n
                                 
                                 
                                    T
                                 
                              
                              =
                              
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                    
                                       T
                                    
                                 
                              
                              =
                              
                                 
                                    ∑
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    c
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    T
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    T
                                 
                              
                              ∈
                              R
                              ,
                           
                        
                      where 
                        
                           
                              B
                           
                           
                              i
                              j
                              k
                           
                           
                              n
                           
                        
                        =
                        
                           
                              n
                              !
                           
                           
                              i
                              !
                              j
                              !
                              k
                              !
                           
                        
                        
                           
                              b
                           
                           
                              1
                           
                           
                              i
                           
                        
                        
                           
                              b
                           
                           
                              2
                           
                           
                              j
                           
                        
                        
                           
                              b
                           
                           
                              3
                           
                           
                              k
                           
                        
                      are the usual Bernstein basis polynomials and 
                        
                           
                              b
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              b
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              b
                           
                           
                              3
                           
                        
                      are the planar b.c.s associated with T. The above functions can now be used as building blocks for splines defined over Ω.


                     
                        Definition 2
                        The spline space 
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                                 
                                    m
                                 
                              
                              (
                              Δ
                              ,
                              Φ
                              )
                            of degree n and continuity of order m, associated with triangulation Δ and transition maps Φ, is defined as
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          n
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    Δ
                                    ,
                                    Φ
                                    )
                                    :
                                    =
                                    
                                       {
                                       f
                                       ∈
                                       
                                          
                                             C
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       Ω
                                       )
                                       ;
                                       
                                       f
                                       
                                          
                                             |
                                          
                                          
                                             T
                                          
                                       
                                       ∈
                                       
                                          
                                             ρ
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       
                                       T
                                       ∈
                                       Δ
                                       }
                                    
                                    .
                                 
                              
                           
                        

Thus, functions belonging to this space, which will be called Rational Geometric Splines (RAGS), are functions of type 
                        f
                        :
                        Ω
                        →
                        R
                     . Therefore, they can be thought of as being parametrized by the piecewise linear surface Ω whose facets are the triangles of Δ. These functions are 
                        
                           
                              C
                           
                           
                              m
                           
                        
                     -smooth in the sense of Definition 1 and w.r.t. the given transition maps Φ. Note that 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        )
                      defined above is not linear. To make it into a linear space, one can fix the denominators 
                        
                           
                              q
                           
                           
                              n
                           
                           
                              T
                           
                        
                      of the rational functions defining the spline. If Q is the set of all such fixed polynomials 
                        
                           
                              q
                           
                           
                              n
                           
                           
                              T
                           
                        
                     , the resulting subset of 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        )
                      will be denoted by 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        ,
                        Q
                        )
                     , which is a linear space.

The central question before us is whether 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        )
                      shares important properties with the classical space 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        )
                     . In particular, is it reasonable to expect that appropriate weights 
                        
                           
                              w
                           
                           
                              i
                              j
                              k
                           
                           
                              T
                           
                        
                      of polynomials 
                        
                           
                              q
                           
                           
                              n
                           
                           
                              T
                           
                        
                      can be found, guaranteeing that the resulting space 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        ,
                        Q
                        )
                      contains nontrivial smooth functions? The answer to this question is that the situation is essentially the same as in the standard spline case.

To explain, we will first consider the following auxiliary problem. Suppose that p is a B-polynomial of degree n w.r.t. a planar triangle and suppose that the barycentric coordinates b for that triangle are transformed by a linear transformation, 
                        b
                        ↦
                        Λ
                        b
                     , where Λ is a matrix of the form (6). The next lemma gives a formula for the B-coefficients of 
                        p
                        (
                        Λ
                        b
                        )
                     . Note that in general the vector 
                        
                           
                              b
                           
                           
                              ′
                           
                        
                        :
                        =
                        Λ
                        b
                      does not represent planar b.c.s since its components may not add up to one. In that case 
                        p
                        (
                        
                           
                              b
                           
                           
                              ′
                           
                        
                        )
                        =
                        p
                        (
                        Λ
                        b
                        )
                      is still well defined if the Bernstein basis polynomials 
                        
                           
                              B
                           
                           
                              i
                              j
                              k
                           
                           
                              n
                           
                        
                      are interpreted as homogeneous trivariate polynomials.


                     
                        Lemma 1
                        
                           Let Λ be a matrix of the form
                           
                              
                                 (10)
                                 
                                    Λ
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                            
                           and let 
                           
                              p
                              (
                              b
                              )
                              =
                              ∑
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    n
                                 
                              
                              (
                              b
                              )
                            
                           and 
                           
                              
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                              (
                              b
                              )
                              =
                              ∑
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    n
                                 
                              
                              (
                              b
                              )
                           
                           . Then
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    b
                                    )
                                    =
                                    p
                                    (
                                    Λ
                                    b
                                    )
                                    ,
                                    
                                    ∀
                                    b
                                    ∈
                                    A
                                    ,
                                 
                              
                            
                           if and only if
                           
                              
                                 (11)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          r
                                          +
                                          s
                                          +
                                          t
                                          =
                                          k
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          +
                                          r
                                          ,
                                          j
                                          +
                                          s
                                          ,
                                          t
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          r
                                          s
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    λ
                                    )
                                    ,
                                 
                              
                            
                           for all 
                           
                              i
                              ,
                              j
                              ,
                              k
                            
                           such that 
                           
                              i
                              +
                              j
                              +
                              k
                              =
                              n
                           
                           , where 
                           
                              λ
                              =
                              
                                 
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 
                                    t
                                 
                              
                           
                           .
                        


                     
                        Proof
                        This result is well known in the affine case, i.e. when 
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                              
                              =
                              1
                           , and was proved by de Boor (1987). The proof for the case 
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                              
                              ≠
                              1
                            is still the same.  □

In the affine case, the result has a well-known interpretation. Suppose that 
                        T
                        ,
                        
                           
                              T
                           
                           
                              ′
                           
                        
                      are adjacent triangles in the plane with vertices 
                        
                           
                              v
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              3
                           
                        
                      and 
                        
                           
                              v
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              3
                           
                           
                              ′
                           
                        
                     , and suppose that a polynomial p is given in the B-form w.r.t. triangle T. Then p can be expressed in the B-form corresponding to triangle 
                        
                           
                              T
                           
                           
                              ′
                           
                        
                     . Lemma 1 shows how to express the B-coefficients of p w.r.t. 
                        
                           
                              T
                           
                           
                              ′
                           
                        
                     . Namely, the vector λ in (11) should be such that its components are the b.c.s of 
                        
                           
                              v
                           
                           
                              3
                           
                           
                              ′
                           
                        
                      w.r.t. T, since this is precisely when the transformation 
                        b
                        ↦
                        Λ
                        b
                      maps b.c.s of 
                        
                           
                              T
                           
                           
                              ′
                           
                        
                      to b.c.s of T.

In spline theory, this lemma is used to impose smoothness conditions between polynomials on adjacent triangles. In particular, if p and 
                        
                           
                              p
                           
                           
                              ′
                           
                        
                      are polynomials on T and 
                        
                           
                              T
                           
                           
                              ′
                           
                        
                     , respectively, they will join with 
                        
                           
                              C
                           
                           
                              m
                           
                        
                     -continuity along the common edge if and only if (11) holds, for all 
                        i
                        ,
                        j
                        ,
                        k
                      such that 
                        i
                        +
                        j
                        +
                        k
                        =
                        n
                      and 
                        k
                        =
                        0
                        ,
                        …
                        ,
                        m
                     . This follows from the lemma using standard facts about B-polynomials. For 
                        
                           
                              C
                           
                           
                              0
                           
                        
                     -continuity, this means that the B-coefficients associated with the common edge should be the same for both polynomials, i.e. 
                        
                           
                              d
                           
                           
                              i
                              j
                              0
                           
                           
                              ′
                           
                        
                        =
                        
                           
                              d
                           
                           
                              i
                              j
                              0
                           
                        
                     , 
                        i
                        +
                        j
                        =
                        n
                     . For 
                        
                           
                              C
                           
                           
                              1
                           
                        
                     -continuity, identity (11) implies that one needs to impose conditions on the “second row” of B-coefficients, namely (see Farin, 2002 and Hoschek and Lasser, 1993)
                        
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                    1
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    d
                                 
                                 
                                    i
                                    +
                                    1
                                    ,
                                    j
                                    ,
                                    0
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    d
                                 
                                 
                                    i
                                    ,
                                    j
                                    +
                                    1
                                    ,
                                    0
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    d
                                 
                                 
                                    i
                                    ,
                                    j
                                    ,
                                    1
                                 
                              
                              ,
                              
                              i
                              +
                              j
                              =
                              n
                              −
                              1
                              .
                           
                        
                     
                  

We now return to 
                        
                           
                              C
                           
                           
                              m
                           
                        
                     -continuity conditions for rational splines and general linear rational transformations, when 
                        
                           
                              λ
                           
                           
                              1
                           
                        
                        +
                        
                           
                              λ
                           
                           
                              2
                           
                        
                        +
                        
                           
                              λ
                           
                           
                              3
                           
                        
                      is not necessarily equal to one. Sufficient conditions for joining two adjacent rational patches with 
                        
                           
                              C
                           
                           
                              m
                           
                        
                     -continuity are spelled out in the following


                     
                        Proposition 2
                        
                           Let 
                           
                              T
                              ,
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              Δ
                            
                           be adjacent triangles and let Λ be the matrix of the form 
                           (10)
                           , corresponding to the linear transition map 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    T
                                 
                              
                           
                           . Let
                           
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          
                                             p
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             
                                                c
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             
                                                w
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          r
                                       
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          
                                             p
                                          
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             
                                                c
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             
                                                w
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                            
                           be rational functions associated with 
                           
                              T
                              ,
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                           
                           , where
                           
                              
                                 (12)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          r
                                          +
                                          s
                                          +
                                          t
                                          =
                                          k
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          +
                                          r
                                          ,
                                          j
                                          +
                                          s
                                          ,
                                          t
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          r
                                          s
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    λ
                                    )
                                 
                              
                            
                           and
                           
                              
                                 (13)
                                 
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          r
                                          +
                                          s
                                          +
                                          t
                                          =
                                          k
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          +
                                          r
                                          ,
                                          j
                                          +
                                          s
                                          ,
                                          t
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          r
                                          s
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    λ
                                    )
                                    ,
                                 
                              
                            
                           for all indices such that 
                           
                              i
                              +
                              j
                              +
                              k
                              =
                              n
                           
                           , 
                           
                              k
                              =
                              0
                              ,
                              …
                              ,
                              m
                           
                           , 
                           
                              m
                              ⩾
                              0
                           
                           . Then 
                           
                              
                                 
                                    r
                                 
                                 
                                    n
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                            
                           join with 
                           
                              
                                 
                                    C
                                 
                                 
                                    m
                                 
                              
                           
                           -continuity along the common edge 
                           
                              
                                 
                                    e
                                 
                                 
                                    3
                                 
                              
                            
                           of 
                           
                              T
                              ,
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                           
                           .
                        


                     
                        Proof
                        The proof follows along standard lines and is a direct consequence of Lemma 1 and the subsequent discussion. More precisely, Definition 1 prompts us to consider the function 
                              
                                 
                                    r
                                 
                                 
                                    n
                                 
                              
                              ∘
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    T
                                 
                              
                           , which can be written as
                              
                                 
                                    (
                                    
                                       
                                          r
                                       
                                       
                                          n
                                       
                                    
                                    ∘
                                    
                                       
                                          ϕ
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          T
                                       
                                    
                                    )
                                    (
                                    b
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                n
                                             
                                          
                                          (
                                          Λ
                                          b
                                          /
                                          1
                                          Λ
                                          b
                                          )
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                n
                                             
                                          
                                          (
                                          Λ
                                          b
                                          /
                                          1
                                          Λ
                                          b
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                n
                                             
                                          
                                          (
                                          Λ
                                          b
                                          )
                                          /
                                          
                                             
                                                (
                                                1
                                                Λ
                                                b
                                                )
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                n
                                             
                                          
                                          (
                                          Λ
                                          b
                                          )
                                          /
                                          
                                             
                                                (
                                                1
                                                Λ
                                                b
                                                )
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                n
                                             
                                          
                                          (
                                          Λ
                                          b
                                          )
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                n
                                             
                                          
                                          (
                                          Λ
                                          b
                                          )
                                       
                                    
                                    ,
                                 
                              
                            where we used the fact that 
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    n
                                 
                              
                            are homogeneous of degree n and that in the vicinity of the common edge, 
                              1
                              Λ
                              b
                              >
                              0
                           . By Lemma 1, the last expression above can be written as
                              
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                n
                                             
                                          
                                          (
                                          Λ
                                          b
                                          )
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                n
                                             
                                          
                                          (
                                          Λ
                                          b
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                            where the B-coefficients satisfy
                              
                                 
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          r
                                          +
                                          s
                                          +
                                          t
                                          =
                                          k
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          +
                                          r
                                          ,
                                          j
                                          +
                                          s
                                          ,
                                          t
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          r
                                          s
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    λ
                                    )
                                    ,
                                    
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          r
                                          +
                                          s
                                          +
                                          t
                                          =
                                          k
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          +
                                          r
                                          ,
                                          j
                                          +
                                          s
                                          ,
                                          t
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          r
                                          s
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    λ
                                    )
                                    ,
                                 
                              
                            for all 
                              i
                              +
                              j
                              +
                              k
                              =
                              n
                           . By Definition 1, we need to verify that the rational functions 
                              
                                 
                                    r
                                 
                                 
                                    n
                                 
                              
                              ∘
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    T
                                 
                              
                            and 
                              
                                 
                                    r
                                 
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                           , or
                              
                                 
                                    
                                       
                                          ∑
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          ∑
                                          
                                             
                                                c
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             
                                                w
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                            and their derivatives up to order m agree along the common edge. However, this follows from the fact that by (12) and (13), one has 
                              
                                 
                                    c
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                            and 
                              
                                 
                                    w
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                           , as long as 
                              k
                              ⩽
                              m
                           , and the well-known fact that the B-coefficients 
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                           , 
                              k
                              >
                              m
                           , of a B-polynomial 
                              ∑
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    n
                                 
                              
                            do not influence derivatives of orders m or less along edge 
                              
                                 
                                    e
                                 
                                 
                                    3
                                 
                              
                           . This shows that 
                              
                                 
                                    r
                                 
                                 
                                    n
                                 
                              
                              =
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              /
                              
                                 
                                    q
                                 
                                 
                                    n
                                 
                              
                            and 
                              
                                 
                                    r
                                 
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              /
                              
                                 
                                    q
                                 
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                            are joined with 
                              
                                 
                                    C
                                 
                                 
                                    m
                                 
                              
                           -continuity.  □

Consistent with the above result, the B-coefficients of 
                        
                           
                              p
                           
                           
                              n
                           
                        
                        ,
                        
                           
                              q
                           
                           
                              n
                           
                        
                      will be assumed to be equal to those of 
                        
                           
                              p
                           
                           
                              n
                           
                           
                              ′
                           
                        
                        ,
                        
                           
                              q
                           
                           
                              n
                           
                           
                              ′
                           
                        
                      along the common edge, i.e.,
                        
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                    j
                                    0
                                 
                              
                              =
                              
                                 
                                    c
                                 
                                 
                                    i
                                    j
                                    0
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                    j
                                    0
                                 
                              
                              =
                              
                                 
                                    w
                                 
                                 
                                    i
                                    j
                                    0
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                              i
                              +
                              j
                              =
                              n
                              ,
                           
                        
                      which ensures a 
                        
                           
                              C
                           
                           
                              0
                           
                        
                     -continuous join of the two rational patches 
                        
                           
                              r
                           
                           
                              n
                           
                        
                        ,
                        
                           
                              r
                           
                           
                              n
                           
                           
                              ′
                           
                        
                     . In general, a consequence of Proposition 2 is that smoothness conditions for the numerators 
                        
                           
                              p
                           
                           
                              n
                           
                        
                      and the denominators 
                        
                           
                              q
                           
                           
                              n
                           
                        
                      of the rational functions can be separated from one another. These conditions are linear and homogeneous and the only difference with the classical spline case is that the numbers 
                        
                           
                              λ
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              λ
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              λ
                           
                           
                              3
                           
                        
                      in (12) and (13) need not sum to one.

Since the defined splines are assembled from rational patches, it is not surprising that one can define the concept of a control net for them. To construct surfaces in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                     , we will consider B-coefficients 
                        
                           
                              c
                           
                           
                              i
                              j
                              k
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              3
                           
                        
                      which have a special form, namely 
                        
                           
                              c
                           
                           
                              i
                              j
                              k
                           
                        
                        =
                        
                           
                              d
                           
                           
                              i
                              j
                              k
                           
                        
                        
                           
                              w
                           
                           
                              i
                              j
                              k
                           
                        
                      (see Farin, 2002 and Hoschek and Lasser, 1993).


                     
                        Definition 3
                        Let 
                              s
                              ∈
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                                 
                                    m
                                 
                              
                              (
                              Δ
                              ,
                              Φ
                              )
                            be a spline, whose rational pieces 
                              
                                 
                                    r
                                 
                                 
                                    n
                                 
                                 
                                    T
                                 
                              
                              =
                              s
                              
                                 
                                    |
                                 
                                 
                                    T
                                 
                              
                              ,
                              T
                              ∈
                              Δ
                           , are of the form
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          n
                                       
                                       
                                          T
                                       
                                    
                                    =
                                    
                                       
                                          
                                             p
                                          
                                          
                                             n
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                          
                                             T
                                          
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             
                                                d
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             
                                                w
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    T
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                            and 
                              
                                 
                                    w
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    T
                                 
                              
                              ∈
                              R
                           . Then the points 
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    T
                                 
                              
                            are called the control points or Bézier points of the rational patch 
                              
                                 
                                    r
                                 
                                 
                                    n
                                 
                                 
                                    T
                                 
                              
                           .

It is well known that functions 
                        
                           
                              r
                           
                           
                              n
                           
                           
                              T
                           
                        
                      of the above form have several useful properties that make them suitable for CAGD. For example, it is easily seen that the patch 
                        
                           
                              r
                           
                           
                              n
                           
                           
                              T
                           
                        
                      interpolates the control points 
                        
                           
                              d
                           
                           
                              n
                              00
                           
                           
                              T
                           
                        
                     , 
                        
                           
                              d
                           
                           
                              0
                              n
                              0
                           
                           
                              T
                           
                        
                     , 
                        
                           
                              d
                           
                           
                              00
                              n
                           
                           
                              T
                           
                        
                     , that the control net, i.e., the usual piecewise linear interpolant of the control points 
                        
                           
                              {
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              }
                           
                           
                              i
                              +
                              j
                              +
                              k
                              =
                              n
                           
                        
                     , has the convex hull property (if 
                        
                           
                              w
                           
                           
                              i
                              j
                              k
                           
                           
                              T
                           
                        
                        >
                        0
                     , 
                        i
                        +
                        j
                        +
                        k
                        =
                        n
                     ), and points on the surface patch 
                        
                           
                              r
                           
                           
                              n
                           
                           
                              T
                           
                        
                      can be evaluated by a de Casteljau algorithm (Farin, 2002).

To further illustrate the resemblance of rational and polynomial splines, we finish this section with a geometric interpretation of the 
                        
                           
                              C
                           
                           
                              1
                           
                        
                     -continuity conditions of Proposition 2.


                     
                        Proposition 3
                        
                           Let
                           
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          
                                             p
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             
                                                d
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             
                                                w
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          r
                                       
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          
                                             p
                                          
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             
                                                d
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             
                                                w
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                            
                           be rational functions associated with 
                           
                              T
                              ,
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                           
                           , with positive weights 
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    ′
                                 
                              
                           
                           , and such that
                           
                              
                                 (14)
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             i
                                             j
                                             0
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             d
                                          
                                          
                                             i
                                             j
                                             0
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             w
                                          
                                          
                                             i
                                             j
                                             0
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             w
                                          
                                          
                                             i
                                             j
                                             0
                                          
                                       
                                       ,
                                       
                                       i
                                       +
                                       j
                                       =
                                       n
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             i
                                             j
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             i
                                             +
                                             1
                                             ,
                                             j
                                             ,
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             i
                                             ,
                                             j
                                             +
                                             1
                                             ,
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                       i
                                       +
                                       j
                                       =
                                       n
                                       −
                                       1
                                       ,
                                    
                                 
                              
                            
                           and
                           
                              
                                 (15)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          j
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          0
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          1
                                       
                                    
                                    ,
                                    
                                    i
                                    +
                                    j
                                    =
                                    n
                                    −
                                    1
                                    ,
                                 
                              
                            
                           where
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          ,
                                          0
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          ,
                                          0
                                       
                                    
                                    /
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          1
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          0
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          0
                                       
                                    
                                    /
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          1
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          1
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          1
                                       
                                    
                                    /
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          1
                                       
                                    
                                    )
                                    .
                                 
                              
                            
                           Then 
                           
                              
                                 
                                    r
                                 
                                 
                                    n
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                            
                           join with 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                           
                           -continuity along the common edge of 
                           
                              T
                              ,
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                           
                           .
                        


                     
                        Proof
                        Setting 
                              
                                 
                                    c
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              =
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                           , 
                              
                                 
                                    c
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    d
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    ′
                                 
                              
                           , and using (14), identity (15) can be rewritten as
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          j
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          1
                                       
                                    
                                    ,
                                    
                                    i
                                    +
                                    j
                                    =
                                    n
                                    −
                                    1
                                    .
                                 
                              
                            This shows that (12) holds for 
                              k
                              =
                              1
                            and the claim now follows from Proposition 2.  □

On account of 
                        
                           
                              μ
                           
                           
                              i
                              +
                              1
                              ,
                              j
                              ,
                              0
                           
                        
                        +
                        
                           
                              μ
                           
                           
                              i
                              ,
                              j
                              +
                              1
                              ,
                              0
                           
                        
                        +
                        
                           
                              μ
                           
                           
                              i
                              ,
                              j
                              ,
                              1
                           
                        
                        =
                        1
                     , 
                        
                           
                              C
                           
                           
                              1
                           
                        
                     -continuity conditions for two adjacent rational functions 
                        
                           
                              r
                           
                           
                              n
                           
                        
                     , 
                        
                           
                              r
                           
                           
                              n
                           
                           
                              ′
                           
                        
                      have the familiar geometric interpretation that the control points 
                        
                           
                              d
                           
                           
                              i
                              j
                              1
                           
                           
                              ′
                           
                        
                     , 
                        
                           
                              d
                           
                           
                              i
                              +
                              1
                              ,
                              j
                              ,
                              0
                           
                        
                     , 
                        
                           
                              d
                           
                           
                              i
                              ,
                              j
                              +
                              1
                              ,
                              0
                           
                        
                     , 
                        
                           
                              d
                           
                           
                              i
                              ,
                              j
                              ,
                              1
                           
                        
                      are coplanar, for 
                        i
                        +
                        j
                        =
                        n
                        −
                        1
                     . This generalizes a well-known result for piecewise polynomials. However, in that special case 
                        
                           
                              μ
                           
                           
                              i
                              +
                              1
                              ,
                              j
                              ,
                              0
                           
                        
                        =
                        
                           
                              λ
                           
                           
                              1
                           
                        
                     , 
                        
                           
                              μ
                           
                           
                              i
                              ,
                              j
                              +
                              1
                              ,
                              0
                           
                        
                        =
                        
                           
                              λ
                           
                           
                              2
                           
                        
                     , 
                        
                           
                              μ
                           
                           
                              i
                              ,
                              j
                              ,
                              1
                           
                        
                        =
                        
                           
                              λ
                           
                           
                              3
                           
                        
                     , i.e., these coefficients do not depend on 
                        i
                        ,
                        j
                     .

Considerations in this section lead to the following recipe for building splines. Once an appropriate collection of transition maps Φ has been found, a set of weights 
                        
                           
                              w
                           
                           
                              i
                              j
                              k
                           
                        
                      satisfying (13) is determined for each triangle of Δ, which in turn gives rise to a spline space 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        ,
                        Q
                        )
                     . In the next section we briefly describe how this general prescription can be used to obtain smooth surfaces.

We will illustrate the proposed idea with two examples demonstrating the possibility of effectively constructing RAGS surfaces of high smoothness and arbitrary topology. We will content ourselves with a schematic description of the construction, and delegate the technical details to a separate paper.

We consider initial triangular meshes Ω, depicted in Figs. 5(a) and 6(a) and interpolate them by smooth RAGS surfaces parametrized by Ω. The resulting interpolants, displayed in Figs. 5, 6(c–f), are elements of the spaces 
                        
                           
                              S
                           
                           
                              6
                           
                           
                              2
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        )
                      and 
                        
                           
                              S
                           
                           
                              10
                           
                           
                              4
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        )
                     , respectively. Their control nets can be seen in Figs. 5, 6(b).

The first step in setting up the spline space is to determine, for each pair of neighboring triangles 
                        T
                        ,
                        
                           
                              T
                           
                           
                              ′
                           
                        
                     , linear rational transformations 
                        
                           
                              ϕ
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ,
                              T
                           
                        
                     , identified by parameters 
                        
                           
                              λ
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              λ
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              λ
                           
                           
                              3
                           
                        
                     . In the current examples, these were obtained by using a homogeneous geometry as follows. Since the surfaces are of genus 
                        g
                        >
                        1
                     , the initial triangulation Δ is in both cases equipped with the hyperbolic geometry, by associating Δ with a combinatorially equivalent hyperbolic triangulation 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                      (of course, a spherical triangulation should be used when 
                        g
                        =
                        0
                     , while for 
                        g
                        =
                        1
                     , Φ should be chosen as a collection of affine transformations). The triangulation 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                      can be completely described by a collection of angles 
                        
                           
                              α
                           
                           
                              1
                           
                           
                              T
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              2
                           
                           
                              T
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              3
                           
                           
                              T
                           
                        
                        ,
                        T
                        ∈
                        Δ
                     , where each triple 
                        
                           
                              α
                           
                           
                              1
                           
                           
                              T
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              2
                           
                           
                              T
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              3
                           
                           
                              T
                           
                        
                      corresponds to interior angles of a triangle in the hyperbolic plane. Such a hyperbolic triangle is uniquely determined by these angles up to a similarity transformation. These triples of angles describe a consistent hyperbolic triangulation 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                      if the following conditions hold (see Ratcliffe, 2007):
                        
                           (i)
                           the sum of the areas of all triangles in 
                                 
                                    
                                       Δ
                                    
                                    
                                       H
                                    
                                 
                               is 
                                 4
                                 π
                                 (
                                 g
                                 −
                                 1
                                 )
                              ;

the sum of the angles surrounding each vertex is 2π;

common sides of adjacent triangles in 
                                 
                                    
                                       Δ
                                    
                                    
                                       H
                                    
                                 
                               have equal lengths.

In our examples, the hyperbolic triangulation 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                      was determined through a simple iterative procedure, which starts from an initial set of angles satisfying conditions (i) and (ii) and which then adjusts the angles iteratively in order to satisfy (iii). A detailed discussion of this and related aspects of the construction is beyond the scope of this paper and will be postponed to another occasion.

Once 
                        
                           
                              Δ
                           
                           
                              H
                           
                        
                      has been found, the transition maps can be read off this triangulation as follows. For each pair of neighboring triangles 
                        T
                        ,
                        
                           
                              T
                           
                           
                              ′
                           
                        
                        ∈
                        Δ
                     , corresponding to angles 
                        
                           
                              α
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              3
                           
                        
                      and 
                        
                           
                              α
                           
                           
                              1
                           
                           
                              ′
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              2
                           
                           
                              ′
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              3
                           
                           
                              ′
                           
                        
                     , we determine two adjacent triangles in the hyperbolic plane having these angles and with vertices labeled by 
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              3
                           
                        
                      and 
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              3
                           
                           
                              ′
                           
                        
                     , as depicted in Fig. 4
                     . The sought-for values 
                        
                           
                              λ
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              λ
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              λ
                           
                           
                              3
                           
                        
                      are then the hyperbolic or homogeneous (Alfeld et al., 1996a) b.c.s of 
                        
                           
                              u
                           
                           
                              3
                           
                           
                              ′
                           
                        
                      w.r.t. the triangle 
                        〈
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              3
                           
                        
                        〉
                     , that is,
                        
                           
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                              
                              .
                           
                        
                     
                  

Note that a pair of adjacent hyperbolic triangles corresponding to angles 
                        
                           
                              α
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              3
                           
                        
                      and 
                        
                           
                              α
                           
                           
                              1
                           
                           
                              ′
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              2
                           
                           
                              ′
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              3
                           
                           
                              ′
                           
                        
                      is determined uniquely up to a similarity transformation. Hence each such pair will give rise to the same triple of homogeneous b.c.s 
                        
                           
                              λ
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              λ
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              λ
                           
                           
                              3
                           
                        
                     .

We remark that although we used a hyperbolic geometry to determine the linear rational transformations in the above examples, in general we do not advocate the use of homogeneous geometry. This approach, in fact, unnecessarily restricts the class of available transformations. Moreover, in a homogeneous geometry, the problem of finding appropriate transition maps becomes global in nature. As a consequence, local modifications to the triangular mesh, for example adding a handle or some other local feature to the surface, require solving the global problem of computing the transition maps for the entire modified triangulation Δ. In this way, the entire spline space would need to be altered, as opposed to the preferable approach of changing it locally in modified regions of the mesh.

Once appropriate transition maps Φ have been selected, the next constructive step is to obtain a spline from the space 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        )
                      that meets prescribed objectives. In our examples, we sought a parametric spline from spaces 
                        
                           
                              S
                           
                           
                              6
                           
                           
                              2
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        )
                     , 
                        
                           
                              S
                           
                           
                              10
                           
                           
                              4
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        )
                     , interpolating the vertices of the given mesh. The orders of smoothness 
                        m
                        =
                        2
                        ,
                        4
                      were chosen to demonstrate that a high order of continuity is not a hindrance. Note that for methods based on the stitching-patches-together approach, already 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -continuity represents a major hurdle. Like in all spline-based methods (see Lai and Schumaker, 2007), suitable spline degrees, in our case 
                        n
                        =
                        6
                        ,
                        10
                     , need to be chosen to allow sufficient flexibility of the splines to meet the smoothness constraints. The Bézier points of the spline, 
                        
                           
                              d
                           
                           
                              i
                              j
                              k
                           
                           
                              T
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              3
                           
                        
                     , and the weights 
                        
                           
                              w
                           
                           
                              i
                              j
                              k
                           
                           
                              T
                           
                        
                        ∈
                        R
                      have been computed such that the resulting spline interpolates the vertices of the mesh, is 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              C
                           
                           
                              4
                           
                        
                     -smooth, and “fair”. The last objective was achieved by minimizing a fairness or energy functional based on the Laplace operator. Overall, the procedure is formally the same as that pursued in the classical bivariate spline setting. To be sure, this is true for a number of other methods we have tested, which are direct adaptations of available methods for bivariate splines. These will be reported elsewhere.

@&#DISCUSSION@&#

The objective of this paper, which is based on our earlier work (Neamtu, 2006), has been to introduce the RAGS space 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        ,
                        Q
                        )
                      and to argue that it is the proper generalization of the well-known space of bivariate splines (1) to triangulations of arbitrary topology. Indeed, once the transition maps Φ are fixed, along with a compatible collection of polynomials Q, the space 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        ,
                        Q
                        )
                      has many essential characteristics in common with 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        )
                     . The new space is linear, on account of the linearity of conditions (12), and can be employed in the same general fashion as its classical counterpart. For example, one can set up a linear system for the Bézier points to obtain an interpolating or approximating spline of any desired degree and any order of global continuity. The set of denominators Q, which depend on Φ, can be chosen to reflect the topology of the triangulation Δ, whereas the Bézier points of a spline in 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        ,
                        Q
                        )
                      can then be selected to match the geometry of the desired surface. Another important feature of the RAGS space that distinguishes it from related attempts to model surfaces of arbitrary topology is the ability to make use of the rich reservoir of existing classical spline data fitting methods. In our view this is further evidence that 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        ,
                        Q
                        )
                      is the proper generalization of the classical bivariate spline space.

An added benefit of our approach is that the new splines are piecewise rational and hence they are, at least in principle, compatible with the NURBS representation. We note that the fact that composite rational surfaces can be used to model surfaces of arbitrary topology has been observed before, see Peters (1990) and Hoschek and Lasser (1993), for references on some of the earliest surface construction methods employing polynomial and rational patches. In this context we remark that conditions exist for joining two rational patches smoothly, which are not only sufficient – as is the case in Proposition 2 – but also necessary, see e.g., Kiciak (1996). However, if we want to employ the linear space 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        ,
                        Q
                        )
                      instead of the full nonlinear space 
                        
                           
                              S
                           
                           
                              n
                           
                           
                              m
                           
                        
                        (
                        Δ
                        ,
                        Φ
                        )
                     , then Proposition 2 is appropriate because for a fixed set of weights satisfying (13), conditions (12) are also necessary for 
                        
                           
                              C
                           
                           
                              m
                           
                        
                     -continuity. In addition we note that in the affine case Proposition 3 is proved in Liu (1990).

We would also like to point out that special instances of RAGS have appeared before. In particular, spherical splines introduced by Alfeld et al. (1996a) are used in the paper by Liu and Schumaker (1996) to define a class of 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      interpolating splines on the sphere, which are piecewise rational functions. Moreover, the paper by Ferguson and Rockwood (1993) and later Wallner (1996) and Pottmann and Wallner (1997) represent the first attempts to employ hyperbolic geometry in the construction of surfaces. The last two works use hyperbolic geometry and the machinery of orbifolds, which allows them to model smooth surfaces of higher genus by rational splines. Nevertheless, except for the above special cases, we have not encountered in the literature a definition of bivariate splines based explicitly on general linear rational transition maps.

The idea of using transition maps or reparametrizations in connection with building smooth piecewise polynomial or rational surfaces is also not novel. In fact, the prevalent approach to defining the so-called geometric continuity is via reparametrizations. For example, Definition 1 is essentially the same as those given in other works, including DeRose (1985), Hahn (1989), Peters (2002b), and references therein. In addition to smoothness, the reparametrizations or transition maps also need to be compatible in that they must satisfy the so-called vertex enclosure condition. Thus, the composition of all transition maps associated with edges emanating from any given vertex must be, roughly speaking, an approximate identity (see Hahn, 1989; Peters, 2002b). In the case of RAGS, the transition maps are infinitely differentiable and their composition is exactly the identity map.

Many researchers have attempted to construct appropriate reparametrizations and then to use them to define smooth surfaces. The basic idea is to select, for a given triangulation, a collection of smooth reparametrizations for each pair of neighboring triangles. For example, DeRose (1985) gave one of the first general definitions of splines, which is based on the idea of fixing the reparametrizations. This approach was later used by several authors, including Goodman (1991), Höllig and Mögerle (1990), Prautzsch (1997), Reif (1998), and Peters (2002a), to construct 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      and higher-order surfaces. For a more detailed list of references and a discussion of existing methods until about 2001, we refer the reader to the survey by Peters (2002b).

Some of the recent constructions, which are usually referred to as manifold splines, also employ the reparametrization approach. A number of these use reparametrizations that are affine (Gu et al., 2008). If such affine maps exist, then methods based on classical splines can be used in a straightforward way. Namely, one can use algebraic polynomials on each triangle to build a spline space since algebraic polynomials are invariant under affine reparametrizations. General surfaces do not admit an affine structure, which explains why some of the manifold spline methods suffer from having at least one singular vertex. A recent paper by Zeng et al. (2009) circumvents this problem by using hyperbolic structures instead of affine, but the resulting smooth surfaces are not splines in our sense.

It is obvious that more work is needed in order to understand to what extent RAGS can be utilized in CAGD applications. In particular, a constructive theory of these splines is clearly needed, addressing several important questions that have already been mostly answered for the classical bivariate splines, such as the dimension of these spaces, approximation properties, and practical and numerically efficient methods for computing with such splines. We also think that the new spaces will likely be of interest in the emerging area of isogeometric analysis (Cottrell et al., 2009) since it is conceivable that RAGS can be used not only to model the geometry of a given smooth surface, but simultaneously also to construct finite element spaces on such surfaces, with good approximation-theoretic properties. Indeed, based on the fact that locally RAGS exhibit the same flexibility as ordinary polynomials (cf. (9)), we expect that their approximation capabilities will be no different than those of polynomial splines.

@&#ACKNOWLEDGEMENTS@&#

We thank the authors of Della Vecchia et al. (2008), for kindly providing the data sets displayed in Figs. 5(a) and 6(a)
                  
                  . We are also grateful to Professor John Ratcliffe, for stimulating discussions concerning non-Euclidean geometries. Lastly, we thank the anonymous referees for their careful reading of the manuscript and for useful suggestions for improvements.

@&#REFERENCES@&#

