@&#MAIN-TITLE@&#High-quality quadratic curve fitting for scanned data of styling design

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a method for fitting a 
                                 
                                    
                                       G
                                    
                                    
                                       2
                                    
                                 
                               quadratic B-spline curve to planar styling design data.


                        
                        
                           
                           
                              
                                 
                                    
                                       G
                                    
                                    
                                       2
                                    
                                 
                               continuity is attained by using a non-uniform knot vector of the B-spline curve.


                        
                        
                           
                           High-quality curves have been obtained from noisy styling design data.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Quadratic B-spline curve

Non-uniform knot vector




                     




                        




                           




                              G




                           




                           




                              2




                           




                        




                      continuity

@&#ABSTRACT@&#


               
               
                  We propose a new method for fitting a high-quality planar curve to styling design data by using a curvature continuous (
                        
                           
                              G
                           
                           
                              2
                           
                        
                     ) quadratic B-spline curve. In order to attain 
                        
                           
                              G
                           
                           
                              2
                           
                        
                      continuity of the B-spline curve, we use a non-uniform knot vector, which also enables the curve to be composed of fewer segments as compared to a uniform curve. In our method, control points and the knot vector of the B-spline curve are calculated separately; therefore, we can avoid solving a complicated nonlinear optimization problem. By conducting experiments, we demonstrate that high-quality curves can be generated from both artificial noisy data and real-world scanned data.
               
            

@&#INTRODUCTION@&#

In the design of free-form shapes, typically in automotive styling design, the following two requirements are essential. First, the curves fitted to input data should be aesthetic as well as be close to the data within a specified tolerance. Aesthetics is very important for a variety of curve design applications, and studies on aesthetic curves have been rapidly developed in recent years  [1,2]. Aesthetics is generally represented by the monotonicity of curvature  [3] because a subtle change in curvature affects the quality of a curve, and it is extremely difficult to control such changes  [4]. Second, low-degree curves are preferable to higher-degree curves or other complex expressions, so long as the design objective is attained by connecting low-degree curves such as Bézier and B-spline curves  [5].

A planar curve is the most fundamental free-form shape, and the quality is highly desired. As a typical example, planar curves appear in surface modeling for scanned clay models of cars (Fig. 1
                     ). When a curve is properly given, the surface generated by sweeping it can ensure high-quality of the shape. Fig. 2
                      shows an example of section curves created by CAD experts along with their curvature profiles. The curvature profile indicates the normal directions of a curve by the scaled magnitude of curvature or its radius.

In practice, CAD experts struggle with the following two aspects of creating high-quality curves that satisfy the requirements mentioned above without undesirable curvature extrema: (i) finding the minimal number of features such as locations of curvature extrema (curve segmentation), and (ii) creating aesthetic curves for each segment so as to represent a totally smooth shape for each part. Here, we notice that CAD experts often create curves with no inflection point (non-vanishing curvature). In fact, we can observe that each part shown in Fig. 2 has a curvature of constant sign. If such a point exists in the data and should be represented, CAD experts split the input data at that point and create their respective curves.

It is difficult to deal with the problems mentioned above by using curves of degree 2, mainly because such curves are incapable of representing free-form shapes owing to insufficient degrees of freedom. In fact, existing commercial software tools provide a functionality for generating Class A curves of degree 3 or higher. However, quadratic curves offer several advantages such as monotonicity of curvature and robustness of fitting to noisy data. Therefore, in this paper, we address the issue of fitting a quadratic planar curve with 
                        
                           
                              G
                           
                           
                              2
                           
                        
                      continuity to styling design data.

@&#RELATED WORK@&#

Numerous studies have investigated the generation of smooth curves. We simply classify such curves into two types: (a) curves that are intrinsically smooth, and (b) curves that are obtained by minimizing energy functionals.


                        (a) Intrinsically smooth curve. Piecewise conic sections have been investigated intensively. Liming’s work  [7] is representative of the classical literature and presents an application to aircraft design. More recent studies  [8–10] deal with 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         stitching of quadratic curve segments with Bézier forms.

Further, many studies  [11–15] have investigated the cubic case. In particular, Mineur et al.  [13] proposed a typical curve defined as a Bézier curve with some geometric constraints in order to provide monotone curvature variation, and extended it to a composite 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         Bézier curve  [16,17]. Although their research objective is the same as ours, they employed curves of degree 3 or higher in their studies and identified a problem in finding connection points between Bézier curves.

In summary, obtaining 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         continuity of a quadratic B-spline curve by using non-uniform knots has not been proposed in existing studies, and finding the connection points (curve segmentation) is a common problem regardless of the type of curve.


                        (b) Energy minimization. Constructing smooth curves and surfaces by optimization has also been studied by many researchers  [18]. The fairness of a curve is evaluated by minimizing the arc length integral of a functional 
                           L
                        : 
                           
                              
                                 min
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       L
                                    
                                 
                                 L
                                 
                                    (
                                    s
                                    ,
                                    κ
                                    
                                       (
                                       s
                                       )
                                    
                                    ,
                                    
                                       
                                          κ
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       (
                                       s
                                       )
                                    
                                    ,
                                    
                                       
                                          κ
                                       
                                       
                                          ″
                                       
                                    
                                    
                                       (
                                       s
                                       )
                                    
                                    )
                                 
                                 d
                                 s
                                 ,
                              
                           
                         where 
                           κ
                        , 
                           s
                        , and 
                           L
                         denote the curvature, arc length parameter, and total arc length, respectively. Further, 
                           
                              
                              
                                 ′
                              
                           
                         (dash) represents the derivative with respect to 
                           s
                        . The functional is traditionally defined as 
                           
                              
                                 L
                              
                              
                                 
                                    MEC
                                 
                              
                           
                           =
                           
                              
                                 κ
                              
                              
                                 2
                              
                           
                         (minimum energy curve) and 
                           
                              
                                 L
                              
                              
                                 
                                    MVC
                                 
                              
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          κ
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                              
                              
                                 2
                              
                           
                         (minimum variation curve)  [19].

Minimizing the integral of MEC leads to the differential equation  [20]
                        
                           
                              
                                 κ
                              
                              
                                 ″
                              
                           
                           
                              (
                              s
                              )
                           
                           +
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                           
                              
                                 κ
                              
                              
                                 3
                              
                           
                           
                              (
                              s
                              )
                           
                           =
                           0
                        , and minimizing the integral of MVC gives 
                           
                              
                                 κ
                              
                              
                                 ″
                              
                           
                           
                              (
                              s
                              )
                           
                           =
                           0
                         from the Euler–Lagrange equation  [21]. For the latter case, integrating it twice gives 
                           κ
                           
                              (
                              s
                              )
                           
                           =
                           c
                           s
                           +
                           d
                        , where 
                           c
                           ,
                           d
                           ∈
                           R
                        . This is the intrinsic equation of a curve called Euler spiral or clothoid   [3]. Such curvature linearity with respect to arc length has been applied to clothoid curve fitting  [22,23,21]. A discrete analog of the integral of 
                           L
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          κ
                                       
                                       
                                          ″
                                       
                                    
                                    )
                                 
                              
                              
                                 2
                              
                           
                         leads to the discrete clothoid spline  [24,25]: 
                           
                              (1)
                              
                                 
                                    
                                       L
                                    
                                    
                                       
                                          Discrete
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                    
                                 
                                 
                                    
                                       
                                          |
                                          
                                             
                                                Δ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                κ
                                             
                                             
                                                i
                                             
                                          
                                          |
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 Δ
                              
                              
                                 2
                              
                           
                           
                              
                                 κ
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 κ
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           −
                           2
                           
                              
                                 κ
                              
                              
                                 i
                              
                           
                           +
                           
                              
                                 κ
                              
                              
                                 i
                                 −
                                 1
                              
                           
                        . Although clothoid fitting does not always give the best solution for styling design data, it is often useful to apply Eq. (1) to curvature fairing. Further details are provided in Section  4.3.

Before proceeding to the next subsection, we finally mention some studies on knot calculation of B-spline curve below.


                        Knot placement of B-spline curve. In most existing studies on the curve fitting problem, a uniform knot is used because of its simplicity and efficiency. However, it often leads to redundant segments for complex shapes to satisfy the fitting accuracy. On the other hand, when we use non-uniform B-spline fitting, we have to solve a multivariate and multimodal nonlinear optimization problem in order to determine the control points and knot vector. To address this problem, methods for adaptive knot placement have been proposed by using a heuristic rule  [26], a genetic algorithm  [27], a stochastic algorithm  [28], and 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         optimization  [29].

The main contributions of this paper can be summarized as follows: 
                           
                              •
                              representation of a planar curve by using a parametric curve of degree 2;

attainment of 
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                  continuity with non-uniform knots of quadratic B-spline curve.

First, we employ a quadratic curve, which is the lowest-degree curve for free-form shape design although the cubic curve is generally used in a variety of fields. This enables us not only to conduct curve fitting to scanned data robustly and efficiently but also to avoid generating curves with inflection points. Furthermore, smooth extension of the obtained curve can be reliably ensured. This functionality is very important during the design process.

Second, in Käferböck’s study  [30] of curvature continuous quadratic B-spline curve with uniform knots, the 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         condition is given by the geometric constraint for control points: the triangular areas consisting of three successive control points are equal. In contrast, we construct the 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         curve with non-uniform knots. The control points are calculated by a composite Bézier curve fitting and the knot vector is adjusted so as to satisfy the 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         condition. Dividing the calculation of control points and the adjustment of the knot vector into respective cases enables us to avoid solving a complicated optimization problem. Using non-uniform knots, we can increase the degree of freedom to ensure the 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         condition even in the case of a quadratic curve, and we can prevent the generation of redundant segments in contrast to the case of uniform knots.

The remainder of this paper is organized as follows. Section  2 describes the proposed method. Section  3 presents our experimental results. Section  4 discusses the effectiveness of our method by comparing it with some existing methods. Finally, Section  5 concludes the paper.

@&#METHOD@&#

We present our method for generating a 
                        
                           
                              G
                           
                           
                              2
                           
                        
                      quadratic non-uniform B-spline curve in this section. The curve is obtained in three steps. First, we conduct curve fitting by using a composite Bézier curve with 
                        
                           
                              G
                           
                           
                              0
                           
                        
                      continuity. Next, we conduct curve fitting again under the 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      condition between adjacent Bézier segments. Finally, we generate the 
                        
                           
                              G
                           
                           
                              2
                           
                        
                      B-spline curve with non-uniform knots. Further details are described in the following subsections.

In this study, we fix both ends of the fitted curve 
                        
                           C
                        
                        
                        
                           (
                           
                              
                                 
                                    C
                                 
                              
                              
                                 s
                              
                           
                           ,
                           
                              
                                 
                                    C
                                 
                              
                              
                                 e
                              
                           
                           )
                        
                      to those of the input data (
                        
                           
                              
                                 P
                              
                           
                           
                              s
                           
                        
                        ,
                        
                           
                              
                                 P
                              
                           
                           
                              e
                           
                        
                     ) as the boundary condition: 
                        
                           (2)
                           
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    s
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    e
                                 
                              
                              =
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    e
                                 
                              
                              .
                           
                        
                     
                  

For the specified number of segments 
                           M
                        , we conduct least-squares fitting of a quadratic composite Bézier curve to the input data. The objective of this step is curve segmentation. Therefore, in order to obtain the fitted curve with a small error for each segment, we impose only the 
                           
                              
                                 G
                              
                              
                                 0
                              
                           
                         condition at the junction point of adjacent Bézier curves. This is because the 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         or 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         condition decreases the degree of freedom for shape representation and may cause a blunt solution. Fig. 3
                        (b) shows an example of the obtained curve.

To generate the fitted curve denoted by 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 G
                                 0
                              
                           
                        , we calculate 
                           2
                           M
                           −
                           1
                         control points (duplicate points at each junction are removed, and the number of control points to be calculated decreases by 2 from Eq. (2)) so as to minimize the objective function 
                           
                              
                                 J
                              
                              
                                 1
                              
                           
                        : 
                           
                              (3)
                              
                                 
                                    
                                       J
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   C
                                                
                                             
                                             
                                                G
                                                0
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                              
                           
                         is the closest point on the input polyline of 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 G
                                 0
                              
                           
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         and 
                           N
                         is the number of points to be calculated. In this study, we set 
                           N
                           =
                           100
                        .

For smooth input data, we can expect that the obtained curve approximately meets the 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         condition. However, we cannot always expect such curves. Fig. 4
                         shows an example of a non-smooth composite Bézier curve. Therefore, we introduce the following criterion of curve smoothness. 
                           
                              Smoothness.
                           
                           
                              If the angle composed of two tangent vectors 
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          e
                                       
                                       
                                          
                                             (
                                             m
                                             )
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          s
                                       
                                       
                                          
                                             (
                                             m
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                  is less than 
                                    α
                                  [deg], then the given Bézier curves are smooth at the junction point.

In this study, if the composite Bézier curve obtained in Step 1 does not satisfy the above criterion, then we split the curve at the junction point. We set 
                           α
                           =
                           3
                         [deg] in our experiments.

We conduct least-squares fitting again. In this step, we generate a quadratic composite Bézier curve with the 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         condition. Fig. 3(c) shows an example of the obtained curve.

To generate the curve denoted by 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 G
                                 1
                              
                           
                        , we calculate the same number of control points in Step 1 so as to minimize the objective function 
                           
                              
                                 J
                              
                              
                                 2
                              
                           
                        : 
                           
                              (4)
                              
                                 
                                    
                                       J
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   C
                                                
                                             
                                             
                                                G
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                              
                           
                         is the closest point on 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 G
                                 0
                              
                           
                         of 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 G
                                 1
                              
                           
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        . By using the control points of 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 G
                                 0
                              
                           
                         as the initial values, we can obtain a desirable solution by a local search.

To deal with 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         continuity between adjacent Bézier curves, we consider the scale of each segment  [5]. At each junction point, the scale factor 
                           
                              
                                 k
                              
                              
                                 m
                              
                           
                         is defined by the ratio of the magnitudes of two tangent vectors 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 e
                              
                              
                                 
                                    (
                                    m
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 s
                              
                              
                                 
                                    (
                                    m
                                    +
                                    1
                                    )
                                 
                              
                           
                        : 
                           
                              
                                 
                                    
                                       k
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       
                                          |
                                          
                                             
                                                
                                                   T
                                                
                                             
                                             
                                                e
                                             
                                             
                                                
                                                   (
                                                   m
                                                   )
                                                
                                             
                                          
                                          |
                                       
                                    
                                    
                                       
                                          |
                                          
                                             
                                                
                                                   T
                                                
                                             
                                             
                                                s
                                             
                                             
                                                
                                                   (
                                                   m
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                          |
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          |
                                          
                                             
                                                
                                                   Q
                                                
                                             
                                             
                                                n
                                             
                                             
                                                
                                                   (
                                                   m
                                                   )
                                                
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   Q
                                                
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                             
                                                
                                                   (
                                                   m
                                                   )
                                                
                                             
                                          
                                          |
                                       
                                    
                                    
                                       
                                          |
                                          
                                             
                                                
                                                   Q
                                                
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   (
                                                   m
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   Q
                                                
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   (
                                                   m
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                          |
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    Q
                                 
                              
                              
                                 i
                              
                              
                                 
                                    (
                                    m
                                    )
                                 
                              
                           
                         denotes the 
                           i
                        th Bézier control point at the 
                           m
                        th segment (see Fig. 5
                        ). Using 
                           
                              
                                 k
                              
                              
                                 m
                              
                           
                        , we impose the following conditions on 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 G
                                 1
                              
                           
                         during the minimization of 
                           
                              
                                 J
                              
                              
                                 2
                              
                           
                        : 
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             Q
                                          
                                       
                                       
                                          n
                                       
                                       
                                          
                                             (
                                             m
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Q
                                          
                                       
                                       
                                          0
                                       
                                       
                                          
                                             (
                                             m
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             Q
                                          
                                       
                                       
                                          n
                                       
                                       
                                          
                                             (
                                             m
                                             )
                                          
                                       
                                    
                                    −
                                    
                                       
                                          
                                             Q
                                          
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                       
                                          
                                             (
                                             m
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       
                                          k
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Q
                                             
                                          
                                          
                                             1
                                          
                                          
                                             
                                                (
                                                m
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                       −
                                       
                                          
                                             
                                                Q
                                             
                                          
                                          
                                             0
                                          
                                          
                                             
                                                (
                                                m
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

We generate a 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         quadratic non-uniform B-spline curve, denoted by 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 G
                                 2
                              
                           
                        , from the curve obtained in Step 2 as follows:


                        
                           
                              1.
                              select the control points;

estimate the initial knot vector;

optimize the knot vector.

First, we select the control points of the curve obtained in Step 2 except for the connection points of the Bézier segments. In the case of the curve with 
                           M
                           =
                           4
                        , for example, six points 
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             Q
                                          
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 5
                              
                           
                           =
                           
                              {
                              
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    0
                                 
                                 
                                    
                                       (
                                       0
                                       )
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    1
                                 
                                 
                                    
                                       (
                                       0
                                       )
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    1
                                 
                                 
                                    
                                       (
                                       1
                                       )
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    1
                                 
                                 
                                    
                                       (
                                       2
                                       )
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    1
                                 
                                 
                                    
                                       (
                                       3
                                       )
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    2
                                 
                                 
                                    
                                       (
                                       3
                                       )
                                    
                                 
                              
                              }
                           
                         are selected as shown in Fig. 6
                        (a). Here, we transform the two end points into their reflected points: 
                           
                              
                                 
                                    Q
                                 
                              
                              
                                 0
                              
                           
                           ←
                           2
                           
                              
                                 
                                    Q
                                 
                              
                              
                                 0
                              
                              
                                 
                                    (
                                    0
                                    )
                                 
                              
                           
                           −
                           
                              
                                 
                                    Q
                                 
                              
                              
                                 1
                              
                              
                                 
                                    (
                                    0
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Q
                                 
                              
                              
                                 5
                              
                           
                           ←
                           2
                           
                              
                                 
                                    Q
                                 
                              
                              
                                 2
                              
                              
                                 
                                    (
                                    3
                                    )
                                 
                              
                           
                           −
                           
                              
                                 
                                    Q
                                 
                              
                              
                                 1
                              
                              
                                 
                                    (
                                    3
                                    )
                                 
                              
                           
                        .

Second, we calculate the knot interval 
                        
                           
                              
                                 d
                              
                              
                                 i
                              
                           
                        , which is the difference between two adjacent knots in a knot vector, from the control polygon obtained in Step 2 as follows: 
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 max
                                 
                                    {
                                    
                                       
                                          
                                             |
                                             
                                                
                                                   
                                                      Q
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      Q
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             |
                                          
                                       
                                       
                                          
                                             |
                                             
                                                
                                                   
                                                      Q
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      Q
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             |
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             |
                                             
                                                
                                                   
                                                      Q
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      Q
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             |
                                          
                                       
                                       
                                          
                                             |
                                             
                                                
                                                   
                                                      Q
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      Q
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             |
                                          
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                         This is because the knot interval is assigned to the control point 
                           
                              
                                 
                                    Q
                                 
                              
                              
                                 i
                              
                           
                         for even-degree B-spline curves  [31]. Thereafter, we calculate the initial knot vector from the obtained intervals. (See Fig. 6(b).)

Third, we calculate the optimum knot vector 
                           
                              {
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         such that the curvature gap vanishes at any junction point of two adjacent segments. In this study, we obtain an approximate solution by minimizing the objective function 
                           
                              
                                 J
                              
                              
                                 3
                              
                           
                        : 
                           
                              (6)
                              
                                 
                                    
                                       J
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   C
                                                
                                             
                                             
                                                G
                                                2
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                κ
                                             
                                             
                                                m
                                             
                                             
                                                +
                                             
                                          
                                          −
                                          
                                             
                                                κ
                                             
                                             
                                                m
                                             
                                             
                                                −
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 κ
                              
                              
                                 m
                              
                              
                                 +
                              
                           
                           
                           
                              (
                              
                                 
                                    κ
                                 
                                 
                                    m
                                 
                                 
                                    −
                                 
                              
                              )
                           
                         denotes the curvature value at the 
                           m
                        th junction point of segments from the right (left). Here, the control points 
                           
                              {
                              
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         are fixed, and the knot intervals 
                           
                              {
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         are the only variables to be determined.

Before proceeding to Section  3, we summarize the entire procedure of our curve fitting method in the next subsection.


                        Curve fitting process
                        
                           1. Obtain input polyline:
                           
                              It is given by linking point sequences, section curve of a scanned mesh, discretized CAD curve, etc.

2. Set up initial conditions 
                           2.1 Rescale the input curve:
                           
                              We normalize the input curve divided by the total curve length and define a local 2D coordinate whose origin is set to the midpoint of the normalized curve.

First, we calculate the intersection 
                                    
                                       P
                                    
                                  of the two tangents at the input curve ends 
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          s
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          e
                                       
                                    
                                 . Next, we construct a single quadratic Bézier curve using the three points 
                                    
                                       P
                                    
                                    ,
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          s
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          e
                                       
                                    
                                 . Then, we elevate the degree of the Bézier curve to 
                                    M
                                    ≥
                                    2
                                  (
                                    M
                                 : the specified number of segments) and divide the Bézier curve at the closest point of each control point into 
                                    M
                                  segments. For each segment, we construct a Bézier curve using three points as mentioned above.

3. Conduct quadratic curve fitting 
                           3.1. Step 1) 
                                 
                                    
                                       G
                                    
                                    
                                       0
                                    
                                 
                               fitting:
                           
                              curve segmentation, see Section  2.1.

composite Bézier, see Section  2.2.

non-uniform B-spline, see Section  2.3.

4. Output generated curve: From the obtained curve, we restore the original length and coordinate.

@&#RESULTS@&#

We implemented the proposed method using VC++ on a desktop Intel/Core i7 (3.5 GHz) computer. To calculate the objective functions defined by Eqs. (3), (4), and (6), we used the software NLopt  [32], which includes a C/C++ library for nonlinear optimization. We selected a local derivative-free algorithm, namely, the Nelder–Mead simplex method  [33], from among several methods, even though the global minimum and not a mere local minimum is usually of interest. This is because our three-step method can accurately estimate the initial variables to be determined as each step proceeds, and therefore, even a local minimizer provides a good solution, which convinces us that the local minimum is nearly equal to the global one. The convergence criterion is set as follows: when the changes in all the variables are less than the specified tolerance 1E−06, we stop the processing.

We conducted some experiments using two types of section curves. One was derived from CAD data (Fig. 7
                     ), and the other was derived from a scanned mesh (Fig. 8
                     ). Here, in the former case, we additionally prepared polylines including artificial noise having a magnitude of around ±0.2 (mm). The properties of these data are summarized in Table 1
                     . We present the results for Data 1 and Data 2 in Sections  3.1 and 3.2, respectively.


                           Fig. 9
                            (Hood 1), Fig. 10
                            (Roof 1), and Fig. 11
                            (Window 1) show the curves obtained in each step along with their curvature profiles. We show both the radius of curvature and the curvature profile for each case because we consider that only either indication is used in practical applications. The results of error analysis (maximum deviation from the ground truth) and processing time are summarized in Table 2
                           .

From these results, we can observe the following facts: 
                              
                                 •
                                 the curves obtained in Step 3 meet the 
                                       
                                          
                                             G
                                          
                                          
                                             2
                                          
                                       
                                     condition for each case;

the curvature profiles of the obtained curves are nearly the same as those of each ground truth regardless of the number of segments 
                                       M
                                    ;

the maximum deviation from each ground truth is smaller than 0.1 (mm) except for the case of Roof 1 (
                                       M
                                       =
                                       4
                                    );

the curves obtained in Step 2 approximately satisfy the 
                                       
                                          
                                             G
                                          
                                          
                                             2
                                          
                                       
                                     condition in most cases although the step does not ensure the continuity.


                           Fig. 12
                            (Hood 2), Fig. 13
                            (Roof 2), and Fig. 14
                            (Window 2) show the curves obtained for noisy data. The maximum error and processing time are summarized in Table 3
                           . From these results, we can observe the following facts:


                           
                              
                                 •
                                 compared with the noiseless case, the curvature difference at the connection point of adjacent Béziers increases with the number of segments in both Step 1 and Step 2;

each step improves the curvature difference as it proceeds, and finally, the curves obtained in Step 3 meet the 
                                       
                                          
                                             G
                                          
                                          
                                             2
                                          
                                       
                                     condition for each case, and their curvature profiles are nearly the same as those of each ground truth and noiseless case shown in Figs. 9, 10, and 11.


                        Figs. 15 and 16
                        
                         show the curves obtained by applying our method to the section curves of a real-world scanned mesh. The results shown in Fig. 15(d) and Fig. 16(d), (e) are created by CAD experts from the same data. Table 4
                         summarizes the error analysis and processing time results.

First, in the case of Roof 3 (Fig. 15), the proposed method generates curves equivalent to that of CAD expert. The curvature profiles are very similar to each other regardless of the number of segments.

Second, in the case of Hood 3 (Fig. 16), we can observe the following facts: 
                           
                              •
                              the curves obtained in Step 1 have large angle differences between two tangent (or curvature) vectors at the junction point of two adjacent Bézier curves marked (A) or (B). Table 5
                                  summarizes the values along with the previous cases (Hood 1 and Hood 2);

the locations marked (A) in Fig. 16(a) and (b) exist inside the range of the styling radius shown in Fig. 17
                                 (a), and the location marked (B) in Fig. 16(c) exists outside of it.

For the second point stated above, it is important that CAD experts foresee a styling radius curve (also called fillet) and conduct curve fitting such that two curves deviate from the data points, as shown in Fig. 17(b). In this respect, our method does not ensure the same results as those of the CAD experts. By disregarding the data points around the styling radius, we have to set the junction point such that it may exist around the center of the styling radius. The large curvature value around (B) in Fig. 16(c) is caused by fitting the curve to the data that should be disregarded.

@&#DISCUSSION@&#

To demonstrate the effectiveness of our method, we took the measures listed below, which are described in the following subsections, respectively:


                     
                        
                           1.
                           skip the processing of Step 1;

use a uniform B-spline curve in Step 3;

compare our results with those of existing methods;

apply the obtained curves to surface generation.


                        Fig. 18
                        (c) shows the result without Step 1 of our method. The same figures as Fig. 10 (Roof 1)(a) and (b) are shown alongside for comparison. From these figures, we can observe the following facts: 
                           
                              •
                              the interval of the Bézier control points in Step 2 are distributed more uniformly;

the curvature in the right end becomes small.

The error analysis and run-time results are summarized in Table 6
                        . Compared with Table 2, the maximum error increases when we skip Step 1. We have checked this aspect for different parts.

Based on the above facts, our reason for introducing Step 1 is confirmed. Specifically, the derivative (or higher-order derivative) continuity condition causes a blunt solution with a small increase in error. In practice, it is difficult to detect segments properly from input data with a smooth change in curvature. Thus, we can claim that Step 1 plays an important role in curve segmentation.


                        Fig. 19
                         shows the result of uniform B-spline fitting. The upper figures indicate the results obtained in Step 3 (Hood 1) for comparison, and the middle figures indicate the results obtained by simply converting the curve in Step 3 into uniform knots. The lower figures show the results of quadratic uniform B-spline fitting by adjusting the control points  [30]. From these figures, we can observe the following facts:


                        
                           
                              •
                              in Fig. 19(a), the curvature profile of the obtained curve is clearly different from that in Step 3;

as the number of segments 
                                    M
                                  increases, the obtained curves have similar profiles to those in Step 3, and the differences in the control points between them are small.

From the above facts, we confirmed that the use of non-uniform knots enables us to generate a desirable curve with fewer segments.

We generate curves for comparison so as to minimize the objective function 
                           J
                        , which is defined by applying discrete clothoid fairing  [24,25] to curve fitting: 
                           
                              
                                 J
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             C
                                          
                                          
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 ϵ
                                 
                                    
                                       L
                                    
                                    
                                       
                                          Discrete
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 L
                              
                              
                                 
                                    Discrete
                                 
                              
                           
                         is given by Eq. (1) and 
                           ϵ
                         is a weight. Here, we fit the composite 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         Bézier curve of degree 3 to the data. 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         continuity is attained by adding the following condition along with Eq. (5): 
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    
                                       n
                                    
                                    
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                 
                                 −
                                 2
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                    
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    
                                       n
                                       −
                                       2
                                    
                                    
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       m
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             Q
                                          
                                       
                                       
                                          2
                                       
                                       
                                          
                                             (
                                             m
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    −
                                    2
                                    
                                       
                                          
                                             Q
                                          
                                       
                                       
                                          1
                                       
                                       
                                          
                                             (
                                             m
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             Q
                                          
                                       
                                       
                                          0
                                       
                                       
                                          
                                             (
                                             m
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     


                        Fig. 20
                         shows the obtained curves and the error analysis results are summarized in Table 7
                        (a). From these results, we can observe the following facts:


                        
                           
                              •
                              although the simple least-squares fitting shown in Fig. 20(a) and (c) generates curves with a smaller error in more than half of the cases listed in Table 7(a) (
                                    ϵ
                                    =
                                    0
                                 ) as compared with those in Step 3, the curvature profiles deteriorate as 
                                    M
                                  increases;

by setting the weight 
                                    ϵ
                                    =
                                    0.001
                                 , the faired curves shown in Fig. 20(b) and (d) are obtained, but the curvature profiles in Fig. 20(b) are different from the curvature profile of the ground truth.

From the above facts, we confirmed that our method is superior to the standard least-squares fitting method with and without fairing. Further, we verified that 
                           ϵ
                         has a significant influence on the results.

The fairing technique is useful for improving the curves generated from our method. In order to make the curvature profiles smoother, we applied log-curvature fairing (not clothoid fairing) to our generated curves. The use of log-curvature is inspired by 
                           α
                        
                        -convexity   [3], and we define the fairing equation as follows: 
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       
                                          Discrete
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                    
                                 
                                 
                                    
                                       
                                          |
                                          
                                             
                                                Δ
                                             
                                             
                                                2
                                             
                                          
                                          log
                                          
                                             
                                                κ
                                             
                                             
                                                i
                                             
                                          
                                          |
                                       
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                         In order to apply Eq. (7) to the curves obtained in Step 3, we converted the curves to composite Bézier forms once, and then, we elevated the degree of each Bézier curve to 3.


                        Fig. 21
                         shows the faired curves along with those in Step 3 for comparison. Fig. 22
                         shows the smoothness of the curvature obtained in Step 3 with the aid of curvature and log-curvature graphs with respect to the arc length. Fig. 23
                         shows the graphs of the faired curves. From these results and Table 7(b), we can observe the following facts: 
                           
                              •
                              the slopes of the curvature profiles are smooth in the case of the faired curves shown in Fig. 21(b) and (d);

the above fact can be observed in the graphs shown in Fig. 22 (for Step 3) and Fig. 23 (for faired curves);

the difference between the curve in Step 3 and the faired curve is small for most of the cases listed in Table 7(b).

Here, we observe that the 
                           s
                         vs. 
                           κ
                         graphs in Fig. 22 (or Fig. 23) do not consist of straight line segments. This implies that the desirable curve cannot be generated from clothoid curve fitting.

To verify the influence of the quality of the obtained curves on that of the surfaces generated from them, we created three swept surfaces as shown in Fig. 24
                        , and evaluated them by silhouette pattern analysis. In generating the surfaces, we used the common guide curve and three section curves: ground truth (Fig. 12(a)), Step 3 for Hood 2 (Fig. 12(b)), and the faired curve (Fig. 21(b), 2 segments).

From the results shown in Fig. 25
                        , we can observe the following facts: 
                           
                              •
                              there is little difference among three zebra maps;

among the silhouette patterns, a slight difference exists as follows: in Fig. 25(a) and (c), the patterns change gradually in the direction of the arrows in the figures. In Fig. 25(b), the pattern changes not gradually but in a linear manner or at mostly equal intervals.

From the above facts, we can argue that the slope discontinuity of the curvature of a section curve has a slight influence on the quality of the corresponding swept surface. This fact does not undermine the effectiveness of our method although a smooth change in the curvature of the section curve is indispensable for generating a high-quality surface. This is because CAD experts often create a styling radius curve additionally when slope discontinuity is a problem; we have verified that the fairing technique can overcome this problem. Data segmentation and fitting of curves that are connected smoothly for each part are more serious problems. Our method provides solutions to overcome these problems.


                        Limitations. Our method does not generate a high-quality curve that shows smooth changes in curvature without undesirable curvature extrema in the following cases: (i) the input data include a curve with a small styling radius, as shown in Fig. 17; (ii) the desirable curve is not apparently approximated by a quadratic B-spline curve (parabolas). To obtain a desirable curve in case (i), we have to discriminate the features more precisely around the styling radius; we plan to address this issue in the future.

@&#CONCLUSIONS AND FUTURE WORK@&#

We have presented a method for fitting quadratic curves to styling design objects. Based on experiments conducted using several types of data, we have reached the following conclusions: 
                        
                           •
                           by using a non-uniform knot vector, our method can generate a planar 
                                 
                                    
                                       G
                                    
                                    
                                       2
                                    
                                 
                               quadratic B-spline curve;

the quality of the generated curve is nearly similar to that of the curve created by CAD experts (high-quality) except for the limitations mentioned above and the existence of slope discontinuity in the curvature;

our algorithm is simple and easy to implement.

In the case of slope discontinuity, 
                        
                           •
                           log-curvature fairing can make the curve smooth within a small error.

Further experimental investigation is required to analyze the practical effectiveness of our method. Moreover, the generation of surfaces for styling design requires high-quality spatial curves and section curves. Hence, in the future, we plan to extend this study to the generation of spatial curves and high-quality surfaces.

@&#REFERENCES@&#

