@&#MAIN-TITLE@&#A novel algorithm for defect inspection of touch panels

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We develop a novel algorithm to inspect the defects on touch panel.


                        
                        
                           
                           Based on periodic patterns of touch panel, an adaptive model is learned online to extract defects.


                        
                        
                           
                           The experimental results indicate that our proposed method achieves accurate detection with efficient computation.


                        
                        
                           
                           The users pay very little effort for the testing of different panel products.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Automatic optical inspection

Defect inspection

Touch panel

@&#ABSTRACT@&#


               
               
                  Automatic optical inspection plays an important role to control the appearance quality of wide range of products in the product process. Recently, the high popularity of smartphones and information appliances drives significant demand of touch panels. However, the traditional frequency-based method which exploits the line structure feature of texture images is not effective for the defect detection of touch panels. The paper presents a novel spatial domain algorithm to inspect the defects on touch panel. By utilizing the characteristics of periodic patterns of the sensing circuits, an adaptive model for each pattern is learned online to effectively extract defects. The experimental results indicate that our proposed method achieves accurate detection with efficient computation. In addition, the users pay very little effort for the testing of different panel products.
               
            

@&#INTRODUCTION@&#

Surface inspection based on machine vision has been widely used for quality control in manufacturing various products. A large variety of surfaces such as wood, steel, wafer, ceramics, fabric, fruits and aircraft surfaces have been studied [1] in the past two decades. However, few researches on touch panels have been reported [2,3]. A touch panel is a piece of equipment that lets users interact with computing devices such as smartphones, personal computers, cashier machines, and ATM. Recently, the high popularity of smartphones, pads, and many types of information appliances is driving the great demand of touch panels. The appearance quality of touch panels affects their yield rates significantly in manufacturing process. In [18], the authors listed the defect rates of 12 inspection workstations in the production process for a touch panel manufacturer. Total defect rate is 36.2%. There are four workstations related to sensing circuits, included touch panel clean, protect film attachment, pre-test of sensing circuit and function film attachment. The total defect rate of the four stages is 14.1%, which is approximately to 39% of the defect rate of the whole process. Therefore, automatic optical inspection (AOI) for the surface defect of the sensing circuits of the touch panel is urgently required in the production process.

Sensing circuits are always coated in the touch panels in a regular arrangement, as illustrated in Fig. 1(a). In the real case, the defects such as particles, scratches, fibers and strains, are often embedded into sensing circuits as shown in Fig. 1(b), so the inspection task becomes how to extract defects from circuit patterns. However, every panel product has its particular sensing circuit structure, which means a large variety of circuit patterns exist. This makes developing a universal inspection algorithm for different products very challengeable.

Many existing defect detection systems focused on non-textured surfaces such as glass panel, sheet steel, aluminum strips and web materials. The images of this type of surfaces have uniform gray-level, thus simple thresholding or edge detection techniques in spatial domain [4,5] are often used to detect defects. These kinds of defects can be easily detected because commonly used measures usually have very distinct values [4]. As for texture surfaces, defect detection is to compute a set of textural features, and search for significant local deviations in the feature values. The selection of an adequate feature set is critical but difficult. Moreover, a set of features which is optimal in the representation of a specific texture could be completely useless for other texture patterns [4]. For texture-based defect detection, the approaches can be roughly classified into four categories: statistical, structural, filter based and model based [1,6]. The filter-based approach is most popular, which includes spatial domain filtering, frequency domain analysis and joint spatial/spatial-frequency approaches. The three techniques used in frequency and spatial/frequency domain analysis are: Fourier transform [4,7,8], wavelet transform [9–12] and Gabor filter [13–14].

For touch panel inspection, the works presented in the literature still treat the sensing circuits as texture patterns, and apply frequency-based filtering methods to extract defects [2,3]. The common point of these methods is to design a filtering mask in frequency domain to remove background patterns such as circuit parts, and only defects appear in the reconstructed image. In [3], the authors analyzed some touch panels with directional line structures and found that the high-energy distributed along four directional lines, i.e., horizontal and vertical lines, and two diagonal lines flipped horizontally each other. Thus, they design four notch filters using the scheme similar to [4] to successfully remove the circuit parts and detect the defects.

To investigate the effectiveness of the frequency domain filtering methods, we apply the method presented in [3,4] to two defect-free touch panels, Product I and Product II, and the results are demonstrated in Fig. 2
                     . Fig. 2(a)–(b) shows two sensing circuit images from two panels. By performing fast Fourier transform (FFT) to the images, we obtain the energy spectrums shown in Fig. 2(c)–(d). Generally, the major energy seemly distributes along four directional lines, i.e., horizontal, vertical, and two diagonal lines, as pointed out in [3,4]. However, detailed observations indicate that the distributions of energy spectrum are quite complex and not so regular. The high energy not only occurs at the neighborhood of the four directional lines, but also appears at other frequency components. In addition, the shape of the distribution varies with different products. For example, Product I exhibits shape like a bug (see Fig. 2(c)), and the shape of Product II exhibits like a snow flower (see Fig. 2(d)).

The angles of the diagonal lines change with different structures of sensing circuits. The angle of the diagonal line can be estimated by the maximum of the directional projection on the spectrum image. Fig. 2(e)–(f) shows the estimated angles of the diagonal lines are respectively 25° and 31° for Product I and Product II. Based on the estimated angles, we design four line-shape notch filters with appropriate bandwidths by the method in [3]. By applying the notch filters to the spectrum images, and then performing the inverse FFT, we obtain the reconstructed images, as shown in Fig. 2(g)–(h). Observing the reconstructed images, it is seen that some circuit parts are not completely removed, and some flat parts (non-circuit parts) are changed a lot, especially for Product II.

The above analysis indicates that the complicated shapes of energy spectrum make the design of effective notch filters rather difficult. Thus, the frequency domain filtering method is very useful for the textures with pure line structures. However, we argue that it is not effective for the defect detection of general touch panels.

Several AOI companies have also promoted their inspection equipment for touch panels in recent years. To eliminate sensing circuits, most of inspection methods use circuit schematics such as CAD drawing to register on test images of panels, which are known as CAD mapping. The CAD mapping needs camera calibration to remove the distortion of images to achieve well mapping. However, the camera calibration often increases extra works and costs in the development stage. Especially, to acquire good calibration, the implementation cost of the calibration board is very expensive.

This paper presents a novel method which regards sensing circuits of touch panel as a periodic (repeated) pattern structure. By learning the pattern structure from the defect images of a specific panel, we obtain a reference pattern which is defect free. Comparing each pattern of the defect image to be tested with the reference pattern, we can locate the defect parts of the panel image. The proposed algorithm is performed in spatial domain rather than in frequency domain.

The remainder of this paper is organized as follows. Section 2 describes the proposed method, which includes offline training and online testing phases. In Section 3, we first describe the experiment setup and training procedure, and then demonstrate the performance evaluation of the proposed methods and discuss the experimental results and comparisons. Section 4 gives an analysis and discussion of our method. The conclusions are drawn in Section 4.

@&#PROPOSED METHOD@&#

Referring to Fig. 1(a), we regard the sensing circuits of a touch panel as a periodic (repeated) pattern structure, as shown in the red square in Fig. 3(a). A pattern has four control points (CP) associated, as indicated by blue squares in Fig. 3(b). The structure of a control point is shown in Fig. 3(c).

The major idea behind our approach is to learn a defect-free panel image, pattern by pattern, from the image which has defects, and then compare the test image with the defect-free image to judge whether a pixel of the test image is defective or not. Our method does not intend to remove the circuit parts, but just generate a defect-free reference image. This is very different from the traditional approaches.


                     Fig. 4
                      shows the flow chart of our proposed method, which includes offline training phase and online testing phase. The purpose of the off-line phase is to create an edge template of a control point from the training image of a specific panel product to be tested. The goal of the on-line phase is to generate a defect-free image in a pattern by pattern manner. The location of a control point is refined first using the edge template. Then each pattern image is aligned with a geometrical transform, and the aligned neighboring patterns are used to build up a defect-free pattern (called reference pattern hereafter). All reference patterns are formed into a defect-free panel image. Finally, the test image of the specific panel product is evaluated by comparing it with the defect-free panel image, and the defect or non-defect result is reported for each pixel. In the proposed defect inspection, any defects forms abnormal areas in test images, and they are different from the reference patterns. Our proposed method is basically based on the comparison between the test image and the reference pattern. Thus it is suitable for the detection of any types of defects. We describe the details of the training and testing phases in the following paragraphs.

The first step of the training phase is to estimate the positions of all control points using a training image. First, we use a two-dimensional matrix to record the spatial positions of all control points (CP). Each entry of the matrix represents the coordinate of a CP. To determine the matrix size N
                        row
                        ×
                        N
                        col, we manually set five reference points from the training image, where row number N
                        row and column number N
                        col represent the number of control points in horizontal and vertical direction, respectively. The three of the five points are selected from the CPs of the top-left, top-right and bottom-left corners respectively, as labeled with A, B and C in Fig. 4. The remaining two points are selected from the first horizontal neighbor and vertical neighbor of the control point A, which are denoted as B′ and C′ in Fig. 5
                        . Therefore, the column number (N
                        col) and row number (N
                        row) can be calculated with Eq. (1). Then, the horizontal period u
                        row and vertical period u
                        col can be used to estimate the coordinates of any control point using Eq. (2), as shown in Fig. 5. In real case, the distance between two control points is not fixed; hence the above procedure locates only the rough positions of the control points.
                           
                              (1)
                              
                                 
                                    N
                                    row
                                 
                                 =
                                 round
                                 
                                    
                                       
                                          AC
                                          ¯
                                       
                                       /
                                       
                                          
                                             A
                                             
                                                C
                                                ′
                                             
                                          
                                          ¯
                                       
                                    
                                 
                                 +
                                 1
                                 
                                 ,
                                 
                                 
                                    N
                                    col
                                 
                                 =
                                 round
                                 
                                    
                                       
                                          AB
                                          ¯
                                       
                                       /
                                       
                                          
                                             A
                                             
                                                B
                                                ′
                                             
                                          
                                          ¯
                                       
                                    
                                 
                                 +
                                 1
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       
                                          C
                                          
                                             P
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          =
                                          
                                             
                                                x
                                                A
                                             
                                             
                                                y
                                                A
                                             
                                          
                                          +
                                          i
                                          ⋅
                                          
                                             u
                                             row
                                          
                                          +
                                          j
                                          ⋅
                                          
                                             u
                                             col
                                          
                                          ,
                                          
                                          f
                                          o
                                          r
                                          
                                          i
                                          =
                                          0
                                          ,
                                          
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             N
                                             row
                                          
                                          −
                                          1
                                          
                                          ,
                                          
                                          j
                                          =
                                          0
                                          ,
                                          
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             N
                                             col
                                          
                                          −
                                          1
                                          ,
                                       
                                    
                                    
                                       
                                          where
                                          
                                          
                                             u
                                             row
                                          
                                          =
                                          
                                             AC
                                             ¯
                                          
                                          /
                                          
                                             
                                                
                                                   N
                                                   row
                                                
                                                −
                                                1
                                             
                                          
                                          
                                          ,
                                          
                                          
                                             u
                                             col
                                          
                                          =
                                          
                                             AB
                                             ¯
                                          
                                          /
                                          
                                             
                                                
                                                   N
                                                   col
                                                
                                                −
                                                1
                                             
                                          
                                          
                                          .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In Eqs. (1)–(2), 
                           
                              
                                 X
                                 Y
                              
                              ¯
                           
                         represents the distance (number of pixels) between any two points, and (xA
                        ,yA
                        ) is the coordinate of point A.

The second step is to create a template centered at a CP. We manually draw a rectangle region centered at a particular CP, called ROI (region of interest). To build a reliable template, the ROI should be selected at the noiseless and defect-less part of the training image. By applying the Canny edge detector [15] to the ROI, we obtain an edge template (a binary image), as displayed in Fig. 6(a)–(b). At the end of the off-line phrase, a 2-D matrix which records the arrangement (positions) of all CPs and an edge template are stored for the use in the on-line phase.

The first step of the testing phase is to refine the locations of CPs stored in the arrangement matrix in the training phase. The refinement should consider the geometric distortion of an edge template, including rotation, scaling and translation. In practice, the hardware of image acquisition of a touch panel is specially designed. For example, in our system, each panel is first fasten by a fixture, and then a linear motor drives and carries the fixture forward on the slide rail. Next, the motion trigs a sensor to signal a line-scan camera. The image acquisition in this scan way is very stable; the detail is described in Section 3. The acquired panel images of the same product model have very small variations in rotation, scaling and translation. Therefore, it is very easy and efficient to address the very small RST variation using multiple template matching. A typical implementation is stated as follows. The original edge template is rotated in three different angles, such as −0.25, 0, and 0.25°. Then, these rotated templates are scaled in three different sizes, such as 0.995, 1.00, and 1.005, and thus nine edge templates are generated. For each CP of the arrangement matrix, we generate a search window centered at the CP. The size of the window is predefined empirically. By applying edge detection to the image pixels on the search window, we obtain a binary search image. Then we compare each edge template with each candidate in the binary search image in an exhausted search manner using the similarity criterion defined in Eq. (3). As a result, nine matched candidates are obtained, and the one with largest S(O,C) is selected as the best match. The location of the best match is regarded as the refined (new) location of the CP. Since the similarity calculation is a simple bit comparison, the computation is very efficient.
                              
                                 (3)
                                 
                                    S
                                    
                                       O
                                       C
                                    
                                    =
                                    
                                       ∑
                                       
                                          O
                                          
                                             i
                                             j
                                          
                                          ⊕
                                          C
                                          
                                             i
                                             j
                                          
                                       
                                    
                                    
                                    ,
                                    
                                    where
                                    
                                    ⊕
                                    
                                    is
                                    
                                    bit
                                    
                                    comparison
                                    .
                                 
                              
                           
                        


                           Fig. 6(c) shows the search window (red frame), original location of a CP (red rotated cross), and the new location of the CP after the above refinement process (blue cross).

In this work, we would like to build an adaptive pattern model (local standard model) using spatial neighbor patterns. Since the spatial neighbor patterns are often different in rotation angle, scaling as well as spatial positions, we first align them into standard images by geometric transform. The estimate of the parameters of the geometric transform for each pattern is described in the following. The geometric transformation can be affine transformation or perspective transformation. In this work, we adopt 2-D perspective transformation.

The coordinates of four CPs of each pattern are obtained in the previous step, and they are denoted as (x
                           1,y
                           1), (x
                           2,y
                           2), (x
                           3,y
                           3), and (x
                           4,y
                           4), as illustrated in Fig. 7
                           . The four CPs are called source points. We assume a standard rectangle image with size of H
                           ×
                           W, and the coordinates of the four corners are (x′
                           1,y′
                           1)=(0,0), (x′
                           2,y′
                           2)=(W-1,0), (x′
                           3,y′
                           3)=(0,H-1), (x′
                           4,y′
                           4)=(W-1,H-1), as shown in Fig. 6. The four corners of the rectangle image are called target points. The four source points are mapped into their corresponding target points with transform matrix H
                           =[hij
                           ]. Using the eight points, the transformed parameters hij
                            can be calculated with Eq. (4). Then, each pattern image is transformed using Eq. (5) and the aligned image is obtained.
                              
                                 (4)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   1
                                                
                                             
                                             
                                                
                                                   y
                                                   1
                                                
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                −
                                                
                                                   x
                                                   1
                                                
                                                
                                                   x
                                                   1
                                                   ′
                                                
                                             
                                             
                                                −
                                                
                                                   y
                                                   1
                                                
                                                
                                                   x
                                                   1
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   x
                                                   1
                                                
                                             
                                             
                                                
                                                   y
                                                   1
                                                
                                             
                                             
                                                1
                                             
                                             
                                                −
                                                
                                                   x
                                                   1
                                                
                                                
                                                   y
                                                   1
                                                   ′
                                                
                                             
                                             
                                                −
                                                
                                                   y
                                                   1
                                                
                                                
                                                   y
                                                   1
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                
                                                   x
                                                   2
                                                
                                             
                                             
                                                
                                                   y
                                                   2
                                                
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                −
                                                
                                                   x
                                                   2
                                                
                                                
                                                   x
                                                   2
                                                   ′
                                                
                                             
                                             
                                                −
                                                
                                                   y
                                                   2
                                                
                                                
                                                   x
                                                   2
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   x
                                                   2
                                                
                                             
                                             
                                                
                                                   y
                                                   2
                                                
                                             
                                             
                                                1
                                             
                                             
                                                −
                                                
                                                   x
                                                   2
                                                
                                                
                                                   y
                                                   2
                                                   ′
                                                
                                             
                                             
                                                −
                                                
                                                   y
                                                   2
                                                
                                                
                                                   x
                                                   2
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                
                                                   x
                                                   3
                                                
                                             
                                             
                                                
                                                   y
                                                   3
                                                
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                −
                                                
                                                   x
                                                   3
                                                
                                                
                                                   x
                                                   3
                                                   ′
                                                
                                             
                                             
                                                −
                                                
                                                   y
                                                   3
                                                
                                                
                                                   x
                                                   3
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   x
                                                   3
                                                
                                             
                                             
                                                
                                                   y
                                                   3
                                                
                                             
                                             
                                                1
                                             
                                             
                                                −
                                                
                                                   x
                                                   3
                                                
                                                
                                                   y
                                                   3
                                                   ′
                                                
                                             
                                             
                                                −
                                                
                                                   y
                                                   3
                                                
                                                
                                                   x
                                                   3
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                
                                                   x
                                                   4
                                                
                                             
                                             
                                                
                                                   y
                                                   4
                                                
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                −
                                                
                                                   x
                                                   4
                                                
                                                
                                                   x
                                                   4
                                                   ′
                                                
                                             
                                             
                                                −
                                                
                                                   y
                                                   4
                                                
                                                
                                                   x
                                                   4
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   x
                                                   4
                                                
                                             
                                             
                                                
                                                   y
                                                   4
                                                
                                             
                                             
                                                1
                                             
                                             
                                                −
                                                
                                                   x
                                                   4
                                                
                                                
                                                   y
                                                   4
                                                   ′
                                                
                                             
                                             
                                                −
                                                
                                                   y
                                                   4
                                                
                                                
                                                   x
                                                   4
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                   11
                                                
                                             
                                          
                                          
                                             
                                                
                                                   h
                                                   12
                                                
                                             
                                          
                                          
                                             
                                                
                                                   h
                                                   13
                                                
                                             
                                          
                                          
                                             
                                                
                                                   h
                                                   21
                                                
                                             
                                          
                                          
                                             
                                                
                                                   h
                                                   22
                                                
                                             
                                          
                                          
                                             
                                                
                                                   h
                                                   23
                                                
                                             
                                          
                                          
                                             
                                                
                                                   h
                                                   31
                                                
                                             
                                          
                                          
                                             
                                                
                                                   h
                                                   32
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   1
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                
                                                   y
                                                   1
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                
                                                   x
                                                   2
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                
                                                   y
                                                   2
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                
                                                   x
                                                   3
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                
                                                   y
                                                   3
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                
                                                   x
                                                   4
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                
                                                   y
                                                   4
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (5)
                                 
                                    
                                       
                                          
                                             
                                                x
                                                '
                                             
                                          
                                          
                                             
                                                y
                                                '
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                         11
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                         12
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                         13
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                         21
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                         22
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                         23
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                         31
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                         32
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   
                                                      y
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                         31
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                         22
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   
                                                      y
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    G
                                    
                                    
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             
                                                y
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

After the alignment process, the aligned images corresponding to the patterns will have the same size, orientation and spatial location. As the example shown in Fig. 8(a) and (b), the five consecutive pattern images of pk
                            are geometrically transformed into the five aligned image gk
                           , as shown in Fig. 8(b). The aligned images are used to generate an adaptive pattern model.

Using the N aligned images gk
                           (x′,y′) from N consecutive pattern images, we calculate a median image m(x′,y′) and a deviation image d(x′,y′) by Eq. (6).
                              
                                 (6)
                                 
                                    
                                       
                                          
                                             
                                                m
                                                
                                                   
                                                      x
                                                      '
                                                      ,
                                                      y
                                                      '
                                                   
                                                
                                                =
                                                median
                                                
                                                   
                                                      
                                                         g
                                                         i
                                                      
                                                      
                                                         
                                                            x
                                                            '
                                                            ,
                                                            y
                                                            '
                                                         
                                                      
                                                      ,
                                                      
                                                      f
                                                      o
                                                      r
                                                      
                                                      i
                                                      =
                                                      k
                                                      −
                                                      M
                                                      ,
                                                      …
                                                      ,
                                                      k
                                                      +
                                                      M
                                                   
                                                
                                             
                                          
                                          
                                             
                                                d
                                                
                                                   
                                                      x
                                                      '
                                                      ,
                                                      y
                                                      '
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         1
                                                         N
                                                      
                                                      
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               k
                                                               −
                                                               M
                                                            
                                                            
                                                               k
                                                               +
                                                               M
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        g
                                                                        i
                                                                     
                                                                     
                                                                        
                                                                           x
                                                                           '
                                                                           ,
                                                                           y
                                                                           '
                                                                        
                                                                     
                                                                     −
                                                                     m
                                                                     
                                                                        
                                                                           x
                                                                           '
                                                                           ,
                                                                           y
                                                                           '
                                                                        
                                                                     
                                                                  
                                                               
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where N must be odd and M
                           =⌊N/2⌋. According to the assumption that defects do not happen in the same position of the consecutive patterns, the median image obtained is defect-free, as shown in Fig. 8(c). The deviation image is similar to an edge image caused by the high deviation in edge parts and low deviation in smooth parts of the pattern image, as shown in Fig. 8(d).

In the final step, to detect defects mixed with the repeated pattern, we compare a pattern image with an adaptive pattern model, and then obtain the differences between them [16]. Based on the median image and deviation image, we generate a upper image u(x′,y′) and a lower image l(x′,y′) as
                              
                                 (7)
                                 
                                    
                                       
                                          
                                             
                                                u
                                                
                                                   
                                                      x
                                                      '
                                                      ,
                                                      y
                                                      '
                                                   
                                                
                                                =
                                                m
                                                
                                                   
                                                      x
                                                      '
                                                      ,
                                                      y
                                                      '
                                                   
                                                
                                                +
                                                max
                                                
                                                   
                                                      α
                                                      ,
                                                      β
                                                      ⋅
                                                      d
                                                      
                                                         
                                                            x
                                                            '
                                                            ,
                                                            y
                                                            '
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                l
                                                
                                                   
                                                      x
                                                      '
                                                      ,
                                                      y
                                                      '
                                                   
                                                
                                                =
                                                m
                                                
                                                   
                                                      x
                                                      '
                                                      ,
                                                      y
                                                      '
                                                   
                                                
                                                −
                                                max
                                                
                                                   
                                                      α
                                                      ,
                                                      β
                                                      ⋅
                                                      d
                                                      
                                                         
                                                            x
                                                            '
                                                            ,
                                                            y
                                                            '
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

The upper image and lower image form an adaptive model of a pattern image. By comparing the aligned image of a pattern of the test image, gk
                           (x′,y′), to the adaptive pattern model, we can generate the defect detection map b(x′,y′) as Eq. (8)
                           
                              
                                 (8)
                                 
                                    b
                                    
                                       
                                          x
                                          ′
                                          ,
                                          y
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                1
                                                
                                                
                                                   defective
                                                
                                                ,
                                                
                                                if
                                                
                                                
                                                   g
                                                   k
                                                
                                                
                                                   
                                                      x
                                                      ′
                                                      ,
                                                      y
                                                      ′
                                                   
                                                
                                                >
                                                u
                                                
                                                   
                                                      x
                                                      ′
                                                      ,
                                                      y
                                                      ′
                                                   
                                                
                                                
                                                or
                                                
                                                
                                                   g
                                                   k
                                                
                                                
                                                   
                                                      x
                                                      ′
                                                      ,
                                                      y
                                                      ′
                                                   
                                                
                                                <
                                                l
                                                
                                                   
                                                      x
                                                      ′
                                                      ,
                                                      y
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                                
                                                
                                                   
                                                      n
                                                      o
                                                      n
                                                      ‐
                                                      defective
                                                   
                                                
                                                ,
                                                
                                                otherwise
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

It is noted that Eq. (8) is in the aligned image domain. To map the result back to the original image, we need to inversely transform b(x′,y′) of a pattern back to (x,y) coordinate by applying the inverse matrix of G which has appeared in Eq. (5), as shown in Eq. (9). The whole defect-detected panel image is finally composed by all the defect-detected patterns.
                              
                                 (9)
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             
                                                y
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                    =
                                    
                                       G
                                       
                                          −
                                          1
                                       
                                    
                                    
                                    
                                       
                                          
                                             
                                                x
                                                '
                                             
                                          
                                          
                                             
                                                y
                                                '
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

It is noted that the model derived from Eq. (7) is adaptive rather than fixed. It automatically adjusts the lower and upper limits, l(x′,y′) and u(x′,y′), according to the image contents. In smooth area, d(x
                           ′,
                           y
                           ′) is very small, hence the u(x′,y′) and l(x′,y′) are determined by the fixed parameter α. This means the detection range (threshold) is fixed. On the contrary, in non-smooth area such as edges, the u(x′,y′) and l(x′,y′) are proportional to the deviation image d(x′,y′). Since d(x′,y′) is varying with different edge strengths, the range for defect detection is dynamic. The two parameters α and β are used to adjust the detection sensitivity and specificity for the smooth region and non-smooth region, respectively. By decreasing α, more defects in smooth area will be detected and miss detection rate will be lowered, but of course false alarm rate will be increased. In this case, the sensitivity will be raised but specificity reduced. By the inverse way (increasing α), we can reduce false alarm rate and false detection rate but will raise miss detection rate in the smooth region. Similarly, decreasing β will increase sensitivity but reduce specificity in the non-smooth area. In the experiments below, we will discuss the setting of the two parameters.

@&#EXPERIMENTAL RESULTS@&#

In the experiments, we evaluate our proposed method with three touch panels denoted as Product I, Product II and Product III. Three different sensing circuits are coated in the three panels, respectively. The panel images are captured by a line scan camera under bright-field illumination. Our testing bench uses Visual C++ with Intel Core i-5 CPU at 2.5GHz.

The hardware configuration of the image capture in our AOI system is shown in Fig. 9
                        . It consists of a line-scan camera (including a single row of CCDs), a LED light source which is composed of multiple LEDs arranged in a one-dimensional array, and a fixture. The angles of the camera and the LED light relative to the perpendicular line are 15°. The fixture carries a panel and moves forward on the slide rail. The panel is scanned line-by-line and the image is formed in the camera. It is noted that the light source offers illumination of a line of the panel rather than the whole area. Thus the light on a single line of a panel can be well controlled such that the illumination change is usually very small. Fig. 10
                         displays a real picture of our capture device.

The sizes of Product I and II are small (4.3 and 4.7in.). Product III is a large-size panel (10in.) with more complicated pattern structures, compared to the Products I and II. The image size of Product III is more than five times of those of the other two products. To evaluate the performance of our proposed method, we manually label every pattern in a touch panel as NG or OK. If any defect happens within a pattern, the pattern is labeled by NG otherwise by OK. We count the numbers of NG and OK for the three products and the results are listed in Table 1
                        . Then, these manually labeled patterns are regarded as the ground truth of defects and non-defects.

The training process for all products is the same, and here it is illustrated by using Product I. Fig. 11(a)–(c) shows the reference points set for the estimation of CPs, and Fig. 11(d) is the created template centered at the CP. As mentioned before, users pay only very little effort for completing the training. Fig. 12
                         shows the refined results of CPs of Product I using template matching.

@&#PERFORMANCE EVALUATION@&#

The performance of detection is evaluated with the confusion matrices of NG and OK. The four permutations of the confusion matrix are: labeled NG and detected NG (true positive, TP), labeled NG but detected OK (false negative, FN), labeled OK but detected NG (false positive, FP), and labeled NG and detected NG (true negative, TN). Finally, we compute true positive rate (TPR) and false positive rate (FPR) by Eq. (11).
                           
                              (11)
                              
                                 T
                                 P
                                 R
                                 =
                                 
                                    
                                       T
                                       P
                                    
                                    
                                       T
                                       P
                                       +
                                       F
                                       N
                                    
                                 
                                 ×
                                 100
                                 %
                                 
                                 ,
                                 
                                 F
                                 P
                                 R
                                 =
                                 
                                    
                                       F
                                       P
                                    
                                    
                                       F
                                       P
                                       +
                                       T
                                       N
                                    
                                 
                                 ×
                                 100
                                 %
                              
                           
                        
                     

To determine suitable values of the parameters α and β, we plot receiver operating characteristic (ROC) curves of FPR vs. TPR under different parameter values. Here, Products I and II are used to illustrate the determination of parameters. We fix β and adjust α to generate ROC curves as shown Fig. 13(a), (c) and (e), and then fix α and adjust β to obtain ROC curves as shown Fig. 13(b), (d) and (f). In fixed-β ROC curves, small α results in better TPR but worse FPR. Similarly, small β yields better TPR but worse FPR in fixed-α ROC curves. In Fig. 13(a), three close ROC curves are obtained with fixed β of 5.0, 4.5 and 4.0, and varying α from 7 to 13. Considering more than 90% of TPR and less than 10% of FPR, we choose the moderate operation point [17] falling at α
                        =10. Then, we plot ROC curve with fixed α
                        =10 and adjust β from 3.5 to 7.0, as shown Fig. 13(b). The moderate operation point falls at β
                        =4.5. Therefore, the value of (α, β) can be chosen as (10, 4.5) for Product I. Similarly, by observing Fig. 13(c)–(d), it is found that either (10, 5) or (10, 5.5) would be suitable for Product II. Using the similar procedure, we can evaluate the influence of the parameters values on the performance of Product III as well.


                        Table 2
                         shows the confusion matrix of the detection results of proposed method with α
                        =10 and β
                        =5. Obviously, the proposed method can achieve the requirement of industry standard, that is, (TPR>90%, FPR<10%), for all three products. Fig. 14
                         exhibits detected results of the three products at parameter values of α
                        =10 and β
                        =5. The adaptive pattern model is obtained from seven consecutive pattern images. From the results, very low false detection happens in the normal sensing circuits. The defects including particle, scratch, fiber and stain mixed with sensing circuits are successfully extracted out by the proposed method.

For comparison, we evaluate the performance of Lin's method [3] for the three products. In Lin's method, the test image is first transformed into frequency domain by FFT, and then a notch filter is employed to remove circuit patterns. Next, the result is inversely transformed to obtain reconstructed image. Finally, a thresholding scheme with upper and lower thresholds calculated by Eq. (9) is used to extract the defects.
                           
                              (9)
                              
                                 
                                    T
                                    U
                                 
                                 =
                                 
                                    μ
                                    f
                                 
                                 +
                                 k
                                 
                                    σ
                                    f
                                 
                                 
                                 and
                                 
                                 
                                    T
                                    L
                                 
                                 =
                                 
                                    μ
                                    f
                                 
                                 −
                                 k
                                 
                                    σ
                                    f
                                 
                              
                           
                        where μf
                         and σf
                         are the mean and standard deviation of the reconstructed image, respectively. The pixel g(x,y) is regarded as defect if g(x,y)>
                        TU
                         or g(x,y)<
                        TL
                        , where g(x,y) is the gray level of the reconstructed image. The parameter k controls the threshold level of the defect detection. In filtering, the band width of the notch filter (w) is chosen to be 1pixel or 3pixels in the experiment. Fig. 15
                         shows the experimental results of Lin's method. For Product I, the value of parameter k varies from 3.5 to 4.5, and the result is shown in Fig. 15(a). When k
                        =3.8 and w
                        =1, the best performance is achieved, where TPR and FPR are 94% and 11%, respectively. For Product II, the parameter k varies from 4.5 to 5.5, and the best result is TPR=
                        81% and FPR=
                        8% at k
                        =5.0 and w
                        =1. For Product III, the performance is very poor. For example at w
                        =3, to achieve TPR of 80%, the FPR is up to 60%. The result indicates that Lin's method performs worse for complicated circuits like Product II and Product III. In addition, the detection performance is very sensitive to the parameter value of k. For example, when k decreases from 3.8 to 3.5 slightly, FPR increases from 11% to 43% for Product I; when k decreases from 5.0 to 4.5, FPR increases from 2% to 52% significantly for Product II; and when k decreases from 4.7 to 4.5, FPR increases from 8% to 61% rapidly for Product III.

The comparison of ROC performances of our proposed method and Lin's method for the three products is summarized in Fig. 16
                        . It is obvious that our method performs much better Lin's method, especially for Product II and III. In practical application of industries, performance of more than 90% in TPR and less than 10% in FPR is often required, which is called practical standard. To meet 10% of FPR, the achieved TPR of our method and Lin's method are respectively 95% and 90% for Product I. To meet 90% of TPR, the two methods respectively achieve FPR of 6.5% and 9%. For Product II, to meet the practical standard, our proposed method achieves TPR=94%, and FPR=4.5%. However, Lin's method cannot meet the standard with any parameter settings. Furthermore, as shown in Fig. 16, the parameter k in Lin's method is so sensitive that the adjustment is not easy. On the contrary, the parameter α in our method is not too sensitive to adjust. For the complicated panel Product III, there are three operation points of α
                        =8, 9 and 10 to meet TPR
                        >90% and FPR
                        <10%. However, the performance of the Lin's method is poor for this product. The results indicate that our proposed method also achieves good performance for the products with complicated patterns.

In the following, we will analyze the major features of our method and then describe its limitation.

In this work, we design defect detection algorithm based on the repetitive characteristic of four-control-point patterns. We evaluate three different types of sensing circuits in experiments. Fig. 17(a) shows ten types of sensing circuits, which are collected from website [19–28]. By marking the repeated patterns on these circuits with red lines, as shown in Fig. 17(b), it is seen that all circuits can be regarded as the composition of four-control-point patterns in a repetitive way. Therefore, our proposed method can be applied various types of sensing circuits.

Geometric distortion would be introduced in the captured image for a general AOI system. Thus, camera calibration is usually adopted to remove the distortion to generate a calibrated image. The defect detection is then applied to the calibrated image. The calibration process is tedious but necessary for most defect detection methods like CAD mapping.

We apply the proposed method to un-calibrated and calibrated images and compare the results in terms of geometric distortion and defect detection performance. We mark a set of standard coordinates of control points (CPs) for a specific product, which is denoted as 
                              
                                 
                                    
                                       x
                                       ˜
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 
                                    
                                       y
                                       ˜
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                           . Then, we obtain the coordinates of CPs in un-calibrated and calibrated images by executing “refinement of control points” mentioned in Section 2.2.1. The two sets of coordinates are further geometrically transformed into the standard coordinates. Let (x
                           
                              i,j
                           ,
                           y
                           
                              i,j
                           ) represent the transformed coordinates of CPs in an un-calibrated or calibrated image. To evaluate the geometric distortion, the root mean square error (RMSE) between (x
                           
                              i,j
                           ,
                           y
                           
                              i,j
                           ) and 
                              
                                 
                                    
                                       x
                                       ˜
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 
                                    
                                       y
                                       ˜
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                            is calculated by Eq. (12), where N is the total number of CPs.
                              
                                 (12)
                                 
                                    RMSE
                                    =
                                    
                                       
                                          ∑
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         
                                                            i
                                                            ,
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            x
                                                            ˜
                                                         
                                                         
                                                            i
                                                            ,
                                                            j
                                                         
                                                      
                                                   
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         y
                                                         
                                                            i
                                                            ,
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            y
                                                            ˜
                                                         
                                                         
                                                            i
                                                            ,
                                                            j
                                                         
                                                      
                                                   
                                                
                                                2
                                             
                                          
                                       
                                    
                                    /
                                    N
                                    .
                                 
                              
                           
                        


                           Table 3
                            indicates that the geometric distortion is reduced significantly if the image is calibrated. However, detection performances for the two types of images are very close Therefore, we conclude that our proposed method can be applied to un-calibrated images.

The adaptive pattern model is obtained by self-training from the test image. In addition, the distortion of image affect the detection results slightly, which is due to the fact that our pattern alignment scheme can compensate the geometrical variation. This method saves works and costs of camera calibration in the image acquisition stage.

From the above analysis and description in other sections of the paper, the beneficial features of our proposed method are summarized as
                              
                                 (1)
                                 It can be directly applied to various types of sensing circuits of different panel products though pattern learning.

It can be applied to un-calibrated images.

It is computational efficient.

Users pay very little effort for the training of different products.

Only two parameters are required to set in detection, and the setting of parameters is quite easy.

The possible limitation of our approach is that a small defect in a testing pattern may not be detected if a significant defect exists at the same location of the neighbor pattern of the testing pattern. We refer this as a shadow effect.

We illustrate the shadow effect using an example shown in Figs. 18 and 19
                        
                        . Fig. 18(a) is an image of touch panel with a significant defect. Fig. 18(b) and (c) show the median and deviation images of our proposed method. Although the median image is defect-free, the deviation image shows large changes. We found that the large variation appears at location of the significant defect, and also appears at the same location of the neighbor patterns. To analyze the influence on the defect detection of our proposed method, we add two artificial defects (cross shape) having the same gray level into the patterns next to the pattern with significant defect, as shown in Fig. 19(a). The two defects are denoted by L and R. The detection result is shown in Fig. 19(b). The right cross defect can be detected, but the left one cannot. Although the shadow effect exists in our algorithm, the influence on defect detection is insignificant because the occurrence probability that a pair of defects with large and small areas occurs at the neighboring patterns is very small in practice.

@&#CONCLUSIONS@&#

In this paper, we have presented an effective algorithm to inspect surface defects of touch panels. Unlike the traditional frequency-based methods, we treat the panel images as repeated patterns and develop a spatial domain defect detection method. Referring to the estimated control points of patterns, an adaptive pattern model is built by training the geometrically aligned patterns. The defects embedded in sensing circuit are easily extracted out by comparing the input pattern with the learned adaptive pattern model. The experimental results indicate that the detection performance is very promising with efficient computation. Moreover, the proposed algorithm requires very little user's effort and has the capacity to deal with various products which have different types of sensing circuits.

@&#ACKNOWLEDGMENT@&#

The authors would like to express their sincere thanks to the anonymous reviewers for their invaluable comments, which truly helped towards an effective presentation of this paper. This work was supported in part by the Ministry of Science and Technology Granted MOST 
                  103-2221-E-130 -006.

@&#REFERENCES@&#

