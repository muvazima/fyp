@&#MAIN-TITLE@&#Performance and security enhanced authentication and key agreement protocol for SAE/LTE network

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We exhaustively discuss the security threats of LTE access network.


                        
                        
                           
                           The scheme boosts the security level and improves performance of the network.


                        
                        
                           
                           We contribute to the methods of security protocols verification.


                        
                        
                           
                           The bandwidth consumption of exchange of authentication vectors is reduced by 79%.


                        
                        
                           
                           The computational, communication and storage overheads are significantly reduced.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

EPS AKA

LTE authentication

LTE key agreement

User Equipment(UE) authentication

3GPP

@&#ABSTRACT@&#


               
               
                  In recent years, Long Term Evolution has been one of the promising technologies of current wireless communication systems. Quality of service and data rate contribute for the robustness of the field. These two factors are the sum up of transmission rate, security delay, delay variation and some other communication factors. Despite its high data rate and quality of service, Long Term Evolution has some drawbacks as far as the security of this technology is concerned. Particularly, there are some security holes in authenticating users for access in the domain of Access Network. For instance, when User Equipment requests for attachment, the International Mobile Subscriber Identity (IMSI) is sent over network without security protection, hence privacy does not hold. In addition, many parameters are generated by invoking a function with only one input key by which compromising this key results in the whole failure of the system security. So as to mitigate these and some other huge security problems, the researchers, propose an improved approach without adding extra cost so that it can be implemented within the same environment as the existing security system (Evolved Packet System Authentication and Key agreement). As one of the performance enhancements, fetching authentication vectors from foreign network is enabled instead of fetching from home network, which significantly reduces the authentication delay and message overhead. Generally, the purpose is to boost the security level and performance of the protocol keeping the architecture of the system as similar as the conventional security system. These has been exhaustively analyzed and verified under network as well as security verification and simulation tools.
               
            

@&#INTRODUCTION@&#

Evolved Packet System (EPS) has brought two new major elements in to 3GPP environment with defined quality of service [1,2]: the radio network Evolved Universal Terrestrial Radio Access Network (E-UTRAN) with new radio interface, and the Internet Protocol based core network Evolved Packet Core (EPC) [6,10,31]. The security mechanism and functions that are deployed in GSM and 3G mobile communication are mostly based on principles that are generic enough and usable in many environments as this security mechanisms are tightly related to functions and mechanisms (e.g. UE attachment procedure, location area update, bearer establishment, handover) in the system. The design of EPS security architecture follows the same principle with GSM and 3G security. GSM and 3G security mechanisms put a good basis for EPS security architecture for which most of them are directly adapted to the EPS architecture. The EPS is also designed in a way it can inter-work with legacy systems; hence, it is done in a backward-compatibility manner. In addition to adapting existing security, functionality from legacy systems, many new extensions and enhancements have been introduced in to the EPS security architecture [10]. A high level EPS security architecture is shown in Fig. 1
                      for which the detail is briefly discussed in [3,10].

The conventional security architecture of Evolved Packet System (EPS) consists of Network Entities and security protocols that protect communication among these entities or sub-networks. Universal Integrated Circuit Card (UICC) with in Mobile Equipment(ME), mutually authenticates with the serving network for which authentication data is fetched from home network. A Communication among serving network nodes such as Evolved NodeB (eNB), Serving Gate-Way (S-GW) and Mobility Management Entity (MME) is protected under Internet Protocol Security (IPsec) where as the confidentiality as well as Integrity of data exchange between the serving network and ME is guaranteed by Non-Access Stratum (NAS), Access Stratum (AS), and User Plane (UP) security Protections.

During the execution of EPS security, once the User Equipment (UE) is identified (the UE sends its identity to MME), the MME in the serving network or visited network fetches authentication vectors (AVs) from the home network if there is no AVs available or if it is exhausted. Consequently, the MME initiates Authentication and Key Agreement (AKA) protocol which is termed as Evolved Packet System Authentication and Key Agreement (EPS AKA).

The EPS AKA comprises of three authentication procedures. Receiving a request from UE for authentication through MME, HSS generates EPS authentication vectors (RAND, AUTN, XRES, KASME) and delivers them to an MME as initial step. Secondly, the MME(on the behalf of serving network) selects one of the authentication vectors for mutual authentication with a UE and both generate same authentication key (KASME) as a master key using EPS AKA algorithm. Thirdly, new-shared keys are generated between the serving networks (SN) and the UE for signaling and user plane data protection. In the LTE access networks, in order to justify the legitimacy of the serving network, authentication of the network by the user is performed in addition to authentication of the user by the network. EPS AKA can be run depending on the network operators interest and policy to establish or renew a security context. A full EPS AKA procedure needs to be executed (apart from the case of emergency calls) whenever the UE and the network want to communicate but do not share a security context [10]. Particularly, authentication procedure can be run in different situations such as during the UE attachment, location area update, call originating, call terminating, handovers and during detachment [29].

EPS AKA achieves most of the security requirements of wireless network and successfully protects the communication interfaces against threats that were found in the preceding authentication and key agreement protocols of the access network. Nevertheless, it is still vulnerable to some security breaches such as user privacy violation, redirection attack, man-in-the-middle attack,denial of service attack, and lack of forward secrecy during handover key exchange. These security gaps, for which we discuss in detail in following problem statement section of this paper, are the deriving forces for the authors to come up with solution. Specifically, our contributions are:
                     
                        
                           1.
                           Despite most of threats are discussed in [1,10], we identify some unknown security threats or Scenarios of the LTE access network such as accessibility of the network for multiple device and exhaustively discuss with respect to security requirements of the network, which helps us to find solutions and obviously contributes to other researchers of the field as well.

As a security enhanced and performance optimized solution, we propose a scheme that mitigates the identified security breaches of the authentication and key agreement protocol and reduces the latency of execution. The scheme boosts the security level and improves performance of the protocol, keeping the architecture of the system as similar as the conventional security system.

We simulated the proposed scheme under OPNET modeler in order to evaluate the network performance of the protocol, which implies the applicability of the solution to the access network. It would also be an input for the literature of EPS AKA and helps other researchers to approach this simulation environment in similar fashion to model LTE access network. we formally analyze the proposed protocol under AVISPA to verify the security of the protocol, which proves the validity of the scheme and would also contribute to the methods of security protocols verification.

The security of the protocol is analytically illustrated and a bandwidth consumption during authentication fetching is mathematically shown using fluid flaw mobility model. Accordingly, the proposed scheme is found to be security enhanced and the bandwidth consumption of exchange of authentication vectors is reduced by 79% as compare to the conventional system.

Exploiting the application of cryptographic algorithms is also one of the objectives of the research.

The rest of the paper is organized as follows: We discuss the security holes of EPS (SAE/LTE) authentication and key agreement protocol in Section 2. Section 3 provides the related works for which an additional discussion is detailed under comparison section of the paper. We introduce our proposed scheme in Section 4 with multiple subsections. Section 5 comes up with protocol analysis. Subsequently, depending on the simulation and analysis results, we briefly illustrate the improvements of the protocol as compare to the conventional system in Section 6 and finally conclude the work in Section 7.

Although, numerous researchers have been working to address unanswered vulnerabilities of the SAE/LTE wireless access network, still, there are huge number of threats. Under this section, the authors illustrate these security gaps for which we will come up with solutions later.

                        
                           1.
                           Having an assumption that an adversary is operating a device that has a capability of functioning as base station (in this case eNB) and can emulate a mobile station, the adversary can impersonate as genuine base station and entices a legitimate user equipment (UE) to camp on the radio channel of the false base station. The attacker can also impersonate as a legitimate UE and establishes connection with a genuine base station. The capability of the false base station or mobile stations to act as genuine false base station or mobile stations allows the adversary to relay messages in between a legitimate mobile station and a genuine base station. Once the attacker entices the UE to camp on the radio channel of the false base station he can redirect it to Unintended access network. This scenario can happen when the false base station redirects connection request to foreign network while the intention of the UE is to connect to Home network. Due to this, a foreign network charges the user based on a rate higher than that offered by the home network. As another scenario, “To intercept user traffic, the adversary may redirect user traffic to a network in which data encryption is either not provided or provided but very weak” [35].

Forward security is another vulnerability that needs consideration in EPS-AKA. When UE handovers with in MME (intra-MME) and to new MME, 
                                 
                                    N
                                    e
                                    x
                                    t
                                    −
                                    H
                                    o
                                    p
                                    −
                                    K
                                    e
                                    N
                                    B
                                 
                               parameter is transferred from MME to the target eNB with path switch acknowledgement message. Because the acknowledgment message of path switch is transmitted after the radio link handover, it can only be used to generate keys for the next handover procedure and target eNB comes after the current target eNB. Thus, forward security happens only after two hops because the source eNB knows the current target eNBs keys. In other words, the forward security is achieved after two hops, as the source eNB does not have a way to know the keys that the current target eNB uses to prepare handover to the next target eNBs (the fresh key derivation parameter, 
                                 
                                    N
                                    e
                                    x
                                    t
                                    −
                                    H
                                    o
                                    p
                                    −
                                    K
                                    e
                                    N
                                    B
                                    ,
                                 
                               comes from the MME to the target eNB in the path switch acknowledgement message) [3].
                           

The EPS AKA lacks a privacy protection due to unsecured transmission of International Mobile Subscriber Identity (IMSI) over networks. One can illustrate many instances that results in disclosure of the IMSI, which helps attackers to track the mobility of the users. For instance, when a UE registers to a network for the first time, or IMSI cannot be retrieved due to a possible synchronization failure when it roams to a new MME, the current MME or the new MME requests the IMSI of the UE, and thus, the UE must transmit the IMSI insecurely. Once the IMSI is obtained, the adversary can acquire subscriber information, location information, and even conversation information, and then disguise the real UE and launch the other attacks such as DOS attacks to destroy the network [8]. To minimize the risk of transmitting IMSI frequently on unsecured channel, TMSI (Temporary Mobile Subscriber Identity) was proposed to replace IMSI [16]. However, this could not fully resolve the problem due to the above possibilities of sending IMSI through a network. Moreover, allocating TMSI dynamically incurs computational load and updating the TMSI each time it is allocated consumes bandwidth.

Several denial-of-service attacks have been found on EPS-AKA. For instance, a denial-of-service attacks by modifying the unprotected messages in the EPS AKA during first authentication of UE to cause authentication failure [30]. On the other hand, by sending a large number of valid IMSIs, which are collected in advance, to cause massive attachment request to exhaust/congest the bandwidth between the serving network and the home network or to exhaust the computational capacity of the networks. This finally leads to denial of service.

In addition to SAE/LTE, user identity module (UIM) authentication and key agreement in relation with 3GPP access networks is considered in this work. Today, service providers are supposed to provide services on number of different devices in order to attract customers to their services. As the number of devices that a subscriber may use to connect to a network increases, a service provider may want to issue a UIM for each of the subscriber’s devices, where each UIM has the same shared secret key. It should be noted that the 3GPP standards allow for multiple UIMs with the same shared secret key. Security vulnerability, however, arises when known key exchange protocols are used in an environment where a subscriber has multiple devices, and where each device has its own UIM with the same shared secret. Attack scenarios can happen due to the following.

Let denote two devices of a customer as D1 and D2. D1 and D2 both want to connect to the access network where D1 initiates the connection first. As defined in AKA procedure, a server sends random number (RAND), authentication token (AUTH) to D1, which an adversary (A) overhears. Again, D2 initiates connection request, but A intercepts the request and then replays the RAND, AUTH parameters to D2. Thus, the both D1 and D2 generate the same ciphering key (CK), integrity key (IK). This may lead to unintended transaction on the customers account. For instance, the adversary may redirect an account transaction intended for D1’s UIM to D2’s UIM.

Man in the middle attack is also still a security problem of EPS AKA. This simply illustrated as in the figure below (Fig. 2).

Bandwidth consumption and authentication signaling overhead between the serving network (foreign network) and the home network (HN) is one of the problems. This is because the serving network (SN) must go back to the HN for a request of another set of authentication vectors (AVs) when the UE stays in the SN for a long period and exhausts its set of AVs for the authentication.

EPS-AKA is fully dependent on the secrecy of a single key, pre-shared secret key between authentication center and mobile station (UE). Once, this key is compromised, every key can be retrieved and possibly an adversary can be authenticated by the network.

@&#RELATED WORKS@&#

There are several authentication and key agreement researches that have been carried out with the aim of improving authentication efficiency, computational and communication performance of the LTE networks [9,11,12,15,19,22,23,26–28,30,33,36]. Privacy has also been one of the security gaps that need improvement for which different approaches such as symmetric and asymmetric cryptography solutions have been proposed.

Hamandi et al. [13] proposed improved key with aim of protecting international mobile subscriber identity (IMSI) which is to assure the privacy of a user not to be tracked. It also considers power utilization of the mobile device. In the aforementioned paper, after receiving attachment request, the MME generates random number and sends it to UE. Subsequently, UE also generates another random number in which both numbers are fed to key generation function together with pre-shared key K, results in encryption key for ciphering (XOR) IMSI. There is also newly introduced sequence number (SQN
                     HSK) intended to inform the HSS to which pre-shared key K the UE belongs. Each UE is assigned a limited range of sequential numbers that direct to key K so that HSS can identify the key K by matching the sequence number (SQN
                     HSN) with the range assigned to the UE. This scheme holds for some security needs, but still has some security holes and computational overhead. Managing the newly introduced sequence number and other security parameters, results in system complexity and performance overhead. As one of computational overheads, each time the UE requests for authentication, the MME has to go back to HSS to fetch authentication vector.

On the other hand, some security parameters that are assumed as private can be retrieved from the authentication vector. For instance, RMSI is assumed as private to UE and HSS in the proposed scheme, but it can be simply retrieved from AUTN. As it is described in the paper, AUTN can be computed as 
                        
                           A
                           U
                           T
                           N
                           =
                           S
                           Q
                           N
                           ⊕
                           A
                           K
                           ∥
                           S
                           Q
                           
                              N
                              HSK
                           
                           ⊕
                           A
                           K
                           ∥
                           R
                           M
                           S
                           I
                           ⊕
                           S
                           Q
                           N
                           ⊕
                           A
                           K
                           ∥
                           A
                           M
                           F
                           ∥
                           M
                           A
                           C
                        
                     . From this, one knows the value of SQN⊕AK and RMSI⊕SQN⊕AK from the fact that concatenated bits reach the destination in the order of transmission. Hence, 
                        
                           R
                           M
                           S
                           I
                           =
                           R
                           M
                           S
                           I
                           ⊕
                           S
                           Q
                           N
                           ⊕
                           A
                           K
                           ⊕
                           S
                           Q
                           N
                           ⊕
                           A
                           K
                           ,
                        
                      which leads to retrieval of other parameters generated from RMSI. Moreover, man in the middle and denial of service attacks are not considered here. Zhang [35] proposed an execution environment adaptive protocol in such a way that it is flexible depending on whether the user has unused authentication vectors or not. Still, in this scheme, some threats such as denial of service attacks, Man in the middle attack, privacy issue, and redirection attack are not addressed.

In general, almost no schemes that are proposed as of this paper that could fully mitigate the threats mentioned under problem statement section, which are found as EPS AKA security faults. It is obviously stated that the security of EPS AKA is fully dependent on pre-shared key K between HSS and UE. i.e. once this key is compromised, none of security goal of LTE network is achieved. As of today, none of the proposed protocols could meet this requirement or feature. Further discussion on works related to EPS AKA will be analyzed in detail under Section 6 in comparison with our scheme, which illustrates the contribution of our work.

Pre-shared parameters are considered as it is shared during customer subscription by storing in to secure storage part of USIM from the authentication center. In addition to private key K, which has been already defined in 3GPP AKA, there are two more newly introduced parameters (f′ and E) that have to be shared in advance. These are stored on both authentication center and UE in secure manner so that the entities can access during attachment request or when authentication is needed for any other procedure. The parameters that are considered to be shared during subscription or during manufacturing are generally discussed as follows:

                           
                              •
                              
                                 f′ (fprime) : a newly added cryptographic function, which is preferably one way key derivation function, but strictly kept private that is known to UE and HSS only.


                                 E: a newly introduced that is taken as pre-selected encryption function depends on the ciphering algorithms that the UE and HSS support, but public.


                                 K: commonly known as LTE K, which is defined by 3GPP and privately known to HSS and UE.


                                 KI: newly introduced as unique Key Identifier which points to the key K (LTE K) that has to be changed or re-allocated after each successful full execution of the authentication and key agreement protocol or after each successful attachment.

In the proposed scheme, the security level achieved in the conventional security mechanisms is improved, while all security services provided by the system are fully maintained. It includes Mutual Authentication, Non-Access Stratum (NAS) Security Setup with Key Agreement, and Access Stratum (AS) Security Setup with Key Agreement phases of which the procedural discussion is presented as follows:

                           
                              1.
                              Initially, looking for an attachment, the UE sends an attach request to MME together with its IMSI, newly generated random number RAND
                                 UE, mobile identity (
                                    
                                       M
                                       −
                                       I
                                       D
                                    
                                 ), unique key identifier (KI) and the SNID. The parameters 
                                    
                                       M
                                       −
                                       I
                                       D
                                       ,
                                    
                                  
                                 IMSI and SNID are encrypted under a key S, where 
                                    
                                       S
                                       =
                                       
                                          f
                                          ′
                                       
                                       
                                          (
                                          K
                                          I
                                          )
                                       
                                       _
                                       K
                                    
                                  and K is the LTE K(see Fig. 3
                                 ).

Extracting RAND
                                 UE and UE security capability from the received message, MME adds SNID to the received message (in order the HSS can compare the SNID sent from UE with SNID sent from MME) and relays it to HSS. i.e. MME sends 
                                    
                                       E
                                       
                                          (
                                          M
                                          −
                                          I
                                          D
                                          ∥
                                          I
                                          M
                                          S
                                          I
                                          ∥
                                          S
                                          N
                                          I
                                          
                                             D
                                             UE
                                          
                                          )
                                       
                                       _
                                       S
                                       ∥
                                       S
                                       N
                                       I
                                       
                                          D
                                          MME
                                       
                                    
                                  to HSS.

Receiving the parameters relayed from MME, HSS performs the following:

                                    
                                       •
                                       Using the key identifier (KI), a unique number that has been allocated to UE in the home network, the HSS/AUC identifies the key K (LTE K) to compute 
                                             
                                                S
                                                =
                                                
                                                   f
                                                   ′
                                                
                                                
                                                   (
                                                   K
                                                   I
                                                   )
                                                
                                                _
                                                K
                                             
                                          .
                                       

Then it decrypts 
                                             
                                                E
                                                (
                                                M
                                                −
                                                I
                                                D
                                                ∥
                                                I
                                                M
                                                S
                                                I
                                                ∥
                                                S
                                                N
                                                I
                                                D
                                                )
                                                _
                                                S
                                             
                                           which is to access the 
                                             
                                                M
                                                −
                                                I
                                                D
                                                ,
                                             
                                           
                                          IMSI and SNID
                                          UE sent from UE so as to compare whether the SNIDUE sent from UE is the same with SNIDMME received from MME or not. i.e. 
                                             
                                                
                                                   (
                                                   M
                                                   −
                                                   I
                                                   D
                                                   ∥
                                                   I
                                                   M
                                                   S
                                                   I
                                                   ∥
                                                   S
                                                   N
                                                   I
                                                   
                                                      D
                                                      UE
                                                   
                                                   )
                                                
                                                =
                                                E
                                                
                                                   (
                                                   E
                                                   
                                                      (
                                                      M
                                                      −
                                                      I
                                                      D
                                                      ∥
                                                      I
                                                      M
                                                      S
                                                      I
                                                      ∥
                                                      S
                                                      N
                                                      I
                                                      
                                                         D
                                                         UE
                                                      
                                                      )
                                                   
                                                   _
                                                   S
                                                   )
                                                
                                                _
                                                S
                                             
                                          . is 
                                             
                                                S
                                                N
                                                I
                                                
                                                   D
                                                   UE
                                                
                                                =
                                                S
                                                N
                                                I
                                                
                                                   D
                                                   UE
                                                
                                             
                                          ? The comparison of the two SNIDs is to protect redirection attack(The detail will appear under analysis section).

After assigning a new unique key identifier (KI) number to key K, HSS send back the parameters S∥KI∥IMSI over secure channel to MME, where KI’s value is the newly assigned number.

Up on receiving S∥KI; MME stores IMSI (by decrypting message from UE under key S), generates a random number RAND
                                 MME, assigns sequence number SQN, and then computes authentication parameters as indicated below:

                                    
                                       •
                                       Message authentication code 
                                             
                                                M
                                                A
                                                C
                                                =
                                                
                                                   f
                                                   1
                                                
                                                
                                                   (
                                                   S
                                                   Q
                                                   N
                                                   ∥
                                                   R
                                                   A
                                                   N
                                                   
                                                      D
                                                      MME
                                                   
                                                   ∥
                                                   A
                                                   M
                                                   F
                                                   ∥
                                                   K
                                                   I
                                                   ∥
                                                   S
                                                   )
                                                
                                                ,
                                             
                                           where f
                                          1 is a message authentication function,

An expected response 
                                             
                                                X
                                                R
                                                E
                                                S
                                                =
                                                
                                                   f
                                                   2
                                                
                                                
                                                   (
                                                   R
                                                   A
                                                   N
                                                   
                                                      D
                                                      MME
                                                   
                                                   ∥
                                                   S
                                                   )
                                                
                                                ,
                                             
                                           where f
                                          2 is a (possibly truncated) message authentication function,

A cipher key 
                                             
                                                C
                                                K
                                                =
                                                
                                                   f
                                                   3
                                                
                                                
                                                   (
                                                   R
                                                   A
                                                   N
                                                   
                                                      D
                                                      UE
                                                   
                                                   ∥
                                                   S
                                                   )
                                                
                                                ,
                                             
                                           where f
                                          3 is a one-way key generating function,

An integrity key 
                                             
                                                I
                                                K
                                                =
                                                
                                                   f
                                                   4
                                                
                                                
                                                   (
                                                   R
                                                   A
                                                   N
                                                   
                                                      D
                                                      UE
                                                   
                                                   ∥
                                                   S
                                                   )
                                                
                                                ,
                                             
                                           where f
                                          4 is a one-way key generating function and S derived from K.

An anonymity key 
                                             
                                                A
                                                K
                                                =
                                                
                                                   f
                                                   5
                                                
                                                
                                                   (
                                                   R
                                                   A
                                                   N
                                                   
                                                      D
                                                      MME
                                                   
                                                   ∥
                                                   S
                                                   )
                                                
                                                ,
                                             
                                           where f
                                          5 is a key derivation function or f
                                          5 =0

A local master key 
                                             
                                                
                                                   K
                                                   ASME
                                                
                                                =
                                                K
                                                D
                                                F
                                                
                                                   (
                                                   S
                                                   Q
                                                   N
                                                   ⊕
                                                   A
                                                   K
                                                   ∥
                                                   C
                                                   K
                                                   ∥
                                                   I
                                                   K
                                                   )
                                                
                                                ,
                                             
                                           Where KDF is 
                                             
                                                H
                                                M
                                                A
                                                C
                                                −
                                                S
                                                H
                                                A
                                                −
                                                256
                                                (
                                                k
                                                e
                                                y
                                                ,
                                                t
                                                e
                                                x
                                                t
                                                m
                                                a
                                                s
                                                s
                                                a
                                                g
                                                e
                                                )
                                             
                                          .

Finally the authentication token 
                                             
                                                A
                                                U
                                                T
                                                N
                                                =
                                                (
                                                S
                                                Q
                                                N
                                                ⊕
                                                A
                                                K
                                                )
                                                ∥
                                                A
                                                M
                                                F
                                                ∥
                                                M
                                                A
                                                C
                                                )
                                                ,
                                             
                                           where 
                                             
                                                
                                                   f
                                                   5
                                                
                                                ≡
                                                0
                                                
                                                   (
                                                   A
                                                   K
                                                   =
                                                   0
                                                   )
                                                
                                             
                                           if the concealment of SQN is not needed by the operator.

After computing the authentication token, MME sends AUTN to UE concatenating with encrypted newly assigned KI∥RAND
                                 MME. KI∥RAND
                                 MME are encrypted under key S by encryption algorithm X, selected from UE security capability that was sent to MME with initial authentication request. i.e. MME 
                                    
                                       A
                                       U
                                       T
                                       N
                                       ∥
                                       (
                                       K
                                       I
                                       ∥
                                       R
                                       A
                                       N
                                       
                                          D
                                          MME
                                       
                                       )
                                       _
                                       S
                                    
                                  to UE.

Generating 
                                    
                                       A
                                       K
                                       =
                                       
                                          f
                                          5
                                       
                                       
                                          (
                                          R
                                          A
                                          N
                                          
                                             D
                                             MME
                                          
                                          ∥
                                          S
                                          )
                                       
                                    
                                  and deriving SQN (
                                    
                                       S
                                       Q
                                       N
                                       =
                                       S
                                       Q
                                       N
                                       ⊕
                                       A
                                       K
                                       ∥
                                       A
                                       M
                                       F
                                       ∥
                                       M
                                       A
                                       C
                                       ⊕
                                       A
                                       K
                                    
                                 ), UE computes the XAUTN parameter by using the same cryptographic algorithms with MME. If 
                                    
                                       X
                                       A
                                       U
                                       T
                                       N
                                       =
                                       A
                                       U
                                       T
                                       N
                                    
                                  and SQN is with in pre-defined range, UE authenticates the network and then sends 
                                    
                                       R
                                       E
                                       S
                                       =
                                       
                                          f
                                          2
                                       
                                       
                                          (
                                          R
                                          A
                                          N
                                          
                                             D
                                             MME
                                          
                                          ∥
                                          S
                                          )
                                       
                                    
                                  to MME while storing KI for future authentication purpose, else sends failure message to MME.

Once the MME receives the RES, it verifies that 
                                    
                                       X
                                       R
                                       E
                                       S
                                       =
                                       R
                                       E
                                       S
                                    
                                  to authenticate the UE where authentication phase is completed and NAS security context setup starts if and only if UE is authenticated. A successful completion of this phase is termed as Mutual Authentication.

Subsequently, MME generates K
                                 NASenc (NAS signaling encryption key) and K
                                 NASint (NAS signaling integrity key) by using K
                                 ASME as similar as algorithms in [3] to assure the integrity and confidentiality of control signaling of interface between UE and MME or to protect Non-Access Stratum (NAS) control signaling. Selecting ciphering and integrity protection algorithms from UE security capability, MME sends these algorithms with NAS Security Mode command to UE while this message is integrity protected through selected integrity algorithm and key K
                                 NASint.

Computing K
                                 NASenc (NAS signaling encryption key) andK
                                 NASint (NAS signaling integrity key), UE sends back a NAS Security Mode Complete to MME, i.e. is a completion of Non-Access Stratum Security Setup phase. Here after, ciphered and integrity protected NAS signaling will be exchanged. Computationally, the two keys are generated as follows:

                                    
                                       •
                                       
                                          K
                                          NASenc = KDF (K
                                          ASME, AL-ID, NAS-Ciphering algorithm distinguish-er), where AL-ID is an algorithm identifier for NAS ciphering and integrity algorithms in common.


                                          K
                                          NASint = KDF (K
                                          ASME, AL-ID, NAS-Integrity algorithm distinguish-er)

As final phase, Access Stratum (AS) security context setup proceeds when the UE inters to ECM (EPS Connection Management) state. Consequently, MME sends K
                                 eNB,which is derived from K
                                 ASME, with UE Network Capability and Initial Context Setup Request to eNB. Then, eNB sends AS security Mode Command to UE after selecting integrity and ciphering algorithms from UE security capability profile for AS signaling and user plane data security. On both side, generating Keys for AS security, eNB and UE complete the enhanced-AKA procedure (which is almost similar with NAS security Mode command execution) as shown in Fig. 4. AS security keys, K
                                 RRCint, K
                                 RRCenc and K
                                 UPenc, are generated from K
                                 eNB where K
                                 RRCint and K
                                 RRCenc are used for integrity verification and encryption of control plane data (i.e. RRC control signaling messages), and K
                                 UPenc is used for ciphering of user plane data (i.e. IP packets). Integrity verification and encryption are performed at the PDCP (Packet Data Convergence Protocol) layer. The keys with in Access Stratum (AS) security context are derived as shown below:

                                    
                                       •
                                       
                                          K
                                          eNB = KDF (K
                                          ASME, NAS UPlink Count).


                                          K
                                          RRCint = KDF (K
                                          eNB, AS-AL-ID, AS-Int-Al-distinguish-er), where AS-AL-ID is Access Stratum Ciphering & Integrity algorithms identifier in common and AS-Int-Al-distinguish-er is a Access Stratum (AS) signaling integrity algorithm distinguish-er.


                                          K
                                          RRCenc = KDF (K
                                          eNB, AS-AL-ID, AS-enc-Al-distinguish-er), where AS-enc-Al-distinguish-er is a Access Stratum (AS) signaling encryption algorithm distinguish-er.


                                          K
                                          UPenc = KDF (K
                                          eNB, AS-AL-ID, UPenc-Al-distinguish-er), where UPenc-Al-distinguish-er is a user plane encryption algorithm distinguish-er.

The authentication vectors generation and key derivation procedures are generally explained under the section ‘Authentication Procedure’ and in Fig. 3. To elaborate the sequential execution of computing these keys in order to create clear picture for the reader, it is diagrammatically viewed as in Fig. 4.

Note that KI (a unique key identifier within the enhanced system) has to be carefully allocated, otherwise assigning the same KI to different UEs simultaneously may lead to authentication failure or denial of service. This is because the HSS has a possibility of accessing a wrong LTE K (K) instead of fetching the LTE K for intended UE. When new KI is assigned to UE from the pool of pre-defined numbers, the old KI will be released and kept ideal for defined amount of time without assigning to another UE. If the authentication procedure fails after a new KI is assigned (after authentication parameters are sent from HSS to MME) and before the new KI reaches to UE, the old KI is reallocated to UE’s LTE K in the HSS. Moreover, the state of each KI has to be stored within HSS.

Cell Radio Network Temporary Identifier (
                           
                              C
                              −
                              R
                              N
                              T
                              I
                           
                        ) is used as a unique and temporary identifier when UE is associated with a cell, which is assigned by network via RRC signals and transmitted with scheduling information in plain-text. It is also analyzed that there is a possibility to guess the new 
                           
                              C
                              −
                              R
                              N
                              T
                              I
                           
                         from old one [11,34]. In the legacy EPS handover security, the target eNB computes the 
                           
                              N
                              e
                              x
                              t
                              −
                              H
                              o
                              p
                              −
                              
                                 K
                                 eNB
                              
                           
                         and the 
                           
                              K
                              
                                 eNB
                              
                              *
                           
                         from the source eNB key K
                        eNB with 
                           
                              C
                              −
                              R
                              N
                              T
                              I
                           
                         as an input. As already mentioned, the source eNB can read a new 
                           
                              C
                              −
                              R
                              N
                              T
                              I
                           
                         that assigned to UE in a new cell and can compute the key 
                           
                              K
                              
                                 eNB
                              
                              *
                           
                        . The source eNB can also derive many other consecutive K
                        eNBs for eNBs that shall be visited by the UE in the future, hence forward security is does not hold.

To solve this security problem, the handover security protocol is enhanced, as the detail procedure of handover security solution is defined as described in Fig. 5
                        . When the measured report indicates that the decision making parameters are bellow threshold and the source eNB find that handover is needed, it sends a handover request to the target eNB. Receiving the request, the target eNB asks the MME for 
                           
                              K
                              
                                 eNB
                              
                              *
                           
                         to associate a security context with UE moving to the target eNB coverage area, where 
                           
                              K
                              
                                 eNB
                              
                              *
                           
                         is computed as 
                           
                              
                                 K
                                 
                                    eNB
                                 
                                 *
                              
                              
                                 =
                                 K
                                 D
                                 F
                                 (
                                 N
                                 e
                                 x
                                 t
                                 −
                                 H
                                 o
                                 p
                                 −
                                 K
                                 e
                                 N
                                 B
                                 ,
                              
                           
                         “eNBHanover” ∥ Physical cell id) for which 
                           
                              N
                              e
                              x
                              t
                              −
                              H
                              o
                              p
                              −
                              K
                              e
                              N
                              B
                              =
                              K
                              D
                              F
                              (
                              
                                 K
                                 ASME
                              
                              ,
                              
                                 K
                                 eNB
                              
                              ,
                           
                         “HN String”). The MME sends the computed key 
                           
                              K
                              
                                 eNB
                              
                              *
                           
                         to the target eNB to calculate 
                           
                              K
                              
                                 eNB
                              
                              
                                 *
                                 *
                              
                           
                         from which RCC and UP keys are derived. The source eNB has no means to access K
                        ASME and 
                           
                              N
                              e
                              x
                              t
                              −
                              H
                              o
                              p
                              −
                              K
                              e
                              N
                              B
                           
                         to generate next hop signaling and user plane data keys; hence, forward security problem is solved. The procedural execution of the solution is summarized as in the following steps:

                           
                              Step 1:
                              The Source eNB sends handover request to the target eNB. Know that MME and UE have stored value of 
                                    
                                       N
                                       e
                                       x
                                       t
                                       −
                                       H
                                       o
                                       p
                                       −
                                       K
                                       e
                                       N
                                       B
                                    
                                  = KDF (K
                                 ASME ∥K
                                 eNB, “NH String”).

The Target eNB requests a next hop key 
                                    
                                       K
                                       
                                          eNB
                                       
                                       *
                                    
                                  from MME for which MME sends 
                                    
                                       K
                                       
                                          eNB
                                       
                                       *
                                    
                                  = KDF (
                                    
                                       N
                                       e
                                       x
                                       t
                                       −
                                       H
                                       o
                                       p
                                       −
                                       K
                                       e
                                       N
                                       B
                                       ,
                                    
                                  “eNB Handover” ∥ Physical cell Id) in response to the request.

Computing 
                                    
                                       K
                                       
                                          eNB
                                       
                                       
                                          *
                                          *
                                       
                                    
                                  = KDF(
                                    
                                       
                                          K
                                          
                                             eNB
                                          
                                          *
                                       
                                       ,
                                    
                                  C-RNTI) and RRC as well as UP link keys from 
                                    
                                       
                                          K
                                          
                                             eNB
                                          
                                          
                                             *
                                             *
                                          
                                       
                                       ,
                                    
                                  target eNB sends a request acknowledgment to source eNB. RRC and UP link keys are generated as in Section 4.3 procedure number 10.

Using stored Next-Hop-KeNB, UE computes 
                                    
                                       K
                                       
                                          eNB
                                       
                                       *
                                    
                                  = KDF(
                                    
                                       N
                                       e
                                       x
                                       t
                                       −
                                       H
                                       o
                                       p
                                       −
                                       K
                                       e
                                       N
                                       B
                                       ,
                                    
                                  “eNB Handover” ∥ Physical cell Id), 
                                    
                                       N
                                       e
                                       x
                                       t
                                       −
                                       H
                                       o
                                       p
                                       −
                                       K
                                       e
                                       N
                                       
                                          B
                                          *
                                       
                                    
                                  = KDF (K
                                 ASME
                                 
                                    
                                       ∥
                                       
                                          K
                                          
                                             eNB
                                          
                                          *
                                       
                                       ,
                                    
                                  “NH String”), and 
                                    
                                       K
                                       
                                          eNB
                                       
                                       
                                          *
                                          *
                                       
                                    
                                  = KDF (
                                    
                                       
                                          K
                                          
                                             eNB
                                          
                                          *
                                       
                                       ,
                                    
                                  C-RNTI).

Finally, MME computes 
                                    
                                       N
                                       e
                                       x
                                       t
                                       −
                                       H
                                       o
                                       p
                                       −
                                       K
                                       e
                                       N
                                       
                                          B
                                          *
                                       
                                    
                                  = KDF (K
                                 ASME
                                 
                                    
                                       ∥
                                       
                                          K
                                          
                                             eNB
                                          
                                          *
                                       
                                       ,
                                    
                                  “NH String”) and then updates next hop key.

As it has already been explained, an attacker can entice a legitimate UE to camp on radio channel of false base station to redirect UE in order it connects to foreign network or to unintended network (see Section 2). In the Enhance-AKA,when the attach request message is delivered from UE to MME, the SNID is encrypted with other security parameters as:


                        
                           
                              E
                              (
                              M
                              −
                              I
                              D
                              ∥
                              I
                              M
                              S
                              I
                              ∥
                              S
                              N
                              I
                              
                                 D
                                 UE
                              
                              )
                              _
                              S
                           
                         and the message from MME to HSS includes 
                           
                              E
                              
                                 (
                                 M
                                 −
                                 I
                                 D
                                 ∥
                                 I
                                 M
                                 S
                                 I
                                 ∥
                                 S
                                 N
                                 I
                                 
                                    D
                                    UE
                                 
                                 )
                              
                              _
                              S
                              ∥
                              S
                              N
                              I
                              
                                 D
                                 MME
                              
                              ,
                           
                         where S is a key derived from the pre-shared key K and the E is an encryption algorithm shared between USIM and AUC/HSS.

This enables HSS to compare the SNIDUE sent from UE and SNIDMME from MME as follows:

                           
                              
                                 
                                    
                                       
                                          
                                             S
                                             N
                                             I
                                             
                                                D
                                                UE
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             E
                                             (
                                             E
                                             
                                                (
                                                M
                                                −
                                                I
                                                D
                                                ∥
                                                I
                                                M
                                                S
                                                I
                                                ∥
                                                S
                                                N
                                                I
                                                
                                                   D
                                                   UE
                                                
                                                )
                                             
                                             _
                                             S
                                             )
                                             _
                                             S
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             ?
                                             S
                                             N
                                             I
                                             
                                                D
                                                MME
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             E
                                             
                                                (
                                                M
                                                −
                                                I
                                                D
                                                ∥
                                                I
                                                M
                                                S
                                                I
                                                ∥
                                                S
                                                N
                                                I
                                                
                                                   D
                                                   UE
                                                
                                                )
                                             
                                             _
                                             S
                                             ∥
                                             S
                                             N
                                             I
                                             
                                                D
                                                MME
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

If SNIDUE and SNIDMME are the same, HSS knows that the access network is the intended network which the UE wants to connected to. Accordingly, in the case of proposed scheme, HSS can easily identify the network to which the UE is looking for accessing, where as in the legacy AKA or other proposed protocols, there is no means (UE doesn’t include the SNID of the network) for the HSS to verify the ID of the intended network or the SNIDMME is sent in plaintext, which enables an intruder to replace or replay it. In the Enhanced-AKA, even though one can modify SNIDMME, because of ciphering and freshness of Key S, one cannot replay or replace the SNIDUE and therefore, the new protocol unquestionably resists redirection attack; hence, device that has a capability of base station cannot emulate the UE. On the other hand, a false base station cannot disguise a legitimate user to establish connection with legitimate base station because the ciphered identity of mobile station (
                           
                              M
                              −
                              I
                              D
                           
                        ) and IMSI is included in the message by which the network verifies the legitimacy of the UE by comparing actual identity of sender with that of encrypted values.

As there are many instances through which IMSI is disclosed due to unprotected transmission of it, one can track a path of a user to launch an attack in the EPS-AKA (i.e. privacy does not hold). To minimize a frequent transmission of IMSI on unprotected medium, TMSI was proposed; however, it could not totally solve the problem in some cases for which IMSI necessarily be sent over insecure network, unless Public Key Infrastructure is implemented. Relying on Public Key Infrastructure technically results computational while it incurs cost. In addition to this, allocating TMSI dynamically has brought computational load and resource consumption. As a solution to this, the Enhanced-AKA comes up with new key identifier (KI) which would be assigned uniquely to UE’s K or points to K in the home network. This parameter is used to compute a key S as 
                           
                              
                                 f
                                 ′
                              
                              
                                 (
                                 K
                                 I
                                 )
                              
                              _
                              K
                           
                         and also functions as TMSI, where f′ is a crypto-function shared as secret between UE and HSS and K is LTE K.

Ciphering as 
                           
                              E
                              (
                              M
                              −
                              I
                              D
                              ∥
                              I
                              M
                              S
                              I
                              ∥
                              S
                              N
                              I
                              D
                              )
                              _
                              S
                           
                         during attach request or as X(IMSI∥Count) under S for other situations (e.g. AVs synchronization failure), a UE transmits IMSI over a network each time it has to be communicated so as to hide the path of the user, hence privacy holds. For the sake of protecting replay attack or DOS attack, `Count’ is incremented each time the IMSI is sent over network except for attach request. While assigning KI from a pool of pre-defined numbers to UE’s Key K, the system possibly has three alternative states to store the numbers i.e. assigned, unassigned and released, this is to avoid allocating the same number for different UEs simultaneously. Only a number with unassigned state can be allocated to UEs’ Keys. To be assigned, a number with released state waits at least for time `t’ greater than time taken for authentication token to reach from HSS to UE. This is a solution for a scenario in which an authentication probably fails before the newly assigned KI(in the HSS) reaches to UE so that HSS re-allocates the old KI to UE’s Key K. Unless and other wise, the KI can be assigned to other UE’s K that comes immediately after the former UE for authentication before it (the former) receives the new one. Storing the new KI, MME identifies whether there is security context already defined, and authentication parameters generated within serving network. Newly assigned KI is multi-casted /Updated to each UIM with the same K (LTE K) not to have different KIs.

A denial of service attack may be launched by sending large number of pre-stored IMSI s to cause massive attachment requests those results in bandwidth congestion and computational load in the legacy system. Despite the difficulty of solving all denial of service problems, the enhanced scheme mitigates through encrypting the IMSI. Even if the attacker has a chance to access the IMSI of a UE, it cannot encrypt it to replay. It may replay the attach message 
                           
                              E
                              
                                 (
                                 M
                                 −
                                 I
                                 D
                                 ∥
                                 I
                                 M
                                 S
                                 I
                                 ∥
                                 S
                                 N
                                 I
                                 D
                                 )
                              
                              _
                              S
                              ∥
                              R
                              A
                              N
                              
                                 D
                                 UE
                              
                              ∥
                              K
                              I
                              ∥
                           
                         UE Security Capability) as a whole or the message 
                           
                              X
                              (
                              I
                              M
                              S
                              I
                              ∥
                              C
                              o
                              u
                              n
                              t
                              )
                              _
                              S
                           
                         sent for partial authentication purpose. In the former case, the key S by which the replayed message is encrypted is old, whereas the S at HSS is updated; thus, HSS can easily verify and reject the request without processing security parameters. Accordingly, the bandwidth is easily released while computational power/ capacity is saved. In the case of 
                           
                              X
                              (
                              I
                              M
                              S
                              I
                              ∥
                              C
                              o
                              u
                              n
                              t
                              )
                              _
                              S
                              ,
                           
                         the `Count’ variable is incremented each time IMSI is transmitted, hence an attacker cannot replay it to cause denial of service. RAND
                        UE can be encrypted to protect the random number from modification which may turn out to denial of service.

As the number of device that a subscriber may use to connect to a network increases, a service provider may want to issue a UIM for each of the subscriber’s devices, where each UIM has the same shared secret key. It is stated under problem statements section that there is an attack scenario due to multiple UIMs with the same shared-secret key K. An adversary can cause two or more devices to have the same CK and IK by replaying AUTH and RAND sent from MME to one of these devices (UIMs) in the conventional EPS AKA (read Section 4 more detail). This security gap is ‘filled up’ by enabling both UE and MME to generate random number so as to contribute for the randomness of the authentication parameters. For instance, a device D1 sends a request to MME for attachment/authentication with RAND
                        UE-D1. Fetching S∥KI∥IMSI from HSS (if the request is for the first time) or from its own database, the MME generates another random number RAND
                        MME and then computes MAC, XRES, CK, IK and AK, where

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             M
                                             A
                                             C
                                             =
                                             
                                                f
                                                1
                                             
                                             
                                                (
                                                S
                                                Q
                                                N
                                                ∥
                                                R
                                                A
                                                N
                                                
                                                   D
                                                   MME
                                                
                                                ∥
                                                A
                                                M
                                                F
                                                ∥
                                                K
                                                I
                                                ∥
                                                S
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             X
                                             R
                                             E
                                             S
                                             =
                                             
                                                f
                                                2
                                             
                                             
                                                (
                                                R
                                                A
                                                N
                                                
                                                   D
                                                   MME
                                                
                                                ∥
                                                S
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             A
                                             K
                                             =
                                             
                                                f
                                                5
                                             
                                             
                                                (
                                                R
                                                A
                                                N
                                                
                                                   D
                                                   MME
                                                
                                                ∥
                                                S
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             I
                                             K
                                             =
                                             
                                                f
                                                4
                                             
                                             
                                                (
                                                R
                                                A
                                                N
                                                
                                                   D
                                                   
                                                      UE
                                                      −
                                                      D
                                                      1
                                                   
                                                
                                                ∥
                                                S
                                                )
                                             
                                             
                                             &
                                             
                                             C
                                             K
                                             =
                                             
                                                f
                                                3
                                             
                                             
                                                (
                                                R
                                                A
                                                N
                                                
                                                   D
                                                   
                                                      UE
                                                      −
                                                      D
                                                      1
                                                   
                                                
                                                ∥
                                                S
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

MME sends AUTN(SQN⊕AK ∥ AMF∥MAC) and RAND
                        MME to UE. Receiving these to parameters, UE computes its own CK, IK, XMAC, RES and other keys. Here after, a device D2 having another UIM with same key K requests for authentication by sending new RAND
                        UE-D2 that is generated by itself. Consequently, an attacker intercepts the request and replays the AUTH and RAND
                        MME, which was sent to Device D1. The D2 computes the same XMAC, RES and AK with D1 but different IK and CK because the RAND
                        UE-D1 that the D1 used to generate IK and CK is different from what D2 is using, hence the attacker cannot be successful. i.e. 
                           
                              I
                              K
                              =
                              
                                 f
                                 4
                              
                              
                                 (
                                 R
                                 A
                                 N
                                 
                                    D
                                    
                                       UE
                                       −
                                       D
                                       2
                                    
                                 
                                 ∥
                                 S
                                 )
                              
                           
                        &, 
                           
                              C
                              K
                              =
                              
                                 f
                                 3
                              
                              
                                 (
                                 R
                                 A
                                 N
                                 
                                    D
                                    
                                       UE
                                       −
                                       D
                                       2
                                    
                                 
                                 ∥
                                 S
                                 .
                                 )
                              
                           
                        
                     

In the legacy EPS AKA, man in the middle is still problem (see Fig. 1). This can happen when an intruder sends an attachment/authentication request using a legitimate UE’s IMSI to receive authentication token and random number. After storing the token, the intruder waits until the legitimate UE sends a request to MME. Once the genuine UE sends a request, an intruder intercepts the request and sends the stored token to UE. Thinking as if it receives the token from MME, the UE sends RES back to the intruder and then the intruder send RES to MME in response to the token sent initially, in order to be authenticated by the network. As the result of this, the network is tricked to authenticate the intruder. This is simply mitigated in the Enhance-AKA by including UE’s identity (
                           
                              M
                              −
                              I
                              D
                           
                        ) in the request and encrypting the request message in which the intruder cannot cipher the request message due to lack of key S. It may try to launch replay attack using attach request message of the legal user. In this case, from 
                           
                              E
                              (
                              M
                              −
                              I
                              D
                              ∥
                              I
                              M
                              S
                              I
                              ∥
                              S
                              N
                              I
                              D
                              )
                              _
                              S
                           
                        ,the server knows to whom the included identity (
                           
                              M
                              −
                              I
                              D
                           
                        ) belongs by comparing the actually address or identity of the sender(
                           
                              M
                              −
                              I
                              D
                           
                        ) attached to the message with that of ciphered 
                           
                              M
                              −
                              I
                              D
                           
                        . If the identities are different, the server verifies that someone is falsifying the identity of legitimate user. Moreover, each time the 
                           
                              E
                              (
                              M
                              −
                              I
                              D
                              ∥
                              I
                              M
                              S
                              I
                              ∥
                              S
                              N
                              I
                              D
                              )
                              _
                              S
                           
                         is sent, a key S is fresh to protect against replay attack.

In the legacy AKA, bandwidth consumption and authentication signaling overhead between the serving network (foreign network) and the home network (HN) is one of the problems. This is because of the serving network (SN) that must go back to the HN for a request of another set of authentication vectors (AVs) when the UE stays in the SN for a long period and exhausts its set of AVs for the authentication. In the case of Enhanced-AKA this is optimized by enabling the MME to generate the AVs by itself without going back to HSS. Once the UE is registered in the serving network, no need of requesting the HSS for authentication vector since RAND is generated by MME and the key S (from which AVs are generated) reside in the serving network.

The existing EPS AKA and all other schemes are fully dependent on the secrecy of a single key K (LTE K), pre-shared secret key between authentication center and mobile station (UE). Once, this key is compromised, every key can be retrieved and possibly an adversary can be authenticated by the network. Taking this in to consideration, the new proposed protocol introduces a shared secret crypto-function (f′) concept, which is recommended to be one-way function. The dynamic key S, used to generate authentication tokens, authentication response, CK and IK, is derived from the pre-shared key K (
                           
                              S
                              =
                              
                                 f
                                 ′
                              
                              
                                 (
                                 K
                                 I
                                 ∥
                                 K
                                 )
                              
                           
                        ) using the function f′. Because the function f′ is secret and also one has to know KI, an adversary who may compromise the original key cannot derive the key S. Moreover, because of irreversibility property of one-way function f′, an adversary who may be successful in knowing S and f′ cannot retrieve K.

As it is illustrated under ‘Solution to Handover Procedure’ Section, when the source eNB find that handover is needed, it sends a handover request to the target eNB. Receiving the request, the target eNB asks the MME for 
                           
                              K
                              
                                 eNB
                              
                              *
                           
                         to have a security context with UE moving to its coverage area, where 
                           
                              K
                              
                                 eNB
                              
                              *
                           
                         is computed as:


                        
                           
                              
                                 K
                                 
                                    eNB
                                 
                                 *
                              
                              
                                 =
                                 K
                                 D
                                 F
                                 (
                                 N
                                 e
                                 x
                                 t
                                 −
                                 H
                                 o
                                 p
                                 −
                                 K
                                 e
                                 N
                                 B
                              
                           
                        , “eNBHanover''∥ Physical cell id) for which 
                           
                              N
                              e
                              x
                              t
                              −
                              H
                              o
                              p
                              −
                              K
                              e
                              N
                              B
                              =
                              K
                              D
                              F
                              (
                              
                                 K
                                 ASME
                              
                              ,
                              
                                 K
                                 eNB
                              
                              ,
                           
                         “HNString”).

The MME sends the computed key 
                           
                              K
                              
                                 eNB
                              
                              *
                           
                         to the target eNB to calculate 
                           
                              K
                              
                                 eNB
                              
                              
                                 *
                                 *
                              
                           
                         from which RRC and UP keys are derived. Although it has K
                        eNB, because 
                           
                              N
                              e
                              x
                              t
                              −
                              h
                              o
                              p
                              −
                              K
                              e
                              N
                              B
                           
                         (derived from a key K
                        ASME which is secret to eNB) is computed and stored in MME, the source eNB cannot derive 
                           
                              K
                              
                                 eNB
                              
                              *
                           
                         and other keys for consecutive handover by any means. Therefore, forward and backward security goals are achieved with in Enhanced-AKA whereas forward security is not met in the conventional AKA because MME sends 
                           
                              N
                              e
                              x
                              t
                              −
                              H
                              o
                              p
                              −
                              K
                              e
                              N
                              B
                           
                         to eNB. This enables eNB to compute 
                           
                              K
                              
                                 eNB
                              
                              *
                           
                         and subsequently derives the key 
                           
                              K
                              
                                 eNB
                              
                              
                                 *
                                 *
                              
                           
                        .

One of the most important security property that have to be met by key exchange or key agreement protocols is perfect forward security (secrecy). This property holds if an intruder cannot compromise session key(s) of previous sessions so that the past exchanged messages are securely locked, even if he learns long-term keys of the communicating parties. In the conventional protocol, Integrity Key (IK) and Ciphering Key (CK), which we use as input parameter with random number RAND for key derivation function to derive a local master K
                        ASME, is generated from a long-term key K. Hierarchically, NAS control signaling integrity and ciphering keys (K
                        NASint
                        
                           
                              &
                              
                                 K
                                 NASenc
                              
                           
                        ), K
                        eNB, AS signaling keys (K
                        RRCint, K
                        RRCenc), and user plane data ciphering key (K
                        UPenc) are derived from KASME by using key derivation function 
                           
                              H
                              M
                              A
                              C
                              −
                              S
                              H
                              A
                              −
                              256
                              (
                              k
                              e
                              y
                              ,
                              m
                              e
                              s
                              s
                              a
                              g
                              e
                              )
                           
                        . Once an adversary compromises the long-term key K, Keeping a profile of UE, he can regenerate the above all session keys; hence, perfect forward security is not guaranteed. In case of Enhanced-AKA, the long term key K is not directly used to generate the session keys, rather it is used to compute a dynamic key S (
                           
                              S
                              =
                              
                                 f
                                 ′
                              
                              
                                 (
                                 K
                                 ∥
                                 K
                                 I
                              
                           
                        )) under a secret one-way key derivation function f′ in which S is the key to generate the above sub-sequential session keys. An f′ function can be as simple as g
                        
                           K∥KI
                        
                        mod n, where g is a group generator and n is large prime number. An adversary who may learn the long-term key Kcannot compute session keys because of the frequently changed Key S as well as the secrecy of the one way key derivation function f′ and also RAND
                        MME and RAND
                        UE from which session keys are generated, can optionally be encrypted under S. Thus, perfect forward security holds for our protocol.

Coming up with different solutions, many researchers have contributed to the evolved packet system security. Lee et al. [18] proposed scheme in which the UE is known to home or the authentication request is sent to home network through TMSI aiming to reduce the exposure of IMSI. The protocol is successfully completed with five rounds of message exchange between the authentication entities for which mobile station and foreign network generate a random numbers so that it can contribute to the randomness of the security parameters. A temporary key (TK), which computed from random number sent from mobile station to HSS through FN, is used to derive authentication token in the foreign network. This key TK would be sent from Home network to FN. The scheme satisfies most of the security requirements of EPS, however it is found to be suspicious to some attackers and lack of privacy. In EPS network or in networks defined under 3GPP, there is at least one chance to transmit IMSI over network in plain text. For instance, during roaming among PLMNs, the mobile station should execute a location registration procedure in order to obtain TMSI for which IMSI is necessarily sent because TMSI is only known and allocated dynamically with in a network where UE is being served. In addition to this, in case where TMSI is not recognized or cannot be tracked back to the network element that has assigned it to UE, the serving network needs to obtain IMSI from UE using identification procedure before new TMSI is allocated. The mentioned protocol doesn’t consider these scenarios; hence privacy of a user is not fully protected in the scheme. Moreover, there is a chance by which a man in the middle attack can happen simply by relaying the messages exchanged between foreign network and UE/mobile station. Still a single key problem is also the security hole for this scheme.
                  

A hybrid authentication and key agreement scheme based on trusted model plat form and public key infrastructure for fourth generation mobile network was contributed in [14] that could provide considerable robustness for mobile network security. As one of the features, passwords are associated with figure print and public key to achieve mutual authentication between UE and HSS through trusted model platform. Practically, due to the introduction of trusted model and public key infrastructure, there is huge cost in building these facilities, which is draw back in terms of security economic. Similarly, [5,14,20,25] proposed public key base schemes having goals such as optimizing energy consumption, overcoming vulnerabilities found in the legacy system and thus can achieve mutual authentication between the UE and HSS in which some of these protocols used eclipse curve ciphering as solution. Again, these all schemes contribute for computational cost, initial cost, storage cost, communication cost, also has vulnerabilities such as single key problem and multiple UIMs attack scenario.

In scheme [32], an EAP-Archie method was introduced so as to provide access layer security in the LTE networks by using the AES ciphering with a goal of mutual authentication and key agreement between the users and the network access layer. However, this scheme is susceptible to the same vulnerabilities as the EPS AKA protocol that cannot protect the LTE network against the disclosure of the user identity and spoofing attacks. The scheme [29] significantly optimizes the authentication signaling between the serving network and the home network to fetch authentication vectors, and thus reduces the bandwidth consumption at the HSS. Nevertheless, the protocol adds a burden to the MME because a large number of AVs has to be generated at the MME. Moreover; it can only enhance the efficiency of the authentication procedure, while the security problems that exist in the EPS-AKA protocol are still there. Lai et al. (2012) [17] and Lai et al. (2013) [16] have introduced an handover authentication protocol between eNBs and group authentication protocol respectively. The protocols are efficient in mitigating threats found with in the conventional protocol;however, they are resulted in some other gaps. For instance, a single key problem is not resolved in both protocols. Lai et al. (2012) does not solve multiple UIMs problem where as, Lai et al. (2013) does not support if multiple UEs initiate the initial authentication request simultaneously. In addition to this, Lai et al. (2012) introduces Public Key Infrastructure cost, storage overhead, bandwidth consumption overhead(as shown in Section 6) and totally changes the software implementation of the conventional protocol. As compare to the above-mentioned schemes and other protocols that are considered under related work section in its part, the scheme that the author are proposing takes advantages over others in terms of problems in the legacy system and in terms of analyzed problems with respect to different proposals.

As main concern of this comparison section, the analysis results of the Enhanced-AKA and the EPS AKA is demonstrated in such a way that can show the enhancements. under the determined section, the formal verification results are indicated where as a summarized comparison of the legacy authentication and key agreement system with the Enhanced-AKA will be presented in tabular form later. The improved scheme is found safe under all backbends (OFMC, CL-AtSe, TA4SP and SATMC) of AVISPA tool [7]; however three of them are demonstrated in Fig. 6 due to space limitation.

As of this paper, AVISPA is the most analytical high-level security protocol specification and verification tool by considering almost all attacks on network security protocols. The indication of the keyword, ’SAFE’ or ’NO ATTCK FOUND’, is that the new protocol achieves goals specified under goal declaration simulation and resistant against automatically created attacks by AVISPA tool.

As far as the conventional EPS AKA is concerned, the verification results in all the backbends (only one of them is shown here) show that the scheme is UNSAFE with the respect to the defined goals and under simulation attacks created against the protocol. Fig. 7
                        (a) shows an intruder can reach to parameters that are supposed to be secret and the protocol doesn’t protect the access network from attacks such as man in the middle and replay attacks.

As one can easily understand, the intruder can trick to be authenticated by the access network by intercepting the request from mobile station since the intruder is the network. As shown in Fig. 7(b), the intruder intercepts the IMSI of the legitimate user and sends the identity to the server by attaching its own address or local identity, while the mobile station requests for an access. The server responds by sending authentication message together with authentication token. In the case of existing security protocol, as a consequence of single key problem, the long term key K can be compromised by an adversary using some known attacks. Accordingly, the intruder can simply compute a response message (RES) and then authenticated by serving network. Even if the key is kept secret, as illustrated under man in the middle attack, the intruder can forge the identity of the mobile station by intercepting and replaying the messages from the subscribed user. Hence, the intruder can authenticate the mobile station to itself (see Fig. 7c). But, the proposed scheme has answer to the problems of the legacy system i.e. it is resistant to these attacks as it is verified under the same environment and analyzed under Security Analysis Section.

The evaluation that has been conducted under OPNET simulation indicates that the there is also advancement in the new protocol in terms of band width consumption, memory usage, HSS delay as well as end to end delay. Fig. 8
                        (a) and (b) clearly demonstrate the improvement made to be happened for two simulation durations, where the HSS is more loaded in the EPS AKA due to the fact that the MME goes to HSS to fetch authentication vector.
                     

The bits imposed on the home network due to the requests for authentication vector in the conventional protocol is indicated in the figure. The load of the server is reduced by the amount of load (bits/sec) difference of the two systems, when the improved protocol is deployed in place of the existing one. The packet delay due to AVs transmission, propagation, queuing, and processing with in HSS is shown in Fig. 8(c) and (d) as a sum up of delays occurred due to authentication vectors that fetched from the home network. The Enhanced-AKA (blue color) and EPS AKA (red color) end-to-end delay simulation result, from which we can simply compute the difference, is illustrated. The difference of the two graphs is the total delay introduced due to fetching AVs from the HSS. Conclusively, the improved protocol has a performance enhancement over the conventional protocol.

To analyze the bandwidth consumption and transmission overhead of the EPS AKA and Enhanced-AKA, a fluid mobility model is customized in its simplest form. The model is formulated, as the amount of traffic flow out of certain region is directly proportional to the density of population within the region, average speed of a user with respect to direction (v), and the length (L) of registration area boundary. Assuming the direction of movement is uniformly distributed over [0, 2π] and also users are uniformly populated with a density of ρ, the rate of registration area crossing is given by:

                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             R
                                             =
                                             
                                                
                                                   ρ
                                                   v
                                                   L
                                                
                                                π
                                             
                                          
                                       
                                    
                                 
                              
                           
                        In analyzing the fluid flaw mobility model [24], the following assumptions (see Table 1) were made by the researchers which we also consider to evaluate the bandwidth consumption of the protocols.

Based on the above assumptions, one can simply compete rate of mobile station (arrival rate of mobile station for registration per registration area) crossing a registration area as indicated below:


                        
                           
                              R
                              =
                              (
                              30.3
                              
                              km
                              ×
                              5.6
                              
                              km
                              /
                              sec
                              ×
                              390
                              /
                              
                                 sqr
                                 .
                                 km
                              
                              )
                              /
                              3600
                              π
                           
                         = 5.85 mobile stations/sec, where deregistration rate is equal to registration rate. Hence, the total number of mobile stations requesting for registration or attachment per second with in serving network, which is equivalent to the number of mobile stations requesting authentication for registration per second, is calculated as:
                        
                     


                        
                           
                              
                                 R
                                 total
                              
                              =
                              R
                              ×
                           
                         Total Registration area per Serving network. = 5.85 mobile station/sec 
                           
                              ×
                              128
                              =
                              748.8
                              /
                              sec
                           
                        
                     

This is the arrival rate of mobile stations for registration at serving network that need to be authenticated. The MME should therefore be able manage the location area update for 749 mobile stations/sec, which in turn need authentication in order to get attached to the serving network. Depicting the bit size of authentication parameters as in Table 2, we can calculate bandwidth consumption for each mobile station (UE) from authentication request arrival rate(Rtotal).

Total bandwidth (BW) = total size of Auth message*Auth request/sec.

For the fact that a bandwidth consumption of the proposed protocol is optimized for the authentication message transmission between serving network (MME) and home network (HSS), we have found that computing the bandwidth utilization between the two entities is pretty enough to show the improvement. Accordingly, the bandwidth consumption for the existing and the enhanced protocols is revealed as follows:

                           
                              i.
                              Total bit size of message transmitted between MME and HSS for conventional protocol is the sum of the message sent while requesting authentication vector (AV) and the authentication vectors itself.

Size of message = SNID + IMSI + [AV (RAND + XRES + AUTN + KASME)]*n = 48 + +128 + 128 + 32 + 128 + 256 = 720 bits*5 =3600 bits, where number of AV n is assumed to be 5. From this, BW = 3600 bits*748.8/sec = 2.57 Mbits/sec

During initial attachment to new serving network, except the difference in size of message transmitted between the two entities (MME&HSS), the number of round for requesting authentication vector is similar in both existing and proposed protocols. Hence, the bit size of message between MME and HSS for enhanced protocol is the sum of message sent while requesting for authentication and message sent in response to the request.

i.e. Size of message = 2*SNID + 2*KI + IMSI + M-ID + RANDUE + S = 2*48 + 2*128 + 128 + 32 + 128 + 128 = 768 bits.

Note that if the UE is already registered in the serving network and has security association, this message size is zero for the new protocol because MME generates AV by itself, where as in the conventional protocol there is a communication cost when the AVs for the UE is exhausted.

BW = 768 bits* 748.8/sec = 0.548 Mbits/sec

The above results, which show a 79% reduction of bandwidth consumption, are computed with an assumption that for all authentication request arrivals, authentication vectors are supposed to be fetched; however, in case of authentication request for mobile stations which has obtained a registered security context, there is no need of fetching AV (in case of conventional protocol there is a possibility of fetching when it is exhausted). In other meaning, from the authentication request arrival rate of 748.8/sec, certain amount of the requests are sent to home network for AV provision. To elaborate the bandwidth consumption for different AV requests arrival rate, we illustrate as it is shown in Fig. 9 with different number of authentication vector depending on the fluid flaw mobility model.

In the preceding analytical results; call origination, call termination and handover request arrivals for authentication are not included, in which considering these requests obviously increases the bandwidth consumption of the conventional protocol (unlike the enhanced protocol) during AV exhaustion. As one can understand from Fig. 9(a)–(d) for all number of AVs, the maximum request arrival rate is 748.8 assuming all requests that arrive at serving network(MME) need authentication Vectors from home network (HSS). To show the bandwidth consumption, it is also computed for different arrival rates that are received by the HSS when the arrival rate of HSS is less than arrival rate of MME. Because of absence of AVs fetching, for different number of vectors, the enhanced scheme bandwidth consumption is steady.

To compare the bandwidth consumption of Enhanced-AKA and SE-AKA [16], we compute the message overhead for the whole mutual authentication. This is because the schemes follow different approaches with different size of messages except that their number of messages are the same. Let assume UEs with in one registration area are categorized as one authentication group of SE-AKA and with in a registration area there are number of sub-nets to which a UE handovers. The messages are denoted as follows:

                           
                              •
                              M1: Authentication request message sent from UE to MME.

M2: Authentication vector (AV) request message sent from MME to HSS.

M3: Authentication vectors sent from HSS to MME.

M4: Authentication token sent from MME to UE.

M5: Authentication response sent from UE to MME.

The bandwidth (BW) consumption varies depending on whether the HSS is involved or not. In Enhanced-AKA, HSS is involved only when the UE is registered to the serving network for the first time, where as in the SE-AKA, HSS is involved when the first UE of a group is registered to the serving network for the first time. i.e.involvement of HSS is required when there is no available AV and not required when AV is available.

                           
                              i.
                              Initial Authentication (No available AV): bandwidth consumption is the sum up of the bit size of the five messages multiplied by authentication request rate/sec.

M1 = SNID + KI + IMSI + M-ID + RANDUE.

M2 = 2*SNID + KI + IMSI + M-ID + RANDUE.

M3 = KI + S.

M4 = KI + RANDMME + AUTH.

M5 = RES.

From the assumptions in Table 1, there are 128 registrations areas per serving network which is equivalently 128 authentication groups of SE-AKA scheme. For each group, there is one UE that completes the full authentication procedure to fetch authentication vectors for the group, while the others UEs send M1, M5 and receive M4. Thus, the bandwidth for SE-AKA is calculated as indicated below:

                           
                              (3)
                              
                                 
                                    
                                       
                                          BW
                                       
                                       
                                          =
                                       
                                       
                                          
                                             128
                                             /
                                             
                                                
                                                   sec
                                                
                                                *
                                             
                                             
                                                ∏
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                5
                                             
                                             
                                                M
                                                (
                                                i
                                                )
                                             
                                             +
                                             
                                                
                                                   (
                                                   748.8
                                                   --
                                                   128
                                                   )
                                                
                                                *
                                             
                                             
                                                (
                                             
                                             
                                                M
                                                1
                                             
                                             +
                                             
                                                M
                                                4
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                M
                                                5
                                             
                                             −
                                             
                                                MAC
                                                Gj
                                             
                                             −
                                             
                                                T
                                                
                                                   G
                                                   j
                                                
                                             
                                             
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              MAC
                              
                                 G
                                 j
                              
                           
                         is the bit size of the jth group message authentication code and it is the same in bit size for all groups and authentication request rate per second per serving network is 748.8 as in Eq. (1). The bit size for each message of SE-AKA [16] for which the bit size for each security primitives is indicated in Table 3
                        , is as follows:

                           
                              M1 = 
                                    
                                       
                                          ID
                                          
                                             G
                                             j
                                          
                                       
                                       +
                                       
                                          TID
                                          
                                             ME
                                             +
                                             
                                                R
                                                ME
                                             
                                          
                                       
                                       +
                                       
                                          MAC
                                          
                                             G
                                             j
                                          
                                       
                                       +
                                       
                                          T
                                          
                                             G
                                             j
                                          
                                       
                                       ,
                                    
                                  where j is group number.

M2 = 
                                    
                                       
                                          ID
                                          
                                             G
                                             j
                                          
                                       
                                       +
                                       
                                          TID
                                          
                                             ME
                                             +
                                             
                                                R
                                                ME
                                             
                                          
                                       
                                       +
                                       
                                          MAC
                                          
                                             G
                                             j
                                          
                                       
                                       +
                                       
                                          T
                                          
                                             G
                                             j
                                          
                                       
                                       +
                                       LAI
                                    
                                 
                              

M3 = 
                                    
                                       
                                          R
                                          
                                             HSS
                                             +
                                             
                                                R
                                                ME
                                             
                                          
                                       
                                       +
                                    
                                  AMF + 748.8/128
                                    
                                       (
                                       
                                          SV
                                          
                                             ME
                                             +
                                             
                                                TID
                                                ME
                                             
                                          
                                       
                                       )
                                       .
                                    
                                 
                              

M4 = 
                                    
                                       
                                          ID
                                          MME
                                       
                                       +
                                       
                                          ID
                                          
                                             G
                                             j
                                          
                                       
                                       +
                                       
                                          TID
                                          ME
                                       
                                       +
                                       
                                          MAC
                                          MME
                                       
                                       +
                                       
                                          R
                                          HSS
                                       
                                       +
                                       
                                          R
                                          MME
                                       
                                       +
                                       
                                          R
                                          ME
                                       
                                       +
                                       AMF
                                       +
                                       
                                          aP
                                          .
                                       
                                    
                                 
                              

M5 = 
                                    
                                       
                                          MAC
                                          ME
                                       
                                       +
                                       bP
                                       .
                                    
                                 
                              

AV available in the serving network/Registered UE: In both Enhanced-AKA and SE-AKA, once the UE is registered in the network and fetches AV, no need of going back to HSS for fetching AV i.e. during intra-domain handover authentication and session authentication, only UE and MME involved in the authentication execution. To compute the bandwidth consumption of these two authentication, one has to know their request arrival rate. From [21], we know that intra-domain handover authentication request rate, λ
                                 1 is expressed as:

Session authentication request arrival rate, λ
                        2, is equal to the call arrival rate of a UE [20].

                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                λ
                                                2
                                             
                                             =
                                             
                                                λ
                                                u
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Bandwidth consumption for Enhanced-AKA is computed as:

                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             BW
                                             =
                                             
                                                
                                                   (
                                                   
                                                      λ
                                                      1
                                                   
                                                   +
                                                   
                                                      λ
                                                      2
                                                   
                                                   )
                                                
                                                *
                                             
                                             
                                                (
                                                
                                                   M
                                                   1
                                                
                                                +
                                                
                                                   M
                                                   4
                                                
                                                +
                                                
                                                   M
                                                   5
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Bandwidth consumption for SE-AKA is expressed as:

                           
                              (7)
                              
                                 
                                    
                                       
                                          BW
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      λ
                                                      1
                                                   
                                                   +
                                                   
                                                      λ
                                                      2
                                                   
                                                   )
                                                
                                                *
                                             
                                             
                                                (
                                                
                                                   M
                                                   1
                                                
                                                +
                                                
                                                   M
                                                   4
                                                
                                                +
                                                
                                                   M
                                                   5
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                             
                                                
                                                   (
                                                   
                                                      λ
                                                      1
                                                   
                                                   +
                                                   
                                                      λ
                                                      2
                                                   
                                                   )
                                                
                                                *
                                             
                                             
                                                (
                                                
                                                   MAC
                                                   
                                                      G
                                                      j
                                                   
                                                
                                                +
                                                
                                                   T
                                                   
                                                      G
                                                      j
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In general, from the Eqs. (2)–(7), the bandwidth consumption of Enhanced-AKA and SE-AKA is comparatively shown in Fig. 10
                         and 11
                         assuming 
                           
                              
                                 λ
                                 u
                              
                              =
                              8.7
                              /
                              sec
                           
                        /registration area [24] and Pr =1, because we assume that the call originates and terminates before moves out of the network domain. 
                           
                              
                                 
                                    N
                                    a
                                 
                                 ¯
                              
                              =
                              10
                           
                        .
                     

As the memory consumption of the newly proposed protocol is concerned, the storage overhead incurred due to the introduced new features is the bit size for representing secret key derivation function f′ and pre-defined encryption algorithm E which are stored in UE and HSS. To represent f′ and E by an algorithm or function distinguish-er on memory, it can be a matter of eight and three bits respectively where as KI replaces the Temporary Mobile Subscriber Identity (TMSI); and hence would not be taken as memory overhead in relative to the existing protocol. In contrary to the proposed scheme, the authentication vectors for each UE are stored in the serving network by a rate of 3.9 Mbits/sec [
                           
                              RAND
                              +
                              XRES
                              +
                              AUTN
                              +
                              
                                 K
                                 ASME
                              
                              =
                              
                                 
                                    (
                                    128
                                    +
                                    32
                                    +
                                    128
                                    +
                                    256
                                    )
                                 
                                 *
                              
                              748.8
                              /
                              
                                 
                                    sec
                                 
                                 *
                              
                              10
                           
                        ] in the conventional protocol, where number of vectors is 10 and the authentication request arrival rate and authentication vector request rate are assumed to be equal. As the number of authentication vectors increases, the memory consumption overhead of the conventional protocol increases proportionally and the memory consumption is predominantly large for large period of time. In the enhanced protocol, there is no need of storing authentication vector because it is generated locally during the execution of authentication procedure, thus it significantly optimizes this memory overhead. As compare to SE-AKA storage overhead, here also our protocol has an improvement over the scheme. From UE memory perspective, SE-AKA introduces additional two keys, 
                           
                              GK
                              
                                 G
                                 j
                              
                           
                         (128 bits) and PUBHN (1024 bits) that to be stored in UE on the top of conventional keys. In Enhanced-AKA, only bits (maximum 16bits) needed to represent the two algorithms (f′ & E) are added as additional bits as mentioned above. Again, SE-AKA results in storage overhead to the serving network to store group information of huge size, where as our protocol eliminates an overhead to store authentication vectors in the serving network.

The two sources of requirements for EPS security: [TS22.278] [3] and [TS33.401] [4] provides high-level service-related requirements, security requirements, and Privacy requirements with implementation. Accordingly, one can generalize the high-level security requirements of [TS22.278] as follows.

                           
                              •
                              (H-1) EPS shall provide a high level of security.

(H-2) Any security lapse in one access technology must not compromise other accesses.

(H-3) EPS should provide protection against threats and attacks.

(H-4) EPS shall support authenticity of information between the terminal and the network.

(H-5) Appropriate traffic protection measures should be provided.

(H-6) EPS shall ensure that unauthorized users cannot establish communications through the system.

Based on these high-level security requirements, some of the security service features are taken as comparison factors to make the reader clear about the enhancement of the protocol as it is indicated in Table 4.

As of this paper, the authors could not find a scheme that can fully mitigate the threats of SAE/LTE security or that can attain the security level of this research results. By introducing negligible computational load, insiginificant amount of UE memory Consumption, and inconsiderable software upgrading, the scheme boosts the security of EPS.

@&#CONCLUSION@&#

Providing an Enhanced authentication and key agreement protocol for System Architecture Evolution/ Long Term evolution (SAE/LTE) or Evolved Packet System (EPS), the objectives of this research are successfully completed within defined scope. In summary, adding enciphering and some other security services, we solve the exposure of UE attachment request parameters and MME authentication response credentials that highly increases the difficulty of compromising the generated parameters. An introduction of new secret crypto-function that resides in USIM enhances the security level of the system as compare to the conventional EPS security by enabling ciphering of IMSI and other parameters. Key Identifier (KI) that avoids the use of Temporary Mobile Subscriber Identity (TMSI) is also one of the improvements. KI has multi-role of which indicating the LTE K (K), can optimize the transmission of IMSI over network and used for derivation parameter of ciphering Key S. Deriving the key S solves a single key problem, which is the security hole of almost all proposed protocols in which compromising the key K compromises the whole security of evolved packet system.

Instead of generating AVs in the home network, it is enhanced to generate in the serving network as one of the improvements in the new scheme, which results in reduction of bandwith consumption, memory consumption and authentication delay. As briefly discussed under comparison and analysis sections, the proposed protocol answers almost all security issues raised in the existing security system and in other proposed protocols. Moreover, the Enhanced AKA solution is applicable to LTE without need of modifying its architecture or without special software implementation while it improves the security and performance of the scheme. Eventually the authors conclude that the Enhanced-AKA is a robust scheme for the next generation mobile access network security because of its novel features. The proposed scheme is conclusively efficient and safe under formal analytical verification, simulation-evaluation and theoretical views; thus, it is reasonably applicable to any LTE environment.

We wish to confirm that there are no known conflicts of interest associated with this publication. We confirm that the manuscript has been read by all named authors and that there are no other persons who satisfied the criteria for authorship but are not listed.

@&#ACKNOWLEDGMENTS@&#

This research was supported by the Basic Science Research Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Science, ICT, and Future Planning (2014R1A1A2002775).

@&#REFERENCES@&#

