@&#MAIN-TITLE@&#Flat-end cutter orientation on a quadric in five-axis machining

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The conditions to avoid local gouging and rear gouging are formulated.


                        
                        
                           
                           The machined strip width is evaluated analytically.


                        
                        
                           
                           Two orientation angles are fully exploited to maximise the width without gouging.


                        
                        
                           
                           The theory has been successfully applied in 5-axis sculptured surface machining.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Five-axis machining

Flat-end cutter

Cutter orientation

Quadric

Machined strip width

Gouging

@&#ABSTRACT@&#


               
               
                  The authors have recently developed methods for cutter orientation and tool path generation in 5-axis sculptured surface machining, where the design surface is approximated locally by a quadric. This paper presents, from a purely geometric perspective, the fundamental theory for optimising the cutter orientation on a quadric, which maximises the machined strip width whilst avoiding local and rear gouging. The analysis focuses on the flat-end cutter which is modelled by a circular cylinder but can be generalised for any fillet-end cutter using an appropriate offset of the design surface and the concept of geometric equivalency. The theory is illustrated by three examples.
               
            

@&#INTRODUCTION@&#

Five-axis machining is used widely in the aerospace, automobile and die/mould industries where machining efficiency and quality are crucial. In order to reduce cutting time and obtain a well-finished surface, an optimal cutter orientation is required. Much research effort has been concentrated on optimising the cutter orientation  [1]. Recent developments of the quadric method (QM)  [2] for orienting the cutter at one single point and the integrated method (IM)  [3] for orienting the cutter along tool passes have significantly improved the machining efficiency and quality. In the two methods, there is a purely geometrical problem of how to orient a circular cylinder on a general quadric, which is addressed in this paper. Interestingly, the geometric interactions of cylinders and quadrics are encountered in many other applications such as engineering tribology  [4], robotics  [5] and rigid body simulations  [6].

To avoid any ambiguity, the basic concepts of cutter orientation, gouging, and machined strip width are introduced in this subsection.


                        Cutter orientation is used to specify how a flat-end cutter 
                           
                              C
                           
                         is placed relative to a design surface 
                           
                              S
                           
                         at their contact point, the cutter contact (CC) point. The orientation can be described in a local machining coordinate system (LMCS, XM-YM-ZM) as shown in Fig. 1
                        . The origin is at the CC point. The ZM-axis is along the surface normal  
                           
                              N
                           
                         and the XM-axis is in the cutting direction, which is tangent to a tool pass  
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                              
                           
                         at the CC point. The cutter is rotated first a lead angle 
                        
                           α
                         around the YM-axis, and then a screw angle 
                        
                           β
                         around the ZM-axis. In general, 
                           0
                           ≤
                           α
                           ≤
                           π
                           /
                           2
                        , 
                           −
                           π
                           /
                           2
                           <
                           β
                           <
                           π
                           /
                           2
                        , but the ranges may be further restricted by gouging avoidance between 
                           
                              C
                           
                         and 
                           
                              S
                           
                        .

Gouging is a critical problem in 5-axis machining. According to where gouging occurs on 
                           
                              C
                           
                        , it is classified either as local gouging, rear gouging or global gouging (collision)  [7]. In the paper, only local gouging and rear gouging are considered. Local gouging refers to the removal of excess material in the vicinity of the CC point, and is due to the mismatch in curvatures between 
                           
                              S
                           
                         and the cutter swept surface 
                        
                           
                              
                                 
                                    W
                                 
                              
                              
                                 i
                              
                           
                        , the envelope swept out by 
                           
                              C
                           
                         along the tool pass 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                              
                           
                        . Rear gouging refers to the interference between 
                           
                              S
                           
                         and a region on the bottom of 
                           
                              C
                           
                         at some distance from the CC point.

Let an error surface 
                        
                           
                              E
                           
                         denote the offset of 
                           
                              S
                           
                         with a distance equal to the machining tolerance 
                           ε
                         as shown in Fig. 2
                        (a). Then, to ensure that machining deviation, the distance from the machined surface to 
                           
                              S
                           
                        , is smaller than 
                           ε
                        , the machined surface must lie between 
                           
                              E
                           
                         and 
                           
                              S
                           
                        . Define the machined region as an area on 
                           
                              E
                           
                         bounded by intersection curves with 
                           
                              C
                           
                        . Then on the tangent plane of 
                           
                              S
                           
                         at the CC point as illustrated in Fig. 2 (b), the maximum span of the projected machined region along the YM-axis is the machined strip width   
                           w
                        . Evidently, to improve machining efficiency at the CC point along 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                              
                           
                        , an optimal orientation is desired to maximise 
                           w
                         and give no gouging.

There has been much research effort to optimise the cutter orientation. The published algorithms can be classified broadly into local and global methods. In local methods, only the normal curvatures of 
                           
                              C
                           
                         and 
                           
                              S
                           
                         at the CC point are considered to determine the orientation. 
                           
                              C
                           
                         is inclined in the minimum principal direction of 
                           
                              S
                           
                           [8,9] or in the cutting direction  [10]. Then the lead angle 
                           α
                         is determined to match the normal curvatures of 
                           
                              C
                           
                         and 
                           
                              S
                           
                         in the direction perpendicular to the cutting direction on the tangent plane. Rao and Sarma  [11] and Yoon et al. [12] have improved the methods by comparing normal curvatures of 
                           
                              
                                 
                                    W
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              S
                           
                         to avoid local gouging, but there might still be rear gouging.

To avoid the possibility of rear gouging, the global methods use an area of 
                           
                              S
                           
                         beneath 
                           
                              C
                           
                         to orient 
                           
                              C
                           
                        . In the multi-point machining method  [13,14], several contact points between 
                           
                              C
                           
                         and 
                           
                              S
                           
                         are found to determine the orientation. However, the method has to evaluate intersections between 
                           
                              C
                           
                         and 
                           
                              S
                           
                         iteratively, and there can be divergence in some cases  [15]. In the arc-intersect method  [16], 
                           α
                         is set to the maximum rotation angle from sampled points on 
                           
                              S
                           
                         to 
                           
                              C
                           
                         when 
                           α
                           =
                           0
                        . The weakness of the method is the low computational efficiency, since a bisection method is used at each sampled point for evaluating the rotation angle. Hosseinkhani et al. [17] developed the penetration–elimination method to avoid the angle evaluation, but a numerical root finding algorithm has to be applied at each point for gouging check.

To simplify the computation, another approach in global methods is to locally approximate 
                           
                              S
                           
                         by a simple surface and then orient 
                           
                              C
                           
                         on the simple surface. Based on the study of 5-axis spherical surface machining  [18], Gray et al. [15] developed a rolling ball method which approximates 
                           
                              S
                           
                         by part of a sphere and then places 
                           
                              C
                           
                         on it. The method is easy to implement but, due to the limited shape defining capability of a sphere, the lead angle 
                           α
                         is conservative in the sense that it could be reduced to generate a wider machined strip width  [16]. Yoon  [19] proposed a method to determine the orientation on an osculating paraboloid and then used the method for machining 
                           
                              S
                           
                        , but there is a tacit assumption that 
                           
                              S
                           
                         can be closely approximated by its second-order Taylor expansion at the CC point.

A more general approach involves the orientation of the flat-end cutter on an osculating quadric, which is the second-order algebraic surface form embracing all spheres, cylinders, cones, ellipsoids, paraboloids and hyperboloids  [20]. It has been successfully applied in the quadric method (QM)  [2] and integrated method (IM)  [3], where practical products were machined and numerical simulations showed higher efficiency than previously published methods. To date, however, the geometric details for optimising the cutter orientation on a quadric have not been reported.

This paper presents the fundamental theory for orienting a flat-end cutter on a quadric in 5-axis machining, to maximise the machined strip width and avoid local and rear gouging. The study is limited to orienting a cutter 
                           
                              C
                           
                         on a design surface 
                           
                              S
                           
                         at a single location under the following assumptions: 
                           
                              •
                              
                                 
                                    
                                       S
                                    
                                  is a quadric.


                                 
                                    
                                       C
                                    
                                  is a flat-end cutter and its spindle speed is much higher than the feed rate, so it can be considered as a circular cylinder.

The size of 
                                    
                                       C
                                    
                                  has been selected appropriately  [21].

Potential collisions on the flank of 
                                    
                                       C
                                    
                                  have been avoided by restricting the cutter orientation, but possible interference on the bottom of 
                                    
                                       C
                                    
                                  needs to be checked.

The allowable deviation of the machined surface from 
                                    
                                       S
                                    
                                 , which is referred to as machining tolerance 
                                 
                                    ε
                                 , is positive, and consistent with that in the finishing stage.

The conditions to avoid local gouging and rear gouging are formulated in Sections  2 and 3 respectively, followed by the evaluation of the machined strip width in Section  4. Then the two cutter orientation angles are optimised in Section  5 with three typical examples in Section  6 and an error analysis in Section  7. Finally, conclusions and future research directions are presented in Section  8.

Local gouging critically affects the machining accuracy. The precise detection of local gouging reduces the search space for cutter orientation and, consequently, makes rear gouging detection and orientation optimisation more efficient. In this section, the condition for no local gouging is derived by comparing the normal curvature of the cutter swept surface 
                        
                           
                              
                                 W
                              
                           
                           
                              i
                           
                        
                      with that of the quadric surface 
                        
                           S
                        
                      in every direction.

Without loss of generality, it can be assumed that the quadric 
                           
                              S
                           
                         in the local machining coordinate system LMCS has an equation of the form: 
                           
                              (1)
                              
                                 f
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          M
                                       
                                    
                                    )
                                 
                                 =
                                 a
                                 
                                    
                                       x
                                    
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 b
                                 
                                    
                                       y
                                    
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 c
                                 
                                    
                                       z
                                    
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 e
                                 
                                    
                                       y
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       M
                                    
                                 
                                 +
                                 2
                                 g
                                 
                                    
                                       z
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       M
                                    
                                 
                                 +
                                 2
                                 h
                                 
                                    
                                       x
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       M
                                    
                                 
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       M
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                         It is easily checked that the quadric passes through the origin, i.e.  
                           f
                           
                              (
                              0
                              ,
                              0
                              ,
                              0
                              )
                           
                           =
                           0
                        , and the normal vector at the origin is of unit length and in the direction opposite to the ZM-axis, i.e.  
                           ∇
                           f
                           
                              (
                              0
                              ,
                              0
                              ,
                              0
                              )
                           
                           =
                           
                              (
                              0
                              ,
                              0
                              ,
                              −
                              1
                              )
                           
                        .

So the two principal curvatures 
                           
                              
                                 κ
                              
                              
                                 
                                    max
                                 
                              
                           
                        , 
                           
                              
                                 κ
                              
                              
                                 
                                    min
                                 
                              
                           
                         and the angle 
                           θ
                         from the XM-axis to the maximum principal direction at the CC point are given by  [22]
                        
                           
                              
                                 (2)
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          
                                             max
                                          
                                       
                                    
                                    =
                                    a
                                    +
                                    b
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   a
                                                   −
                                                   b
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          4
                                          
                                             
                                                h
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          κ
                                       
                                       
                                          
                                             min
                                          
                                       
                                    
                                    =
                                    a
                                    +
                                    b
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   a
                                                   −
                                                   b
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          4
                                          
                                             
                                                h
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                              
                                 (3)
                                 
                                    θ
                                    =
                                    
                                       
                                          tan
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            a
                                                            −
                                                            b
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   4
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             −
                                             
                                                (
                                                a
                                                −
                                                b
                                                )
                                             
                                          
                                          
                                             2
                                             h
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

Since 
                           
                              
                                 
                                    W
                                 
                              
                              
                                 i
                              
                           
                         is swept out by 
                           
                              C
                           
                        , they have tangential contact along a curve, called the CC curve. In addition, 
                           
                              
                                 
                                    W
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              S
                           
                         contact along the tool pass 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                              
                           
                        . Therefore, at the CC point, where the CC curve and 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                              
                           
                         intersect, 
                           
                              C
                           
                        , 
                           
                              
                                 
                                    W
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              S
                           
                         share the surface normal 
                           
                              N
                           
                        . Further, the normal curvatures of 
                           
                              C
                           
                         and 
                           
                              
                                 
                                    W
                                 
                              
                              
                                 i
                              
                           
                         are identical along the CC curve, and those of 
                           
                              
                                 
                                    W
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              S
                           
                         are identical along 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                              
                           
                        . This relationship can be interpreted geometrically in terms of osculating paraboloid approximations and Dupin’s indicatrices IC, IW and IS of 
                           
                              C
                           
                        , 
                           
                              
                                 
                                    W
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              S
                           
                         as shown in Fig. 3
                        (a) and (b). Dupin’s indicatrix of a general surface could be an ellipse, hyperbola or two parallel lines  [23]. Consider a more general case where the cutter 
                           
                              C
                           
                         is a fillet-end cutter specified by bottom radius 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                         and corner radius 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        . Then, since 
                           
                              C
                           
                         is convex, IC is an ellipse. So there are 9 main configurations of IC, IW and IS as illustrated in Fig. 3(b)–(j).

Let 
                           
                              
                                 κ
                              
                              
                                 S
                              
                           
                         denote the normal curvature of 
                           
                              S
                           
                         in an arbitrary direction on the tangent plane, specified by the angle 
                           τ
                         (
                           0
                           ≤
                           τ
                           <
                           π
                        ) from the XM-axis as shown in Fig. 3(b). Then, using Euler’s theorem  [24], 
                           
                              
                                 κ
                              
                              
                                 S
                              
                           
                         can be expressed as 
                           
                              (4)
                              
                                 
                                    
                                       κ
                                    
                                    
                                       S
                                    
                                 
                                 =
                                 
                                    
                                       κ
                                    
                                    
                                       
                                          max
                                       
                                    
                                    
                                       S
                                    
                                 
                                 
                                    
                                       cos
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    τ
                                    −
                                    θ
                                    )
                                 
                                 +
                                 
                                    
                                       κ
                                    
                                    
                                       
                                          min
                                       
                                    
                                    
                                       S
                                    
                                 
                                 
                                    
                                       sin
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    τ
                                    −
                                    θ
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       1
                                       +
                                       
                                          
                                             tan
                                          
                                          
                                             2
                                          
                                       
                                       τ
                                    
                                 
                                 
                                    (
                                    
                                       
                                          κ
                                       
                                       
                                          0
                                       
                                       
                                          S
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          κ
                                       
                                       
                                          Δ
                                       
                                       
                                          S
                                       
                                    
                                    tan
                                    τ
                                    +
                                    
                                       
                                          κ
                                       
                                       
                                          π
                                          /
                                          2
                                       
                                       
                                          S
                                       
                                    
                                    
                                       
                                          tan
                                       
                                       
                                          2
                                       
                                    
                                    τ
                                    )
                                 
                              
                           
                         where 
                           θ
                         is the angle from the XM-axis to the maximum principal direction of 
                           
                              S
                           
                        , and 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                0
                                             
                                             
                                                S
                                             
                                          
                                          =
                                          
                                             
                                                κ
                                             
                                             
                                                
                                                   max
                                                
                                             
                                             
                                                S
                                             
                                          
                                          
                                             
                                                cos
                                             
                                             
                                                2
                                             
                                          
                                          θ
                                          +
                                          
                                             
                                                κ
                                             
                                             
                                                
                                                   min
                                                
                                             
                                             
                                                S
                                             
                                          
                                          
                                             
                                                sin
                                             
                                             
                                                2
                                             
                                          
                                          θ
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                π
                                                /
                                                2
                                             
                                             
                                                S
                                             
                                          
                                          =
                                          
                                             
                                                κ
                                             
                                             
                                                
                                                   max
                                                
                                             
                                             
                                                S
                                             
                                          
                                          
                                             
                                                sin
                                             
                                             
                                                2
                                             
                                          
                                          θ
                                          +
                                          
                                             
                                                κ
                                             
                                             
                                                
                                                   min
                                                
                                             
                                             
                                                S
                                             
                                          
                                          
                                             
                                                cos
                                             
                                             
                                                2
                                             
                                          
                                          θ
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                Δ
                                             
                                             
                                                S
                                             
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   κ
                                                
                                                
                                                   
                                                      max
                                                   
                                                
                                                
                                                   S
                                                
                                             
                                             −
                                             
                                                
                                                   κ
                                                
                                                
                                                   
                                                      min
                                                   
                                                
                                                
                                                   S
                                                
                                             
                                             )
                                          
                                          sin
                                          θ
                                          cos
                                          θ
                                          .
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 κ
                              
                              
                                 0
                              
                              
                                 S
                              
                           
                        , 
                           
                              
                                 κ
                              
                              
                                 π
                                 /
                                 2
                              
                              
                                 S
                              
                           
                         are the normal curvatures of 
                           
                              S
                           
                         along the XM and YM-axes respectively. 
                           
                              
                                 κ
                              
                              
                                 Δ
                              
                              
                                 S
                              
                           
                         is the surface torsion along the XM-axis  [24].

Since the screw angle 
                           β
                         is the angle from the XM-axis to the maximum principal direction (along the meridian) of 
                           
                              C
                           
                           [25], the normal curvature 
                           
                              
                                 κ
                              
                              
                                 C
                              
                           
                         of 
                           
                              C
                           
                         in the direction 
                           τ
                         is 
                           
                              (5)
                              
                                 
                                    
                                       κ
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       1
                                       +
                                       
                                          
                                             tan
                                          
                                          
                                             2
                                          
                                       
                                       τ
                                    
                                 
                                 
                                    (
                                    
                                       
                                          κ
                                       
                                       
                                          0
                                       
                                       
                                          C
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          κ
                                       
                                       
                                          Δ
                                       
                                       
                                          C
                                       
                                    
                                    tan
                                    τ
                                    +
                                    
                                       
                                          κ
                                       
                                       
                                          π
                                          /
                                          2
                                       
                                       
                                          C
                                       
                                    
                                    
                                       
                                          tan
                                       
                                       
                                          2
                                       
                                    
                                    τ
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                0
                                             
                                             
                                                C
                                             
                                          
                                       
                                       
                                          =
                                          
                                             
                                                κ
                                             
                                             
                                                
                                                   max
                                                
                                             
                                             
                                                C
                                             
                                          
                                          
                                             
                                                cos
                                             
                                             
                                                2
                                             
                                          
                                          β
                                          +
                                          
                                             
                                                κ
                                             
                                             
                                                
                                                   min
                                                
                                             
                                             
                                                C
                                             
                                          
                                          
                                             
                                                sin
                                             
                                             
                                                2
                                             
                                          
                                          β
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                π
                                                /
                                                2
                                             
                                             
                                                C
                                             
                                          
                                       
                                       
                                          =
                                          
                                             
                                                κ
                                             
                                             
                                                
                                                   max
                                                
                                             
                                             
                                                C
                                             
                                          
                                          
                                             
                                                sin
                                             
                                             
                                                2
                                             
                                          
                                          β
                                          +
                                          
                                             
                                                κ
                                             
                                             
                                                
                                                   min
                                                
                                             
                                             
                                                C
                                             
                                          
                                          
                                             
                                                cos
                                             
                                             
                                                2
                                             
                                          
                                          β
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                Δ
                                             
                                             
                                                C
                                             
                                          
                                       
                                       
                                          =
                                          
                                             (
                                             
                                                
                                                   κ
                                                
                                                
                                                   
                                                      max
                                                   
                                                
                                                
                                                   C
                                                
                                             
                                             −
                                             
                                                
                                                   κ
                                                
                                                
                                                   
                                                      min
                                                   
                                                
                                                
                                                   C
                                                
                                             
                                             )
                                          
                                          sin
                                          β
                                          cos
                                          β
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

Suppose that the normal curvature 
                           
                              
                                 κ
                              
                              
                                 W
                              
                           
                         of 
                           
                              
                                 
                                    W
                                 
                              
                              
                                 i
                              
                           
                         in the direction 
                           τ
                         is given by 
                           
                              (6)
                              
                                 
                                    
                                       κ
                                    
                                    
                                       W
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       1
                                       +
                                       
                                          
                                             tan
                                          
                                          
                                             2
                                          
                                       
                                       τ
                                    
                                 
                                 
                                    (
                                    
                                       
                                          κ
                                       
                                       
                                          0
                                       
                                       
                                          W
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          κ
                                       
                                       
                                          Δ
                                       
                                       
                                          W
                                       
                                    
                                    tan
                                    τ
                                    +
                                    
                                       
                                          κ
                                       
                                       
                                          π
                                          /
                                          2
                                       
                                       
                                          W
                                       
                                    
                                    
                                       
                                          tan
                                       
                                       
                                          2
                                       
                                    
                                    τ
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 κ
                              
                              
                                 0
                              
                              
                                 W
                              
                           
                        , 
                           
                              
                                 κ
                              
                              
                                 π
                                 /
                                 2
                              
                              
                                 W
                              
                           
                         are the normal curvatures of 
                           
                              W
                           
                         along the XM and YM-axes respectively. 
                           
                              
                                 κ
                              
                              
                                 Δ
                              
                              
                                 S
                              
                           
                         is the surface torsion along the XM-axis. Then, according to the local characteristics that 
                           
                              C
                           
                         contacts 
                           
                              
                                 
                                    W
                                 
                              
                              
                                 i
                              
                           
                         along the CC curve and 
                           
                              
                                 
                                    W
                                 
                              
                              
                                 i
                              
                           
                         contacts 
                           
                              S
                           
                         along 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                              
                           
                         with 
                           τ
                           =
                           0
                        , 
                           
                              
                                 κ
                              
                              
                                 W
                              
                           
                         can be expressed explicitly as 
                           
                              (7)
                              
                                 
                                    
                                       κ
                                    
                                    
                                       W
                                    
                                 
                                 =
                                 
                                    
                                       κ
                                    
                                    
                                       0
                                    
                                    
                                       S
                                    
                                 
                                 
                                    
                                       cos
                                    
                                    
                                       2
                                    
                                 
                                 τ
                                 +
                                 
                                    
                                       κ
                                    
                                    
                                       Δ
                                    
                                    
                                       S
                                    
                                 
                                 sin
                                 2
                                 τ
                                 +
                                 
                                    (
                                    
                                       
                                          κ
                                       
                                       
                                          π
                                          /
                                          2
                                       
                                       
                                          C
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         Δ
                                                      
                                                      
                                                         C
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         Δ
                                                      
                                                      
                                                         S
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                0
                                             
                                             
                                                C
                                             
                                          
                                          −
                                          
                                             
                                                κ
                                             
                                             
                                                0
                                             
                                             
                                                S
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       sin
                                    
                                    
                                       2
                                    
                                 
                                 τ
                                 .
                              
                           
                        
                     

In machining, material on 
                           
                              S
                           
                         is removed by the cutter swept surface 
                           
                              
                                 
                                    W
                                 
                              
                              
                                 i
                              
                           
                        . Thus, the condition of no local gouging on 
                           
                              S
                           
                         can be given mathematically as 
                           
                              (8)
                              
                                 
                                    
                                       κ
                                    
                                    
                                       S
                                    
                                 
                                 ≤
                                 
                                    
                                       κ
                                    
                                    
                                       W
                                    
                                 
                                 
                                 for all
                                 
                                 0
                                 ≤
                                 τ
                                 <
                                 π
                                 .
                              
                           
                         Substituting (4) and (7) into (8) and simplifying give 
                           
                              (9)
                              
                                 
                                    (
                                    
                                       
                                          κ
                                       
                                       
                                          
                                             max
                                          
                                       
                                       
                                          C
                                       
                                    
                                    −
                                    
                                       
                                          κ
                                       
                                       
                                          
                                             min
                                          
                                       
                                       
                                          C
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          κ
                                       
                                       
                                          
                                             max
                                          
                                       
                                       
                                          S
                                       
                                    
                                    −
                                    
                                       
                                          κ
                                       
                                       
                                          
                                             min
                                          
                                       
                                       
                                          S
                                       
                                    
                                    )
                                 
                                 
                                    
                                       sin
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    θ
                                    −
                                    β
                                    )
                                 
                                 −
                                 
                                    (
                                    
                                       
                                          κ
                                       
                                       
                                          
                                             max
                                          
                                       
                                       
                                          C
                                       
                                    
                                    −
                                    
                                       
                                          κ
                                       
                                       
                                          
                                             min
                                          
                                       
                                       
                                          S
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          κ
                                       
                                       
                                          
                                             min
                                          
                                       
                                       
                                          C
                                       
                                    
                                    −
                                    
                                       
                                          κ
                                       
                                       
                                          
                                             min
                                          
                                       
                                       
                                          S
                                       
                                    
                                    )
                                 
                                 ≤
                                 0
                                 .
                              
                           
                        
                     

For a fillet-end cutter with bottom radius 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                         and corner radius 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        , the two principal curvatures are given by  [25]
                        
                           
                              (10)
                              
                                 
                                    
                                       κ
                                    
                                    
                                       
                                          max
                                       
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       κ
                                    
                                    
                                       
                                          min
                                       
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 
                                    
                                       sin
                                       α
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                       sin
                                       α
                                    
                                 
                                 .
                              
                           
                         The flat-end cutter 
                           
                              C
                           
                         can be considered as a fillet-end cutter with 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           =
                           0
                        . Accordingly, substituting (10) into (9) and taking the limit as 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           →
                           0
                         give the condition for no local gouging as 
                           
                              (11)
                              
                                 α
                                 ≥
                                 
                                    
                                       sin
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             κ
                                          
                                          
                                             
                                                max
                                             
                                          
                                          
                                             S
                                          
                                       
                                       
                                          
                                             sin
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          θ
                                          −
                                          β
                                          )
                                       
                                       +
                                       
                                          
                                             κ
                                          
                                          
                                             
                                                min
                                             
                                          
                                          
                                             S
                                          
                                       
                                       
                                          
                                             cos
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          θ
                                          −
                                          β
                                          )
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 κ
                              
                              
                                 
                                    max
                                 
                              
                              
                                 S
                              
                           
                           
                              
                                 sin
                              
                              
                                 2
                              
                           
                           
                              (
                              θ
                              −
                              β
                              )
                           
                           +
                           
                              
                                 κ
                              
                              
                                 
                                    min
                                 
                              
                              
                                 S
                              
                           
                           
                              
                                 cos
                              
                              
                                 2
                              
                           
                           
                              (
                              θ
                              −
                              β
                              )
                           
                         is the normal curvature of 
                           
                              S
                           
                         in the direction 
                           τ
                           =
                           β
                           +
                           π
                           /
                           2
                        . In this direction, the normal curvature of 
                           
                              C
                           
                         is 
                           sin
                           α
                           /
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                        . Thus, condition (11) can be interpreted geometrically as there being no local gouging if 
                           
                              
                                 κ
                              
                              
                                 S
                              
                           
                           ≤
                           
                              
                                 κ
                              
                              
                                 C
                              
                           
                         in the direction 
                           τ
                           =
                           β
                           +
                           π
                           /
                           2
                        . The condition is necessary and sufficient, since inequality (8) can be deduced from (11) inversely.

If 
                           
                              S
                           
                         is a quadric of local form (1), then substituting (2) and (3) into (11) yields the condition of no local gouging in quadric machining with a flat-end cutter 
                           
                              (12)
                              
                                 α
                                 ≥
                                 
                                    
                                       sin
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    2
                                    
                                       
                                          R
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       a
                                       
                                          
                                             sin
                                          
                                          
                                             2
                                          
                                       
                                       β
                                       +
                                       b
                                       
                                          
                                             cos
                                          
                                          
                                             2
                                          
                                       
                                       β
                                       −
                                       h
                                       sin
                                       2
                                       β
                                       )
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

When a flat-end cutter 
                        
                           C
                        
                      is oriented on the quadric without local gouging, there may still be some rear gouging. To avoid rear gouging, any intersection between the quadric and the bottom of 
                        
                           C
                        
                      needs to be detected and eliminated. The plane at the bottom of 
                        
                           C
                        
                     , referred to as the bottom plane, intersects the quadric in a conic as illustrated in Fig. 4
                     . If the conic lies entirely outside the boundary of the bottom, referred to as the bottom circle, then there is no rear gouging.

To analyse the relationship between the conic and the bottom circle, a cutter coordinate system (CCS, XC-YC-ZC) is defined at the CC point. The ZC-axis is along the cutter axis, and the XC-axis is along the vector from the circle centre to the CC point as shown in Fig. 4. In the CCS, the bottom circle of radius 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                         is given by 
                           
                              (13)
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                C
                                             
                                          
                                          +
                                          
                                             
                                                R
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       z
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                        
                     

Suppose that 
                           
                              C
                           
                         is oriented in the LMCS with two orientation angles 
                           
                              (
                              α
                              ,
                              β
                              )
                           
                        . Then the rotation matrices about the YM-axis and ZM-axis are defined respectively by 
                           
                              
                                 
                                    Y
                                 
                                 
                                    (
                                    α
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             cos
                                             α
                                             
                                          
                                          
                                             0
                                             
                                          
                                          
                                             −
                                             
                                                sin
                                             
                                             α
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             1
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             sin
                                             α
                                          
                                          
                                             0
                                          
                                          
                                             cos
                                             α
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    Z
                                 
                                 
                                    (
                                    β
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             cos
                                             β
                                             
                                          
                                          
                                             sin
                                             β
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             −
                                             
                                                sin
                                             
                                             β
                                          
                                          
                                             cos
                                             β
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Consequently, the transformation from the LMCS to CCS is 
                           
                              (14)
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          M
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          C
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          C
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          C
                                       
                                    
                                    )
                                 
                                 
                                    Y
                                 
                                 
                                    (
                                    α
                                    )
                                 
                                 
                                    Z
                                 
                                 
                                    (
                                    β
                                    )
                                 
                                 .
                              
                           
                        
                     

Substituting (14) into the quadric (1) and setting 
                           
                              
                                 z
                              
                              
                                 C
                              
                           
                           =
                           0
                         give the conic in the CCS as 
                           
                              (15)
                              
                                 A
                                 
                                    
                                       x
                                    
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 B
                                 
                                    
                                       x
                                    
                                    
                                       C
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       C
                                    
                                 
                                 +
                                 C
                                 
                                    
                                       y
                                    
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 D
                                 
                                    
                                       x
                                    
                                    
                                       C
                                    
                                 
                                 +
                                 2
                                 E
                                 
                                    
                                       y
                                    
                                    
                                       C
                                    
                                 
                                 +
                                 F
                                 =
                                 0
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    A
                                    =
                                    
                                       (
                                       a
                                       
                                          
                                             cos
                                          
                                          
                                             2
                                          
                                       
                                       β
                                       +
                                       b
                                       
                                          
                                             sin
                                          
                                          
                                             2
                                          
                                       
                                       β
                                       +
                                       h
                                       sin
                                       2
                                       β
                                       )
                                    
                                    
                                       
                                          cos
                                       
                                       
                                          2
                                       
                                    
                                    α
                                    +
                                    c
                                    
                                       
                                          sin
                                       
                                       
                                          2
                                       
                                    
                                    α
                                    −
                                    
                                       (
                                       e
                                       sin
                                       β
                                       +
                                       g
                                       cos
                                       β
                                       )
                                    
                                    sin
                                    2
                                    α
                                    ,
                                 
                              
                              
                                 
                                    B
                                    =
                                    
                                       (
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          b
                                          −
                                          a
                                          )
                                       
                                       sin
                                       2
                                       β
                                       +
                                       h
                                       cos
                                       2
                                       β
                                       )
                                    
                                    cos
                                    α
                                    −
                                    
                                       (
                                       e
                                       cos
                                       β
                                       −
                                       g
                                       sin
                                       β
                                       )
                                    
                                    sin
                                    α
                                    ,
                                 
                              
                              
                                 
                                    C
                                    =
                                    a
                                    
                                       
                                          sin
                                       
                                       
                                          2
                                       
                                    
                                    β
                                    +
                                    b
                                    
                                       
                                          cos
                                       
                                       
                                          2
                                       
                                    
                                    β
                                    −
                                    h
                                    sin
                                    2
                                    β
                                    ,
                                    
                                    D
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    sin
                                    α
                                    ,
                                    
                                    E
                                    =
                                    F
                                    =
                                    0
                                    .
                                 
                              
                           
                        
                     

To classify the conics, define 
                           
                              
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          =
                                          
                                             |
                                             
                                                
                                                   
                                                      A
                                                      
                                                   
                                                   
                                                      B
                                                      
                                                   
                                                   
                                                      D
                                                   
                                                
                                                
                                                   
                                                      B
                                                      
                                                   
                                                   
                                                      C
                                                      
                                                   
                                                   
                                                      E
                                                   
                                                
                                                
                                                   
                                                      D
                                                      
                                                   
                                                   
                                                      E
                                                      
                                                   
                                                   
                                                      F
                                                   
                                                
                                             
                                             |
                                          
                                          =
                                          −
                                          C
                                          
                                             
                                                D
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                          J
                                          =
                                          
                                             |
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      B
                                                   
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      C
                                                   
                                                
                                             
                                             |
                                          
                                          =
                                          A
                                          C
                                          −
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          =
                                          
                                             |
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      D
                                                   
                                                
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      F
                                                   
                                                
                                             
                                             |
                                          
                                          +
                                          
                                             |
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      E
                                                   
                                                
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      F
                                                   
                                                
                                             
                                             |
                                          
                                          =
                                          −
                                          
                                             
                                                1
                                             
                                             
                                                4
                                             
                                          
                                          
                                             
                                                sin
                                             
                                             
                                                2
                                             
                                          
                                          α
                                          ≤
                                          0
                                          .
                                       
                                    
                                 
                              
                           
                         Then, considering the real solutions of (15), the conic can be classified according to the 7 types in Table 1
                           [26]. Since the bottom circle lying between two branches or within one branch of a hyperbola are two distinct cases in quadric machining, there are 8 configurations to be considered.

Suppose that local gouging has been detected and eliminated, then condition (12) is necessarily satisfied. Substituting the coefficients of the conic into (12) gives 
                           
                              (16)
                              
                                 C
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 D
                                 .
                              
                           
                        
                     

The occurrence of rear gouging depends on the relationship or intersection points between the conic and the bottom circle. So the rear gouging can be checked based on the common solutions of the conic (15) and circle (13). Note that the conic and circle share the same tangent direction (first-order contact) at the CC point 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    C
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    C
                                 
                              
                              )
                           
                           =
                           
                              (
                              0
                              ,
                              0
                              )
                           
                        . Thus 
                           
                              (
                              0
                              ,
                              0
                              )
                           
                         is a double root. As two bivariate quadratics generally have four common solutions, the other two solutions need to be identified for the detection of rear gouging.

Eliminating the 
                           
                              
                                 x
                              
                              
                                 C
                              
                           
                         term in (15) using (13) gives a quadratic in 
                           
                              (
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          C
                                       
                                    
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          C
                                       
                                    
                                 
                              
                              )
                           
                         as 
                           
                              (17)
                              
                                 
                                    (
                                    C
                                    
                                       
                                          R
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    D
                                    )
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      C
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      C
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 B
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                C
                                             
                                          
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                C
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    (
                                    A
                                    
                                       
                                          R
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    D
                                    )
                                 
                                 =
                                 0
                                 ,
                                 
                                 
                                    
                                       x
                                    
                                    
                                       C
                                    
                                 
                                 ≠
                                 0
                                 .
                              
                           
                         The common solutions are therefore equivalent to those between the circle (13) and the two straight lines passing through 
                           
                              (
                              0
                              ,
                              0
                              )
                           
                         with slopes 
                           
                              (
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          C
                                       
                                    
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          C
                                       
                                    
                                 
                              
                              )
                           
                         given by (17). Thus, under condition (16), which excludes the possibility 
                           C
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           >
                           D
                        , define 
                           
                              (18)
                              
                                 δ
                                 =
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    (
                                    C
                                    
                                       
                                          R
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    D
                                    )
                                 
                                 
                                    (
                                    A
                                    
                                       
                                          R
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    D
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    A
                                    C
                                    )
                                 
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    (
                                    A
                                    +
                                    C
                                    )
                                 
                                 D
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       D
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                         Then, there are seven possible configurations of the quadric and circle, as summarised in Table 2
                        , and rear gouging can be detected in three of them.

At a cutter location, there may be many cutter orientations satisfying the conditions of no local gouging nor rear gouging. To improve machining efficiency, the cutter orientation is evaluated and optimised eventually with respect to the machined strip width. In this section, the machined region is identified and the strip width is determined analytically.

In the machining of a quadric given by (1), the error surface 
                           
                              E
                           
                         is 
                           
                              (19)
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          ε
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          ε
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          ε
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          M
                                       
                                    
                                    )
                                 
                                 −
                                 ε
                                 
                                    
                                       ∇
                                       f
                                    
                                    
                                       
                                          |
                                          ∇
                                          f
                                          |
                                       
                                    
                                 
                                 .
                              
                           
                         By definition, the area on 
                           
                              E
                           
                         bounded by the intersection curves with 
                           
                              C
                           
                         is the machined region. Due to the square root in the denominator of (19), the intersection curves generally have to be evaluated by numerical methods.

To simplify the computation  [25,12], the offset (19) may be replaced by a translated surface given by 
                           
                              (20)
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          M
                                       
                                    
                                    )
                                 
                                 +
                                 ε
                                 
                                    (
                                    0
                                    ,
                                    0
                                    ,
                                    1
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          M
                                       
                                    
                                    +
                                    ε
                                    )
                                 
                                 .
                              
                           
                         Thus, the area on the translated surface bounded by two intersection curves with 
                           
                              C
                           
                         is the approximate machined region. The distance between the quadric and 
                           
                              E
                           
                         is 
                           ε
                        , and that between the quadric and the translated surface is smaller than  
                           ε
                        . In this sense, the translated surface lies between the quadric and 
                           
                              E
                           
                        . Consequently, when machining wi thin the approximate machined region, the machining deviation is smaller than 
                           ε
                        . Moreover, in most situations where the surface normal variation of 
                           
                              S
                           
                         beneath 
                           
                              C
                           
                         is small, the difference between the two regions is small and practically negligible  [12]. Further consideration is given to this approximation in the error analysis of Section  7 and the discussion in Section  8.

As shown in Fig. 2, two boundary curves of the machined region terminate at width points on the bottom circle. The number and spacing of the width points relative to the CC point are critical in the evaluation of the strip width. Since the translated surface intersects the bottom plane in a conic, referred to as the translated conic, the width points can be evaluated as the common solution of the translated conic and the bottom circle. In the LMCS, the translated surface (20) is expressed implicitly as 
                           
                              
                                 a
                                 
                                    
                                       x
                                    
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 b
                                 
                                    
                                       y
                                    
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 c
                                 
                                    
                                       
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                M
                                             
                                          
                                          −
                                          ε
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 e
                                 
                                    
                                       y
                                    
                                    
                                       M
                                    
                                 
                                 
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          M
                                       
                                    
                                    −
                                    ε
                                    )
                                 
                                 +
                                 2
                                 g
                                 
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          M
                                       
                                    
                                    −
                                    ε
                                    )
                                 
                                 
                                    
                                       x
                                    
                                    
                                       M
                                    
                                 
                                 +
                                 2
                                 h
                                 
                                    
                                       x
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       M
                                    
                                 
                                 −
                                 
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          M
                                       
                                    
                                    −
                                    ε
                                    )
                                 
                                 =
                                 0
                                 .
                              
                           
                         Transforming the translated surface from the LMCS to CCS using (14) and setting 
                           
                              
                                 z
                              
                              
                                 C
                              
                           
                           =
                           0
                         give the translated conic as 
                           
                              (21)
                              
                                 
                                    
                                       A
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 
                                    
                                       B
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       C
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       C
                                    
                                 
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 
                                    
                                       D
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       C
                                    
                                 
                                 +
                                 2
                                 
                                    
                                       E
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       C
                                    
                                 
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       (
                                       a
                                       
                                          
                                             cos
                                          
                                          
                                             2
                                          
                                       
                                       β
                                       +
                                       b
                                       
                                          
                                             sin
                                          
                                          
                                             2
                                          
                                       
                                       β
                                       +
                                       h
                                       sin
                                       2
                                       β
                                       )
                                    
                                    
                                       
                                          cos
                                       
                                       
                                          2
                                       
                                    
                                    α
                                    +
                                    c
                                    
                                       
                                          sin
                                       
                                       
                                          2
                                       
                                    
                                    α
                                    −
                                    
                                       (
                                       e
                                       sin
                                       β
                                       +
                                       g
                                       cos
                                       β
                                       )
                                    
                                    sin
                                    2
                                    α
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          b
                                          −
                                          a
                                          )
                                       
                                       sin
                                       2
                                       β
                                       +
                                       h
                                       cos
                                       2
                                       β
                                       )
                                    
                                    cos
                                    α
                                    −
                                    
                                       (
                                       e
                                       cos
                                       β
                                       −
                                       g
                                       sin
                                       β
                                       )
                                    
                                    sin
                                    α
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    a
                                    
                                       
                                          sin
                                       
                                       
                                          2
                                       
                                    
                                    β
                                    +
                                    b
                                    
                                       
                                          cos
                                       
                                       
                                          2
                                       
                                    
                                    β
                                    −
                                    h
                                    sin
                                    2
                                    β
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       ε
                                       c
                                       )
                                    
                                    sin
                                    α
                                    −
                                    ε
                                    
                                       (
                                       e
                                       sin
                                       β
                                       
                                       +
                                       g
                                       cos
                                       β
                                       )
                                    
                                    cos
                                    α
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    ε
                                    
                                       (
                                       g
                                       sin
                                       β
                                       −
                                       e
                                       cos
                                       β
                                       )
                                    
                                    ,
                                    
                                    
                                       
                                          F
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    ε
                                    
                                       (
                                       1
                                       +
                                       c
                                       ε
                                       )
                                    
                                    .
                                 
                              
                           
                         Eliminating 
                           
                              
                                 y
                              
                              
                                 C
                              
                           
                         from (21) using the circle equation (13), and rearranging give a polynomial equation of degree four or less:
                           
                              (22)
                              
                                 
                                    
                                       a
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       C
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       C
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       C
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          =
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          4
                                          
                                             
                                                B
                                             
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          =
                                          4
                                          
                                             (
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      t
                                                   
                                                
                                                −
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      t
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      t
                                                   
                                                
                                                −
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             +
                                             2
                                             
                                                
                                                   B
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      t
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          =
                                          2
                                          
                                             (
                                             2
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      t
                                                   
                                                
                                                −
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      t
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   t
                                                
                                             
                                             +
                                             2
                                             
                                                
                                                   E
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                (
                                                4
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      t
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                          =
                                          4
                                          
                                             (
                                             
                                                (
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      t
                                                   
                                                
                                                −
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   t
                                                
                                             
                                             +
                                             2
                                             
                                                
                                                   E
                                                
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   R
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                          ,
                                          
                                          
                                             
                                                a
                                             
                                             
                                                4
                                             
                                          
                                          =
                                          
                                             
                                                F
                                             
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

Solving the equation analytically  [26] gives 0 to 4 real solutions of 
                           
                              
                                 x
                              
                              
                                 C
                              
                           
                        . Substituting back into (13) and checking by (21) give 0 to 4 width points. According to the number of width points, the machined regions can be classified into 5 possible types as illustrated in Fig. 5
                        . To ensure that the machining deviation is smaller than 
                           ε
                        , the machined strip width is evaluated only from the region or connected regions containing the CC point.

According to the types of machined regions, the machined strip width 
                           w
                         can be determined from the width points, or tangent points where the tangent direction of the projected circle is parallel to the XM-axis. As illustrated in Fig. 6
                        , if two width points are on the same side of the straight line passing through the two tangent points as the CC point, then 
                           w
                         is measured between the two width points. If only a single width point is on the same side as the CC point, then 
                           w
                         is measured between this width point and the tangent point on the opposite side of the XM-axis. If there is no width point on the same side as the CC point, then 
                           w
                         is measured between the two tangent points.

In this section, the cutter orientation is determined to maximise the machined strip width. First, the lead angle 
                        α
                      is optimised by placing the cutter as close as possible to the quadric. Then, a numerical method is developed to find the optimal screw angle 
                        β
                     .

The machined strip width 
                           w
                         is a function of 
                           α
                         and 
                           β
                        , that is 
                           w
                           =
                           w
                           
                              (
                              α
                              ,
                              β
                              )
                           
                        , when 
                           
                              S
                           
                         is machined by 
                           
                              C
                           
                         within the tolerance 
                           ε
                        , and unfortunately the function cannot be expressed explicitly. For a given 
                           β
                        , if 
                           α
                         decreases by a small amount, then the two points, from which 
                           w
                         is measured, can only move away from the CC point along the bottom circle, leading to an increase of 
                           w
                        . So, the width 
                           w
                         is a monotonic decreasing function in terms of 
                           α
                        , and the smallest value of 
                           α
                         that does not result in gouging is the optimal solution for maximising  
                           w
                        .

Consider the relationship between the conic and the bottom circle summarised in Table 2. In cases (a), (d) and (e), there is rear gouging, which can be avoided by increasing 
                           α
                        . In case (c), there is no rear gouging, but 
                           α
                         can be further reduced for cutting more material. In cases (b), (f) and (g), 
                           α
                         reaches the optimum since it is the smallest value without gouging. In the optimal cases, case (f) is referred to as overlap machining, since the conic and circle overlap as shown in Fig. 7
                        (a). The conditions of overlap machining are 
                           
                              (23)
                              
                                 C
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 D
                                 ,
                                 
                                 B
                                 =
                                 0
                                 ,
                                 
                                 A
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 D
                                 ,
                              
                           
                         depending on not only the orientation angles (
                           α
                           ,
                           β
                        ) but also the coefficients of the quadric. For a sphere 
                           
                              
                                 x
                              
                              
                                 M
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 y
                              
                              
                                 M
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          M
                                       
                                    
                                    −
                                    R
                                    )
                                 
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         machined by a flat-end cutter, the coefficients of the conic can be derived from (15) as 
                           
                              
                                 A
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       R
                                    
                                 
                                 ,
                                 
                                 B
                                 =
                                 0
                                 ,
                                 
                                 C
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       R
                                    
                                 
                                 ,
                                 
                                 D
                                 =
                                 
                                    
                                       sin
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 E
                                 =
                                 0
                                 ,
                                 
                                 F
                                 =
                                 0
                                 .
                              
                           
                         When 
                           α
                           =
                           
                              
                                 sin
                              
                              
                                 −
                                 1
                              
                           
                           
                              (
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                              
                              /
                              R
                              )
                           
                        , the conditions (23) are satisfied and it is a case of overlap machining.

Case (g) is called one contact machining, since the bottom circle has contact of order 3 with the conic at the vertex as shown in Fig. 7(b). The conditions of one contact machining are 
                           
                              (24)
                              
                                 C
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 D
                                 ,
                                 
                                 B
                                 =
                                 0
                                 ,
                                 
                                 A
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 D
                                 ,
                              
                           
                         which also depend on both (
                           α
                           ,
                           β
                        ) and coefficients of the quadric. The conditions can be interpreted geometrically as the centre of the circle lying on the major axis of the ellipse, transverse axis of the hyperbola, or axis of the parabola, and the radius of curvature of the conic at the vertex being 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                        . The overlap machining is an extreme case of one contact machining, and their conditions of no rear gouging and those of no local gouging are identical.

Case (b) is called two contact machining, since there is a second contact point between the conic and the circle. Its condition can be derived by a quadratic equation of 
                           δ
                           =
                           0
                         in (18). Solving the quadratic gives two cutter radii 
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       2
                                       D
                                    
                                    
                                       A
                                       +
                                       C
                                       +
                                       
                                          
                                             4
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      (
                                                      A
                                                      −
                                                      C
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                    
                                       ∗
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       2
                                       D
                                    
                                    
                                       A
                                       +
                                       C
                                       −
                                       
                                          
                                             4
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      (
                                                      A
                                                      −
                                                      C
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         Substituting into the condition (16) of no local gouging yields 
                           
                              
                                 
                                    
                                       
                                          C
                                          
                                             
                                                R
                                             
                                             
                                                1
                                             
                                             
                                                ∗
                                             
                                          
                                          −
                                          D
                                       
                                       
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                R
                                             
                                             
                                                1
                                             
                                             
                                                ∗
                                             
                                          
                                          
                                             (
                                             −
                                             
                                                (
                                                A
                                                −
                                                C
                                                )
                                             
                                             −
                                             
                                                
                                                   4
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            (
                                                            A
                                                            −
                                                            C
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                             )
                                          
                                          ≤
                                          0
                                          ,
                                       
                                    
                                    
                                       
                                          C
                                          
                                             
                                                R
                                             
                                             
                                                1
                                             
                                             
                                                ∗
                                                ∗
                                             
                                          
                                          −
                                          D
                                       
                                       
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                R
                                             
                                             
                                                1
                                             
                                             
                                                ∗
                                                ∗
                                             
                                          
                                          
                                             (
                                             −
                                             
                                                (
                                                A
                                                −
                                                C
                                                )
                                             
                                             +
                                             
                                                
                                                   4
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            (
                                                            A
                                                            −
                                                            C
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                             )
                                          
                                          ≥
                                          0
                                          .
                                       
                                    
                                 
                              
                           
                         So, 
                           
                              
                                 R
                              
                              
                                 1
                              
                              
                                 ∗
                              
                           
                         is the only radius satisfying both no rear gouging condition of 
                           δ
                           =
                           0
                         and no local gouging condition (16). Consequently, the condition of two contact machining is 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 R
                              
                              
                                 1
                              
                              
                                 ∗
                              
                           
                        , and the optimal 
                           α
                         can be obtained typically by the bisection method. Fig. 8
                         illustrates all possible cases of two contact machining according to the conics given in Table 1.

The condition 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 R
                              
                              
                                 1
                              
                              
                                 ∗
                              
                           
                         also holds in one contact machining, which can be considered as two contact machining with two contact points converging to the CC point. Thus, in quadric machining with a flat cutter, the optimal 
                           α
                         can be evaluated from 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 R
                              
                              
                                 1
                              
                              
                                 ∗
                              
                           
                        , Then, if necessary, the different cases of machining can be identified according to (23) and (24).

For a given screw angle 
                           β
                        , the optimal 
                           α
                         can be obtained according to the condition of two contact machining. Then the objective width can be expressed as 
                           w
                           =
                           w
                           
                              (
                              α
                              
                                 (
                                 β
                                 )
                              
                              ,
                              β
                              )
                           
                        . If the machined region is a single region in the full range of 
                           β
                        , then the objective 
                           w
                         is continuous with respect to 
                           β
                        , and a local maximum can be evaluated numerically according to the first derivatives of 
                           w
                         with initial 
                           β
                           =
                           0
                        . If the machined region comprises two disjoint regions within the range of 
                           β
                        , then local maxima can be found using Euler’s rotation theorem.

Euler’s rotation theorem states that, in three-dimensional space, any displacement of a rigid body such that a point on the rigid body remains fixed, is equivalent to a rotation about a fixed axis through that point. In the general case of two contact machining, the cutter contact (CC) point remains fixed and the second contact point moves perpendicularly to the surface normal. Therefore, at one instant as 
                           β
                         varies in its range, the cutter rotates around the straight line passing through the CC point, intersecting and perpendicular to the surface normal at the second contact point. This line is referred to as the instant axis of rotation.

Let left width 
                           
                              
                                 w
                              
                              
                                 l
                              
                           
                         and right width 
                           
                              
                                 w
                              
                              
                                 r
                              
                           
                         denote the left portion and right portion of the machined strip width 
                           w
                        , relative to the CC point as illustrated in Fig. 9
                        . If the two machined regions are separate, then the left width point and right width point lie on opposite sides of the instant axis. So, at one instant of rotation, the width 
                           w
                         can increase or decrease because one of 
                           
                              
                                 w
                              
                              
                                 l
                              
                           
                         and 
                           
                              
                                 w
                              
                              
                                 r
                              
                           
                         increases and the other decreases. If the two machined regions are connected, then the two width points lie on the same side of the instant axis. Both 
                           
                              
                                 w
                              
                              
                                 l
                              
                           
                         and 
                           
                              
                                 w
                              
                              
                                 r
                              
                           
                         decrease from when the two regions just touch to when the two regions exactly overlap, and further increase until the two regions separate. At the transition case of two connected regions, 
                           w
                         increases discontinuously from two disjoint regions to one single region due to the change of one width point. So 
                           w
                         reaches the local maximum if the two regions just touch. Using a numerical method, such as the bisection method, to search the two connected regions, the local maxima can be obtained.

Three intrinsically different quadrics, which are locally concave, saddle or convex at the origin, are tested for optimising the lead angle 
                        α
                      and the screw angle  
                        β
                      with a flat-end cutter of radius 
                        
                           
                              R
                           
                           
                              1
                           
                        
                        =
                        4
                        
                        
                           mm
                        
                     . Fig. 10
                      shows the three test surfaces. Their local characteristics are given in Table 3
                      and their equations in local coordinates are respectively: 
                        
                           
                              
                                 0.024369748
                                 
                                    
                                       x
                                    
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 0.015966387
                                 
                                    
                                       y
                                    
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 0.005
                                 
                                    
                                       z
                                    
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 0.0011961525
                                 
                                    
                                       y
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       M
                                    
                                 
                                 −
                                 0.0099282032
                                 
                                    
                                       z
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       M
                                    
                                 
                                 +
                                 0.014555049
                                 
                                    
                                       x
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       M
                                    
                                 
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       M
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                           
                              
                                 −
                                 0.0023151994
                                 
                                    
                                       x
                                    
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 0.0068290883
                                 
                                    
                                       y
                                    
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 0.005
                                 
                                    
                                       z
                                    
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 0.0081881198
                                 
                                    
                                       y
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       M
                                    
                                 
                                 −
                                 0.030148875
                                 
                                    
                                       z
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       M
                                    
                                 
                                 −
                                 0.025123727
                                 
                                    
                                       x
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       M
                                    
                                 
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       M
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                           
                              
                                 −
                                 0.0098216796
                                 
                                    
                                       x
                                    
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 0.019269229
                                 
                                    
                                       y
                                    
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 0.002
                                 
                                    
                                       z
                                    
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 0.0046215781
                                 
                                    
                                       y
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       M
                                    
                                 
                                 −
                                 0.013661662
                                 
                                    
                                       z
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       M
                                    
                                 
                                 −
                                 0.0054545454
                                 
                                    
                                       x
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       M
                                    
                                 
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       M
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                        
                      where 
                        
                           
                              x
                           
                           
                              M
                           
                        
                     , 
                        
                           
                              y
                           
                           
                              M
                           
                        
                      and 
                        
                           
                              z
                           
                           
                              M
                           
                        
                      are in mm.


                     Fig. 11
                      illustrates the smallest value of lead angle 
                        
                           
                              α
                           
                           
                              
                                 min
                              
                           
                        
                      and strip width 
                        w
                      in terms of the screw angle 
                        β
                      in the machining of the first quadric. It is evident in Fig. 11(a) that the consideration of no rear gouging leads to a larger 
                        
                           
                              α
                           
                           
                              
                                 min
                              
                           
                        
                     , which implies that rear gouging may exist although local gouging is absent. When 
                        β
                        =
                        −
                        63
                        °
                     , the condition of no local gouging and that of no rear gouging are identical, and hence it is one contact machining. Fig. 11(b) shows that when 
                        ε
                        <
                        0.3
                        
                        
                           mm
                        
                     , the width 
                        w
                      is discontinuous because of the merging and splitting between one single region and two disjoint regions. On the side of a discontinuity that has the greater width, 
                        w
                      is a local maximum. With the increase of 
                        ε
                     , the range of 
                        β
                      corresponding to the two disjoint regions becomes narrower. When 
                        ε
                        ≥
                        0.3
                        
                        
                           mm
                        
                     , 
                        w
                      is continuous due to the absence of disjoint regions.


                     Table 4
                      presents the optimal orientation and maximum width for each machining tolerance. It also compares the maximum width with that obtained by other published orientation strategies, in which the screw angle is specified by 
                        β
                        =
                        0
                        °
                      or 
                        −
                        60
                        °
                      (the minimum principal direction). Since it is possible that two disjoint regions appear when 
                        β
                        =
                        0
                        °
                     , the width  
                        w
                      may be small. For example, 
                        w
                      is only 
                        46.2
                        %
                        ,
                        53.5
                        %
                        ,
                        61.3
                        %
                      of the maximum for 
                        ε
                        =
                        0.005
                        ,
                        0.01
                        ,
                        0.02
                        
                        
                           mm
                        
                     , respectively. When 
                        β
                        =
                        −
                        60
                        °
                     , it generally corresponds to a single region, but again 
                        w
                      may be small. For example, 
                        w
                      is 
                        65.9
                        %
                      of the maximum for 
                        ε
                        =
                        0.05
                        
                        
                           mm
                        
                     .


                     Fig. 12
                      shows the optimisation of cutter orientation in the machining of the second quadric. Obviously, the consideration of rear gouging results in a larger 
                        
                           
                              α
                           
                           
                              
                                 min
                              
                           
                        
                     . When 
                        β
                        =
                        38
                        °
                     , the condition of no local gouging and that of no rear gouging are identical, implying one contact machining. Due to the appearance of disjoint regions, the width changes significantly at the discontinuities, and on the side of a discontinuity that has the greater width, 
                        w
                      is a local maximum. Table 5
                      gives optimal orientations for various machining tolerances. Compared to the optimal solution, the width 
                        w
                      corresponding to 
                        β
                        =
                        0
                        °
                      is only 
                        34.0
                        %
                        ,
                        41.8
                        %
                        ,
                        59.7
                        %
                      of the maximum for 
                        ε
                        =
                        0.005
                        ,
                        0.01
                        ,
                        0.02
                        
                        
                           mm
                        
                     , and corresponding to the minimum principal direction 
                        β
                        =
                        35
                        °
                      is only 
                        64.2
                        %
                        ,
                        65.8
                        %
                      of the maximum for 
                        ε
                        =
                        0.2
                        ,
                        0.3
                        
                        
                           mm
                        
                     .

Depicted in Fig. 13
                      is the optimisation of cutter orientation in the machining of the third quadric. In the variation of the screw angle 
                        β
                     , 
                        
                           
                              α
                           
                           
                              
                                 max
                              
                           
                        
                        =
                        0
                        °
                     , which is the lowest bound of the lead angle, and satisfies the conditions of no local gouging nor rear gouging. Due to the single region, the width is continuous and its maximum corresponds to the optimal 
                        β
                      as given in Table 6
                     . Compared to the optimal solution, the width corresponding to 
                        β
                        =
                        0
                        °
                      is close to the maximum and that corresponding to the minimum principal direction 
                        β
                        =
                        75
                        °
                      is only about half of the maximum in this case.

All three examples have been tested using PowerMILL®  12, a world leading CAM software package. Toolpath Verification in PowerMILL reports neither local gouging nor rear gouging in all cases, and simulation results obtained from ViewMILL in PowerMILL are consistent with those presented in this section. Some critical situations, in which machined strip widths reach the local maxima, are illustrated below.

In each simulation test, the stock is first machined by a fine raster finishing tool path. The tool path leaves additional material, whose thickness is equal to the machining tolerance 
                        ε
                     , on the test surface. Thus, the machined surface can be used to represent the actual error surface 
                        
                           E
                        
                      in ViewMILL. Then the cutter 
                        
                           C
                        
                      is placed on the test surface with the specified lead angle 
                        α
                      and lean angle 
                        β
                     . The cutter removes some material, and one or two machined regions can be observed on 
                        
                           E
                        
                     , from which the machined strip width is measured.


                     Fig. 14
                      illustrates the maximisation of the machined strip width with 
                        ε
                        =
                        0.1
                        
                        
                           mm
                        
                      in the first example. The lead angle 
                        α
                      is minimised at 
                        β
                        =
                        2
                        °
                     , 
                        4
                        °
                      or 
                        6
                        °
                      respectively. The width reaches the local maximum at 
                        β
                        =
                        4
                        °
                     , since two connected regions at 
                        β
                        =
                        4
                        °
                      is the transition from one single region at 
                        β
                        =
                        2
                        °
                      to two disjoint regions at 
                        β
                        =
                        6
                        °
                     .


                     Fig. 15
                      shows width maximisation with 
                        ε
                        =
                        0.05
                        
                        
                           mm
                        
                      in the second example. The lead angle 
                        α
                      is minimised at 
                        β
                        =
                        −
                        9
                        °
                     , 
                        −
                        11
                        °
                      or 
                        −
                        13
                        °
                      respectively. The machined region converts from one single region at 
                        β
                        =
                        −
                        9
                        °
                      to two disjoint regions at 
                        β
                        =
                        −
                        13
                        °
                      via two connected regions at 
                        β
                        =
                        −
                        11
                        °
                     , and so the width reaches the local maximum at 
                        β
                        =
                        −
                        11
                        °
                     . Fig. 16
                      shows the machined regions with 
                        ε
                        =
                        0.02
                        
                        
                           mm
                        
                      in the third example. The widths are similar at 
                        β
                        =
                        0
                        °
                      and 
                        β
                        =
                        14
                        °
                     , and it reaches the maximum at 
                        β
                        =
                        14
                        °
                     .

In Sections  4 and 5, the machined strip width is determined by locally approximating the offset of the quadric surface by a translation of the quadric. Since the translated surface is geometrically closer to the original quadric than the offset surface, the machining is guaranteed to be within tolerance. The aim of this section is to gain some insight into the size of the approximation errors, by computing the machined strip width as accurately as possible with current CAD technology and comparing results.

First, to evaluate the approximation error, an offset of the quadric with a distance equal to the machining tolerance 
                        ε
                      is generated by the approach developed by Piegl and Tiller  [27]. Then, using the curve–surface and surface–surface intersection algorithms introduced by Marciniak  [25], the width points on the bottom circle, and the intersection curve on the flank are evaluated numerically. Thus, the actual width 
                        
                           
                              w
                           
                           
                              a
                           
                        
                      is obtained.

Depicted in Fig. 17
                      are the approximation errors in the machining of the first quadric. Obviously, the approximate width 
                        w
                      is smaller than the actual width 
                        
                           
                              w
                           
                           
                              a
                           
                        
                     . The absolute error 
                        Δ
                        w
                        =
                        
                           |
                           w
                           −
                           
                              
                                 w
                              
                              
                                 a
                              
                           
                           |
                        
                      and relative error 
                        E
                        =
                        
                           
                              Δ
                              w
                           
                           
                              w
                              +
                              Δ
                              w
                           
                        
                      are respectively smaller than 
                        0.14
                        
                        
                           mm
                        
                      and 1.9% for 
                        ε
                        =
                        0.2
                        
                        
                           mm
                        
                     . With decreasing 
                        ε
                     , 
                        Δ
                        w
                      and 
                        E
                      further reduce. When 
                        ε
                        =
                        0.01
                        
                        
                           mm
                        
                     , 
                        Δ
                        w
                        =
                        0.02
                        
                        
                           mm
                        
                      and 
                        E
                        =
                        0.7
                        %
                     . Thus, the approximations are acceptable in practical machining. The same conclusions can be drawn from the second and third test surfaces.

More generally, the discrepancy between the translated quadric and the offset to the quadric increases as the machining tolerance 
                        ε
                      or the bottom radius of the flat-end cutter 
                        
                           
                              R
                           
                           
                              1
                           
                        
                      is increased. In all cases, the calculation of the machined strip width is conservative which may compromise the efficiency of the machining but not the quality. The tacit assumption is that with values of 
                        ε
                      and 
                        
                           
                              R
                           
                           
                              1
                           
                        
                      appropriate to the finishing stage, the approximations are acceptable. However, in other situations where the values of 
                        ε
                      and 
                        
                           
                              R
                           
                           
                              1
                           
                        
                      are relatively large, the error in the machined strip width might not be small enough to ignore. Then it would probably be better to approximate the offset surface directly by a quadric.

@&#CONCLUSIONS@&#

The theory for optimising the orientation of a flat-end cutter on a quadric has been presented in this paper, with sections on local gouging avoidance, rear gouging avoidance and evaluating the machined strip width. The aim has been to fully exploit the two orientation angles 
                        
                           (
                           α
                           ,
                           β
                           )
                        
                      of the cutter, in order to maximise the machined strip width 
                        w
                      whilst avoiding local and rear gouging. Three intrinsically different examples have been presented to illustrate the theory and the results have been verified using a commercial CAM software package.

In current CAD/CAM systems, a design surface is typically represented by an assembly of patches in Bézier, B-spline or NURBS form, which are unlikely to be exact quadrics. However, the essence of the quadric method (QM)  [2] is that the design surface in the locality of each CC point can be closely approximated by two osculating quadrics, one lying above the surface to orient the cutter and the other lying below the surface to evaluate the machined strip width. Fig. 18
                      illustrates an example of applying the theory to orient the cutter in the machining of a human surface along two tool passes. Further details can be found in the quadric method (QM)  [2] and the integrated method (IM)  [3].

The quadric fitting of the QM  [2] and evaluation of the machined strip width are both based on algebraic rather than geometric distances. It is a well-established simplifying approximation [25,12] and is most appropriate to the finishing stage of machining. However, with increasing values of the machining tolerance 
                        ε
                      and cutter radius 
                        
                           
                              R
                           
                           
                              1
                           
                        
                     , the calculations may become too conservative. Further research is needed to determine whether it would be better, particularly with extreme date, to approximate the offset directly by a quadric. A first step might be to consider in detail the generalisation for a fillet-end cutter, using an appropriate offset of the design surface and the concept of geometric equivalency [19].

@&#REFERENCES@&#

