@&#MAIN-TITLE@&#Improved integer linear programming formulations for the job Sequencing and tool Switching Problem

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study the job Sequencing and tool Switching Problem, arising in computer systems.


                        
                        
                           
                           We study the polyhedral combinatorics of the problem.


                        
                        
                           
                           We develop new integer linear programming formulations for the problem.


                        
                        
                           
                           We show that the formulations are provably better than the current state-of-the-art.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Job sequencing

Tool switching

Traveling salesman problem

Combinatorial optimization

Integer programming

@&#ABSTRACT@&#


               
               
                  In this article we investigate the job Sequencing and tool Switching Problem (SSP), a 
                        NP
                     -hard combinatorial optimization problem arising from computer and manufacturing systems. Starting from the results described in Tang and Denardo (1987), Crama et al. (1994) and Laporte et al. (2004), we develop new integer linear programming formulations for the problem that are provably better than the alternative ones currently described in the literature. Computational experiments show that the lower bounds obtained by the linear relaxation of the considered formulations improve, on average, upon those currently described in the literature and suggest, at the same time, new directions for the development of future exact solution approaches.
               
            

@&#INTRODUCTION@&#

In manufacturing systems it often happens that a set of jobs, each one requiring a specific set of tools, has to be sequentially processed in a flexible machine with a capacitated tool magazine (Crama, 1997; Crama, Moonen, Spieksma, and Talloen, 2007; Tang and Denardo, 1987). The capacity of the magazine is usually suited to store the tools required by any job, but it is usually insufficient to store, at the same time, all of the involved tools. Hence, operations of tools switching (i.e., the removal of a tool from the magazine and the insertion of a new one in its place) may be necessary to sequentially process the considered set. This situation often occurs e.g., in metal working industries, where automatic machines are used to manufacture parts. Each machine performs operations by using the tools placed in its limited capacity tool magazine and requires tool switching operations when completing a job and moving to the next one in the sequence (Tang and Denardo, 1987). This situation also occurs in other contexts, such as computer systems. Specifically, a modern computer system has k pages of fast memory and 
                        
                           n
                           −
                           k
                        
                      pages of slow memory. The system usually has to satisfy a sequence of requests to pages in their order of occurrence. A request can be addressed only if the required page is in the fast memory. If the request cannot be addressed, a page fault occurs and a page in the fast memory must be selected and moved to the slow memory in order to make room for the requested page (McGeoch and Sleator, 1994).

Tools switching operations can be performed either in groups or one at a time, depending on the specific application. However, they are generally time consuming and/or expensive, hence it is usually convenient to process the jobs in such a way that the overall number of tool switches is minimized.

The switching cost may be tool and/or application dependent as shown in Tang and Denardo (1987), Crama (1997), Crama et al. (2007), Crama, Kolen, Oerlemans, and Spieksma (1994), Balakrishnan and Chakravarty (2001), Belady (1966), Blazewicz and Finke (1994), McGeoch and Sleator (1994), Privault and Finke (2000). In this article we just focus on the simplest (although the main) version of the switching cost, characterized by being uniform and tool independent, and we investigate the problem of determining the job processing sequence inducing the minimum overall switching cost. Such a problem is known in the literature as the job Sequencing and tool Switching Problem (SSP) (Crama et al., 1994; Ghiani, Grieco, and Guerriero, 2010; Laporte, Salazar-Gonzáles, and Semet, 2004; Tang and Denardo, 1987). An example of an instance of the SSP is shown in Table 1
                     . In particular, the first row in the table provides the labels of the jobs and the corresponding processing order; the last row provides the capacity of the magazine. Each column in the table refers to a particular job in the considered set and specifies the tools necessary to its processing. The empty entries in each column denote jobs requiring a number of tools smaller than the capacity of the magazine. A solution to an instance of the SSP is obtained by specifying both the sequence in which the jobs have to be processed and the tools that have to be in the magazine when a given job is processed. For example, Table 2
                      shows a feasible solution to the instance shown in Table 1. In this case, the job processing sequence is {8, 1, 6, 4, 2, 5, 10, 3, 9, 7}; the circled tools represent tools that are unnecessary to process a specific job, but that may prove useful to decrease the overall number of switches induced by a specific job sequence. The circled tools can be added only if a job requires a number of tools smaller than the capacity of the magazine. The solution induces an overall number of tool switches equal to 15, in particular: 4 tool switches to load the tools required by job 8; 1 tool switch in the transition from job 8 to job 1; 1 tool switch in the transition from job 1 to job 6; 2 tool switches in the transition from job 6 to job 4; 2 tool switches in the transition from job 4 to job 2; and 1 tool switch in each of the remaining transitions. The size (i.e., the number of jobs and tools) of an instance of the SSP depends on the nature of the considered application and can easily range from dozens (e.g., in manufacturing systems) to hundreds (e.g., in computer systems) of jobs and tools.

Although numerous applications of the SSP appeared in the literature since 1966 (see e.g., Balakrishnan and Chakravarty, 2001; Belady, 1966; Blazewicz and Finke, 1994; Crama et al., 1994; Crama et al., 2007; McGeoch and Sleator, 1994; Privault and Finke, 2000), the problem was formally stated only in 1987 by Tang and Denardo (1987). The authors first observed that the optimal solution to an instance of the SSP does not change if one removes from the instance a job whose tool set is a subset of the tool set required by another job. The authors called this property the dominance rule. For example, job 10 in Table 1 requires tools 5 and 7 i.e., a subset of the tool set required by job 4. Hence, job 10 can be removed from the instance without affecting the corresponding optimal solution. If we apply the dominance rule also to jobs 7, 8 and 9, we obtain a new instance of the SSP (see Table 3
                     ) characterized by a smaller size. Unless not explicitly stated, in this article we will always assume to work with instances of the SSP containing only jobs requiring non-dominated tool sets.


                     Tang and Denardo (1987) also investigated a number of practical aspects of the problem and first pointed out the relationship between the SSP and the Traveling Salesman Problem (TSP) (see Garey and Johnson, 2003). In particular, the authors observed that an instance of the SSP degenerates into an instance of the TSP when (i) the tool set of each job has cardinality constant and equal to the capacity of the magazine and (ii) the switching cost is uniform and tool independent. This observation constitutes the earliest proof of NP-hardness of the SSP; a more formal and thorough analysis of the complexity of the SSP was performed seven years later by Crama et al. (1994).

Interestingly, Tang and Denardo showed that the SSP can be decomposed into two nested subproblems called:

                        
                           1.
                           
                              the Sequencing Problem (SP), consisting of identifying an (optimal) job processing sequence;


                              the Tooling Problem (TP), consisting of determining, for a given job processing sequence, what tools should be loaded in the tool magazine at each position of the sequence, in order to minimize the total number of tool switches.

The authors showed that the TP can be solved in polynomial time via a greedy algorithm called Keep Tool Needed Soonest (KTNS); in contrast, the SP constitutes the hardest part of the problem. Tang and Denardo developed an integer linear programming formulation to exactly solve the problem and a constructive heuristic to approximate its optimal solution. However, the performances of both approaches proved to be rather disappointing in practice (Laporte et al., 2004). Hence, numerous research efforts focused on developing solution approaches aiming at solving, at least heuristically, instances of the SSP, see e.g., Crama (1997), Crama et al. (2007), Crama et al. (1994), Askin, Sodhi, and Sen (1994), Avci and Akturk (1996), Bard (1988), Gray, Seidmann, and Stecke (1993), Hertz and Widmer (1993), Hertz, Laporte, Mittaz, and Stecke (1998). Surprisingly enough, however, in the last two decades only a limited number of exact solution approaches have been proposed in the literature, namely Laporte et al. (2004) and Ghiani et al. (2010).


                     Laporte et al. (2004) proposed an Integer Linear Programming (ILP) formulation and a branch-and-bound algorithm to exactly solve the SSP. The authors showed that the proposed ILP formulation was tighter than Tang and Denardo’s but, at the same time, unable to solve instances containing more than 10 jobs within 1 hour of computing time. In contrast, the branch-and-bound algorithm and the corresponding combinatorial lower bounds proved to be more successful, allowing the solution of instances of the SSP containing up to 25 jobs within the same runtime limit. Ghiani et al. (2010) proposed a different exact solution approach for the SSP based on modeling the problem as a nonlinear TSP. The authors improved the KTNS greedy algorithm for the TP and developed a branch-and-cut algorithm for the SSP exploiting a number of symmetry breaking techniques, dominance rules, and specific lower bounds. Their computational experiments showed that the proposed algorithm outperforms the performance of Laporte et al., being able to solve instances of the SSP containing up to 45 jobs within 1 hour of computing time.

The weak lower bounds provided by the linear programming relaxations of the ILP formulations currently described in the literature on the SSP possibly are one of the main reasons for explaining the limited number of exact solution approaches for the problem. In this article, we address this major limitation and investigate new ILP formulations for the SSP able to provide tighter lower bounds to the problem. Starting from the results discussed in Tang and Denardo (1987), Crama (1997), Crama et al. (1994), Laporte et al. (2004), Ghiani et al. (2010), in Section 2 we briefly review the main ILP formulations for the SSP currently described in the literature. In Section 3 we present new ILP formulations for the SSP that have a Linear Programming (LP) relaxation that is provably tighter than the LP relaxation of the previous ones described in the literature. We investigate the combinatorial interpretation of the proposed formulations and we propose valid inequalities to further improve the lower bounds provided by their linear programming relaxations. In Sections 4.4 and 4.5 we present computational results obtained by running the proposed formulations on a number of benchmark instances for the SSP and discuss the performances of each formulation. The theoretical findings discussed in this article may provide new insights about the combinatorial aspects of the problem and may suggest, at the same time, new directions for the development of future exact solution approaches for the problem.

Before proceeding, in the next section we introduce some notation that will prove useful throughout the article.

Consider a set 
                        
                           J
                           =
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                           }
                        
                      of n jobs to process in the flexible machine and let 
                        
                           T
                           =
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           m
                           }
                        
                      be the set of m tools necessary to process the jobs in J. Denote Tj
                      as the set of tools necessary to process job j ∈ J; Jt
                      as the set of jobs using tool t ∈ T; 
                        c
                     
                     Jt
                      as the complement of Jt
                     ; and C ≥ max 
                        j
                     {|Tj
                     |} as the capacity of the magazine, i.e., the maximum number of tools that can be stored in the magazine of the machine at any time. A job processing sequence s, is a sequence of n naturals representing the processing order for the jobs. For example, by referring to the example in Table 1, 
                        
                           s
                           =
                           {
                           1
                           ,
                           2
                           ,
                           3
                           ,
                           4
                           ,
                           5
                           ,
                           6
                           }
                        
                      represents a job processing sequence having job 1 as first job to process, job 2 as second job to process, and so on. Tang and Denardo proposed the following formulation for the SSP based on the assignment of jobs to the positions of a processing sequence (Tang and Denardo, 1987).

Denote 
                           
                              K
                              =
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              }
                           
                         as the set of n positions in the job sequence to be determined. Let 
                           
                              u
                              
                                 j
                              
                              k
                           
                         be a decision variable equal to 1 if job j is processed in position k and 0 otherwise. Similarly, let 
                           
                              v
                              
                                 t
                              
                              k
                           
                         be a decision variable equal to 1 if tool t is present when processing a job in position k and 0 otherwise. Finally, let 
                           
                              w
                              
                                 t
                              
                              k
                           
                         be a decision variable equal to 1 if tool t is present when processing job k and not when processing job 
                           
                              k
                              −
                              1
                              ,
                           
                         and 0 otherwise. Then, a valid formulation for the problem is the following:

                           Formulation 1
                           
                              (Tang and Denardo, 1987),

                                 
                                    (1a)
                                    
                                       
                                          min
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             v
                                             
                                                t
                                             
                                             1
                                          
                                          +
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                K
                                                ∖
                                                {
                                                1
                                                }
                                             
                                          
                                          
                                             w
                                             
                                                t
                                             
                                             k
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (1b)
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             u
                                             
                                                j
                                             
                                             k
                                          
                                          =
                                          1
                                          
                                          ∀
                                          
                                          k
                                          ∈
                                          K
                                       
                                    
                                 
                              
                              
                                 
                                    (1c)
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                K
                                             
                                          
                                          
                                             u
                                             
                                                j
                                             
                                             k
                                          
                                          =
                                          1
                                          
                                          ∀
                                          
                                          j
                                          ∈
                                          J
                                       
                                    
                                 
                              
                              
                                 
                                    (1d)
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   J
                                                   t
                                                
                                             
                                          
                                          
                                             u
                                             
                                                j
                                             
                                             k
                                          
                                          ≤
                                          
                                             v
                                             
                                                t
                                             
                                             k
                                          
                                          
                                          ∀
                                          
                                          k
                                          ∈
                                          K
                                          ,
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                              
                                 
                                    (1e)
                                    
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             v
                                             
                                                t
                                             
                                             k
                                          
                                          ≤
                                          C
                                          
                                          ∀
                                          
                                          k
                                          ∈
                                          K
                                       
                                    
                                 
                              
                              
                                 
                                    (1f)
                                    
                                       
                                          
                                             v
                                             
                                                t
                                             
                                             k
                                          
                                          −
                                          
                                             v
                                             t
                                             
                                                k
                                                −
                                                1
                                             
                                          
                                          ≤
                                          
                                             w
                                             
                                                t
                                             
                                             k
                                          
                                          
                                          ∀
                                          
                                          k
                                          ∈
                                          K
                                          ∖
                                          
                                             {
                                             1
                                             }
                                          
                                          ,
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                              
                                 
                                    (1g)
                                    
                                       
                                          
                                             u
                                             
                                                j
                                             
                                             k
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          k
                                          ∈
                                          K
                                          ,
                                          j
                                          ∈
                                          J
                                       
                                    
                                 
                              
                              
                                 
                                    (1h)
                                    
                                       
                                          
                                             v
                                             
                                                t
                                             
                                             k
                                          
                                          ,
                                          
                                             w
                                             
                                                t
                                             
                                             k
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          k
                                          ∈
                                          K
                                          ,
                                          t
                                          ∈
                                          T
                                          .
                                       
                                    
                                 
                              
                           

The objective function (1a) minimizes the total number of tool switches. In particular, the addend 
                           
                              
                                 ∑
                                 
                                    t
                                    ∈
                                    T
                                 
                              
                              
                                 v
                                 
                                    t
                                 
                                 1
                              
                           
                         takes into account the loading of the magazine when processing the first job in the sequence. Constraints (1b) and (1c) are assignment constraints. Constraints (1d) impose that no job requiring tool t can be processed in position k if such a tool is not present in the magazine at that position. Constraints (1e) guarantee that the magazine capacity is never exceeded. Note that these constraints can be stated as equalities since there is no need to remove unnecessary tools from the magazine (Laporte et al., 2004). Finally, constraints (1f) impose that a tool switch must be counted whenever a tool is present in position k but was not present in position 
                           
                              k
                              −
                              1
                           
                        .

It is worth noting that the solution 
                           
                              
                                 u
                                 
                                    j
                                 
                                 k
                              
                              =
                              1
                              /
                              n
                              ,
                           
                         for all j ∈ J and k ∈ K, 
                           
                              
                                 v
                                 
                                    t
                                 
                                 k
                              
                              =
                              
                                 |
                                 
                                    J
                                    t
                                 
                                 |
                              
                              /
                              n
                           
                         for all k ∈ K and t ∈ T, and 
                           
                              
                                 w
                                 
                                    t
                                 
                                 k
                              
                              =
                              0
                              ,
                           
                         for all k ∈ K and t ∈ T, is feasible and optimal for the linear programming relaxation of Formulation 1. To overcome such a drawback, Laporte et al. (2004) proposed an alternative integer linear programming formulation that exploits the analogies between the SP and the TSP. Specifically, the authors introduced a dummy job 0 to represent the start and stop operations and set by convention 
                           
                              
                                 T
                                 0
                              
                              =
                              ∅
                           
                        . Subsequently, they modeled the SSP as a particular version of the TSP in which the optimal hamiltonian circuit has to (i) start and end at vertex (job) 0, (ii) visit all the remaining vertices (jobs) exactly once and (iii) have as a weight on the edge (i, j) of the circuit the corresponding number of tool switches relative to the transition from job i to job j. In order to describe in detail the proposed formulation, denote 
                           
                              
                                 J
                                 0
                              
                              =
                              J
                              ∪
                              
                                 {
                                 0
                                 }
                              
                              ,
                           
                        
                        
                           
                              
                                 J
                                 i
                              
                              =
                              J
                              ∖
                              
                                 {
                                 i
                                 }
                              
                              ,
                           
                         for all i ∈ J, and 
                           
                              
                                 J
                                 
                                    0
                                 
                                 i
                              
                              =
                              
                                 J
                                 0
                              
                              ∖
                              
                                 {
                                 i
                                 }
                              
                              ,
                           
                         for all i ∈ J. Moreover, denote G as the complete graph having as vertexset J
                        0.

Let xij
                         be a decision variable equal to 1 if job j follows immediately job i in the sequence and 0 otherwise, for all i, j ∈ J
                        0, i ≠ j. Moreover, let 
                           
                              y
                              
                                 j
                              
                              t
                           
                         be a decision variable equal to 1 if tool t ∈ T is in the magazine when job j is processed and 0 otherwise, for all j ∈ J
                        0, t ∈ T. Similarly, let 
                           
                              z
                              
                                 j
                              
                              t
                           
                         be a decision variable equal to 1 if tool t ∈ T is inserted when processing job j and 0 otherwise, for all j ∈ J
                        0, t ∈ T. Then, Laporte et al.’s formulation can be stated as follows:

                           Formulation 2
                           
                              (Laporte et al., 2004),

                                 
                                    (2a)
                                    
                                       
                                          min
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                
                                                   T
                                                   j
                                                
                                             
                                          
                                          
                                             z
                                             
                                                j
                                             
                                             t
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (2b)
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   J
                                                   
                                                      0
                                                   
                                                   i
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          1
                                          
                                          ∀
                                          
                                          i
                                          ∈
                                          
                                             J
                                             0
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (2c)
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   J
                                                   
                                                      0
                                                   
                                                   j
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          1
                                          
                                          ∀
                                          
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (2d)
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ∈
                                                         S
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                         ≠
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ≤
                                          
                                             |
                                             S
                                             |
                                          
                                          −
                                          1
                                          
                                          ∀
                                          
                                          S
                                          ⊂
                                          
                                             J
                                             0
                                          
                                          ,
                                          2
                                          ≤
                                          
                                             |
                                             S
                                             |
                                          
                                          ≤
                                          n
                                          −
                                          1
                                       
                                    
                                 
                              
                              
                                 
                                    (2e)
                                    
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             y
                                             
                                                j
                                             
                                             t
                                          
                                          ≤
                                          C
                                          
                                          ∀
                                          
                                          j
                                          ∈
                                          J
                                       
                                    
                                 
                              
                              
                                 
                                    (2f)
                                    
                                       
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          +
                                          
                                             y
                                             
                                                j
                                             
                                             t
                                          
                                          −
                                          
                                             y
                                             
                                                i
                                             
                                             t
                                          
                                          ≤
                                          
                                             z
                                             
                                                j
                                             
                                             t
                                          
                                          +
                                          1
                                          
                                          ∀
                                          
                                          i
                                          ,
                                          j
                                          ∈
                                          J
                                          ,
                                          i
                                          ≠
                                          j
                                          ,
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                              
                                 
                                    (2g)
                                    
                                       
                                          
                                             x
                                             
                                                0
                                                j
                                             
                                          
                                          +
                                          
                                             y
                                             
                                                j
                                             
                                             t
                                          
                                          ≤
                                          
                                             z
                                             
                                                j
                                             
                                             t
                                          
                                          +
                                          1
                                          
                                          ∀
                                          
                                          j
                                          ∈
                                          J
                                          ,
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                              
                                 
                                    (2h)
                                    
                                       
                                          
                                             y
                                             
                                                j
                                             
                                             t
                                          
                                          =
                                          1
                                          
                                          ∀
                                          
                                          j
                                          ∈
                                          J
                                          ,
                                          t
                                          ∈
                                          
                                             T
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (2i)
                                    
                                       
                                          
                                             z
                                             
                                                j
                                             
                                             t
                                          
                                          =
                                          0
                                          
                                          ∀
                                          
                                          j
                                          ∈
                                          J
                                          ,
                                          t
                                          ∈
                                          T
                                          ∖
                                          
                                             T
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (2j)
                                    
                                       
                                          
                                             y
                                             
                                                j
                                             
                                             t
                                          
                                          ,
                                          
                                             z
                                             
                                                j
                                             
                                             t
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          j
                                          ∈
                                          J
                                          ,
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                              
                                 
                                    (2k)
                                    
                                       
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          i
                                          ,
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                          .
                                       
                                    
                                 
                              
                           

The objective function (2a) minimizes the overall number of tool switches. Constraints (2b) and (2c) are assignment constraints. Constraints (2d) prevent the arising of subtours. Constraints (2e) are capacity constraints. Constraints (2f) prevent that job j follows job i in the optimal sequence if, at the same time, job j requires tool t and tool t is neither carried from job i nor inserted for job j. Constraints (2g) are a special case of constraints (2f) and account for the loading of the magazine relative to the transition from the dummy job 0 to the first job in the optimal job processing sequence. Finally, constraints (2h)–(2i) ensure that a tool switch is only performed when the tool is required to immediately execute a job.

As shown in Laporte et al. (2004), the linear programming relaxation of Formulation 2 dominates the relaxation of Tang and Denardo’s model. However, computational experiments showed that the lower bounds provided by Formulation 2 are still generally poor (Laporte et al., 2004). This fact in turn prevents Formulation 2 from solving instances of the SSP containing more than 10 jobs within 1 hour of computing time (Laporte et al., 2004). In order to improve the lower bounds obtained by linear programming, in the next section we shall present a number of alternative ILP formulations for the SSP whose LP relaxations are provably tighter than the LP relaxations of Formulation 2.

Consider a decision variable 
                           
                              y
                              
                                 i
                                 j
                              
                              t
                           
                         equal to 1 if in the processing sequence a tool t ∈ T is carried in the transition from job i to job j, i, j ∈ J
                        0, i ≠ j, and 0 otherwise. Similarly, let 
                           
                              z
                              
                                 i
                                 j
                              
                              t
                           
                         be a decision variable equal to 1 if in the processing sequence a tool t ∈ T has to be added in the transition from job i to job j, i, j ∈ J
                        0, i ≠ j, and 0 otherwise. Then, a valid formulation for the SSP is the following:

                           Formulation 3
                           
                              
                                 
                                    (3a)
                                    
                                       
                                          min
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ∈
                                                         
                                                            J
                                                            0
                                                         
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                         ≠
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                
                                                   T
                                                   j
                                                
                                             
                                          
                                          
                                             z
                                             
                                                i
                                                j
                                             
                                             t
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (3b)
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   J
                                                   
                                                      0
                                                   
                                                   i
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          1
                                          
                                          ∀
                                          
                                          i
                                          ∈
                                          
                                             J
                                             0
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (3c)
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   J
                                                   
                                                      0
                                                   
                                                   j
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          1
                                          
                                          ∀
                                          
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (3d)
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ∈
                                                         S
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                         ≠
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ≤
                                          
                                             |
                                             S
                                             |
                                          
                                          −
                                          1
                                          
                                          ∀
                                          
                                          S
                                          ⊂
                                          
                                             J
                                             0
                                          
                                          ,
                                          2
                                          ≤
                                          
                                             |
                                             S
                                             |
                                          
                                          ≤
                                          n
                                          −
                                          1
                                       
                                    
                                 
                              
                              
                                 
                                    (3e)
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         i
                                                         ∈
                                                         
                                                            J
                                                            
                                                               0
                                                            
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             )
                                          
                                          =
                                          1
                                          
                                          ∀
                                          
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                          ,
                                          t
                                          ∈
                                          
                                             T
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (3f)
                                    
                                       
                                          
                                             y
                                             
                                                i
                                                j
                                             
                                             t
                                          
                                          +
                                          
                                             z
                                             
                                                i
                                                j
                                             
                                             t
                                          
                                          ≤
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          ∀
                                          
                                          i
                                          ,
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                          :
                                          i
                                          ≠
                                          j
                                          ,
                                          t
                                          ∈
                                          T
                                          :
                                          t
                                          ∉
                                          
                                             T
                                             i
                                          
                                          ,
                                          t
                                          ∈
                                          
                                             T
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (3g)
                                    
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             (
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             )
                                          
                                          ≤
                                          C
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          ∀
                                          
                                          i
                                          ,
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                          :
                                          i
                                          ≠
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    (3h)
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         k
                                                         ∈
                                                         
                                                            J
                                                            
                                                               0
                                                            
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                                t
                                             
                                             +
                                             
                                                z
                                                
                                                   k
                                                   i
                                                
                                                t
                                             
                                             )
                                          
                                          ≥
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         j
                                                         ∈
                                                         
                                                            J
                                                            
                                                               0
                                                            
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             y
                                             
                                                i
                                                j
                                             
                                             t
                                          
                                          
                                          ∀
                                          
                                          i
                                          ∈
                                          
                                             J
                                             0
                                          
                                          ,
                                          
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                              
                                 
                                    (3i)
                                    
                                       
                                          
                                             y
                                             
                                                i
                                                j
                                             
                                             t
                                          
                                          ≥
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          ∀
                                          
                                          i
                                          ,
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                          :
                                          i
                                          ≠
                                          j
                                          ,
                                          t
                                          ∈
                                          
                                             T
                                             i
                                          
                                          ∩
                                          
                                             T
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (3j)
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                             
                                             t
                                          
                                          =
                                          0
                                          
                                          ∀
                                          
                                          i
                                          ,
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                          :
                                          i
                                          ≠
                                          j
                                          ,
                                          t
                                          ∈
                                          T
                                          ∖
                                          
                                             T
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (3k)
                                    
                                       
                                          
                                             y
                                             
                                                0
                                                j
                                             
                                             t
                                          
                                          =
                                          0
                                          
                                          ∀
                                          
                                          j
                                          ∈
                                          J
                                          ,
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                              
                                 
                                    (3l)
                                    
                                       
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          i
                                          ,
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                          :
                                          i
                                          ≠
                                       
                                    
                                 
                              
                              
                                 
                                    (3m)
                                    
                                       
                                          
                                             y
                                             
                                                i
                                                j
                                             
                                             t
                                          
                                          ,
                                          
                                             z
                                             
                                                i
                                                j
                                             
                                             t
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          i
                                          ,
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                          :
                                          i
                                          ≠
                                          j
                                          ,
                                          t
                                          ∈
                                          T
                                          .
                                       
                                    
                                 
                              
                           

Constraints (3b)–(3d) are equivalent to constraints (2b)–(2d) in Formulation 2. Constraints (3e) impose that in the transition from job i to job j a given tool t ∈ Tj
                         is either carried from job i or it is added in the transition. Constraints (3f) impose that a tool t ∈ Tj
                         can be either carried from a previous job or added in the transition, only if such a transition is in the optimal job processing sequence. Constraints (3g) are similar to the capacity constraints (2e) in Formulation 2. Constraints (3h) impose that if a tool t ∈ T is carried in the transition from job i to any job j then it must be either carried or added in the transition from another job k to job i, k ≠ i. Constraints (3i) impose to carry all of the tools in Ti
                        ∩Tj
                         when considering the transition from job i to job j. Constraints (3j) are analogous to constraints (2i) in Formulation 2. Finally, constraints (3k) account for the loading of the magazine relative to the transition from the dummy job 0 to the first job in the optimal job processing sequence.

Variables 
                           
                              y
                              
                                 j
                              
                              t
                           
                         and 
                           
                              z
                              
                                 j
                              
                              t
                           
                         in Formulation 2 and variables 
                           
                              y
                              
                                 i
                                 j
                              
                              t
                           
                         and 
                           
                              z
                              
                                 i
                                 j
                              
                              t
                           
                         in Formulation 3 are related by the following equations:

                           
                              (4)
                              
                                 
                                    
                                       y
                                       
                                          j
                                       
                                       t
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          
                                             J
                                             0
                                             j
                                          
                                       
                                    
                                    
                                       (
                                       
                                          y
                                          
                                             i
                                             j
                                          
                                          t
                                       
                                       +
                                       
                                          z
                                          
                                             i
                                             j
                                          
                                          t
                                       
                                       )
                                    
                                    
                                    ∀
                                    
                                    j
                                    ∈
                                    J
                                    ,
                                    t
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       z
                                       
                                          j
                                       
                                       t
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          
                                             J
                                             0
                                             j
                                          
                                       
                                    
                                    
                                       z
                                       
                                          i
                                          j
                                       
                                       t
                                    
                                    
                                    ∀
                                    
                                    j
                                    ∈
                                    J
                                    ,
                                    t
                                    ∈
                                    T
                                    .
                                 
                              
                           
                        These relationships can be used to show that Formulation 3 is tighter than Formulation 2. To this end, we add (4), (5) and (2j) to Formulation 3. Note that this addition does not alter the LP relaxation of Formulation 3 since the new constraints only define the old variables 
                           
                              y
                              j
                              t
                           
                         and 
                           
                              z
                              j
                              t
                           
                        . After adding these constrains, (3e) and (2h) become equivalent. Similarly, the surrogates of constraints (3g) and (3j) with respect to index i become equivalent to constraints (2e) and (2i), respectively. Now, if we combine Eqs. (4) and (5) together with (3c), (3f) and (3h) then we obtain an inequality that dominates constraints (2f) in Formulation 2. Specifically, define 
                           
                              
                                 J
                                 0
                                 
                                    i
                                    j
                                 
                              
                              =
                              
                                 J
                                 0
                              
                              ∖
                              
                                 {
                                 i
                                 ,
                                 j
                                 }
                              
                           
                         and add up constraints (3f) for all jobs in 
                           
                              J
                              0
                              
                                 i
                                 j
                              
                           
                         by using constraints (3c). Then, it holds that

                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   
                                                      J
                                                      0
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   y
                                                   
                                                      k
                                                      j
                                                   
                                                   t
                                                
                                                +
                                                
                                                   z
                                                   
                                                      k
                                                      j
                                                   
                                                   t
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             ≤
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   
                                                      J
                                                      0
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   k
                                                   j
                                                
                                             
                                             =
                                             1
                                             −
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        By adding 
                           
                              
                                 y
                                 
                                    i
                                    j
                                 
                                 t
                              
                              +
                              
                                 z
                                 
                                    i
                                    j
                                 
                                 t
                              
                           
                         to both sides of (6) we get

                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   
                                                      J
                                                      0
                                                      j
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   y
                                                   
                                                      k
                                                      j
                                                   
                                                   t
                                                
                                                +
                                                
                                                   z
                                                   
                                                      k
                                                      j
                                                   
                                                   t
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             ≤
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        It is worth noting that constraint (3h) can be rewritten as

                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   y
                                                   
                                                      k
                                                      i
                                                   
                                                   t
                                                
                                                +
                                                
                                                   z
                                                   
                                                      k
                                                      i
                                                   
                                                   t
                                                
                                                )
                                             
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               
                                                                  i
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   k
                                                
                                                t
                                             
                                             ≥
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Then, it holds that

                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   
                                                      J
                                                      0
                                                      j
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   y
                                                   
                                                      k
                                                      j
                                                   
                                                   t
                                                
                                                +
                                                
                                                   z
                                                   
                                                      k
                                                      j
                                                   
                                                   t
                                                
                                                )
                                             
                                          
                                       
                                       
                                          ≤
                                       
                                       
                                          
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             1
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≤
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   
                                                      J
                                                      0
                                                      i
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   y
                                                   
                                                      k
                                                      i
                                                   
                                                   t
                                                
                                                +
                                                
                                                   z
                                                   
                                                      k
                                                      i
                                                   
                                                   t
                                                
                                                )
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   
                                                      J
                                                      0
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   k
                                                
                                                t
                                             
                                             +
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Now, note that: (i) the first term in the right-hand-side of (9) is equal to 
                           
                              y
                              
                                 i
                              
                              t
                           
                        ; (ii) the second term is less than or equal to 0;and (iii) the third term is less than or equal to 
                           
                              z
                              
                                 j
                              
                              t
                           
                        . Hence, we have

                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             y
                                             
                                                j
                                             
                                             t
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   
                                                      J
                                                      0
                                                      j
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   y
                                                   
                                                      k
                                                      j
                                                   
                                                   t
                                                
                                                +
                                                
                                                   z
                                                   
                                                      k
                                                      j
                                                   
                                                   t
                                                
                                                )
                                             
                                             ≤
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≤
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   
                                                      J
                                                      0
                                                      i
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   y
                                                   
                                                      k
                                                      i
                                                   
                                                   t
                                                
                                                +
                                                
                                                   z
                                                   
                                                      k
                                                      i
                                                   
                                                   t
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             ×
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   
                                                      J
                                                      0
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   k
                                                
                                                t
                                             
                                             +
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             1
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≤
                                             
                                                y
                                                
                                                   i
                                                
                                                t
                                             
                                             +
                                             
                                                z
                                                
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        which implies that

                           Proposition 1
                           The objective function value of the linear programming relaxation of Formulation 3 is greater than or equal to the linear programming relaxation of Formulation 2.

By just exploiting the definitions of variables 
                           
                              y
                              
                                 i
                                 j
                              
                              t
                           
                         and 
                           
                              
                                 z
                                 
                                    i
                                    j
                                 
                                 t
                              
                              ,
                           
                         it is possible to replace constraints (3f) by the following three new sets of constraints:

                           
                              (11a)
                              
                                 
                                    
                                       y
                                       
                                          i
                                          j
                                       
                                       t
                                    
                                    +
                                    
                                       z
                                       
                                          i
                                          j
                                       
                                       t
                                    
                                    =
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    
                                    ∀
                                    
                                    i
                                    ,
                                    j
                                    ∈
                                    
                                       J
                                       0
                                    
                                    :
                                    i
                                    ≠
                                    j
                                    ,
                                    t
                                    ∈
                                    T
                                    :
                                    t
                                    ∉
                                    
                                       T
                                       i
                                    
                                    ,
                                    t
                                    ∈
                                    
                                       T
                                       j
                                    
                                 
                              
                           
                        
                        
                           
                              (11b)
                              
                                 
                                    
                                       y
                                       
                                          i
                                          j
                                       
                                       t
                                    
                                    =
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    
                                    ∀
                                    
                                    i
                                    ,
                                    j
                                    ∈
                                    
                                       J
                                       0
                                    
                                    :
                                    i
                                    ≠
                                    j
                                    ,
                                    t
                                    ∈
                                    T
                                    :
                                    t
                                    ∈
                                    
                                       T
                                       i
                                    
                                    ∩
                                    
                                       T
                                       j
                                    
                                 
                              
                           
                        
                        
                           
                              (11c)
                              
                                 
                                    
                                       y
                                       
                                          i
                                          j
                                       
                                       t
                                    
                                    ≤
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    
                                    ∀
                                    
                                    i
                                    ,
                                    j
                                    ∈
                                    
                                       J
                                       0
                                    
                                    :
                                    i
                                    ≠
                                    j
                                    ,
                                    t
                                    ∈
                                    T
                                    :
                                    t
                                    ∉
                                    
                                       T
                                       j
                                    
                                    .
                                 
                              
                           
                        
                     

Constraints (11a) force a tool t ∈ T such that t∉Ti
                         and t ∈ Tj
                         to be either carried from job i or added in job j if the transition from job i to job j is actually considered in the optimal job processing sequence. Constraints (11b) force a tool t ∈ T such that t ∈ Ti
                        ∩Tj
                         to be carried from job i if the transition from job i to job j is considered in the optimal job processing sequence. Finally, constraints (11c) allow a tool t ∈ T such that t∉Tj
                         to be carried from job i if the transition from job i to job j is considered in the optimal job processing sequence. Interestingly, these new sets of constraints, in particular the equality constraints, can be used to reduce the size of Formulation 3. Specifically, we can use constraints (11a) to eliminate all of variables 
                           
                              z
                              
                                 i
                                 j
                              
                              t
                           
                         and constraints (11b) to eliminate variables 
                           
                              y
                              
                                 i
                                 j
                              
                              t
                           
                         when t ∈ Ti
                        ∩Tj
                        . In this way, we have to consider only variables 
                           
                              y
                              
                                 i
                                 j
                              
                              t
                           
                         defined for all i, j ∈ J
                        0 such that i ≠ j and for all t ∈ T such that either t∉Ti
                         or t ∈ Ti
                        ~and~t∉Tj
                        . In the light of this observation, constraints (3e) become redundant. In fact, for all j ∈ J
                        0 and t ∈ Tj
                        , it holds that

                           
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   y
                                                   
                                                      i
                                                      j
                                                   
                                                   t
                                                
                                                +
                                                
                                                   z
                                                   
                                                      i
                                                      j
                                                   
                                                   t
                                                
                                                )
                                             
                                             =
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               j
                                                            
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               j
                                                            
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                −
                                                
                                                   y
                                                   
                                                      i
                                                      j
                                                   
                                                   t
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        which is equivalent to

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               j
                                                            
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             =
                                             1
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               j
                                                            
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        which can be rewritten as

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               j
                                                            
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               j
                                                            
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             =
                                             1
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        which, in turn, due to (11b), becomes

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               j
                                                            
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               j
                                                            
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             =
                                             1
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Similarly, for all i, j ∈ J
                        0, i ≠ j, constraints (3g) can be rewritten as

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            T
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               i
                                                            
                                                            ,
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             ≤
                                             C
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        which is equivalent to

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            T
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               i
                                                            
                                                            ,
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                −
                                                
                                                   y
                                                   
                                                      i
                                                      j
                                                   
                                                   t
                                                
                                                )
                                             
                                             ≤
                                             C
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        which can be rewritten as

                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            T
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               i
                                                            
                                                            ,
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            T
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               i
                                                            
                                                            ,
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≤
                                             C
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The first term of (12) can in turn be expanded as

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            T
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               i
                                                            
                                                            ,
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            T
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               i
                                                            
                                                            ,
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            T
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               i
                                                            
                                                            ,
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            T
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               i
                                                            
                                                            ,
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≤
                                             C
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        By using (11b) we get

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            T
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               i
                                                            
                                                            ,
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            T
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               i
                                                            
                                                            ,
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            T
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               i
                                                            
                                                            ,
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            T
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               i
                                                            
                                                            ,
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≤
                                             C
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        which is equivalent to

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            T
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               i
                                                            
                                                            ,
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            T
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               i
                                                            
                                                            ,
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            T
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             ≤
                                             C
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        which leads to the constraint

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            T
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               i
                                                            
                                                            ,
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            T
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               i
                                                            
                                                            ,
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             ≤
                                             
                                                (
                                                C
                                                −
                                                |
                                             
                                             
                                                T
                                                j
                                             
                                             
                                                |
                                                )
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Finally, consider constraints (3h) and first assume that t ∈ Ti
                        . Then, it holds that

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               i
                                                            
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                z
                                                
                                                   k
                                                   i
                                                
                                                t
                                             
                                             ≥
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            j
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        By using (11a) we get

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               i
                                                            
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                −
                                                
                                                   y
                                                   
                                                      k
                                                      i
                                                   
                                                   t
                                                
                                                )
                                             
                                             ≥
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            j
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        which, in turn, can be rewritten as

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               i
                                                            
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               i
                                                            
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≥
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            j
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        By using (11b) and (3b) we obtain

                           
                              
                                 
                                    
                                       
                                          
                                             1
                                             =
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               i
                                                            
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   k
                                                   i
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               i
                                                            
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∉
                                                            
                                                               T
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≥
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            j
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        which, in turn, implies that the constraint is redundant. In contrast, if we assume that t∉Ti
                        , then variables 
                           
                              z
                              
                                 i
                                 j
                              
                              t
                           
                         are not defined and the constraint reduces to

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                                t
                                             
                                             ≥
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            j
                                                            ∈
                                                            
                                                               J
                                                               
                                                                  0
                                                               
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Thus, Formulation 3 reduces to

                           Formulation 4
                           
                              
                                 
                                    (13a)
                                    
                                       
                                          min
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             |
                                             
                                                T
                                                j
                                             
                                             |
                                          
                                          
                                             x
                                             
                                                0
                                                j
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ∈
                                                         J
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                         ≠
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         t
                                                         ∈
                                                         T
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                         ∉
                                                         
                                                            T
                                                            i
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                         ∈
                                                         
                                                            T
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             −
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                t
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (13b)
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   J
                                                   
                                                      0
                                                   
                                                   i
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          1
                                          
                                          ∀
                                          
                                          i
                                          ∈
                                          
                                             J
                                             0
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (13c)
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   J
                                                   
                                                      0
                                                   
                                                   j
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          1
                                          
                                          ∀
                                          
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (13d)
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ∈
                                                         S
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                         ≠
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ≤
                                          
                                             |
                                             S
                                             |
                                          
                                          −
                                          1
                                          
                                          ∀
                                          
                                          S
                                          ⊂
                                          
                                             J
                                             0
                                          
                                          ,
                                          2
                                          ≤
                                          
                                             |
                                             S
                                             |
                                          
                                          ≤
                                          n
                                          −
                                          1
                                       
                                    
                                 
                              
                              
                                 
                                    (13e)
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         k
                                                         ∈
                                                         
                                                            J
                                                            
                                                               0
                                                            
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             y
                                             
                                                k
                                                i
                                             
                                             t
                                          
                                          −
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         j
                                                         ∈
                                                         
                                                            J
                                                            
                                                               0
                                                            
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             y
                                             
                                                i
                                                j
                                             
                                             t
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          
                                          i
                                          ∈
                                          
                                             J
                                             0
                                          
                                          ,
                                          t
                                          ∈
                                          T
                                          ∖
                                          
                                             T
                                             i
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (13f)
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         t
                                                         ∈
                                                         T
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                         ∈
                                                         
                                                            T
                                                            i
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                         ∉
                                                         
                                                            T
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             y
                                             
                                                i
                                                j
                                             
                                             t
                                          
                                          +
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         t
                                                         ∈
                                                         T
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                         ∉
                                                         
                                                            T
                                                            i
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                         ∉
                                                         
                                                            T
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             y
                                             
                                                i
                                                j
                                             
                                             t
                                          
                                          ≤
                                          
                                             (
                                             C
                                             −
                                             |
                                          
                                          
                                             T
                                             j
                                          
                                          
                                             |
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          ∀
                                          
                                          i
                                          ,
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                          :
                                          i
                                          ≠
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    (13g)
                                    
                                       
                                          
                                             y
                                             
                                                i
                                                j
                                             
                                             t
                                          
                                          ≤
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          ∀
                                          
                                          i
                                          ,
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                          :
                                          i
                                          ≠
                                          j
                                          ,
                                          t
                                          ∈
                                          T
                                          :
                                          t
                                          ∉
                                          
                                             T
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (13h)
                                    
                                       
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          i
                                          ,
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                          :
                                          i
                                          ≠
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    (13i)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                      
                                                         i
                                                         j
                                                      
                                                      t
                                                   
                                                   ∈
                                                   
                                                      {
                                                      0
                                                      ,
                                                      1
                                                      }
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   
                                                   ∀
                                                   
                                                   i
                                                   ,
                                                   j
                                                   ∈
                                                   
                                                      J
                                                      0
                                                   
                                                   :
                                                   i
                                                   ≠
                                                   j
                                                   ,
                                                   t
                                                   ∈
                                                   T
                                                   :
                                                   t
                                                   ∉
                                                   
                                                      T
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   
                                                   or
                                                   
                                                   
                                                      (
                                                      t
                                                      ∈
                                                      
                                                         T
                                                         i
                                                      
                                                      
                                                      and
                                                      
                                                      t
                                                      ∉
                                                      
                                                         T
                                                         j
                                                      
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

In the light of these results, the following proposition holds:

                           Proposition 2
                           The linear programming relaxations of Formulations 3 and 4 have the same optimal solution value.

The following proposition holds for Formulation 4:

                           Proposition 3
                           Assume that variables xij
                               are fixed and determine a hamiltonian circuit in G. Then, constraints (13e)–(13g) determine a matrix that is totally unimodular.

Consider the capacity constraints (13f) and introduce the slack variable qij
                              , for all i, j ∈ J
                              0, i ≠ j. Then we have

                                 
                                    (14)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∈
                                                                  T
                                                                  :
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∈
                                                                  
                                                                     T
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∉
                                                                  
                                                                     T
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      y
                                                      
                                                         i
                                                         j
                                                      
                                                      t
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∈
                                                                  T
                                                                  :
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∉
                                                                  
                                                                     T
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∉
                                                                  
                                                                     T
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      y
                                                      
                                                         i
                                                         j
                                                      
                                                      t
                                                   
                                                   +
                                                   
                                                      q
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   =
                                                   
                                                      (
                                                      C
                                                      −
                                                      |
                                                   
                                                   
                                                      T
                                                      j
                                                   
                                                   
                                                      |
                                                      )
                                                   
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                
                                             
                                             
                                                
                                                   ∀
                                                   
                                                   i
                                                   ,
                                                   j
                                                   ∈
                                                   
                                                      J
                                                      0
                                                   
                                                   :
                                                   i
                                                   ≠
                                                   j
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Without loss of generality, assume both that 
                                 
                                    
                                       x
                                       
                                          i
                                          ,
                                          i
                                          +
                                          1
                                       
                                    
                                    =
                                    1
                                    ,
                                 
                               for all 
                                 
                                    i
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    n
                                    −
                                    1
                                    ,
                                 
                               and 
                                 
                                    
                                       x
                                       
                                          n
                                          0
                                       
                                    
                                    =
                                    1
                                 
                              . Then, it holds that 
                                 
                                    
                                       y
                                       
                                          i
                                          j
                                       
                                       t
                                    
                                    =
                                    0
                                    ,
                                 
                               for all j ∈ J
                              0 such that 
                                 
                                    j
                                    ≠
                                    i
                                    +
                                    1
                                 
                              . Hence, the system reduces to

                                 
                                    (15)
                                    
                                       
                                          
                                             y
                                             
                                                j
                                                −
                                                1
                                                ,
                                                j
                                             
                                             t
                                          
                                          −
                                          
                                             y
                                             
                                                j
                                                ,
                                                j
                                                +
                                                1
                                             
                                             t
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                          
                                          t
                                          ∈
                                          T
                                          ∖
                                          
                                             T
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (16)
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         t
                                                         ∈
                                                         T
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                         ∈
                                                         
                                                            T
                                                            
                                                               j
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                         ∉
                                                         
                                                            T
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             y
                                             
                                                j
                                                −
                                                1
                                                ,
                                                j
                                             
                                             t
                                          
                                          +
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         t
                                                         ∈
                                                         T
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                         ∉
                                                         
                                                            T
                                                            
                                                               j
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                         ∉
                                                         
                                                            T
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             y
                                             
                                                j
                                                −
                                                1
                                                ,
                                                j
                                             
                                             t
                                          
                                          +
                                          
                                             q
                                             
                                                j
                                                −
                                                1
                                                ,
                                                j
                                             
                                          
                                          =
                                          
                                             (
                                             C
                                             −
                                             |
                                          
                                          
                                             T
                                             j
                                          
                                          
                                             |
                                             )
                                          
                                          
                                          ∀
                                          
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (17)
                                    
                                       
                                          
                                             y
                                             
                                                j
                                                ,
                                                j
                                                +
                                                1
                                             
                                             t
                                          
                                          ≤
                                          1
                                          
                                          ∀
                                          
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                          ,
                                          t
                                          ∈
                                          T
                                          :
                                          t
                                          ∉
                                          
                                             T
                                             j
                                          
                                          .
                                       
                                    
                                 
                              Consider constraints (16) for a fixed j ∈ J
                              0 and subtract the same constraint for 
                                 
                                    j
                                    +
                                    1
                                 
                              . Then it holds that

                                 
                                    (18)
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∈
                                                                  T
                                                                  :
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∈
                                                                  
                                                                     T
                                                                     
                                                                        j
                                                                        −
                                                                        1
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∉
                                                                  
                                                                     T
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      y
                                                      
                                                         j
                                                         −
                                                         1
                                                         ,
                                                         j
                                                      
                                                      t
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∈
                                                                  T
                                                                  :
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∉
                                                                  
                                                                     T
                                                                     
                                                                        j
                                                                        −
                                                                        1
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∉
                                                                  
                                                                     T
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      y
                                                      
                                                         j
                                                         −
                                                         1
                                                         ,
                                                         j
                                                      
                                                      t
                                                   
                                                   +
                                                   
                                                      q
                                                      
                                                         j
                                                         −
                                                         1
                                                         ,
                                                         j
                                                      
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∈
                                                                  T
                                                                  :
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∈
                                                                  
                                                                     T
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∉
                                                                  
                                                                     T
                                                                     
                                                                        j
                                                                        +
                                                                        1
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      y
                                                      
                                                         j
                                                         ,
                                                         j
                                                         +
                                                         1
                                                      
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∈
                                                                  T
                                                                  :
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∉
                                                                  
                                                                     T
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  t
                                                                  ∉
                                                                  
                                                                     T
                                                                     
                                                                        j
                                                                        +
                                                                        1
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      y
                                                      
                                                         j
                                                         ,
                                                         j
                                                         +
                                                         1
                                                      
                                                      t
                                                   
                                                   −
                                                   
                                                      q
                                                      
                                                         j
                                                         ,
                                                         j
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      =
                                                      |
                                                   
                                                   
                                                      T
                                                      j
                                                   
                                                   
                                                      |
                                                      −
                                                      |
                                                   
                                                   
                                                      T
                                                      
                                                         j
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      |
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              Now observe that the system constituted by (15), (17) and (18) is totally unimodular because each variable appears exactly twice with coefficients both 
                                 +
                              1 and 
                                 −
                              1.□

The decomposition of the SSP in two nested subproblems (namely, the Sequencing Problem (SP) and the Tooling Problem (TP)) described in Tang and Denardo (1987) proves useful to provide a combinatorial interpretation of Formulation 4. Before proceeding, we briefly review Crama et al.’s results and insights (Crama et al., 1994) and introduce some notations that will prove useful in the remainder of the article.

A tooling policy for a given job processing sequence s is any determination of the tools that have to be loaded in the tool magazine at each position of s. A tooling policy is feasible if, at each position of s, the capacity constraint is respected, i.e., if the sum of the tools present in the magazine at any position of s is smaller than or equal to C. A feasible tooling policy is optimal if it minimizes the overall tool switches in s.

Let a job processing sequence s be fixed and consider a n × m boolean matrix P whose generic entry pij
                         is equal to 1 if tool i is required for the jth job in s and 0 otherwise. For example, Table 4
                         shows the P matrix corresponding to the example in Table 1.

A 0-block of P is a maximal subset of consecutive zeros in a row of P or, more formally, a set of the form 
                           
                              {
                              (
                              i
                              ,
                              j
                              )
                              ,
                              (
                              i
                              ,
                              j
                              +
                              1
                              )
                              ,
                              …
                              ,
                              (
                              i
                              ,
                              j
                              +
                              k
                              )
                              }
                           
                         for which the following conditions hold:

                           
                              1.
                              
                                 
                                    
                                       1
                                       <
                                       j
                                       ≤
                                       j
                                       +
                                       k
                                       <
                                       n
                                    
                                 ;


                                 
                                    
                                       
                                          p
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       
                                          p
                                          
                                             i
                                             ,
                                             j
                                             +
                                             1
                                          
                                       
                                       =
                                       …
                                       =
                                       
                                          p
                                          
                                             i
                                             ,
                                             j
                                             +
                                             k
                                          
                                       
                                       =
                                       0
                                    
                                 ;


                                 
                                    
                                       
                                          p
                                          
                                             i
                                             ,
                                             j
                                             −
                                             1
                                          
                                       
                                       =
                                       
                                          p
                                          
                                             i
                                             ,
                                             j
                                             +
                                             k
                                             +
                                             1
                                          
                                       
                                       =
                                       1
                                    
                                 .

Thus, a 0-block denotes the maximal interval before and after which a tool t ∈ T is needed, but during which it is not needed. This fact suggests, as a possible approach to solve the SSP, to find a job processing sequence inducing the minimum number of 0-blocks during which each tool t ∈ T is not kept. This is precisely what Formulation 4 does. In fact, it is worth noting that, for each t, Formulation 4 determines a sequence of jobs 
                           
                              
                                 i
                                 1
                              
                              ,
                              
                                 i
                                 2
                              
                              ,
                              …
                              ,
                              
                                 i
                                 p
                              
                              ,
                           
                         that are defined by the variables 
                           
                              y
                              
                                 i
                                 j
                              
                              t
                           
                         being equal to one, more precisely 
                           
                              
                                 y
                                 
                                    
                                       i
                                       1
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 t
                              
                              ,
                              
                                 y
                                 
                                    
                                       i
                                       2
                                    
                                    
                                       i
                                       3
                                    
                                 
                                 t
                              
                              ,
                              …
                              ,
                              
                                 y
                                 
                                    
                                       i
                                       
                                          p
                                          −
                                          1
                                       
                                    
                                    
                                       i
                                       p
                                    
                                 
                                 t
                              
                           
                        . Such a sequence can be seen as a path starting at job i
                        1 and ending at job ip
                        . This path is maximal if it cannot be augmented, i.e., if the variables y associated with all of the arcs incoming into job (vertex) i
                        1 and all of the arcs leaving job (vertex) ip
                         are equal to zero. It is easy to see that these maximal paths correspond to Crama et al.’s 0-blocks.

In this section we provide valid inequalities to strengthen Formulation 4.

                           Proposition 4
                           The inequality

                                 
                                    (19)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            J
                                                            ∖
                                                            {
                                                            j
                                                            ,
                                                            k
                                                            }
                                                         
                                                      
                                                      
                                                         y
                                                         
                                                            i
                                                            j
                                                         
                                                         t
                                                      
                                                      ≥
                                                      
                                                         y
                                                         
                                                            j
                                                            k
                                                         
                                                         t
                                                      
                                                      
                                                      ∀
                                                      
                                                      k
                                                      ,
                                                      j
                                                      ∈
                                                      J
                                                      :
                                                      k
                                                      ≠
                                                      j
                                                      ,
                                                      
                                                      t
                                                      ∈
                                                      
                                                         T
                                                         k
                                                      
                                                      ∖
                                                      
                                                         T
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              is valid for Formulation 4.

In a feasible solution to the problem, variable 
                                 
                                    y
                                    
                                       j
                                       k
                                    
                                    t
                                 
                               can assume values in {0, 1}. If 
                                 
                                    
                                       y
                                       
                                          j
                                          k
                                       
                                       t
                                    
                                    =
                                    0
                                 
                               the inequality is trivially valid. If 
                                 
                                    
                                       y
                                       
                                          j
                                          k
                                       
                                       t
                                    
                                    =
                                    1
                                 
                               then the pair (j, k) belongs to a 0-block during which tool t is kept (see Fig. 1
                              ), hence there exists at least one 
                                 
                                    
                                       i
                                       ^
                                    
                                    ∈
                                    J
                                    ∖
                                    
                                       {
                                       j
                                       ,
                                       k
                                       }
                                    
                                 
                               such that 
                                 
                                    
                                       y
                                       
                                          
                                             i
                                             ^
                                          
                                          j
                                       
                                       t
                                    
                                    =
                                    1
                                 
                              . Thus, the inequality is again valid.□

We refer to inequalities (19) as the 1-arc inequalities. It is worth noting that, with arguments similar to those used in Proposition 4, the 1-arc inequalities can be generalized as in Fig. 2
                        . Specifically, let S
                        1, S
                        2⊂J and denote 
                           
                              
                                 y
                                 t
                              
                              
                                 (
                                 
                                    S
                                    1
                                 
                                 ,
                                 
                                    S
                                    2
                                 
                                 )
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    
                                       S
                                       1
                                    
                                 
                              
                              
                                 ∑
                                 
                                    j
                                    ∈
                                    
                                       S
                                       2
                                    
                                 
                              
                              
                                 y
                                 
                                    i
                                    j
                                 
                                 t
                              
                           
                        . Then the following proposition holds:

                           Proposition 5
                           The inequality

                                 
                                    (20)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         y
                                                         t
                                                      
                                                      
                                                         (
                                                         
                                                         J
                                                         ∖
                                                         S
                                                         ,
                                                         S
                                                         ∖
                                                         
                                                            {
                                                            k
                                                            }
                                                         
                                                         )
                                                      
                                                      ≥
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            S
                                                            ∖
                                                            {
                                                            k
                                                            }
                                                         
                                                      
                                                      
                                                         y
                                                         
                                                            i
                                                            k
                                                         
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   ∀
                                                   
                                                   S
                                                   ⊂
                                                   .
                                                   J
                                                   ,
                                                   k
                                                   ∈
                                                   S
                                                   ,
                                                   
                                                   t
                                                   ∈
                                                   
                                                      T
                                                      k
                                                   
                                                   :
                                                   
                                                      J
                                                      t
                                                   
                                                   ∩
                                                   S
                                                   =
                                                   
                                                      {
                                                      k
                                                      }
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              is valid for Formulation 4.

We refer to inequalities (20) as the cut inequalities.

The structural properties of the tooling subproblem, and in particular the concept of a 0-block, suggest an alternative network-based integer linear programming formulation for the SSP that can be viewed as a disaggregation of Formulation 4. Specifically, by definition a 0-block with respect to a tool t is a sequence of jobs starting at a job i ending at a job j and such that no job in between i and j (but i and j themselves) needs tool t. Such a sequence can be seen as a path in the induced directed subgraph 
                           
                              
                                 G
                                 
                                    i
                                    j
                                 
                                 t
                              
                              =
                              
                                 (
                                 
                                    V
                                    
                                       i
                                       j
                                    
                                    t
                                 
                                 ,
                                 
                                    A
                                    
                                       i
                                       j
                                    
                                    t
                                 
                                 )
                              
                           
                         of G having as vertexset 
                           
                              
                                 V
                                 
                                    i
                                    j
                                 
                                 t
                              
                              =
                              
                                 
                                 c
                              
                              J
                              
                                 
                                 t
                              
                              ∪
                              
                                 {
                                 i
                                 ,
                                 j
                                 }
                              
                              ,
                           
                         for all distinct i, j ∈ J such that t ∈ Ti
                        ∩Tj
                        , and as arcset 
                           
                              A
                              
                                 i
                                 j
                              
                              t
                           
                         the subset of arcs having endpoints in 
                           
                              V
                              
                                 i
                                 j
                              
                              t
                           
                         except: (i) arc (i, j), (ii) arcs incoming into i, and (iii) arcs diverging from j. By denoting 
                           
                              f
                              
                                 i
                                 j
                                 ,
                                 k
                                 l
                              
                              t
                           
                         as a decision variable equal to 1 if vertex l immediately follows vertex k in a path of 
                           
                              G
                              
                                 i
                                 j
                              
                              t
                           
                         and 0 otherwise, it is easy to see that the following relationships hold between variables 
                           
                              y
                              
                                 i
                                 j
                              
                              t
                           
                         in Formulation 4 and variables 
                           
                              f
                              
                                 i
                                 j
                                 ,
                                 k
                                 l
                              
                              t
                           
                        :

                           
                              (21a)
                              
                                 
                                    
                                       
                                          
                                             y
                                             
                                                k
                                                l
                                             
                                             t
                                          
                                       
                                       
                                          
                                             =
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            ∈
                                                            
                                                               J
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                f
                                                
                                                   i
                                                   l
                                                   ,
                                                   k
                                                   l
                                                
                                                t
                                             
                                          
                                       
                                       
                                       
                                          
                                             ∀
                                             
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             ∀
                                             
                                             k
                                             ∈
                                             
                                                
                                                c
                                             
                                             J
                                             
                                                
                                                t
                                             
                                             ,
                                             l
                                             ∈
                                             
                                                J
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21b)
                              
                                 
                                    
                                       
                                          
                                             y
                                             
                                                k
                                                l
                                             
                                             t
                                          
                                       
                                       
                                          
                                             =
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            j
                                                            ∈
                                                            
                                                               J
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                f
                                                
                                                   k
                                                   j
                                                   ,
                                                   k
                                                   l
                                                
                                                t
                                             
                                          
                                       
                                       
                                       
                                          
                                             ∀
                                             
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             ∀
                                             
                                             k
                                             ∈
                                             
                                                J
                                                t
                                             
                                             ,
                                             l
                                             ∈
                                             
                                                
                                                c
                                             
                                             J
                                             
                                                
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21c)
                              
                                 
                                    
                                       
                                          
                                             y
                                             
                                                k
                                                l
                                             
                                             t
                                          
                                       
                                       
                                          
                                             =
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            ,
                                                            j
                                                            ∈
                                                            
                                                               J
                                                               t
                                                            
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                            ≠
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                f
                                                
                                                   i
                                                   j
                                                   ,
                                                   k
                                                   l
                                                
                                                t
                                             
                                          
                                       
                                       
                                       
                                          
                                             ∀
                                             
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             ∀
                                             
                                             k
                                             ,
                                             l
                                             ∈
                                             
                                                
                                                c
                                             
                                             J
                                             
                                                
                                                t
                                             
                                             :
                                             k
                                             ≠
                                             l
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

These relationships suggest the following formulation for the SSP.

                           Formulation 5
                           
                              
                                 
                                    (22a)
                                    
                                       
                                          min
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             |
                                             
                                                T
                                                j
                                             
                                             |
                                          
                                          
                                             x
                                             
                                                0
                                                j
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ∈
                                                         J
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                         ≠
                                                         j
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                         ∈
                                                         
                                                            T
                                                            j
                                                         
                                                         ∖
                                                         
                                                            T
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            J
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            k
                                                            ≠
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            ∈
                                                            
                                                               T
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                f
                                                
                                                   k
                                                   j
                                                   ,
                                                   i
                                                   j
                                                
                                                t
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (22b)
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   J
                                                   
                                                      0
                                                   
                                                   i
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          1
                                          
                                          ∀
                                          
                                          i
                                          ∈
                                          
                                             J
                                             0
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (22c)
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   J
                                                   
                                                      0
                                                   
                                                   j
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          1
                                          
                                          ∀
                                          
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (22d)
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ∈
                                                         S
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                         ≠
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ≤
                                          
                                             |
                                             S
                                             |
                                          
                                          −
                                          1
                                          
                                          ∀
                                          
                                          S
                                          ⊂
                                          
                                             J
                                             0
                                          
                                          ,
                                          2
                                          ≤
                                          
                                             |
                                             S
                                             |
                                          
                                          ≤
                                          n
                                          −
                                          1
                                       
                                    
                                 
                              
                              
                                 
                                    (22e)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         
                                                            
                                                               
                                                                  l
                                                                  ∈
                                                                  
                                                                     V
                                                                     
                                                                        i
                                                                        j
                                                                     
                                                                     t
                                                                  
                                                                  :
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  l
                                                                  ≠
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         i
                                                         j
                                                         ,
                                                         k
                                                         l
                                                      
                                                      t
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         
                                                            
                                                               
                                                                  l
                                                                  ∈
                                                                  
                                                                     V
                                                                     
                                                                        i
                                                                        j
                                                                     
                                                                     t
                                                                  
                                                                  :
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  l
                                                                  ≠
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         i
                                                         j
                                                         ,
                                                         l
                                                         k
                                                      
                                                      t
                                                   
                                                   ≥
                                                   0
                                                
                                             
                                             
                                             
                                                
                                                   
                                                   ∀
                                                   
                                                   i
                                                   ,
                                                   j
                                                   ∈
                                                   J
                                                   :
                                                   i
                                                   ≠
                                                   j
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   ∀
                                                   
                                                   t
                                                   ∈
                                                   
                                                      T
                                                      i
                                                   
                                                   ∩
                                                   
                                                      T
                                                      j
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   
                                                   k
                                                   ∈
                                                   
                                                      
                                                      c
                                                   
                                                   J
                                                   
                                                      
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (22f)
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         i
                                                         ∈
                                                         
                                                            J
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             f
                                             
                                                i
                                                l
                                                ,
                                                k
                                                l
                                             
                                             t
                                          
                                          ≤
                                          
                                             x
                                             
                                                k
                                                l
                                             
                                          
                                          
                                          ∀
                                          
                                          t
                                          ∈
                                          T
                                          ,
                                          
                                          ∀
                                          
                                          k
                                          ∈
                                          
                                             
                                             c
                                          
                                          J
                                          
                                             
                                             t
                                          
                                          ,
                                          l
                                          ∈
                                          
                                             J
                                             t
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (22g)
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         j
                                                         ∈
                                                         
                                                            J
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             f
                                             
                                                k
                                                j
                                                ,
                                                k
                                                l
                                             
                                             t
                                          
                                          ≤
                                          
                                             x
                                             
                                                k
                                                l
                                             
                                          
                                          
                                          ∀
                                          
                                          t
                                          ∈
                                          T
                                          ,
                                          
                                          ∀
                                          
                                          k
                                          ∈
                                          
                                             J
                                             t
                                          
                                          ,
                                          l
                                          ∈
                                          
                                             
                                             c
                                          
                                          J
                                          
                                             
                                             t
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (22h)
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ∈
                                                         
                                                            J
                                                            t
                                                         
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                         ≠
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             f
                                             
                                                i
                                                j
                                                ,
                                                k
                                                l
                                             
                                             t
                                          
                                          ≤
                                          
                                             x
                                             
                                                k
                                                l
                                             
                                          
                                          
                                          ∀
                                          
                                          t
                                          ∈
                                          T
                                          ,
                                          
                                          ∀
                                          
                                          k
                                          ,
                                          l
                                          ∈
                                          
                                             
                                             c
                                          
                                          J
                                          
                                             
                                             t
                                          
                                          :
                                          k
                                          ≠
                                          l
                                       
                                    
                                 
                              
                              
                                 
                                    (22i)
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         t
                                                         ∈
                                                         T
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                         ∈
                                                         
                                                            T
                                                            k
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                         ∉
                                                         
                                                            T
                                                            l
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         j
                                                         ∈
                                                         
                                                            J
                                                            t
                                                         
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         j
                                                         ≠
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             f
                                             
                                                k
                                                j
                                                ,
                                                k
                                                l
                                             
                                             t
                                          
                                          +
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         t
                                                         ∈
                                                         T
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                         ∉
                                                         
                                                            T
                                                            k
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                         ∉
                                                         
                                                            T
                                                            l
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ∈
                                                         
                                                            J
                                                            t
                                                         
                                                         :
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                         ≠
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             f
                                             
                                                i
                                                j
                                                ,
                                                k
                                                l
                                             
                                             t
                                          
                                          ≤
                                          
                                             (
                                             C
                                             −
                                             |
                                          
                                          
                                             T
                                             l
                                          
                                          
                                             |
                                             )
                                          
                                          
                                             x
                                             
                                                k
                                                l
                                             
                                          
                                          
                                          ∀
                                          
                                          k
                                          ,
                                          l
                                          ∈
                                          J
                                          :
                                          k
                                          ≠
                                          l
                                       
                                    
                                 
                              
                              
                                 
                                    (22j)
                                    
                                       
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          i
                                          ,
                                          j
                                          ∈
                                          
                                             J
                                             0
                                          
                                          :
                                          i
                                          ≠
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    (22k)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                      
                                                         i
                                                         j
                                                         ,
                                                         k
                                                         l
                                                      
                                                      t
                                                   
                                                   ≥
                                                   0
                                                
                                             
                                             
                                             
                                                
                                                   
                                                   ∀
                                                   
                                                   t
                                                   ∈
                                                   T
                                                   ,
                                                   ∀
                                                   
                                                   i
                                                   ,
                                                   j
                                                   ∈
                                                   J
                                                   :
                                                   i
                                                   ≠
                                                   j
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   ∀
                                                   
                                                   k
                                                   ,
                                                   l
                                                   ∈
                                                   
                                                      V
                                                      
                                                         i
                                                         j
                                                      
                                                      t
                                                   
                                                   :
                                                   k
                                                   ≠
                                                   l
                                                   ,
                                                   
                                                   
                                                      {
                                                      k
                                                      ,
                                                      l
                                                      }
                                                   
                                                   ≠
                                                   
                                                      {
                                                      i
                                                      ,
                                                      j
                                                      }
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Using Eqs. (21a)–(21c) it is easy to see that the objective function (22a) is analogous to (13a) in Formulation 4; constraints (22b)–(22d) correspond to constraints (13b)–(13d) of Formulation 4; constraints (22e) allow the existence of a path (0-block) in 
                           
                              V
                              
                                 i
                                 j
                              
                              t
                           
                         if such a path has been chosen in the optimal solution to the problem; constraints (22f)–(22h) correspond to constraints (13g) of Formulation 4; and the capacity constraints (22i) correspond to constraints (13f) of Formulation 4. It is easy to see that, if for a fixed triple t, k and l, we add constraint (22e) for all i and j then we obtain constraint (13e) of Formulation 4. Thus, based on the previous observations, the following proposition holds:

                           Proposition 6
                           The objective function value of the linear programming relaxation of Formulation 5 is greater than or equal to the objective function value of the linear programming relaxation of Formulation 4.

We will see in Section 4 that Formulation 5 usually provides tighter lower bounds than Formulation 4.

In this section we analyze the performances of the formulations described in the previous sections. As the performances of Formulation 1 and Formulation 2 have been already discussed in Laporte et al. (2004), here we focus on the comparison between Formulations 2, 4 and 5. We excluded from the analysis Formulation 3 as it provides the same lower bounds as Formulation 4 and contains more variables and constraints.

Our experiments were motivated by a number of goals, namely: to compare the lower bounds of the formulations; to evaluate, with respect to Formulation 4, the benefits obtained by including the valid inequalities previously described; and to allow the analysis of datasets larger than the ones currently handled by Formulation 2. We do not attempt to compare the runtime performances of approaches that are non-linear or that are not based on integer linear programming, as those analyses have been already performed in Laporte et al. (2004) and Ghiani et al. (2010).

In order to test the performances of Formulations 2, 4 and 5, we considered the datasets described in Laporte et al. (2004), downloadable at http://homepages.ulb.ac.be/~dacatanz/Site/Software_files/JSTSPinstances.zip. Each dataset contains 10 random instances of the SSP, characterized by having the same number of jobs, tools, and magazine capacity. Moreover, each dataset is also characterized by two positive numbers, 
                           
                              T
                              m
                              *
                           
                         and 
                           
                              
                                 T
                                 M
                                 *
                              
                              ,
                           
                         such that 
                           
                              
                                 T
                                 m
                                 *
                              
                              =
                              
                                 min
                                 
                                    
                                       j
                                       ′
                                    
                                    ∈
                                    J
                                 
                              
                              
                                 |
                                 
                                    T
                                    
                                       j
                                       ′
                                    
                                 
                                 |
                              
                           
                         and 
                           
                              
                                 T
                                 M
                                 *
                              
                              =
                              
                                 max
                                 
                                    
                                       j
                                       ′
                                    
                                    ∈
                                    J
                                 
                              
                              
                                 |
                                 
                                    T
                                    
                                       j
                                       ′
                                    
                                 
                                 |
                              
                           
                        . As described in Laporte et al., a generic instance in a given dataset is created by generating at random, for each job j ∈ J, the set Tj
                         in such a way that Tj
                         is non-dominated and 
                           
                              
                                 T
                                 m
                                 *
                              
                              ≤
                              
                                 |
                                 
                                    T
                                    j
                                 
                                 |
                              
                              ≤
                              
                                 T
                                 M
                                 *
                              
                           
                        . Datasets belonging to the same group (e.g., datAx, datBx, and so on) differ from one another by the capacity of the magazine. The characteristics of the considered datasets are summarized in Table 5
                        .

@&#IMPLEMENTATION@&#

We implemented Formulations 2, 4 and 5 in Mosel 3.4.3 of FICO Xpress, Optimizer libraries v25.01.05, running on an IMac Core i7, 3.50 gigahertz, equipped with 16 gigabyte RAM and operating system Mac Os X, Darwin version 10.9.1. We considered three implementations of Formulation 4: one including no strengthening valid inequality (hereafter denoted as Formulation 4); one including the 1-arc inequalities (hereafter denoted as Formulation 4
                        
                           +
                        1-Arc); and one including all of the strengthening valid inequalities described in Section 3.4 (hereafter denoted as Formulation 4
                        
                           +
                        Val. Ieq.), separated in an implicit way as described in the next section. Moreover, for each implementation we considered two kinds of runtime settings. Specifically, we first run each formulation by deactivating Fico Xpress proprietary cuts and presolving strategies. This test aimed at empirically validating the theoretical results discussed in the previous sections without incurring in possible alterations introduced by the optimizer. Conservatively, we also considered a second runtime setting in which we run each formulation by activating both Fico Xpress proprietary cuts and presolving strategies. As default setting, in each implementation we activated both Fico Xpress primal heuristic to generate the first upper bound to the problem and the multithread capabilities of the optimizer in order to exploit the multiple cores of the CPU. Finally, we set 3 hours as maximum runtime for each formulation.

As suggested by Grötschel and Padberg (1985), we used the maximum flow algorithm to search for the most violated subtour elimination constraints (2d), (3d) or (13d) (if any) at any node of the search tree. After a few preliminary experiments, we have decided to allow the introduction of at most 15 violated constraints at the root node and at most 5 violated constraints at any other node.

When solving Formulation 2, we computed the lower bound on the optimal solution to the subproblem corresponding to a generic node of the search tree by solving a linear program in which (i) the subtour elimination constraints and the integrality constraints have been relaxed and (ii) the strengthening valid inequalities described in Laporte et al. (2004) have been added. We searched for violated subtour elimination constraints by using Grötschel and Padberg’s (1985) 2 procedure when the solution of the strengthened linear relaxation proved not to be feasible. We experienced no computational benefit in following either the branching strategy or the proposed depth-first tree search strategy described in Laporte et al. (2004). Possibly, this result is due to the improved proprietary search strategies implemented in the Xpress Optimizer. Hence, we let Xpress Optimizer decide both the best candidate binary variable for branching and the best strategy to explore the tree search. We followed similar approaches also for the other implementations.

Concerning Formulation 4
                        
                           +
                        Val. Ieq., we separated the cut inequalities (20) at each node of the search tree by using the following procedure. Consider inequality (20) and add yt
                        (V∖S, k) to both sides. Then, it holds that

                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                   t
                                                
                                                
                                                   (
                                                   V
                                                   ∖
                                                   S
                                                   ,
                                                   S
                                                   ∖
                                                   
                                                      {
                                                      k
                                                      }
                                                   
                                                   )
                                                
                                                +
                                                
                                                   y
                                                   t
                                                
                                                
                                                   (
                                                   V
                                                   ∖
                                                   S
                                                   ,
                                                   k
                                                   )
                                                
                                                ≥
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      S
                                                      ∖
                                                      {
                                                      k
                                                      }
                                                   
                                                
                                                
                                                   y
                                                   
                                                      i
                                                      k
                                                   
                                                   t
                                                
                                                +
                                                
                                                   y
                                                   t
                                                
                                                
                                                   (
                                                   V
                                                   ∖
                                                   S
                                                   ,
                                                   k
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        In turn, inequality (23) is equivalent to

                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                   t
                                                
                                                
                                                   (
                                                   V
                                                   ∖
                                                   S
                                                   ,
                                                   S
                                                   )
                                                
                                                ≥
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         J
                                                         k
                                                      
                                                   
                                                
                                                
                                                   y
                                                   
                                                      i
                                                      k
                                                   
                                                   t
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Hence, the separation of the cut inequalities can be performed by finding the largest set 
                           
                              S
                              ^
                           
                         for which (24) holds. The search can be carried out by solving 
                           
                              n
                              −
                              1
                           
                         max flows from any node in Jt
                        ∖{k} to node k. After preliminary tests, we allowed the introduction of at most 10 violated constraints at the root node and 5 violated constraints at any other node.

Finally, we used a particular branching strategy for binary variables consisting of giving priority to x variables with respect to y variables during the branching process.


                        Figs. 3
                         and 4
                         show the results of our computational experiments in terms of box and whisker plots. Specifically, the bottom and the top of each box represent the first and third quartiles; the band inside the box represents the second quartile (the median), and the ends of the whiskers represent the 9th percentile and the 91st percentile. Outliers are plotted as individual points. We analyze the formulations with respect to the gap, i.e., the difference between the optimal value to a given instance of the SSP in a specific dataset and the objective function value of the linear programming relaxation at the root node of the respective search tree, divided by the optimal value. In particular, Fig. 3 shows the performances of the formulations when disabling Fico Xpress proprietary cuts and presolving strategies. In contrast, Fig. 4 shows the performances of the formulations when enabling the proprietary strategies. The gap is expressed in percentage; the performances are (i) represented by means of box and whiskers plots and (ii) shown in function of the capacity of the magazine and the size of the datasets.


                        Fig. 3 shows that at the root node of the search tree Formulation 4 provides median gaps that are generally smaller than those of Formulation 2. This fact confirms the theoretical results discussed in Section 3.1. The trend is more marked in datasets datA2 and datA3 and less in the others, for which the improvements are marginal. In particular, we have observed that the lower bounds (and more in general the computational performances) of the formulations deteriorate in a manner directly proportional to the ratio 
                           
                              
                                 T
                                 M
                                 *
                              
                              /
                              C
                              ,
                           
                         where 
                           
                              T
                              M
                              *
                           
                         denotes the maximum number of tools per job. Specifically, the smaller the ratio is, the poorer (i.e., the larger) are the gaps. This phenomenon is not surprising, as smaller ratios increase the combinatorial possibilities for the management of the tools in the magazine.

The results showed that the lower bound provided by Formulation 4 at the root node of the search tree increases, on average, when introducing the valid inequalities described in Section 3.4. In particular, we observed that the 1-arc inequalities increase the objective function value of the linear programming relaxation of Formulation 4 up to 17 percent and the combination of the 1-arc inequalities with the cut inequalities may lead to improvements of up to 20 percent. However, with smaller 
                           
                              
                                 T
                                 M
                                 *
                              
                              /
                              C
                           
                         ratios, the benefits provided by the valid inequalities become less significant and the corresponding objective function values of the linear programming relaxations at the root node tend to prescribe the same value. Adding the valid inequalities to Formulation 4 may not be a trivial task. In fact, due to the large number of inequalities involved, the task entails the use of a cut generation approach, which in turn introduces a computational overhead that may prevent the convergence of the simplex algorithm within the time limit.

The results showed that Formulation 5 is the tightest formulation for the SSP, as it provides on average the best lower bounds. In particular, in the datasets datA2, datA3, datA4, datB2 and datC2, the lower bounds provided by Formulation 5 are on average from 6 percent to 10.7 percent better than the ones provided by Formulation 4
                        
                           +
                        Val. Ieq. In the datasets datA1 and datB1, the lower bounds provided by Formulation 5 are on average from 2 percent to 1.4 percent better than the ones provided by Formulation 4
                        
                           +
                        Val. Ieq. In contrast, in datC1 the lower bounds of Formulation 5 are on average equivalent to the ones provided by Formulation 4
                        
                           +
                        Val. Ieq. Formulation 5 was unable to compute, within the limit time, the linear programming relaxations at the root node of any instance in the datasets datDx, due to the large number of variables and inequalities involved in the formulation. As a general trend, we observed that the lower bounds provided by Formulation 5 have a behavior similar to the ones provided by Formulation 4 and its valid inequalities, i.e., they tend to deteriorate in a manner directly proportional to the ratio 
                           
                              
                                 T
                                 M
                                 *
                              
                              /
                              C
                           
                        .


                        Fig. 4 shows that the activation of Fico Xpress proprietary cuts and presolving strategies from one hand causes a general decrement of the median gaps related to the formulations but on the other hand does not change their general trends. In particular, the figure shows that the use of the proprietary strategies has a major impact on Formulations 2 and 4, minor in Formulation 4
                        
                           +
                        1-Arc and Formulation 4
                        
                           +
                        Val. Ieq., and becomes negligible or absent in Formulation 5.


                        Figs. 5
                         and 6
                         show the solution time (expressed in seconds) taken by the formulations to exactly solve Laporte et al.’s datasets. In particular, Fig. 5 shows the results obtained when disabling Fico Xpress proprietary cuts and presolving strategies. In contrast, Fig. 6 shows the results obtained when enabling those strategies. As for Figs. 3 and 4, the performances are (i) represented by means of box and whiskers plots and (ii) showed as a function of the capacity of the magazine and the size of the datasets. In preliminary tests we have observed that Formulation 4
                        
                           +
                        1-Arc and Formulation 4
                        
                           +
                        Val. Ieq tend to have similar solution times; hence, we preferred to exclude Formulation 4
                        
                           +
                        1-Arc from this analysis.

The results showed that Formulation 2 was able to solve (within the limit time) only 6 instances in the dataset datA1, either when activating or deactivating Fico Xpress proprietary cuts and presolving strategies (see Table 6
                        ). Formulation 4 was able to solve 7 instances when deactivating the proprietary strategies and 8 instances when activating them. When using also the valid inequalities, Formulation 4 was able to solve 7 instances when deactivating the proprietary strategies and 9 instances when activating them. Finally, Formulation 5 was able to solve 10 instances either when activating or deactivating the proprietary strategies. As general trend, the results showed that the use of Fico Xpress proprietary cuts and presolving strategies reduces the solution time and may increase the number instances optimally solved.


                        Formulation 2 was unable to solve any instance in the dataset datA2 within the time limit, either when activating or deactivating Fico Xpress proprietary cuts and presolving strategies. Formulation 4 was able to solve 1 instance in datA2 when deactivating the proprietary strategies and 2 instances when activating the proprietary strategies. Unfortunately, the combination of Formulation 4 with the valid inequalities did not prove successful. In fact, independently of the use of the proprietary cuts and presolving strategies, Formulation 4
                        
                           +
                        Val. Ieq proved to be unable to solve any instance in the dataset datA2 within the time limit, mainly due to the computational overhead introduced by the separation oracle. Finally, Formulation 5 was able to solve all of the instances in datA2 both when activating and deactivating the proprietary strategies. The results showed that no formulation was able to solve instances having characteristics larger than or equal to those contained in the dataset datA3.

@&#CONCLUSION@&#

In this article we have investigated the job Sequencing and tool Switching Problem (SSP), a 
                        NP
                     -hard combinatorial optimization problem arising from manufacturing systems. In particular, starting from the results discussed in Tang and Denardo (1987), Crama (1997), Crama et al. (1994), Laporte et al. (2004) and Ghiani et al. (2010), we have developed three integer programming formulations for the SSP that are provably tighter than the ones previously described in the literature. Computational experiments have confirmed the theoretical results and suggested Formulation 5 as the best ILP formulation for the SSP, being characterized by the fastest running times and largest number of solved instances. The results showed however that the new formulations are characterized by very large gaps. Moreover, the large number of involved variables and valid inequalities slows down the solution times of the formulations and may limit their practical use. In our opinion, a possible way to reduce the computational overhead could consist of both optimizing the runtime performances of the separation oracles and using faster programming languages such as C/C
                        
                           +
                           +
                        
                     . We also believe that the use of projective approaches may prove indispensable to overcome the current limitations. Investigating these approaches warrants additional research efforts.

@&#ACKNOWLEDGMENTS@&#

This work is supported by National Funding from FCT - Fundação para a Ciência e a Tecnologia, Portugal, under the project: PEst-OE/MAT/UI0152. The last author was supported by the Interuniversity Attraction Poles Programme initiated by the Belgian Science Policy Office. The authors thank the anonymous reviewers for their valuable comments on previous version of the manuscript.

@&#REFERENCES@&#

