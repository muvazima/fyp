@&#MAIN-TITLE@&#Part level transfer regularization for enhancing exemplar SVMs

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           EE-SVM, a part based transfer regularization method that boosts E-SVM, is introduced.


                        
                        
                           
                           EE-SVM is further improved by transferring the statistics between the parts.


                        
                        
                           
                           All the proposed objectives result in convex formulations.


                        
                        
                           
                           Experimentally shown that EE-SVM has better performance for pose matched retrieval.


                        
                        
                           
                           All objectives are conveniently optimized by mapping to a classical SVM formulation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Exemplar SVMs

Transfer learning

Object detection

Image retrieval

Feature mapping

@&#ABSTRACT@&#


               
               
                  Exemplar SVMs (E-SVMs, Malisiewicz et al., ICCV 2011), where an SVM is trained with only a single positive sample, have found applications in the areas of object detection and content-based image retrieval (CBIR), amongst others.
                  In this paper we introduce a method of part based transfer regularization that boosts the performance of E-SVMs, with a negligible additional cost. This enhanced E-SVM (EE-SVM) improves the generalization ability of E-SVMs by softly forcing it to be constructed from existing classifier parts cropped from previously learned classifiers. In CBIR applications, where the aim is to retrieve instances of the same object class in a similar pose, the EE-SVM is able to tolerate increased levels of intra-class variation, including occlusions and truncations, over E-SVM, and thereby increases precision and recall.
                  In addition to transferring parts, we introduce a method for transferring the statistics between the parts
and also show that there is an equivalence between transfer regularization and feature augmentation for this problem and others, with the consequence that the new objective function can be optimized using standard libraries.
                  EE-SVM is evaluated both quantitatively and qualitatively on the PASCAL VOC 2007 and ImageNet datasets for pose specific object retrieval. It achieves a significant performance improvement over E-SVMs, with greater suppression of negative detections and increased recall, whilst maintaining the same ease of training and testing.
               
            

Content based image retrieval (CBIR), the problem of searching digital images in large databases according to their visual content, is a well established research area in computer vision. In this work we are particularly interested in retrieving subwindows of images which are similar to the given query image, i.e. the goal is detection rather than image level classification. The notion of similarity is defined as being the same object class but also having similar viewpoint (e.g. frontal, left-facing, rear etc.). A query image can be a part of an object (e.g. head of a side facing horse), a complete object (e.g. frontal car image), or a composition of objects (e.g. person riding a horse). For instance, given a query of a horse facing left, the aim is to retrieve any left facing horse (intra-class variation) which might be walking or running with different feet formations (exemplar deformation).

Recently exemplar SVMs (E-SVM) [33], where an SVM is trained with only a single positive sample, have found applications in the areas of CBIR [3,40] and object detection [33]. Since the E-SVM is trained from a single positive sample (together with many negatives), it is specialized to that given sample. This means that it can be strict (on viewpoint for example), and the negatives give some background suppression. However, the single positive is also a limitation: only so much can be learnt about the foreground of the query (and this can lead to false detections), and more significantly it can lead to lack of generalization. In our context, generalization refers to intra-class variation and deformation whilst maintaining the viewpoint. Learning such generalization from a single positive is challenging given the lack of examples of allowable deformations and intra-class variation.

In this work we propose a transfer learning approach for boosting the performance of E-SVMs using part-like patches of previously learned classifiers. The formulation softly constrains the learned template to be constructed from classifiers that have been fully trained (i.e. using many positives). For instance, the neck of a horse can be transferred from the tail of an aeroplane (see Fig. 1
                  ), or a jumping bike can borrow part of wheel patches from regular side facing bike or motorbike classifiers (see Fig. 2
                  ). The intuitive reason behind borrowing patches from other well trained classifiers is that these classifier patches bring with them a better sense of discriminative features and background suppression, and also bring some generalization properties. The result of the transfer learning is an enhancement of background suppression and tolerance to intra-class variation, hence better coping with occlusions and truncations in the query image. However, these enhancements incurs no (significant) additional cost in learning and testing. We term the boosted E-SVM, enhanced exemplar SVM (EE-SVM).

Objects and parts don’t occur in isolation to each other. They appear with certain correlations in nature. For example, we don’t expect to see a zebra in a city scene with road and cars or a bicycle next to a sailing boat in the middle of the sea. Stemming from these observations, co-occurrence statistics are utilized in the computer vision problems such as object detection [12], and semantic segmentation and labeling of objects [25,38] in the scenes. Similarly parts also appear with certain correlations: occurrence of feet supports occurrence of a head, or seeing one wheel increases the chance of seeing another in the close neighborhood. Parts can also have negative correlations, i.e. it is not expected to see spider legs or parts of insects in the close neighborhood of vehicle-like patches. Hence we can transfer not only parts, but also their natural co-occurrence statistics. We include these co-occurrence statistics of the parts, in a convex formulation, for softly enforcing these positive and negative correlations, in the EE-SVM objective.

We describe the relation with the prior work in Section 1, and then introduce the enhanced E-SVM in Section 2, and incorporate part correlations in Section 3. We relate introduced transfer learning methods with feature maps in Section 4. We give implementation details in Section 5. Finally we present a quantitative and qualitative evaluation in Section 6. Although it might be feared that judging the quality of retrieval results will be very subjective, we show that available annotation and measures from the PASCAL VOC [17] can be used for this task.

Exemplar SVMs are utilized in a variety of problems including object detection[33], face recognition[28], transferring segmentations masks and semantic scene parsing[45,51], cross domain image matching (matching drawings to pictures)[2,40], transferring 3D geometry [1,33], and transferring labels to 3D point clouds [50]. Here we propose a method for improving the quality of E-SVMs, which will potentially boost these performances of all these methods.

Our work uses the notion of parts as patches of classifier templates. Many other studies utilize shared parts across different classes. Torralba et al. [48] introduced a method for sharing small patch oriented templates in a boosting framework and Opelt et al. [34] extended this approach to shared boundary fragments. Fidler et al. [20] explored the shareability of features among object classes in a generative hierarchical framework. Stark et al. [44] proposed a method for transferring part-like shape features through explicit migration of model parameters for each part; however this transfer is manual at the moment. Ott and Everingham [35] introduced part sharing across classes for object detection in the framework of discriminatively trained part-based models [19]. In [22,42] HOG based templates are represented as a sparse reconstruction of shared parts (sparselets) which enable very fast evaluation of multiple detectors. Dean et al. [9] also use the notion of part sharing for efficient evalution of large number of detectors. In another perspective Aytar and Zisserman [4] use shared parts to reconstruct and evaluate a single detector very fast on large image collections using inverted file indexing. Endres et al. [16] proposes to learn a diverse collection of discriminative parts from object bounding box annotations and utilize it for object category detection. Recently mining mid-level discriminative patches for scene understanding [13,14,23,36,37,41] has attracted considerable attention for their automatic discovery of distinctive parts for scene recognition. Mid-level discriminative patches are also utilized for inferring the 3D surface normals given a single image [7], and aligning object parts in order to discover visual connections in space and time [27] .

The proposed approach also has a strong relation to the line of work that focuses on enriching the image descriptors with the responses of mid-level and high-level classifiers [18,24,26,29,30,43,54]. These approaches either replace or augment the original low-level descriptor with the outputs of higher level classifiers. The proposed method also employs a similar augmentation scheme; however we augment the feature vector with the responses of previously learned classifier patches which are selected and relocated based on the quality of match with an E-SVM template learned from the query image.

Our approach can be viewed both as a transfer regularization approach and a feature augmentation approach. Hence it constructs an equivalence between these two views. We explicitly prove this equivalence and discuss its implications in Section 4.

This section discusses the E-SVM formulation and introduces the enhanced E-SVM objective. The formulation of the E-SVM [33] is:

                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          
                                             min
                                             
                                                w
                                                ,
                                                b
                                             
                                          
                                          
                                          λ
                                          
                                             
                                                ∥
                                                w
                                                ∥
                                             
                                             2
                                          
                                          +
                                          
                                             ∑
                                             i
                                             N
                                          
                                          max
                                          
                                             (
                                             0
                                             ,
                                             1
                                             −
                                             
                                                y
                                                i
                                             
                                             
                                                (
                                                
                                                   w
                                                   T
                                                
                                                
                                                   x
                                                   i
                                                
                                                +
                                                b
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     where λ controls the weight of regularization term, w is the classifier vector, b is the bias term, xi
                      and yi
                      are the training samples and their labels, respectively. Note that there is only one positive sample in the training set and its error is weighted more (50 times in [33]) than the negative samples. In order to simplify the formulation, different weightings of positive and negative samples are not explicitly shown.

In enhanced E-SVM, part based transfer regularization is incorporated to the E-SVM formulation. The objective is:

                        
                           (2)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             min
                                             
                                                w
                                                ,
                                                b
                                                ,
                                                α
                                             
                                          
                                          
                                          λ
                                          
                                             
                                                ∥
                                                w
                                                −
                                                
                                                   ∑
                                                   i
                                                   M
                                                
                                                
                                                   
                                                      α
                                                      i
                                                   
                                                   
                                                      u
                                                      i
                                                   
                                                
                                                ∥
                                             
                                             2
                                          
                                          +
                                          γ
                                          
                                             ∑
                                             i
                                             M
                                          
                                          
                                             α
                                             i
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          +
                                          
                                          
                                             ∑
                                             i
                                             N
                                          
                                          max
                                          
                                             (
                                             0
                                             ,
                                             1
                                             −
                                             
                                                y
                                                i
                                             
                                             
                                                (
                                                
                                                   w
                                                   T
                                                
                                                
                                                   x
                                                   i
                                                
                                                +
                                                b
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                          
                                          
                                          s
                                          t
                                          :
                                          
                                             α
                                             i
                                          
                                          ≥
                                          0
                                          ,
                                          
                                          ∀
                                          i
                                       
                                    
                                 
                              
                           
                        
                     where λ and γ controls the balance between the two regularization terms as well as the tradeoff between error term and regularization terms. ui
                     ’s are the classifier patches cropped from source classifiers and relocated on a w sized template padded with zeros other than the classifier patch (see Fig. 1), and αi
                     ’s are transfer weights. As αi
                     ’s are the reconstruction weights on ui
                     ’s and negative use of a part is not possible, non-negativity constraints are imposed on αi
                     ’s. Note that given a fixed set of ui
                     ’s the formulation is convex.

The two limits of this formulation are E-SVM and reconstruction from the classifier patches. As γ → ∞, since αi
                     ’s will be forced to be zero due to infinite penalization, 
                        
                           
                              ∑
                              i
                              M
                           
                           
                              
                                 α
                                 i
                              
                              
                                 u
                                 i
                              
                           
                        
                      will be a zero vector and (2) converges to the E-SVM formulation (1). As λ → ∞, w will be forced to be equal to 
                        
                           
                              ∑
                              i
                              M
                           
                           
                              
                                 α
                                 i
                              
                              
                                 u
                                 i
                              
                           
                        
                      and thus it will be forced to be constructed as a weighted combination of ui
                     ’s. Therefore by adjusting λ and γ we can obtain a midway solution between E-SVM and reconstruction from the other classifiers. Fig. 2 shows the smooth transition from reconstruction to E-SVM by changing γ with a fixed λ.


                     Discussion. Transfer regularization is introduced as an adaptive SVM (A-SVM) [31,52] which transfers information from a single auxiliary classifier. Subsequently A-SVMs were extended to transfer from multiple classes [53]. The proposed formulation is also a transfer regularization objective which transfers from the parts of previously learned classifiers. The main difference to [53] is that we control the weight of transfer with an additional regularization term 
                        
                           (
                           γ
                           
                              ∑
                              i
                              M
                           
                           
                              α
                              i
                              2
                           
                           )
                        
                      where γ → ∞ indicates no transfer and γ → 0 indicates maximum transfer. The equivalence of this formulation to a “classical” SVM formulation and advantages will be elaborated in Section 4. Note that this formulation is not specific to E-SVM and this transfer regularization can also be applied to “classical” SVM formulations.

Parts generally occur with certain correlations. The existence of a part hints about the existence or absence of some other parts. For instance the occurrence of an up-left window-corner-like part might increase the occurrence probability of up-right window-corner-like part and decrease the existence probability of a zebra-face-like part. Consequently, in addition to transferring parts from the well trained source classifiers, we can also transfer statistical correlations between parts. This section will elaborate on the incorporation of such pairwise statistical correlations in the EE-SVM objective.

One common approach for enforcing pairwise statistics is performed through pairwise potential functions using Markov random fields (MRF) or conditional random fields (CRF) frameworks [5]. These potential functions are mostly non-convex and defined over discrete random variables; however, they can be efficiently optimized using graph-cuts or linear programming relaxations. Unfortunately they are not directly applicable for the SVM framework. Here we introduce a pairwise potential function that is convex and can be conveniently applied to convex regularized risk minimization frameworks, particularly SVMs. We are particularly interested in enforcing pairwise statistics in the transfer regularization formulations (i.e. Eq. 3) where the correlation is enforced on the activation of classifier parts ui
                     ’s in order to construct the classifier w. Assuming that a positive value of αi
                      represents the activation of the part ui
                      and 
                        
                           
                              α
                              i
                           
                           =
                           0
                        
                      indicates that ui
                      is not activated, the pairwise statistics can be captured through correlations between αi, αj
                      pairs. The energy function to enforce this statistics can be defined as:

                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          
                                             min
                                             α
                                          
                                          
                                          ϕ
                                          
                                             (
                                             α
                                             )
                                          
                                          =
                                          
                                             ∑
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          
                                             C
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             
                                                ∥
                                                
                                                   α
                                                   i
                                                
                                                −
                                                
                                                   α
                                                   j
                                                
                                                ∥
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     where Cij
                      is the pairwise correlation between the variables αi
                      and αj
                     . Then, the complete transfer objective is:

                        
                           (4)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             min
                                             
                                                w
                                                ,
                                                b
                                                ,
                                                α
                                             
                                          
                                          
                                          λ
                                          
                                             
                                                ∥
                                                w
                                                −
                                                
                                                   ∑
                                                   i
                                                   M
                                                
                                                
                                                   
                                                      α
                                                      i
                                                   
                                                   
                                                      u
                                                      i
                                                   
                                                
                                                ∥
                                             
                                             2
                                          
                                          +
                                          γ
                                          
                                             ∑
                                             i
                                             M
                                          
                                          
                                             α
                                             i
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          +
                                          
                                          
                                             ∑
                                             i
                                             N
                                          
                                          max
                                          
                                             (
                                             0
                                             ,
                                             1
                                             −
                                             
                                                y
                                                i
                                             
                                             
                                                (
                                                
                                                   w
                                                   T
                                                
                                                
                                                   x
                                                   i
                                                
                                                +
                                                b
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          +
                                          
                                          θ
                                          
                                             ∑
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                M
                                                ,
                                                M
                                             
                                          
                                          
                                             C
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             
                                                ∥
                                                
                                                   α
                                                   i
                                                
                                                −
                                                
                                                   α
                                                   j
                                                
                                                ∥
                                             
                                             2
                                          
                                          
                                          s
                                          t
                                          :
                                          
                                             α
                                             i
                                          
                                          ≥
                                          0
                                          ,
                                          
                                          ∀
                                          i
                                       
                                    
                                 
                              
                           
                        
                     where θ is the hyperparameter that controls the weight of enforcing statistical correlations.

Intuitively a positive Cij
                      enforces the values of αi
                      and αj
                      to be as close as possible, therefore if one activated the other will be as well, especially when Cij
                      is a very high positive value. Conversely, a negative Cij
                      forces them to be as distinct as possible. However this objective is not necessarily convex, particularly when Cij
                      contains negative values. In order to obtain a convex energy function, we introduce a slight addition to the pairwise potential and define 
                        
                           ϕ
                           ¯
                        
                      as:

                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          
                                             ϕ
                                             ¯
                                          
                                          
                                             (
                                             α
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          
                                             C
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             
                                                ∥
                                                
                                                   α
                                                   i
                                                
                                                −
                                                
                                                   α
                                                   j
                                                
                                                ∥
                                             
                                             2
                                          
                                          −
                                          4
                                          
                                             ∑
                                             i
                                          
                                          
                                             D
                                             
                                                i
                                                i
                                             
                                             −
                                          
                                          
                                             α
                                             i
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          
                                             C
                                             
                                                i
                                                j
                                             
                                             +
                                          
                                          
                                             ∥
                                          
                                          
                                             α
                                             i
                                          
                                          −
                                          
                                             α
                                             j
                                          
                                          
                                             
                                                ∥
                                             
                                             2
                                          
                                          −
                                          
                                             ∑
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          
                                             C
                                             
                                                i
                                                j
                                             
                                             −
                                          
                                          
                                             
                                                ∥
                                                
                                                   α
                                                   i
                                                
                                                +
                                                
                                                   α
                                                   j
                                                
                                                ∥
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     where the pairwise correlation matrix C is decomposed into its positive and negative components as 
                        
                           C
                           =
                           
                              C
                              +
                           
                           +
                           
                              C
                              −
                           
                           ,
                        
                     
                     
                        
                           D
                           +
                        
                      is a diagonal matrix with entries 
                        
                           
                              D
                              
                                 i
                                 i
                              
                              +
                           
                           =
                           
                              ∑
                              j
                           
                           
                              C
                              
                                 i
                                 j
                              
                              +
                           
                           ,
                        
                      and 
                        
                           D
                           −
                        
                      is a diagonal matrix with entries 
                        
                           
                              D
                              
                                 i
                                 i
                              
                              −
                           
                           =
                           
                              ∑
                              j
                           
                           
                              C
                              
                                 i
                                 j
                              
                              −
                           
                        
                     . Intuitively by introducing more penalization (i.e. 
                        
                           −
                           4
                           
                              ∑
                              i
                           
                           
                              D
                              
                                 i
                                 i
                              
                              −
                           
                           
                              α
                              i
                              2
                           
                        
                     ) over highly negatively correlated αi
                     ’s, which is sensible since these αi
                     ’s have smaller probabilities to be activated, we can obtain a convex pairwise potential (6). Finally by plugging 
                        
                           
                              ϕ
                              ¯
                           
                           
                              (
                              α
                              )
                           
                        
                      into (4) as the pairwise potential, we obtain a convex minimization objective that combines transfer regularization and co-occurrence statistics of the parts:

                        
                           (7)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             min
                                             
                                                w
                                                ,
                                                b
                                                ,
                                                α
                                             
                                          
                                          λ
                                          
                                             
                                                ∥
                                                w
                                                −
                                                
                                                   ∑
                                                   i
                                                   M
                                                
                                                
                                                   
                                                      α
                                                      i
                                                   
                                                   
                                                      u
                                                      i
                                                   
                                                
                                                ∥
                                             
                                             2
                                          
                                          +
                                          γ
                                          
                                             ∑
                                             i
                                             M
                                          
                                          
                                             α
                                             i
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          +
                                          
                                          
                                             ∑
                                             i
                                             N
                                          
                                          max
                                          
                                             (
                                             0
                                             ,
                                             1
                                             −
                                             
                                                y
                                                i
                                             
                                             
                                                (
                                                
                                                   w
                                                   T
                                                
                                                
                                                   x
                                                   i
                                                
                                                +
                                                b
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          +
                                          θ
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                
                                                   M
                                                   ,
                                                   M
                                                
                                             
                                             
                                                C
                                                
                                                   i
                                                   j
                                                
                                                +
                                             
                                             
                                                ∥
                                             
                                             
                                                α
                                                i
                                             
                                             −
                                             
                                                α
                                                j
                                             
                                             
                                                
                                                   ∥
                                                
                                                2
                                             
                                             −
                                             
                                                ∑
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                
                                                   M
                                                   ,
                                                   M
                                                
                                             
                                             
                                                C
                                                
                                                   i
                                                   j
                                                
                                                −
                                             
                                             
                                                
                                                   ∥
                                                   
                                                      α
                                                      i
                                                   
                                                   +
                                                   
                                                      α
                                                      j
                                                   
                                                   ∥
                                                
                                                2
                                             
                                             )
                                          
                                          
                                          s
                                          t
                                          :
                                          
                                             α
                                             i
                                          
                                          ≥
                                          0
                                          ,
                                          
                                          ∀
                                          i
                                       
                                    
                                 
                              
                           
                        
                     This new version of EE-SVM will be referred to as EE-SVM-COR. The part correlations are learnt from the source filters, and the implementation details will be discussed in Section 5.


                     Discussion. Another way of enforcing part correlations is to use inverse covariance matrix regularization, i.e. 
                        
                           
                              α
                              T
                           
                           
                              Σ
                              
                                 −
                                 1
                              
                           
                           α
                           ,
                        
                      assuming that Σ is a valid covariance matrix. However, due to the large number of parameters and the limited samples the estimated Σ may not be positive definite which prevents us from computing the inverse. In [21] 
                     Σ is treated as an affinity matrix (i.e. stronger correlation means higher affinity). They directly used it for constructing the precision matrix of a Gaussian and used it in the regularization as 
                        
                           
                              α
                              T
                           
                           
                              (
                              I
                              −
                              λ
                              Σ
                              )
                           
                           α
                           ,
                        
                      where λ is a hyperparameter that ensures the positive definiteness. We also treat the correlation matrix Cij
                      as an affinity matrix and enforce part correlations in a similar manner. The detailed derivations of the formulations are given in Section 4.

In this section, initially we will investigate transforming transfer learning formulations to a “classical” SVM formulation, which comes with the benefit of using easy and robust optimization for transfer learning approaches and makes it potentially possible to use for practical purposes without the need of expert knowledge in transfer learning. Several equivalence relations between transfer regularization and feature mapping will be investigated, and their corresponding implications will be discussed.

Transfer regularization [52] is applied for many transfer learning approaches in object classification and detection. We’ll start with the general form of the formulation used by [47] for transferring from multiple sources which uses squared loss. Due to the robustness of the hinge loss over the squared loss, we substitute the squared loss term with the hinge loss and obtain:

                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                                
                                                   α
                                                   ,
                                                   w
                                                   ,
                                                   b
                                                
                                             
                                             
                                             λ
                                             
                                                
                                                   ∥
                                                   w
                                                   −
                                                   
                                                      ∑
                                                      i
                                                      M
                                                   
                                                   
                                                      
                                                         α
                                                         i
                                                      
                                                      
                                                         u
                                                         i
                                                      
                                                   
                                                   ∥
                                                
                                                2
                                             
                                             +
                                             
                                                ∑
                                                i
                                                N
                                             
                                             max
                                             
                                                (
                                                0
                                                ,
                                                1
                                                −
                                                
                                                   y
                                                   i
                                                
                                                
                                                   (
                                                   
                                                      w
                                                      T
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   +
                                                   b
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             t
                                             :
                                             ∥
                                             
                                                α
                                             
                                             ∥
                                             ≤
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        where ui
                        ’s are the source classifiers and αi
                        ’s are the corresponding weights of transfer for each source classifier. After a slight modification to the transfer regularization formulation (i.e. from (8) to (2) by bringing the constraint into the objective), we will transform the problem to a “classical” SVM formulation through a feature augmentation approach. The derivation below steps through the rearrangements for mapping the transfer regularization objective to an equivalent “classical” SVM formulation where the feature vector is augmented with the responses of source classifier models. Let 
                           
                              w
                              =
                              
                                 w
                                 ^
                              
                              +
                              
                                 ∑
                                 i
                                 M
                              
                              
                                 
                                    α
                                    i
                                 
                                 
                                    u
                                    i
                                 
                              
                              ,
                           
                         and then the derivation is:

                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                λ
                                                ∥
                                                w
                                                −
                                             
                                             
                                                ∑
                                                i
                                                M
                                             
                                             
                                                
                                                   α
                                                   i
                                                
                                                
                                                   u
                                                   i
                                                
                                             
                                             
                                                
                                                   ∥
                                                
                                                2
                                             
                                             +
                                             γ
                                             
                                                ∑
                                                i
                                                M
                                             
                                             
                                                α
                                                i
                                                2
                                             
                                             +
                                             
                                                ∑
                                                i
                                                N
                                             
                                             max
                                             
                                                (
                                                0
                                                ,
                                                1
                                                −
                                                
                                                   y
                                                   i
                                                
                                                
                                                   (
                                                   
                                                      w
                                                      T
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   +
                                                   b
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                =
                                                λ
                                                ∥
                                             
                                             
                                                w
                                                ^
                                             
                                             
                                                
                                                   ∥
                                                
                                                2
                                             
                                             +
                                             γ
                                             
                                                ∑
                                                i
                                                M
                                             
                                             
                                                α
                                                i
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                             
                                                ∑
                                                i
                                                N
                                             
                                             max
                                             
                                                (
                                                0
                                                ,
                                                1
                                                −
                                                
                                                   y
                                                   i
                                                
                                                
                                                   (
                                                   
                                                      
                                                         w
                                                         ^
                                                      
                                                      T
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   +
                                                   
                                                      
                                                         (
                                                         
                                                            ∑
                                                            i
                                                            M
                                                         
                                                         
                                                            
                                                               α
                                                               i
                                                            
                                                            
                                                               u
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                      T
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   +
                                                   b
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                =
                                                ∥
                                             
                                             
                                                w
                                                ¯
                                             
                                             
                                                
                                                   ∥
                                                
                                                2
                                             
                                             +
                                             
                                                ∑
                                                i
                                                N
                                             
                                             max
                                             
                                                (
                                                0
                                                ,
                                                1
                                                −
                                                
                                                   y
                                                   i
                                                
                                                
                                                   (
                                                   
                                                      
                                                         w
                                                         ¯
                                                      
                                                      T
                                                   
                                                   
                                                      
                                                         x
                                                         ¯
                                                      
                                                      i
                                                   
                                                   +
                                                   b
                                                   )
                                                
                                                )
                                             
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where

                           
                              
                                 
                                    
                                       
                                          
                                             w
                                             ¯
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   λ
                                                
                                                
                                                   w
                                                   ^
                                                
                                                ;
                                                
                                                   γ
                                                
                                                
                                                   α
                                                   1
                                                
                                                ;
                                                
                                                   γ
                                                
                                                
                                                   α
                                                   2
                                                
                                                ;
                                                .
                                                .
                                                .
                                                ;
                                                
                                                   γ
                                                
                                                
                                                   α
                                                   M
                                                
                                                ]
                                                ,
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                x
                                                ¯
                                             
                                             i
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      1
                                                      
                                                         λ
                                                      
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   ;
                                                   
                                                      1
                                                      
                                                         γ
                                                      
                                                   
                                                   
                                                      u
                                                      1
                                                      T
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   ;
                                                   
                                                      1
                                                      
                                                         γ
                                                      
                                                   
                                                   
                                                      u
                                                      2
                                                      T
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   ;
                                                   .
                                                   .
                                                   .
                                                   ;
                                                   
                                                      1
                                                      
                                                         γ
                                                      
                                                   
                                                   
                                                      u
                                                      M
                                                      T
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                
                                                ]
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              w
                              ¯
                           
                         is the transformed classifier and 
                           
                              
                                 x
                                 ¯
                              
                              i
                           
                         is the augmented feature vector with the responses of u’s on xi
                        . The classifier w, the solution to the original problem (9), can easily be computed from 
                           
                              w
                              ¯
                           
                         since 
                           
                              w
                              =
                              
                                 w
                                 ^
                              
                              +
                              
                                 ∑
                                 i
                                 M
                              
                              
                                 
                                    α
                                    i
                                 
                                 
                                    u
                                    i
                                 
                              
                           
                        . As is clear from (11), the transformed problem is a “classical” SVM formulation with feature augmentation, and it can be optimized efficiently using existing powerful SVM solvers. Note that this derivation is applicable to both EE-SVM objective and previously used transfer regularization formulations.


                        Discussion. The major implication of this derivation is that transfer regularization can also be stated as a classical SVM minimization problem where the feature vector is augmented with the responses of source classifiers. This equivalence constructs a bridge between papers implementing feature augmentation or populating the features with the responses of high-level classifiers [15,18,24,26,32,49,54] and papers performing transfer regularization [46,47,52,53]. Another direct implication is that transfer regularization approaches [46,47,52,53], which requires specialized optimization, can be reformulated to be efficiently optimized with the state-of-the-art SVM solvers.

Another way of converting (9) to a normal SVM formulation would be solving α analytically and substituting it into the original equation. Let the regularization part of (9) be 
                           
                              R
                              =
                              
                                 
                                    λ
                                    ∥
                                    w
                                    −
                                    U
                                    α
                                    ∥
                                 
                                 2
                              
                              +
                              γ
                              
                                 
                                    ∥
                                    α
                                    ∥
                                 
                                 2
                              
                           
                         then the derivation is as follows:

                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   R
                                                
                                                
                                                   ∂
                                                   α
                                                
                                             
                                             =
                                             0
                                             
                                             →
                                             
                                             α
                                             =
                                             λ
                                             
                                                
                                                   (
                                                   γ
                                                   I
                                                   +
                                                   λ
                                                   
                                                      U
                                                      T
                                                   
                                                   U
                                                   )
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                U
                                                T
                                             
                                             w
                                          
                                       
                                    
                                 
                              
                           
                         By substituting α in to R we obtain:

                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             M
                                             =
                                             
                                                λ
                                             
                                             
                                                (
                                                I
                                                −
                                                λ
                                                U
                                                
                                                   
                                                      (
                                                      γ
                                                      I
                                                      +
                                                      λ
                                                      
                                                         U
                                                         T
                                                      
                                                      U
                                                      )
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   U
                                                   T
                                                
                                                )
                                             
                                             +
                                             λ
                                             
                                                γ
                                             
                                             
                                                
                                                   (
                                                   γ
                                                   I
                                                   +
                                                   λ
                                                   
                                                      U
                                                      T
                                                   
                                                   U
                                                   )
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                U
                                                T
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             R
                                             =
                                             
                                                
                                                   ∥
                                                   M
                                                   w
                                                   ∥
                                                
                                                2
                                             
                                             =
                                             
                                                w
                                                T
                                             
                                             
                                                M
                                                T
                                             
                                             M
                                             w
                                          
                                       
                                    
                                 
                              
                           
                        Similar to the derivation in (11), this regularization can also be implemented as a feature transformation (i.e. 
                           
                              
                                 w
                                 ¯
                              
                              =
                              M
                              w
                              ,
                              
                              
                                 
                                    x
                                    ¯
                                 
                                 i
                              
                              =
                              
                                 
                                    (
                                    
                                       M
                                       T
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 x
                                 i
                              
                           
                        ) and solved using a normal SVM formulation.

This section will discuss how to map the objective (7) to a “classical” SVM formulation by defining appropriate feature maps. Initially the formulation will be converted to a graph Laplacian form, and then by incorporation of some new variables, a few pseudo-training samples and appropriate rearrangements the objective will be transformed to a linear SVM objective.

Assuming that Cij
                         are the weights on a graph, ϕ(α) in (3) can be re-written in the form below:

                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             ϕ
                                             (
                                             α
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                             
                                                C
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                
                                                   ∥
                                                   
                                                      α
                                                      i
                                                   
                                                   −
                                                   
                                                      α
                                                      j
                                                   
                                                   ∥
                                                
                                                2
                                             
                                             =
                                             2
                                             
                                                α
                                                T
                                             
                                             L
                                             α
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             where
                                             
                                             L
                                             =
                                             D
                                             −
                                             C
                                             ,
                                             
                                             
                                                D
                                                
                                                   i
                                                   i
                                                
                                             
                                             =
                                             
                                                ∑
                                                j
                                             
                                             
                                                C
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where L is the graph Laplacian. Similarly we can rewrite 
                           
                              
                                 ϕ
                                 ¯
                              
                              
                                 (
                                 α
                                 )
                              
                           
                         in (5) as:

                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             
                                                ϕ
                                                ¯
                                             
                                             
                                                (
                                                α
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                             
                                                C
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                
                                                   ∥
                                                   
                                                      α
                                                      i
                                                   
                                                   −
                                                   
                                                      α
                                                      j
                                                   
                                                   ∥
                                                
                                                2
                                             
                                             −
                                             4
                                             
                                                α
                                                T
                                             
                                             
                                                D
                                                −
                                             
                                             α
                                             =
                                             2
                                             
                                                α
                                                T
                                             
                                             
                                                L
                                                ¯
                                             
                                             α
                                          
                                       
                                    
                                    
                                       
                                          
                                             L
                                             ¯
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                D
                                                ¯
                                             
                                             −
                                             C
                                             ,
                                             
                                             
                                                
                                                   D
                                                   ¯
                                                
                                                
                                                   i
                                                   i
                                                
                                             
                                             =
                                             
                                                ∑
                                                j
                                             
                                             
                                                |
                                                
                                                   C
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                |
                                             
                                             =
                                             
                                                D
                                                +
                                             
                                             −
                                             
                                                D
                                                −
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Let 
                           
                              U
                              =
                              [
                              
                                 u
                                 1
                              
                              ,
                              
                                 u
                                 2
                              
                              ,
                              .
                              .
                              ,
                              
                                 u
                                 M
                              
                              ]
                           
                         and 
                           
                              w
                              =
                              
                                 w
                                 ^
                              
                              +
                              
                                 ∑
                                 i
                                 M
                              
                              
                                 
                                    α
                                    i
                                 
                                 
                                    u
                                    i
                                 
                              
                              =
                              
                                 w
                                 ^
                              
                              +
                              U
                              α
                              ,
                           
                         rewriting (7) with appropriate substitutions:

                           
                              (17)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   w
                                                   ,
                                                   b
                                                   ,
                                                   α
                                                
                                             
                                             
                                             λ
                                             
                                                
                                                   w
                                                   ^
                                                
                                                T
                                             
                                             
                                                w
                                                ^
                                             
                                             +
                                             
                                                α
                                                T
                                             
                                             
                                                (
                                                γ
                                                I
                                                +
                                                2
                                                θ
                                                
                                                   L
                                                   ¯
                                                
                                                )
                                             
                                             α
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                             
                                                ∑
                                                i
                                                N
                                             
                                             max
                                             
                                                (
                                                0
                                                ,
                                                1
                                                −
                                                
                                                   y
                                                   i
                                                
                                                
                                                   (
                                                   
                                                      
                                                         w
                                                         ^
                                                      
                                                      T
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   +
                                                   
                                                      α
                                                      T
                                                   
                                                   
                                                      U
                                                      T
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   +
                                                   b
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             s
                                             t
                                             :
                                             
                                                α
                                                i
                                             
                                             ≥
                                             0
                                             ,
                                             
                                             ∀
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Considering both 
                           
                              L
                              ¯
                           
                         and I are positive-semi definite, we can decompose the term 
                           
                              γ
                              I
                              +
                              2
                              θ
                              
                                 L
                                 ¯
                              
                           
                         using the Cholesky decomposition as 
                           
                              R
                              
                                 R
                                 T
                              
                           
                         then introduce 
                           
                              β
                              =
                              
                                 R
                                 T
                              
                              α
                           
                         and rewrite:

                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             
                                                α
                                                T
                                             
                                             
                                                (
                                                γ
                                                I
                                                +
                                                2
                                                θ
                                                
                                                   L
                                                   ¯
                                                
                                                )
                                             
                                             α
                                             =
                                             
                                                α
                                                T
                                             
                                             R
                                             
                                                R
                                                T
                                             
                                             α
                                             =
                                             
                                                β
                                                T
                                             
                                             β
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             
                                                α
                                                T
                                             
                                             =
                                             
                                                β
                                                T
                                             
                                             
                                                R
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Plugging in (18) and (19) to (17) we obtain:

                           
                              (20)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   
                                                      w
                                                      ^
                                                   
                                                   ,
                                                   b
                                                   ,
                                                   β
                                                
                                             
                                             
                                             λ
                                             
                                                
                                                   w
                                                   ^
                                                
                                                T
                                             
                                             
                                                w
                                                ^
                                             
                                             +
                                             
                                                β
                                                T
                                             
                                             β
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                             
                                                ∑
                                                i
                                                N
                                             
                                             max
                                             
                                                (
                                                0
                                                ,
                                                1
                                                −
                                                
                                                   y
                                                   i
                                                
                                                
                                                   (
                                                   
                                                      
                                                         w
                                                         ^
                                                      
                                                      T
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   +
                                                   
                                                      β
                                                      T
                                                   
                                                   
                                                      R
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      U
                                                      T
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   +
                                                   b
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             s
                                             t
                                             :
                                             
                                                
                                                   [
                                                   
                                                      
                                                         (
                                                         
                                                            R
                                                            
                                                               −
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                      T
                                                   
                                                   β
                                                   ]
                                                
                                                i
                                             
                                             ≥
                                             0
                                             ,
                                             
                                             ∀
                                             i
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   
                                                      w
                                                      ¯
                                                   
                                                   ,
                                                   b
                                                
                                             
                                             
                                             
                                                
                                                   ∥
                                                   
                                                      w
                                                      ¯
                                                   
                                                   ∥
                                                
                                                2
                                             
                                             +
                                             
                                                ∑
                                                i
                                                N
                                             
                                             max
                                             
                                                (
                                                0
                                                ,
                                                1
                                                −
                                                
                                                   y
                                                   i
                                                
                                                
                                                   (
                                                   
                                                      
                                                         w
                                                         ¯
                                                      
                                                      T
                                                   
                                                   
                                                      
                                                         x
                                                         ¯
                                                      
                                                      i
                                                   
                                                   +
                                                   b
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             s
                                             t
                                             :
                                             
                                                
                                                   [
                                                   
                                                      
                                                         (
                                                         
                                                            R
                                                            
                                                               −
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                      T
                                                   
                                                   β
                                                   ]
                                                
                                                i
                                             
                                             ≥
                                             0
                                             ,
                                             
                                             ∀
                                             i
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                where
                                                
                                                
                                                   w
                                                   ¯
                                                
                                                =
                                                
                                                   [
                                                   
                                                      λ
                                                   
                                                   
                                                      w
                                                      ^
                                                   
                                                   ;
                                                   β
                                                   ]
                                                
                                                ,
                                                
                                                
                                                   
                                                      x
                                                      ¯
                                                   
                                                   i
                                                
                                                =
                                                
                                                   [
                                                   
                                                      1
                                                      
                                                         λ
                                                      
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   ;
                                                   
                                                      R
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      U
                                                      T
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   ]
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Other than the linear constraints 
                           
                              
                                 
                                    [
                                    
                                       
                                          (
                                          
                                             R
                                             
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                       T
                                    
                                    β
                                    ]
                                 
                                 i
                              
                              ≥
                              0
                              ,
                           
                         the objective becomes a linear SVM objective.


                        Enforcing linear constraints in SVMs. For any classical SVM formulation:

                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                                
                                                   w
                                                   ,
                                                   b
                                                
                                             
                                             
                                             
                                                
                                                   ∥
                                                   w
                                                   ∥
                                                
                                                2
                                             
                                             +
                                             
                                                ∑
                                                i
                                                N
                                             
                                             max
                                             
                                                (
                                                0
                                                ,
                                                1
                                                −
                                                
                                                   y
                                                   i
                                                
                                                
                                                   (
                                                   
                                                      w
                                                      T
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                   +
                                                   b
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        we can implement a linear constraint 
                           
                              
                                 a
                                 T
                              
                              w
                              >
                              0
                           
                         by introducing an additional training sample 
                           
                              
                                 x
                                 
                                    N
                                    +
                                    1
                                 
                              
                              =
                              
                                 [
                                 ∞
                                 ×
                                 a
                                 ]
                              
                           
                         with the label 
                           
                              
                                 y
                                 
                                    N
                                    +
                                    1
                                 
                              
                              =
                              +
                              1
                           
                        . Here ∞ × a is the multiplication of the vector a with the infinity which is approximated with a very high numeric value (i.e. 106).

A similar approach will be used for implementing the linear constraints 
                           
                              
                                 
                                    [
                                    
                                       
                                          (
                                          
                                             R
                                             
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                       T
                                    
                                    β
                                    ]
                                 
                                 i
                              
                              ≥
                              0
                              ,
                              ∀
                              i
                           
                         in (20). Another additional training sample will be added for each row of 
                           
                              
                                 (
                                 
                                    R
                                    
                                       −
                                       1
                                    
                                 
                                 )
                              
                              T
                           
                         as each row introduces another constraint on β. Since the constraints only concern the β part of 
                           
                              
                                 
                                    w
                                    ¯
                                 
                                 =
                                 
                                    [
                                    
                                       λ
                                    
                                    
                                       w
                                       ^
                                    
                                    ;
                                    β
                                    ]
                                 
                                 ,
                              
                           
                         the initial parts of the additional training sample will be filled with a zero vector of the same length as 
                           
                              w
                              ^
                           
                        . The rest of it will be filled by the appropriate row extracted from 
                           
                              
                                 (
                                 
                                    R
                                    
                                       −
                                       1
                                    
                                 
                                 )
                              
                              T
                           
                         and multiplied by infinity. In a formal definition, linear constraints are implemented by adding M additional samples to our training set as below:

                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   ¯
                                                
                                                
                                                   N
                                                   +
                                                   k
                                                
                                             
                                             =
                                             
                                                [
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         w
                                                         ^
                                                      
                                                      
                                                         |
                                                      
                                                   
                                                
                                                ;
                                                ∞
                                                ×
                                                
                                                   
                                                      (
                                                      
                                                         R
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      k
                                                      ,
                                                      :
                                                   
                                                   T
                                                
                                                ]
                                             
                                             ,
                                             
                                             
                                                y
                                                
                                                   N
                                                   +
                                                   k
                                                
                                             
                                             =
                                             +
                                             1
                                             ,
                                             
                                             1
                                             ≤
                                             k
                                             ≤
                                             M
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 x
                                 ¯
                              
                              
                                 N
                                 +
                                 k
                              
                           
                         are the additional training samples that implement the constraints, 
                           
                              
                                 0
                              
                              
                                 
                                    |
                                 
                                 
                                    w
                                    ^
                                 
                                 
                                    |
                                 
                              
                           
                         is the zero vector of the same length as 
                           
                              
                                 w
                                 ^
                              
                              ,
                           
                        
                        
                           
                              
                                 (
                                 
                                    R
                                    
                                       −
                                       1
                                    
                                 
                                 )
                              
                              
                                 k
                                 ,
                                 :
                              
                              T
                           
                         is the kth
                         row of 
                           
                              
                                 (
                                 
                                    R
                                    
                                       −
                                       1
                                    
                                 
                                 )
                              
                              T
                           
                        .

After handling the constraints as well, the transformation of the original objective (7) to a classical SVM formulation is completed. Therefore we can optimize (7) using available robust SVM optimization tools.

In this section the details of the implementation will be discussed. Initially training source classifiers and E-SVM will be discussed. Then EE-SVM training procedures and obtaining part correlations will be explained.


                     Source classifiers and part vocabulary. The source classifiers are linear SVM classifiers (templates) over HOG [8,19] features. The source classifiers are trained with three components for each class and without parts, similar to the procedure in [19]. While testing on the PASCAL VOC 2007 test set, the source classifiers are learnt from the 1000 classes of the ImageNet [11] 2012 challenge. In total, the 329 models out of 1000 are selected that have an AP over 30% on a small validation set of 1000 images (50 positive images per class). Together with the mirrored versions of these templates it totals to 329  ×  3  × 2 
                        =
                      1974 source classifiers. To build the vocabulary of classifier patches, all patches with sizes of 5 × 5 are extracted from the components of the trained DPMs, then a k-means clustering is performed with 
                        
                           k
                           =
                           10
                           K
                        
                      centers. Other ways of composing the vocabulary could be learning the vocabulary via sparse reconstruction as in [42], or learning both the vocabulary items and the classifiers at the same time as in [22]; however this is beyond the scope of our work. While testing on ImageNet, the source classifiers are trained using 20 classes of the PASCAL VOC 2007 training set. All 5 × 5 classifier patches are used to form a vocabulary of 1948 items.


                     E-SVM training. Similar to [33], each E-SVM is composed of 100 or slightly less HOG cells where the aspect ratio is chosen according to the query image. The E-SVM is trained with the given query image as the positive sample and randomly selected 2000 negative images from the PASCAL VOC 2007 training set. The training is performed iteratively in a similar fashion to [33] where mined hard negatives are incorporated to the learning after each iteration.
                  


                     EE-SVM training. The training procedure of EE-SVM, which is briefly visualized in Fig. 1, starts with training an E-SVM classifier from the given query image. After obtaining the E-SVM, for each 5 × 5 cell classifier patch a good match is searched for within the vocabulary. This linear search can be efficiently done using fast matrix multiplication since we have a limited number of vocabulary items. Even though we use 5 × 5 cell classifier patches for experimental validation, any other varying size and aspect ratio can also be applied. A good match is defined by thresholding the cosine similarity (normalized dot product) between the E-SVM patch (a 5 × 5 × 32 dimensional vector) and vocabulary items. This threshold value is fixed to 0.2. After determining where to transfer from, each patch is relocated on a w sized HOG template padded with zeros other than the transferred classifier patch. Finally learning of the EE-SVM is performed using the same set of training samples used for training the E-SVM and no new hard negatives are collected.


                     Partial matching for occlusion and truncation. In occluded or truncated queries, the parts of the E-SVM classifier might not match well with the vocabulary items due to the distortion caused by occlusions and truncations. Hence instead of using good mathces of the E-SVM patch from the vocabulary items as defined above, ignoring a few cells (potentially occluded or truncated regions) while computing similarity would be a better idea. The matches obtained by this partial matching method is referred as partial good mathces of the E-SVM patch. Here we only use the most similar (i.e. cosine similarity) β percent of the cells for matching an E-SVM patch to a vocabulary item. For instance if the E-SVM patch and vocabulary items are 5 × 5 cells and β is 70%, then the top matching 18 (i.e. 70% of 25) cells are used for computing normalized dot product and deciding if the vocabulary item is a partial good match or not. Similar to the good match, the same threshold of 0.2 is used for the decision.


                     Optimization. The optimization of the EE-SVM and EE-SVM-COR objectives are performed using the LIBSVM [6] package through the equivalent feature mapping formulations which are already discussed in Section 4. The only additional cost of EE-SVM and EE-SVM-COR over E-SVM is the transformation of training samples, and training another SVM, which constitutes less than 1% of the training time (i.e. mining hard negatives is costly). The test time complexity of EE-SVM and EE-SVM-COR is exactly the same as that of E-SVM.


                     Part correlations. The entries of the pairwise part correlation matrix Cij
                      are estimated using the pairwise sample correlation coefficient ρ
                     
                        i, j
                      which is computed from the joint occurrence of parts i and j in the source filters (i.e. the source filters are the samples). The computation of the correlation coefficient is:

                        
                           (23)
                           
                              
                                 
                                    
                                       
                                          
                                             ρ
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          =
                                          
                                             
                                                cov
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             
                                                
                                                   σ
                                                   i
                                                
                                                
                                                   σ
                                                   j
                                                
                                             
                                          
                                          =
                                          
                                             
                                                E
                                                [
                                                
                                                   (
                                                   i
                                                   −
                                                   
                                                      μ
                                                      i
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   j
                                                   −
                                                   
                                                      μ
                                                      j
                                                   
                                                   )
                                                
                                                ]
                                             
                                             
                                                
                                                   σ
                                                   i
                                                
                                                
                                                   σ
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where cov is the sample covariance, σi
                      is the standard deviation of occurrence of part i computed over samples (1 states occurrence and 0 states absence of part i in the given sample), μi
                      is the mean occurrence of part i across all the samples, and E is the expectation.

@&#EXPERIMENTS@&#

In this section the experimental results will be described. Initially we give the experimental settings, evaluation metrics and the defaults for the hyperparameters. In the next two sections, we then discuss two sets of experiments performed on the PASCAL VOC 2007 [17] dataset and ImageNet [11]. Average precision (AP), and precision at top K (PR@5, PR@10, PR@50, PR@100) retrievals are used for evaluating the quality of retrieval results. A correct retrieval is defined as the same object class with the same pose as the query image and the retrieved subwindow should have at least 50% overlap with the true bounding box around the object class. The definition of the pose is inherited from the PASCAL VOC metrics [17] where four main poses exist namely left, right, frontal, rear (the pose “unspecified” is omitted). In all the experiments the proposed approaches are compared with the E-SVM method. Both λ and γ parameters are fixed to 1, and θ is fixed to 10 in all the experiments unless otherwise stated. The matching similarity threshold, which determines the good classifier patch matches based on the normalized dot product of two vectors, is fixed to 0.2.

The retrievals of PASCAL’07 classes with four main poses are evaluated. The part vocabulary is obtained from ImageNet. The query images are selected as all non-truncated images of the 17 classes (bottle, dining table and potted plant are omitted since they don’t have poses) with four main poses from the PASCAL’07 training set. For each query image, an E-SVM and EE-SVM variants are trained and run on the test set. Ground truth is identified as the same object class with the same pose label. Due to the strong visual similarities in the poses (e.g. left–right symmetries for bicycle, car, motorbike, etc.), the detections of the same object class other than the target pose are omitted and not counted towards AP computation. For instance if we are searching for a bicycle facing left, we ignore (i.e neither count as positive or negative) the detections of front, rear, left or unspecified poses of bicycle. In total 1659 queries from 17 classes are evaluated, and the pose distribution is: 452 left, 439 right, 561 frontal, and 207 rear.

For some query images, due to being unusual examples of the pose (e.g. left facing bicycle with front wheel up as in Fig. 2), the AP results can be very low. Conversely for some others, which are canonical examples of the pose, the AP results are much higher. In order to have a better insight on the results and see the boost for different quality of samples, we grouped the queries as being above some AP threshold. The query belongs to the quality group AP > threshold, if the AP of E-SVM, EE-SVM or EE-SVM-COR is above the defined threshold (for instance group AP ≥ 0 means all the queries).
                        
                        
                        
                        
                     


                        Table 1 shows the AP improvements of EE-SVM variants over E-SVM on a smaller subset of randomly selected 10 query images for each of the 17 classes and 4 major poses. In this table we demonstrated EE-SVM variants in order to see the effects of different components of EE-SVM. The evaluated models are: (a) “EE-SVM w/o learning” which defines the classifier as the average of ui
                        ’s (i.e. 
                           
                              w
                              =
                              
                                 1
                                 M
                              
                              
                                 ∑
                                 i
                                 M
                              
                              
                                 u
                                 i
                              
                              ,
                           
                         it doesn’t learn αi
                        ’s), (b) “EE-SVM reconstruction only” which learns the classifier as the reconstruction from ui
                        ’s only (i.e. 
                           
                              w
                              =
                              
                                 ∑
                                 i
                                 M
                              
                              
                                 
                                    α
                                    i
                                 
                                 
                                    u
                                    i
                                 
                              
                              ,
                           
                         this is achieved by solving (2) when 
                           
                              λ
                              =
                              ∞
                           
                        ), and (c) full EE-SVM (i.e. setting 
                           
                              λ
                              =
                              γ
                              =
                              1
                           
                         in formulation (2)). All EE-SVM variants outperform E-SVM. Learning the combination weights (i.e. αi
                        ’s) as in “EE-SVM reconstruction only” improves to performance over just averaging the ui
                        ’s (i.e. “EE-SVM w/o learning”). Finally the EE-SVM, the midway solution between E-SVM and “EE-SVM reconstruction only”, performs significantly better than the others.


                        Table 2 shows the overall results and the AP improvement of EE-SVM and EE-SVM-COR over E-SVM. This experiment is performed on the full query set. In all the quality groups EE-SVM significantly improves over E-SVM, and EE-SVM-COR improves over EE-SVM. Even though the actual AP improvements are changing across the quality groups of samples, the relative boost of EE-SVM and EE-SVM-COR are consistently similar in different quality groups. In Table 3 the AP results and improvements are shown for individual classes for the quality level (AP ≥ 0.05). For statistical significance only the classes which have more than 5 queries are shown. For all the classes EE-SVM and EE-SVM-COR significantly outperforms E-SVM.

A few qualitative results can be seen in Fig. 3 where the top three positives and negatives are shown with their ranks in the ordered list of retrieved subwindows. In EE-SVM retrievals the ranks of the top three negatives are much later; this shows that EE-SVM better suppresses the negatives and thus increases the recall.


                        Handling occlusion and truncation via EE-SVM. It is quite common to come across truncated and occluded query images. Here we’ll briefly present a potential use scenario of EE-SVM for handling occlusions and truncations. Considering that certain parts of the query object is not visible in truncated or occluded queries, for each E-SVM classifier patch partial good matches (see Section 5) of vocabulary items are used instead of good matches. This procedure simply ignores a few cells (potentially the ones which correspond to occluded and truncated regions of the classifier patch) while performing the matching.


                        Fig. 4 shows two examples of handling occlusion and completing the truncated parts. In these examples 5 × 5 patches are used and the β parameter of the partial good match measure is 70%. γ parameter, which defines the strength of transfer, is set to 1. Particularly in the truncation example (second row on Fig. 4) the truncated parts (i.e. the bottom extension of the query) are partially completed with the support coming from matched vocabulary items, note that there is no visual data coming from the query image for these sections.

These experiments are conducted on ImageNet and the part vocabulary in obtained from PASCAL’07 dataset. Since PASCAL’07 has only 20 classes, robust computation of the part co-occurrence statistics is not feasible: hence the EE-SVM-COR is omitted in these experiments. For quantitative experiments five ImageNet classes (synsets) are selected: lion, deer, tandem, bulldozer, and ambulance. For each of these classes three random queries (from one of the main canonical poses) are selected from web images and evaluated on a test set which contains the images of the corresponding synset (∼1300 images) and the PASCAL’07 test set (∼5000 images). The evaluations are compared using precision at the top K retrievals. From the results, displayed in Table 4, we can conclude that the recall of EE-SVM is much better than the recall of E-SVM, particularly for top 50 and top 100 retrievals.

In addition to canonical poses, the method is also qualitatively demonstrated for unusual poses. With the help of part based transfer, since parts can be relocated and migrated across classes, even for quite unusual poses we can obtain significant improvements. The left facing bicycle with the front wheel up (see Figs. 2 and 5
                        ) is a nice example where the wheel patches are transferred from motorbike and bicycle classifiers with regular poses. Another example, displayed in Fig. 5, is a sitting lion where the ranks of positives clearly show EE-SVM’s ability for better recall.

Recently detecting person–object interactions [10] and compositions of objects [39] gained popularity. Our method can also be utilized in a similar scenario. A qualitative example for retrieving such object compositions (i.e. person riding horse) is demonstrated in Fig. 6
                        .

@&#CONCLUSION@&#

We introduced a method of part based transfer regularization that boosts the performance of E-SVMs. We demonstrated that EE-SVM suppresses the false detections significantly better than E-SVM. This improvement is shown both quantitatively and qualitatively on PASCAL’07 and ImageNet queries with canonical and unusual poses including compositions of objects. We also discussed the potential advantages of EE-SVM for handling truncation and occlusion.

We also introduced a convex potential function for incorporating the pairwise co-occurrence relations into convex max-margin learning frameworks. We showed that by defining appropriate feature maps, many transfer learning formulations are transformed to a classical SVM formulation, and subsequently solved by much easier and more robust optimization tools developed throughout the past years.

@&#REFERENCES@&#

