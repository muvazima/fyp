@&#MAIN-TITLE@&#A hierarchical Dirichlet process mixture of generalized Dirichlet distributions for feature selection

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A statistical framework based on hierarchical Dirichlet processes and generalized Dirichlet distribution is developed.


                        
                        
                           
                           The framework simultaneously performs model parameters estimations as well as model complexity determination.


                        
                        
                           
                           The learning of the model is done via variational Bayes inference.


                        
                        
                           
                           The efficiency of the proposed algorithm is validated via challenging applications.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Clustering

Hierarchical Dirichlet process

Variational learning

Face detection

Facial expression recognition

Human gesture recognition

@&#ABSTRACT@&#


               
               
                  This paper addresses the problem of identifying meaningful patterns and trends in data via clustering (i.e. automatically dividing a data set into meaningful homogenous sub-groups such that the data within the same sub-group are very similar, and data in different sub-groups are very different). The clustering framework that we propose is based on the generalized Dirichlet distribution, which is widely accepted as a flexible modeling approach, and a hierarchical Dirichlet process mixture prior. A main advantage of the adopted hierarchical Dirichlet process is that it provides a principled elegant nonparametric Bayesian approach to model selection by supposing that the number of mixture components can go to infinity. In addition to capturing the structure of the data, the combination of hierarchical Dirichlet process and generalized Dirichlet distribution is shown to offer a natural efficient solution to the feature selection problem when dealing with high-dimensional data. We develop two variational learning approaches (i.e. batch and incremental) for learning the parameters of the proposed model. The batch algorithm examines the entire data set at once while the incremental one learns the model one step at a time (i.e. update the model’s parameters each time new data are introduced). The utility of the proposed approach is demonstrated on real applications namely face detection, facial expression recognition, human gesture recognition, and off-line writer identification. The obtained results show clearly the merits of our statistical framework.
               
            

@&#INTRODUCTION@&#

In the last few years, we have seen an explosion of on-line data in digital form. It is crucial then to develop approaches and techniques to index and understand this content, and to represent it in compact forms. This is the case, for instance, of many forensics applications where one of the main goals is to automatically analyze or predict criminal incidents (see, for instance, [1]) which is vital for law enforcement agencies. Examples include intrusion detection, video-surveillance, user authentification (i.e. the task of confirming or denying the identity claimed by a given person) via face or fingerprint recognition to name a few [2]. Statistical approaches in general and graphical models in particular have been widely used for data (i.e. text, image, video) interpretation, understanding and modeling. Mixture models, as a particular case of graphical models, with their strong theoretical roots are known to be excellent statistical approaches for data analysis by offering a formal approach to unsupervised learning problems [3]. These models are at the heart of many challenging applications from different domains, but their deployment requires the resolution of some problems namely the choice of the components densities, the estimation of the parameters and model selection (i.e. determination of the number of components or model’s complexity). Concerning the choice of components densities, apart from some exceptions most mixture-based approaches consider Gaussian distributions [4]. Recently, however, several works have shown that this choice is not appropriate in many real-life applications and that other distributions such as the generalized Dirichlet may offer better modeling capabilities especially when dealing with proportional data [5]. Thus, in this work we consider the generalized Dirichlet as the parent distribution of our models. Concerning model selection, several approaches have been proposed in the past and are deeply discussed in [5]. The majority of the used approaches consider information theory-based criteria such as minimum description length and minimum message length [5]. Yet, these approaches are computationally expensive since one needs to run the learning algorithm for every candidate number of components. Unlike these conventional approaches which assume a finite number of components, we do not confine ourselves to this assumption. Indeed, infinite mixtures are considered, where a new data point can be affected to a new cluster that was not previously seen, via the adoption of a nonparametric Bayesian approach based on hierarchical Dirichlet process prior. We are mainly motivated by the excellent results obtained recently thanks to Dirichlet processes which avoid elegantly model selection problems [6]. For a comprehensive treatment of nonparametric Bayesian approaches and Dirichlet process the reader is referred to [7] and references therein.

One major limitation of the implementation of mixture models in real-life scenarios is dealing with high-dimensional data which causes sparsely populated spaces. Feature selection techniques have been widely used in the past to tackle this problem and allow generally to attain significant generalization improvement, to unseen data, in many applications such as text classification, image retrieval and annotation. Indeed, it is crucial to take into account the fact that features are generally not equally important (or relevant) for a given task (e.g. clustering) and that irrelevant features may even compromise modeling capabilities (e.g. by blurring clusters). Feature selection is a difficult problem especially in unsupervised settings, characterized by the absence of labeled data that could guide the selection process, which is actually our case since we are considering mixture models. In this context, features have been generally assumed to be independent (e.g. by considering Gaussians with diagonal covariance matrices) [4], to reduce complexity and the number of parameters to learn, which is not the case in several real-life applications [8]. However, the authors in [8] have shown that this assumption could be avoided in the case of the generalized Dirichlet distribution thanks to some interesting mathematical properties that allow the independence between features to become a fact, via a simple geometric transformation, as it will be explained in the next section.

A main drawback each time nonparametric Bayesian approaches have been considered is the fact that learning has been typically performed using Markov Chain Monte Carlo (MCMC) techniques namely Gibbs sampling and Metropolis–Hastings which is clearly time consuming [9]. There is a rich tradition in machine learning of studying inference techniques. The design of a good inference algorithm is particularly difficult. Recently, the variational approach has received a lot of attention by offering a compromise between deterministic approaches and purely Bayesian ones. Indeed, it can be viewed as deterministic approximation to Bayesian inference that allows to incorporate prior information in a principled way. The main idea is to approximate the model posterior distribution by minimizing the Kullback–Leibler divergence between the exact (or true) posterior and an approximating distribution which have had some impressive successes in learning complex statistical models (see, for instance, [10–12] and references therein). Thus, an important contribution of this work is the development of a variational algorithm to learn our hierarchical Dirichlet process mixture of generalized Dirichlet distributions. In order to face the fact that data extracted from real-life applications are generally dynamic, we extend our batch learning algorithm to online setting where data are supposed to arrive sequentially which is crucial in several real-life applications.

The rest of this paper is structured as follows. The paper begins with a presentation of the hierarchical Dirichlet process mixture of GD Distributions in Section 2, followed by the development of our batch and online learning algorithms in Section 3. Section 4 presents the experimental results in the context of four challenging real-life applications namely face detection, facial expression recognition, human gesture recognition, and off-line writer identification. Section 5 concludes the paper with some final remarks.

The hierarchical Dirichlet process framework is particularly useful in problems for modeling grouped data where observations are organized into groups allowed to remain statistically linked by sharing mixture components [13]. In this section, we develop a hierarchical Dirichlet process mixture model of generalized Dirichlet distributions with an unsupervised feature selection scheme.

The formal definition of the Dirichlet process [14] is as following: let H be a distribution over some probability space Θ and γ be a positive real number, then a random distribution G is distributed according to a Dirichlet process with the base distribution H and concentration parameter γ, denoted as 
                           
                              G
                              ∼
                              DP
                              (
                              γ
                              ,
                              H
                              )
                           
                        , if
                           
                              (1)
                              
                                 (
                                 G
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 G
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 )
                                 ∼
                                 Dir
                                 (
                                 γ
                                 H
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 γ
                                 H
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 )
                              
                           
                        where 
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    A
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         is the set of the finite partitions of Θ, and 
                           
                              Dir
                              (
                              γ
                              H
                              (
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              …
                              ,
                              γ
                              H
                              (
                              
                                 
                                    A
                                 
                                 
                                    t
                                 
                              
                              )
                              )
                           
                         is a finite-dimensional Dirichlet distribution with parameters 
                           
                              (
                              γ
                              H
                              (
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              …
                              ,
                              γ
                              H
                              (
                              
                                 
                                    A
                                 
                                 
                                    t
                                 
                              
                              )
                              )
                           
                        . Recently, hierarchical Dirichlet process [13] has been developed as a hierarchical nonparametric Bayesian model and has shown promising results to the problem of model-based clustering of grouped data with sharing clusters. It is built on the Dirichlet process which involves a Bayesian hierarchy where the base measure for a Dirichlet process is itself distributed according to a Dirichlet process. Now, let us introduce the general setting of a two-level hierarchical Dirichlet process: Assume that we have a grouped data set, in which each group is associated with an infinite mixture model (a Dirichlet process 
                           
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                           
                        ). This indexed set of Dirichlet processes 
                           
                              {
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                              }
                           
                         shares a base distribution 
                           
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                           
                        , which is itself distributed as a Dirichlet process:
                           
                              (2)
                              
                                 
                                    
                                       G
                                    
                                    
                                       0
                                    
                                 
                                 ∼
                                 DP
                                 (
                                 γ
                                 ,
                                 H
                                 )
                                 
                                 
                                    
                                       G
                                    
                                    
                                       j
                                    
                                 
                                 ∼
                                 DP
                                 (
                                 λ
                                 ,
                                 
                                    
                                       G
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 
                                 for
                                 
                                 each
                                 
                                 j
                                 ,
                                 j
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 M
                                 }
                              
                           
                        where j is an index for each group of data. In this work, we represent a hierarchical Dirichlet process in a more intuitive and straightforward form through two stick-breaking constructions which involves a global-level and a group-level construction [15,16]. In the global-level construction, the global measure 
                           
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                           
                         is distributed according to a Dirichlet process 
                           
                              DP
                              (
                              γ
                              ,
                              H
                              )
                           
                         and can be described using a stick-breaking representation as
                           
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 ∼
                                 Beta
                                 (
                                 1
                                 ,
                                 γ
                                 )
                                 
                                 
                                    
                                       Ω
                                    
                                    
                                       k
                                    
                                 
                                 ∼
                                 H
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       ψ
                                    
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          s
                                          =
                                          1
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       ψ
                                    
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                 
                                    
                                       G
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              {
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                              }
                           
                         is a set of independent random variables distributed according to 
                           
                              H
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          Ω
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           
                         is an atom at 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                           
                        . The random variables 
                           
                              
                                 
                                    ψ
                                 
                                 
                                    k
                                 
                              
                           
                         are known as the stick-breaking weights that satisfy 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    ∞
                                 
                              
                              
                                 
                                    ψ
                                 
                                 
                                    k
                                 
                              
                              =
                              1
                           
                        , and are obtained by recursively breaking a unit length stick into an infinite number of pieces such that the size of each successive piece is proportional to the rest of the stick. Since 
                           
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                           
                         is the base distribution of Dirichlet processes 
                           
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                           
                         and has a stick-breaking representation, the atoms 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                           
                         are shared among all 
                           
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                           
                         and differ only in weights. In this work, we apply the conventional stick-breaking representation as mentioned in [10] to construct each group-level Dirichlet process 
                           
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                           
                         as
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       jt
                                    
                                    
                                       ′
                                    
                                 
                                 ∼
                                 Beta
                                 (
                                 1
                                 ,
                                 λ
                                 )
                                 
                                 
                                    
                                       ϖ
                                    
                                    
                                       jt
                                    
                                 
                                 ∼
                                 
                                    
                                       G
                                    
                                    
                                       0
                                    
                                 
                                 
                                 
                                    
                                       π
                                    
                                    
                                       jt
                                    
                                 
                                 =
                                 
                                    
                                       π
                                    
                                    
                                       jt
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          s
                                          =
                                          1
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       π
                                    
                                    
                                       js
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                 
                                    
                                       G
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       jt
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             ϖ
                                          
                                          
                                             jt
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          ϖ
                                       
                                       
                                          jt
                                       
                                    
                                 
                              
                           
                         are group-level atoms at 
                           
                              
                                 
                                    ϖ
                                 
                                 
                                    jt
                                 
                              
                              ,
                              {
                              
                                 
                                    π
                                 
                                 
                                    jt
                                 
                              
                              }
                           
                         is a set of stick-breaking weights that satisfy 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    t
                                    =
                                    1
                                 
                                 
                                    ∞
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    jt
                                 
                              
                              =
                              1
                           
                        . Since 
                           
                              
                                 
                                    ϖ
                                 
                                 
                                    jt
                                 
                              
                           
                         is distributed according to the base distribution 
                           
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                           
                        , it takes on the value 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                           
                         with probability 
                           
                              
                                 
                                    ψ
                                 
                                 
                                    k
                                 
                              
                           
                        . This can also be represented using a binary latent variable 
                           
                              
                                 
                                    W
                                 
                                 
                                    jtk
                                 
                              
                           
                         as an indicator variable, such that 
                           
                              
                                 
                                    W
                                 
                                 
                                    jtk
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              ,
                              
                                 
                                    W
                                 
                                 
                                    jtk
                                 
                              
                              =
                              1
                           
                         if 
                           
                              
                                 
                                    ϖ
                                 
                                 
                                    jt
                                 
                              
                           
                         maps to the base-level atom 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                           
                         which is indexed by k; otherwise, 
                           
                              
                                 
                                    W
                                 
                                 
                                    jtk
                                 
                              
                              =
                              0
                           
                        . Then, we can have 
                           
                              
                                 
                                    ϖ
                                 
                                 
                                    jt
                                 
                              
                              =
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                                 
                                    
                                       
                                          W
                                       
                                       
                                          jtk
                                       
                                    
                                 
                              
                           
                        . As a result, group-level atoms 
                           
                              
                                 
                                    ϖ
                                 
                                 
                                    jt
                                 
                              
                           
                         do not need to be explicitly represented which further simplifies the inference process as it shall be clearer later. The indicator variable 
                           
                              
                                 
                                    W
                                 
                                 
                                    →
                                 
                              
                              =
                              (
                              
                                 
                                    W
                                 
                                 
                                    jt
                                    1
                                 
                              
                              ,
                              
                                 
                                    W
                                 
                                 
                                    jt
                                    2
                                 
                              
                              ,
                              …
                              )
                           
                         is distributed according to 
                           
                              
                                 
                                    ψ
                                 
                                 
                                    →
                                 
                              
                           
                         in the form
                           
                              (3)
                              
                                 p
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       →
                                    
                                 
                                 |
                                 
                                    
                                       ψ
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       k
                                    
                                    
                                       
                                          
                                             W
                                          
                                          
                                             jtk
                                          
                                       
                                    
                                 
                              
                           
                        Since 
                           
                              
                                 
                                    ψ
                                 
                                 
                                    →
                                 
                              
                           
                         is a function of 
                           
                              
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                           
                         according to the stick-breaking construction, 
                           
                              p
                              (
                              
                                 
                                    W
                                 
                                 
                                    →
                                 
                              
                              )
                           
                         can then be represented as
                           
                              (4)
                              
                                 p
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       →
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   k
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      ∏
                                                   
                                                   
                                                      s
                                                      =
                                                      1
                                                   
                                                   
                                                      k
                                                      -
                                                      1
                                                   
                                                
                                             
                                             (
                                             1
                                             -
                                             
                                                
                                                   ψ
                                                
                                                
                                                   s
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             W
                                          
                                          
                                             jtk
                                          
                                       
                                    
                                 
                              
                           
                        The prior distribution of 
                           
                              
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                           
                         is a specific Beta distribution according to Eq. (3) as
                           
                              (5)
                              
                                 p
                                 (
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 Beta
                                 (
                                 1
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       -
                                       
                                          
                                             ψ
                                          
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             k
                                          
                                       
                                       -
                                       1
                                    
                                 
                              
                           
                        One of the most significant applications of hierarchical Dirichlet process is as a nonparametric prior over the factors for grouped data. Specifically, let i indexes the observations within each group j, we assume that each variable 
                           
                              
                                 
                                    θ
                                 
                                 
                                    ji
                                 
                              
                           
                         is a factor corresponding to an observation 
                           
                              
                                 
                                    X
                                 
                                 
                                    ji
                                 
                              
                           
                        , and the factors 
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                              =
                              (
                              
                                 
                                    θ
                                 
                                 
                                    j
                                    1
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    j
                                    2
                                 
                              
                              ,
                              …
                              )
                           
                         are distributed according to Dirichlet process 
                           
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                           
                        , one for each j. The likelihood function can then be defined as
                           
                              (6)
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ji
                                    
                                 
                                 |
                                 
                                    
                                       G
                                    
                                    
                                       j
                                    
                                 
                                 ∼
                                 
                                    
                                       G
                                    
                                    
                                       j
                                    
                                 
                                 
                                 
                                    
                                       X
                                    
                                    
                                       ji
                                    
                                 
                                 |
                                 
                                    
                                       θ
                                    
                                    
                                       ji
                                    
                                 
                                 ∼
                                 F
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       ji
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              F
                              (
                              
                                 
                                    θ
                                 
                                 
                                    ji
                                 
                              
                              )
                           
                         represents the distribution of the observation 
                           
                              
                                 
                                    X
                                 
                                 
                                    ji
                                 
                              
                           
                         given 
                           
                              
                                 
                                    θ
                                 
                                 
                                    ji
                                 
                              
                           
                        . Next, we introduce a binary latent variable 
                           
                              
                                 
                                    Z
                                 
                                 
                                    jit
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                           
                         as an indicator variable. That is, 
                           
                              
                                 
                                    Z
                                 
                                 
                                    jit
                                 
                              
                              =
                              1
                           
                         if 
                           
                              
                                 
                                    θ
                                 
                                 
                                    ji
                                 
                              
                           
                         is associated with component t and maps to the group-level atom 
                           
                              
                                 
                                    ϖ
                                 
                                 
                                    jt
                                 
                              
                           
                        ; otherwise, 
                           
                              
                                 
                                    Z
                                 
                                 
                                    jit
                                 
                              
                              =
                              0
                           
                        . Therefore, we have 
                           
                              
                                 
                                    θ
                                 
                                 
                                    ji
                                 
                              
                              =
                              
                                 
                                    ϖ
                                 
                                 
                                    jt
                                 
                                 
                                    
                                       
                                          Z
                                       
                                       
                                          jit
                                       
                                    
                                 
                              
                           
                        . Since 
                           
                              
                                 
                                    ϖ
                                 
                                 
                                    jt
                                 
                              
                           
                         also maps to the global-level atom 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                           
                        , we then have 
                           
                              
                                 
                                    θ
                                 
                                 
                                    ji
                                 
                              
                              =
                              
                                 
                                    ϖ
                                 
                                 
                                    jt
                                 
                                 
                                    
                                       
                                          Z
                                       
                                       
                                          jit
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                                 
                                    
                                       
                                          W
                                       
                                       
                                          jtk
                                       
                                    
                                    
                                       
                                          Z
                                       
                                       
                                          jit
                                       
                                    
                                 
                              
                           
                        . The indicator variable 
                           
                              
                                 
                                    Z
                                 
                                 
                                    →
                                 
                              
                              =
                              (
                              
                                 
                                    Z
                                 
                                 
                                    ji
                                    1
                                 
                              
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    ji
                                    2
                                 
                              
                              ,
                              …
                              )
                           
                         is distributed according to 
                           
                              
                                 
                                    π
                                 
                                 
                                    →
                                 
                              
                           
                         as
                           
                              (7)
                              
                                 p
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       →
                                    
                                 
                                 |
                                 
                                    
                                       π
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       jt
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             jit
                                          
                                       
                                    
                                 
                              
                           
                        According to the stick-breaking construction of the Dirichlet process in Eq. (4), 
                           
                              
                                 
                                    π
                                 
                                 
                                    →
                                 
                              
                           
                         is a function of 
                           
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                           
                        . We then have
                           
                              (8)
                              
                                 p
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       →
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   jt
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      ∏
                                                   
                                                   
                                                      s
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                      -
                                                      1
                                                   
                                                
                                             
                                             (
                                             1
                                             -
                                             
                                                
                                                   π
                                                
                                                
                                                   js
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             jit
                                          
                                       
                                    
                                 
                              
                           
                        The prior distribution of 
                           
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                           
                         is a specific Beta distribution as shown in Eq. (4) as
                           
                              (9)
                              
                                 p
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 Beta
                                 (
                                 1
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       jt
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       jt
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       -
                                       
                                          
                                             π
                                          
                                          
                                             jt
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             jt
                                          
                                       
                                       -
                                       1
                                    
                                 
                              
                           
                        
                     

In this paper, we focus on a specific form of hierarchical Dirichlet process mixture model where each observation within a group is drawn from a mixture of generalized Dirichlet (GD) distributions. Since Dirichlet process mixture models are often considered as infinite mixture models, we refer to the proposed model as the hierarchical infinite GD mixture model. The motivation of focusing on GD mixture is due to its superior performance in modeling high-dimensional proportional data (i.e. normalized histograms) that naturally arise by many applications, such as text, image and video modeling [11,12]. Moreover, the GD distribution has a more general covariance structure than Dirichlet distribution which makes it to be more practical and useful.

Assume that we have a D-dimensional random vector 
                           
                              
                                 
                                    Y
                                 
                                 
                                    →
                                 
                              
                              =
                              (
                              
                                 
                                    Y
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    Y
                                 
                                 
                                    D
                                 
                              
                              )
                           
                         which is drawn from a GD distribution with parameters 
                           
                              
                                 
                                    α
                                 
                                 
                                    →
                                 
                              
                              =
                              (
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    α
                                 
                                 
                                    D
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    β
                                 
                                 
                                    →
                                 
                              
                              =
                              (
                              
                                 
                                    β
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    β
                                 
                                 
                                    D
                                 
                              
                              )
                           
                        
                        
                           
                              (10)
                              
                                 GD
                                 (
                                 
                                    
                                       Y
                                    
                                    
                                       →
                                    
                                 
                                 |
                                 
                                    
                                       α
                                    
                                    
                                       →
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 
                                    
                                       Γ
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             l
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             l
                                          
                                       
                                       )
                                    
                                    
                                       Γ
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             l
                                          
                                       
                                       )
                                       Γ
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             l
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       l
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             l
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      f
                                                      =
                                                      1
                                                   
                                                   
                                                      l
                                                   
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                                
                                                   f
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    l
                                    =
                                    1
                                 
                                 
                                    D
                                 
                              
                              
                                 
                                    Y
                                 
                                 
                                    l
                                 
                              
                              <
                              1
                           
                         and 
                           
                              0
                              <
                              
                                 
                                    Y
                                 
                                 
                                    l
                                 
                              
                              <
                              1
                           
                         for 
                           
                              l
                              =
                              1
                              ,
                              …
                              ,
                              D
                           
                        , 
                           
                              
                                 
                                    α
                                 
                                 
                                    l
                                 
                              
                              >
                              0
                           
                        , 
                           
                              
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                              >
                              0
                           
                        , 
                           
                              
                                 
                                    γ
                                 
                                 
                                    l
                                 
                              
                              =
                              
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                              -
                              
                                 
                                    α
                                 
                                 
                                    l
                                    +
                                    1
                                 
                              
                              -
                              
                                 
                                    β
                                 
                                 
                                    l
                                    +
                                    1
                                 
                              
                           
                         for 
                           
                              l
                              =
                              1
                              ,
                              …
                              ,
                              D
                              -
                              1
                           
                        , 
                           
                              
                                 
                                    γ
                                 
                                 
                                    D
                                 
                              
                              =
                              
                                 
                                    β
                                 
                                 
                                    D
                                 
                              
                              -
                              1
                           
                        , and 
                           
                              Γ
                              (
                              ·
                              )
                           
                         is the gamma function. Based on an interesting mathematical property of the GD distribution which is thoroughly discussed in [8], we can transform the original data point 
                           
                              
                                 
                                    Y
                                 
                                 
                                    →
                                 
                              
                           
                         using a geometric transformation into another D-dimensional data point 
                           
                              
                                 
                                    X
                                 
                                 
                                    →
                                 
                              
                           
                         with independent features in the form of
                           
                              (11)
                              
                                 GD
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       →
                                    
                                 
                                 |
                                 
                                    
                                       α
                                    
                                    
                                       →
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 Beta
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       l
                                    
                                 
                                 |
                                 
                                    
                                       α
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       l
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    X
                                 
                                 
                                    →
                                 
                              
                              =
                              (
                              
                                 
                                    X
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    X
                                 
                                 
                                    D
                                 
                              
                              )
                              ,
                              
                                 
                                    X
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    Y
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    X
                                 
                                 
                                    l
                                 
                              
                              =
                              
                                 
                                    Y
                                 
                                 
                                    l
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                                -
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      f
                                                      =
                                                      1
                                                   
                                                   
                                                      l
                                                      -
                                                      1
                                                   
                                                
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      f
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         for 
                           
                              l
                              >
                              1
                           
                        , and 
                           
                              Beta
                              (
                              
                                 
                                    X
                                 
                                 
                                    l
                                 
                              
                              |
                              
                                 
                                    α
                                 
                                 
                                    l
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                              )
                           
                         is a Beta distribution defined with parameters 
                           
                              {
                              
                                 
                                    α
                                 
                                 
                                    l
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    l
                                 
                              
                              }
                           
                        . As a result, the estimation of a D-dimensional GD distribution is transformed to D estimations of one-dimensional Beta distributions which may facilitate the inference process for multidimensional data [8]. Moreover, this property is important since the independence between the features now becomes a fact rather than an assumption as considered in previous unsupervised feature selection based on Gaussian mixtures.

Now let us consider a data set 
                           
                              X
                           
                         containing N random vectors that are separated into M groups, then each vector 
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ji
                                 
                              
                              =
                              (
                              
                                 
                                    X
                                 
                                 
                                    ji
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    X
                                 
                                 
                                    jiD
                                 
                              
                              )
                           
                         is represented in a D-dimensional space and is drawn from a hierarchical infinite GD mixture model. Then, the corresponding likelihood function of the proposed model with latent variables can be written as
                           
                              (12)
                              
                                 p
                                 (
                                 X
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∏
                                                   
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   
                                                      D
                                                   
                                                
                                             
                                             Beta
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   jil
                                                
                                             
                                             |
                                             
                                                
                                                   α
                                                
                                                
                                                   kl
                                                
                                             
                                             ,
                                             
                                                
                                                   β
                                                
                                                
                                                   kl
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             jit
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             jtk
                                          
                                       
                                    
                                 
                              
                           
                        In practice, not all the features are important, some of them may be irrelevant and may even degrade the clustering performance. Therefore, feature selection technique is important and is adopted here as a tool to choose the “best” feature subset. The most common feature selection technique, in the context of unsupervised learning, defines an irrelevant feature as the one having a distribution independent from class labels [4]. Therefore, in our work the distribution of each feature 
                           
                              
                                 
                                    X
                                 
                                 
                                    l
                                 
                              
                           
                         can be defined by
                           
                              (13)
                              
                                 p
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       jil
                                    
                                 
                                 )
                                 =
                                 Beta
                                 
                                    
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             jil
                                          
                                       
                                       |
                                       
                                          
                                             α
                                          
                                          
                                             kl
                                          
                                       
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             jil
                                          
                                       
                                    
                                 
                                 Beta
                                 
                                    
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             jil
                                          
                                       
                                       |
                                       
                                          
                                             α
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    
                                       1
                                       -
                                       
                                          
                                             ϕ
                                          
                                          
                                             jil
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                           
                         is a binary latent variable that represents the feature relevance indicator, such that 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                              =
                              0
                           
                         means that the feature l of group j is irrelevant (i.e. noise) and follows a Beta distribution: 
                           
                              Beta
                              (
                              
                                 
                                    X
                                 
                                 
                                    jil
                                 
                              
                              |
                              
                                 
                                    α
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                        ; otherwise, the feature 
                           
                              
                                 
                                    X
                                 
                                 
                                    jil
                                 
                              
                           
                         is relevant. The prior distribution of 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    →
                                 
                              
                           
                         is defined as
                           
                              (14)
                              
                                 p
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       →
                                    
                                 
                                 |
                                 
                                    
                                       ∊
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 
                                    
                                       ∊
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             jil
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∊
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       1
                                       -
                                       
                                          
                                             ϕ
                                          
                                          
                                             jil
                                          
                                       
                                    
                                 
                              
                           
                        where each 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                           
                         is a Bernoulli variable such that 
                           
                              p
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                              =
                              1
                              )
                              =
                              
                                 
                                    ∊
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                         and 
                           
                              p
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                              =
                              0
                              )
                              =
                              
                                 
                                    ∊
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        . The vector 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    →
                                 
                              
                              =
                              (
                              
                                 
                                    
                                       
                                          ∊
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          ∊
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    D
                                 
                              
                              )
                           
                         represents the features saliencies (i.e. the probabilities that the features are relevant) such that 
                           
                              
                                 
                                    
                                       
                                          ∊
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    l
                                 
                              
                              =
                              (
                              
                                 
                                    ∊
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    ∊
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    ∊
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              =
                              1
                           
                        . Furthermore, a Dirichlet distribution is chosen over 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    →
                                 
                              
                           
                         as
                           
                              (15)
                              
                                 p
                                 (
                                 
                                    
                                       ∊
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 Dir
                                 (
                                 
                                    
                                       
                                          
                                             ∊
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       l
                                    
                                 
                                 |
                                 
                                    
                                       ξ
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 
                                    
                                       Γ
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             ξ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       Γ
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       Γ
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       ∊
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             1
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       ∊
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             2
                                          
                                       
                                       -
                                       1
                                    
                                 
                              
                           
                        By incorporating this unsupervised feature selection scheme into our hierarchical infinite GD mixture model, we then have the following likelihood function
                           
                              (16)
                              
                                 p
                                 (
                                 X
                                 |
                                 
                                    
                                       Z
                                    
                                    
                                       →
                                    
                                 
                                 ,
                                 
                                    
                                       W
                                    
                                    
                                       →
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       →
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∏
                                                   
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   
                                                      D
                                                   
                                                
                                             
                                             Beta
                                             
                                                
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         jil
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         kl
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         kl
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         jil
                                                      
                                                   
                                                
                                             
                                             Beta
                                             
                                                
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         jil
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         l
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         l
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   1
                                                   -
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         jil
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             jit
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             jtk
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    θ
                                 
                                 
                                    →
                                 
                              
                              =
                              {
                              
                                 
                                    α
                                 
                                 
                                    →
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    →
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              }
                           
                        . In the next step, we need to introduce the prior distributions for parameters 
                           
                              
                                 
                                    α
                                 
                                 
                                    →
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    →
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                           
                        , of Beta distributions. Although Beta distribution belongs to the exponential family and has a formal conjugate prior, it is analytically intractable. Thus, Gamma distribution is adopted to approximate the conjugate prior by assuming that these Beta parameters are statistically independent as
                           
                              (17)
                              
                                 p
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 G
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       →
                                    
                                 
                                 |
                                 
                                    
                                       u
                                    
                                    
                                       →
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             kl
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   kl
                                                
                                             
                                          
                                       
                                    
                                    
                                       Γ
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       kl
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             kl
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       
                                          
                                             v
                                          
                                          
                                             kl
                                          
                                       
                                       
                                          
                                             α
                                          
                                          
                                             kl
                                          
                                       
                                    
                                 
                                 
                                 p
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 G
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       →
                                    
                                 
                                 |
                                 
                                    
                                       g
                                    
                                    
                                       →
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             kl
                                          
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   kl
                                                
                                             
                                          
                                       
                                    
                                    
                                       Γ
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       
                                          
                                             g
                                          
                                          
                                             kl
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       
                                          
                                             h
                                          
                                          
                                             kl
                                          
                                       
                                       
                                          
                                             β
                                          
                                          
                                             kl
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 p
                                 (
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 G
                                 (
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             
                                                
                                                   u
                                                
                                                
                                                   l
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    
                                       Γ
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       l
                                    
                                    
                                       ′
                                       
                                          
                                             u
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       
                                          
                                             v
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             α
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                 p
                                 (
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 G
                                 (
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             
                                                
                                                   g
                                                
                                                
                                                   l
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    
                                       Γ
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       l
                                    
                                    
                                       ′
                                       
                                          
                                             g
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       
                                          
                                             h
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             β
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Variational inference [17] is a deterministic approximation technique that is used to find tractable approximations for posterior distributions of a variety of statistical models. In this section, we first propose a Batch variational inference method for learning the proposed model. Then, we introduce an online learning extension which is useful in applications involving large-scale or streaming data. In order to simplify notations, we define 
                        
                           Θ
                           =
                           (
                           Ξ
                           ,
                           Λ
                           )
                        
                      as the set of latent and unknown random variables, where 
                        
                           Ξ
                           =
                           {
                           
                              
                                 Z
                              
                              
                                 →
                              
                           
                           ,
                           
                              
                                 ϕ
                              
                              
                                 →
                              
                           
                           }
                        
                      and 
                        
                           Λ
                           =
                           {
                           
                              
                                 W
                              
                              
                                 →
                              
                           
                           ,
                           
                              
                                 ∊
                              
                              
                                 →
                              
                           
                           ,
                           
                              
                                 ψ
                              
                              
                                 →
                              
                           
                           ,
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       →
                                    
                                 
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 →
                              
                           
                           ,
                           
                              
                                 β
                              
                              
                                 →
                              
                           
                           ,
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       →
                                    
                                 
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 
                                    
                                       β
                                    
                                    
                                       →
                                    
                                 
                              
                              
                                 ′
                              
                           
                           }
                        
                     .

In variational inference, the goal is to find an approximation 
                           
                              Q
                              (
                              Θ
                              )
                           
                         to the true posterior distribution 
                           
                              p
                              (
                              Θ
                              |
                              X
                              )
                           
                         by maximizing the lower bound of 
                           
                              ln
                              p
                              (
                              X
                              )
                           
                         which is defined by
                           
                              (19)
                              
                                 L
                                 (
                                 Q
                                 )
                                 =
                                 ∫
                                 Q
                                 (
                                 Θ
                                 )
                                 ln
                                 [
                                 p
                                 (
                                 X
                                 ,
                                 Θ
                                 )
                                 /
                                 Q
                                 (
                                 Θ
                                 )
                                 ]
                                 d
                                 Θ
                              
                           
                        In this work, we adopt factorial approximation which is commonly used in variational inference [17] to factorize 
                           
                              Q
                              (
                              Θ
                              )
                           
                         into disjoint tractable distributions. Moreover, we apply a truncation technique as in [18] to truncate the variational approximations of global- and group-level Dirichlet process at K and T, such that
                           
                              (20)
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       K
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 0
                                 
                                 when
                                 
                                 k
                                 >
                                 K
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       π
                                    
                                    
                                       jT
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       jt
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 
                                    
                                       π
                                    
                                    
                                       jt
                                    
                                 
                                 =
                                 0
                                 
                                 when
                                 
                                 t
                                 >
                                 T
                              
                           
                        The truncation levels K and T are variational parameters which can be freely initialized and will be optimized automatically during the learning process. By using the truncated stick-breaking representations and the factorization assumption, the approximated posterior distribution 
                           
                              q
                              (
                              Θ
                              )
                           
                         can be fully factorized into disjoint distributions as
                           
                              (22)
                              
                                 q
                                 (
                                 Θ
                                 )
                                 =
                                 q
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 q
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 q
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 q
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 q
                                 (
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 q
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 q
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 q
                                 (
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 q
                                 (
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 q
                                 (
                                 
                                    
                                       ∊
                                    
                                    
                                       →
                                    
                                 
                                 )
                              
                           
                        In our work, variational inference is performed based on a natural gradient method as introduced in [19] which is motivated by the readily extension of this gradient-based approach to online learning. The main idea is that, since our model has conjugate priors, the functional form of each factor in the variational posterior distribution is known. Therefore, the lower bound 
                           
                              L
                              (
                              q
                              )
                           
                         can be considered as a function of the parameters of these distributions by taking general parametric forms of these distributions. The optimization of variational factors is then obtained by maximizing the lower bound with respect to these parameters. In our case, the functional form of each variational factor is the same as its conjugate prior distribution, namely Discrete for 
                           
                              
                                 
                                    Z
                                 
                                 
                                    →
                                 
                              
                           
                         and 
                           
                              
                                 
                                    W
                                 
                                 
                                    →
                                 
                              
                           
                        , Bernoulli for 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    →
                                 
                              
                           
                        , Dirichlet for 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    →
                                 
                              
                           
                        , Beta for 
                           
                              
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                           
                        , and Gamma for 
                           
                              
                                 
                                    α
                                 
                                 
                                    →
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    →
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                           
                        : 
                           
                              (23)
                              
                                 q
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       jit
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             jit
                                          
                                       
                                    
                                 
                                 
                                 q
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       ϑ
                                    
                                    
                                       jtk
                                    
                                    
                                       
                                          
                                             W
                                          
                                          
                                             jtk
                                          
                                       
                                    
                                 
                                 
                                 q
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       jil
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             jil
                                          
                                       
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       -
                                       
                                          
                                             φ
                                          
                                          
                                             jil
                                          
                                       
                                       )
                                    
                                    
                                       1
                                       -
                                       
                                          
                                             ϕ
                                          
                                          
                                             jil
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 q
                                 (
                                 
                                    
                                       ∊
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 Dir
                                 (
                                 
                                    
                                       
                                          
                                             ∊
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       l
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                                 
                                 q
                                 (
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 Beta
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       jt
                                    
                                    
                                       ′
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       jt
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       jt
                                    
                                 
                                 )
                                 
                                 q
                                 (
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 Beta
                                 (
                                 
                                    
                                       ψ
                                    
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (25)
                              
                                 q
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 G
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       kl
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       kl
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       kl
                                    
                                 
                                 )
                                 
                                 q
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 G
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       kl
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       kl
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       kl
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (26)
                              
                                 q
                                 (
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 G
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       l
                                    
                                    
                                       ′
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       l
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       l
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                 q
                                 (
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 G
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       l
                                    
                                    
                                       ′
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       l
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       l
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                           
                        Consequently, the parameterized lower bound 
                           
                              L
                              (
                              q
                              )
                           
                         can be obtained by substituting Eqs. (23)–(26) into Eq. (19). Maximizing this bound with respect to these parameters then gives the required re-estimation equations developed in Appendix A. The batch variational inference for our model can be considered as an EM-like algorithm and is summarized in Algorithm 1. The convergence of this batch learning algorithm is guaranteed and can be monitored through inspection of the variational lower bound.
                           Algorithm 1
                           Batch variational learning of the model. 
                                 
                                    
                                       
                                       
                                          
                                             1: Choose the initial truncation levels K and T.
                                          
                                          
                                             2: Initialize the values for hyperparameters 
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            jt
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            γ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            kl
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            kl
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            kl
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            kl
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            l
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            l
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            l
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            l
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             3: Initialize the value of 
                                                   
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            jit
                                                         
                                                      
                                                   
                                                 by K-Means algorithm.
                                          
                                          
                                             4: repeat
                                             
                                          
                                          
                                             5: 
                                                The variational E-step:
                                          
                                          
                                             6: Estimate the expected values in Eqs. (52)–(58), use the current distributions over the model parameters.
                                          
                                          
                                             7: 
                                                The variational M-step:
                                          
                                          
                                             8: Update the variational solutions for each factor using Eqs. (23)–(26) and the current values of the moments.
                                          
                                          
                                             9: until Convergence criterion is reached.
                                          
                                       
                                    
                                 
                              
                           

In this section, an online variational inference approach is developed, using the framework presented in [19], to learn our model. In contrast with batch learning algorithms, online algorithms are more efficient when dealing with large-scale or streaming data. In our case, let r denotes the amount of observed data that we currently have. Then, the current lower bound for the observed data can be calculated by
                           
                              (27)
                              
                                 
                                    
                                       L
                                    
                                    
                                       (
                                       r
                                       )
                                    
                                 
                                 (
                                 q
                                 )
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          r
                                       
                                    
                                 
                                 ∫
                                 q
                                 (
                                 Λ
                                 )
                                 d
                                 Λ
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      →
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 Q
                                 (
                                 
                                    
                                       
                                          
                                             Ξ
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ln
                                 
                                    
                                       
                                          
                                             
                                                p
                                                (
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            Ξ
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                |
                                                Λ
                                                )
                                             
                                             
                                                q
                                                (
                                                
                                                   
                                                      
                                                         
                                                            Ξ
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 +
                                 ∫
                                 q
                                 (
                                 Λ
                                 )
                                 ln
                                 
                                    
                                       
                                          
                                             
                                                p
                                                (
                                                Λ
                                                )
                                             
                                             
                                                q
                                                (
                                                Λ
                                                )
                                             
                                          
                                       
                                    
                                 
                                 d
                                 Λ
                              
                           
                        where 
                           
                              Ξ
                              =
                              {
                              
                                 
                                    Z
                                 
                                 
                                    →
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    →
                                 
                              
                              }
                           
                         and 
                           
                              Λ
                              =
                              {
                              
                                 
                                    W
                                 
                                 
                                    →
                                 
                              
                              ,
                              
                                 
                                    ∊
                                 
                                 
                                    →
                                 
                              
                              ,
                              
                                 
                                    ψ
                                 
                                 
                                    →
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    α
                                 
                                 
                                    →
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    →
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              }
                           
                        . The main idea of the online variational learning algorithm is to successively maximize the current variational lower bound as in Eq. (27) with respect to each variational factor. Assume that we have already observed a data set 
                           
                              {
                              
                                 
                                    X
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              
                                 
                                    X
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              }
                           
                        . Then, after obtaining a new observation 
                           
                              
                                 
                                    X
                                 
                                 
                                    r
                                 
                              
                           
                        , we can maximize the current lower bound 
                           
                              
                                 
                                    L
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              (
                              q
                              )
                           
                         with respect to 
                           
                              q
                              (
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    r
                                 
                              
                              )
                           
                         while other variational factors remain fixed to their 
                           
                              (
                              r
                              -
                              1
                              )
                           
                        th values. Thus, the variational solution to 
                           
                              q
                              (
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    r
                                 
                              
                              )
                           
                         can be updated as
                           
                              (28)
                              
                                 q
                                 (
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       r
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       jrl
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             jrl
                                          
                                       
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       -
                                       
                                          
                                             φ
                                          
                                          
                                             jrl
                                          
                                       
                                       )
                                    
                                    
                                       1
                                       -
                                       
                                          
                                             ϕ
                                          
                                          
                                             jrl
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (29)
                              
                                 
                                    
                                       φ
                                    
                                    
                                       jrl
                                    
                                 
                                 =
                                 
                                    
                                       exp
                                       (
                                       
                                          
                                             
                                                
                                                   φ
                                                
                                                
                                                   ∼
                                                
                                             
                                          
                                          
                                             jrl
                                          
                                       
                                       )
                                    
                                    
                                       exp
                                       (
                                       
                                          
                                             
                                                
                                                   φ
                                                
                                                
                                                   ∼
                                                
                                             
                                          
                                          
                                             jrl
                                          
                                       
                                       )
                                       +
                                       exp
                                       (
                                       
                                          
                                             
                                                
                                                   φ
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             jrl
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (30)
                              
                                 
                                    
                                       
                                          
                                             φ
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       jrl
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 〈
                                 
                                    
                                       Z
                                    
                                    
                                       j
                                       (
                                       r
                                       -
                                       1
                                       )
                                       t
                                    
                                 
                                 〉
                                 〈
                                 
                                    
                                       W
                                    
                                    
                                       jtk
                                    
                                    
                                       (
                                       r
                                       -
                                       1
                                       )
                                    
                                 
                                 〉
                                 [
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       (
                                       r
                                       -
                                       1
                                       )
                                    
                                 
                                 +
                                 (
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       (
                                       r
                                       -
                                       1
                                       )
                                    
                                 
                                 -
                                 1
                                 )
                                 ln
                                 
                                    
                                       X
                                    
                                    
                                       jrl
                                    
                                 
                                 +
                                 (
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       (
                                       r
                                       -
                                       1
                                       )
                                    
                                 
                                 -
                                 1
                                 )
                                 ln
                                 (
                                 1
                                 -
                                 
                                    
                                       X
                                    
                                    
                                       jrl
                                    
                                 
                                 )
                                 ]
                                 +
                                 〈
                                 ln
                                 
                                    
                                       ∊
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       (
                                       r
                                       -
                                       1
                                       )
                                    
                                 
                                 〉
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    
                                       
                                          
                                             φ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       jrl
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       l
                                    
                                    
                                       ′
                                       (
                                       r
                                       -
                                       1
                                       )
                                    
                                 
                                 +
                                 〈
                                 ln
                                 
                                    
                                       ∊
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       (
                                       r
                                       -
                                       1
                                       )
                                    
                                 
                                 〉
                                 +
                                 (
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       l
                                    
                                    
                                       ′
                                       (
                                       r
                                       -
                                       1
                                       )
                                    
                                 
                                 -
                                 1
                                 )
                                 ln
                                 (
                                 1
                                 -
                                 
                                    
                                       X
                                    
                                    
                                       jrl
                                    
                                 
                                 )
                                 +
                                 (
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       l
                                    
                                    
                                       ′
                                       (
                                       r
                                       -
                                       1
                                       )
                                    
                                 
                                 -
                                 1
                                 )
                                 ln
                                 
                                    
                                       X
                                    
                                    
                                       jrl
                                    
                                 
                              
                           
                        The updating of the variational solutions with respect to the other factors is detailed in Appendix B.

Since the hyperparameters of 
                           
                              
                                 
                                    q
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              )
                              ,
                              
                                 
                                    q
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              )
                              ,
                              
                                 
                                    q
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              (
                              
                                 
                                    α
                                 
                                 
                                    →
                                 
                              
                              )
                           
                         
                        
                           
                              
                                 
                                    q
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              (
                              
                                 
                                    β
                                 
                                 
                                    →
                                 
                              
                              )
                              ,
                              
                                 
                                    q
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         are independent from each other, they can be updated in parallel. This online variational inference procedure is repeated until all the variational factors are updated with respect to the current arrived observation. According to [19], the online variational algorithm can be defined as a stochastic approximation method [20] for estimating the expected lower bound and the convergence is guaranteed if the learning rate satisfies the following conditions:
                           
                              (32)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       ζ
                                    
                                    
                                       r
                                    
                                 
                                 =
                                 ∞
                                 ,
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          =
                                          1
                                       
                                       
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       ζ
                                    
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 <
                                 ∞
                              
                           
                        The proposed online learning algorithm is much more computationally efficient than its batch counterpart. This is due to the fact that the batch algorithm updates the variational factors by using the whole data set in each iteration, and thus its estimation quality is improved much more slowly than in the case of the online one. The online variational inference for hierarchical infinite GD mixture model with feature selection is summarized in Algorithm 2.
                           Algorithm 2
                           Online variational learning of the model. 
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                1: Choose the initial truncation levels K and T.
                                          
                                          
                                             
                                                
                                                2: Initialize the values for hyperparameters 
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            jt
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            γ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            kl
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            kl
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            kl
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            kl
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            l
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            l
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            l
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            l
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             
                                                
                                                3: for 
                                                
                                                   
                                                      r
                                                      =
                                                      1
                                                      →
                                                      N
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                
                                                4: 
                                                The variational E-step:
                                             
                                          
                                          
                                             
                                                
                                                5: Update the variational solutions to 
                                                   
                                                      q
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  ϕ
                                                               
                                                               
                                                                  →
                                                               
                                                            
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      )
                                                   
                                                 and 
                                                   
                                                      q
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  Z
                                                               
                                                               
                                                                  →
                                                               
                                                            
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      )
                                                   
                                                , sequentially using Eqs. (28) and (59).
                                          
                                          
                                             
                                                
                                                6: 
                                                The variational M-step:
                                             
                                          
                                          
                                             
                                                
                                                7: Compute learning rate 
                                                   
                                                      
                                                         
                                                            ζ
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  η
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            +
                                                            r
                                                            )
                                                         
                                                         
                                                            -
                                                            ς
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             
                                                
                                                8: Calculate natural gradients 
                                                   
                                                      Δ
                                                      
                                                         
                                                            ϑ
                                                         
                                                         
                                                            jtk
                                                         
                                                         
                                                            (
                                                            r
                                                            )
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      Δ
                                                      
                                                         
                                                            
                                                               
                                                                  ξ
                                                               
                                                               
                                                                  →
                                                               
                                                            
                                                         
                                                         
                                                            ∗
                                                            (
                                                            r
                                                            )
                                                         
                                                      
                                                   
                                                 using Eqs. (64) and (65).
                                          
                                          
                                             
                                                
                                                9: Update variational factors 
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            (
                                                            r
                                                            )
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                      )
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            (
                                                            r
                                                            )
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            ∊
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                      )
                                                   
                                                 as shown in Eqs. (62) and (63).
                                          
                                          
                                             10: Calculate the natural gradients of the remaining hyperparameters using Eqs. (79)–(88).
                                          
                                          
                                             11:Update variational factors 
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            (
                                                            r
                                                            )
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  π
                                                               
                                                               
                                                                  →
                                                               
                                                            
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                      ,
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            (
                                                            r
                                                            )
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  ψ
                                                               
                                                               
                                                                  →
                                                               
                                                            
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                      ,
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            (
                                                            r
                                                            )
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                      )
                                                      ,
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            (
                                                            r
                                                            )
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                      )
                                                      ,
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            (
                                                            r
                                                            )
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  →
                                                               
                                                            
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            (
                                                            r
                                                            )
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  →
                                                               
                                                            
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                 through Eqs. (70)–(72).
                                          
                                          
                                             12:Repeat the variational E-step and M-step until new data is observed.
                                          
                                          
                                             13: end for
                                             
                                          
                                       
                                    
                                 
                              
                           

@&#EXPERIMENTAL RESULTS@&#

We evaluate the effectiveness of the proposed online hierarchical infinite GD mixture model with feature selection (referred to as Method 1) through four challenging real-world applications namely face detection, facial expression recognition, human gesture recognition, and off-line writer identification. In our experiments, for the first three applications, we adopt the bag-of-visual words representation since it has demonstrated its effectiveness and efficiency in various applications of computer vision, such as image categorization [21,22]. Its main idea is to represent a given object by a set of local descriptors (e.g. SIFT [23]) representing local interest points or patches. These local descriptors are then quantized into a visual vocabulary which allows the representation of a given object as a histogram of visual words. Rather than choosing the number of visual words manually in most of the bag-of-visual words applications, the size of visual vocabulary can be inferred automatically by our hierarchical Dirichlet process mixture model. We demonstrate the advantages of the proposed approach by comparing its performance with three other mixture models including the batch hierarchical infinite GD mixture model with feature selection (Method 2), the online hierarchical infinite GD mixture model without feature selection (Method 3) and the online hierarchical infinite Gaussian mixture model [13] to which a feature selection step is added (Method 4). To make a fair comparison, all of these models are learned using variational inference. In our experiments, the testing data is supposed to arrive sequentially in an online manner except for Method 2. In all experiments, we empirically choose the initialization values as the following: the global truncation level K and the group truncation level T are respectively initialized to 800 and 100; the parameters ς and 
                        
                           
                              
                                 η
                              
                              
                                 0
                              
                           
                        
                      of the learning rate are set to 0.65 and 64, respectively; other involved hyperparameters in our model are initialized as 
                        
                           (
                           
                              
                                 λ
                              
                              
                                 jt
                              
                           
                           ,
                           
                              
                                 γ
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 kl
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 kl
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 kl
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 kl
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 l
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 l
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 l
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 l
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 2
                              
                           
                           )
                           =
                           (
                           0.07
                           ,
                           0.07
                           ,
                           0.1
                           ,
                           0.05
                           ,
                           0.1
                           ,
                           0.05
                           ,
                           0.1
                           ,
                           0.05
                           ,
                           0.1
                           ,
                           0.05
                           ,
                           0.5
                           ,
                           0.5
                           )
                        
                     .

Modeling the appearance of humans has been the topic of extensive research in the past. Face recognition, in particular, has been widely studied. The problem is very complex taking into account varying illumination conditions [24]. The topic has received renewed attention from computer vision researchers. This interest is motivated by a wide spectrum of applications (e.g. video surveillance, content-based image retrieval) and a variety of new developed robust local descriptors. The capability to detect and recognize faces using computers is crucial in security-sensitive areas such as borders and airports, and is of great interest to the police, law enforcement agencies, and military [25]. Machine learning techniques have been widely used to tackle this problem. Several works have shown that the design of an effective recognition framework requires taking into account the interplay between feature selection, feature representation, and classification. And a main issue is choosing a good representation within our computing as well as modeling constraints. Among several representational choices, local image representations have been widely used successfully in the past few years to detect a variety of objects in general and faces in particular. The goal of face detection is to distinguish the images that contain human faces from non-face ones. In this experiment, we perform face detection using the proposed approach with the bag-of-visual words representation.

@&#METHODOLOGY@&#

Our methodology for detecting face images is summarized as the following: First, the 128-dimensional scale-invariant feature transform (SIFT) [23] descriptors are computed from each image using the Difference-of-Gaussians (DoG) interest point detectors and then normalized. Then, these obtained SIFT features are modeled using our proposed approach. More specifically, each image 
                              
                                 
                                    
                                       I
                                    
                                    
                                       j
                                    
                                 
                              
                            is considered as a “group” and is therefore associated with a Dirichlet process mixture (infinite mixture) model 
                              
                                 
                                    
                                       G
                                    
                                    
                                       j
                                    
                                 
                              
                           . Therefore, each extracted SIFT feature vector 
                              
                                 
                                    
                                       X
                                    
                                    
                                       ji
                                    
                                 
                              
                            of the face image 
                              
                                 
                                    
                                       I
                                    
                                    
                                       j
                                    
                                 
                              
                            is supposed to be drawn from 
                              
                                 
                                    
                                       G
                                    
                                    
                                       j
                                    
                                 
                              
                           , where the mixture components of 
                              
                                 
                                    
                                       G
                                    
                                    
                                       j
                                    
                                 
                              
                            can be considered as “visual words”. A global vocabulary is constructed and is shared among all groups (images) through the common global infinite mixture model 
                              
                                 
                                    
                                       G
                                    
                                    
                                       0
                                    
                                 
                              
                            of our hierarchical model. This setting matches the desired design of a hierarchical Dirichlet process mixture model. It is noteworthy that an important step in applications with bag-of-visual words representation is the construction of visual vocabulary. Nevertheless, most of the previously proposed approaches have to apply a separate vector quantization algorithm to build the visual vocabulary, where the size of vocabulary is normally manually selected. In our approach, the construction of the visual vocabulary is part of the framework of our hierarchical Dirichlet process mixture model, and therefore the size of the vocabulary (i.e., the number of mixture components in the global-level mixture) can be automatically inferred from the data thanks to the property of nonparametric Bayesian model. Since the goal of our experiment is to determine which image category (face or non-face) that a testing image 
                              
                                 
                                    
                                       I
                                    
                                    
                                       j
                                    
                                 
                              
                            belongs to, we also need to introduce an indicator variable 
                              
                                 
                                    
                                       B
                                    
                                    
                                       jm
                                    
                                 
                              
                            associated with each image (or group) in our hierarchical Dirichlet process mixture framework. 
                              
                                 
                                    
                                       B
                                    
                                    
                                       jm
                                    
                                 
                              
                            denotes image 
                              
                                 
                                    
                                       I
                                    
                                    
                                       j
                                    
                                 
                              
                            is from category m and is drawn from another infinite mixture model which is truncated at level J. This means that we need to add a new level of hierarchy to our hierarchical infinite mixture model with a sharing vocabulary among all image categories. In this experiment, we truncate J to 60 and initialize the hyperparameter of the mixing probability of 
                              
                                 
                                    
                                       B
                                    
                                    
                                       jm
                                    
                                 
                              
                            to 0.05. Finally, we assign a testing image to the category (face or non-face) which has the highest posterior probability according to Bayes’ decision rule.

We adopted three publicly available databases to test the effectiveness of our approach on face detection: (1) Caltech face database
                           
                              1
                              
                                 http://www.vision.caltech.edu/html-files/archive.html.
                           
                           
                              1
                           : the Caltech face database contains 450 front human face images which are recorded under various conditions (i.e. varying illumination, expressions and complex background). (2) Extended Yale B database 
                           [26]
                           
                              2
                              
                                 http://vision.ucsd.edu/∼leekc/ExtYaleDatabase/ExtYaleB.html.
                           
                           
                              2
                           : The extended Yale B face database contains 16,128 images of 28 human subjects under 9 poses and 64 illumination conditions. In our case we used a subset of this database which includes 700 frontal face images from 7 subjects under varying poses and illumination conditions. (3) Georgia Tech face database 
                           [27]
                           
                              3
                              
                                 http://www.anefian.com/research/face_reco.htm.
                           
                           
                              3
                           : The Georgia Tech face database consists of 50 subjects with 15 face images available for each subject. Face images in this database include different facial expressions, lighting conditions and scales, while each image has a size of 
                              
                                 640
                                 ×
                                 480
                              
                           
                           pixels. For non-face images, we adopted the Caltech background database.
                              4
                              
                                 http://www.vision.caltech.edu/html-files/archive.html.
                           
                           
                              4
                            It includes 550 background images with the size of 
                              
                                 896
                                 ×
                                 592
                              
                           
                           pixels. Sample images from the above databases are shown in Fig. 1
                           . We randomly divided each database (face and non-face) into two halves: one for training and the other for testing.

@&#RESULTS@&#

We evaluated the performance of our approach for face detection by running it 30 times. The average results of our approach and the three other tested approaches are shown in Table 1
                           . According to this table, the batch approach (Method 2) can obtain the highest detection rate. Nevertheless, its online version (Method 1) was able to provide comparable performances with Method 2 for all tested databases, and their difference in detection rates is not statistically significant based on Student’s t-test (i.e., for different runs, we have obtained p-values between 0.1215 and 0.2453 for Caltech database, p-values between 0.1304 and 0.2371 for extended Yale B database, and p-values between 0.1361 and 0.2508 for Georgia Tech database). By contrast, Method 1 was significantly faster than Method 2 because of its online learning property. This can be explained by the fact that the batch algorithm updates the variational factors by using the whole data set in each iteration, and thus its estimation quality is improved more slowly than in the case of the online one. We may also notice in Table 1 that, Method 1 outperformed Method 3 and Method 4 for all databases. This phenomenon demonstrates the advantage of incorporating a feature selection scheme into our framework and also verifies that the GD mixture model has a better modeling capability for proportional data than Gaussian mixture model. Based on our results, different features were assigned different relevance degrees. As shown in Fig. 2
                           , in the case of the Caltech database, Method 1 obtained 18 features with high relevance degrees where the feature saliencies were greater than 0.9. By contrast, there were 12 features calculated by Method 1 that have feature saliencies lower than 0.5, and therefore provided less contribution to the detection process.

Facial expression recognition is a challenging task in computer vision and has been applied in many applications such as psychological studies, image understanding, video surveillance and security in general. It is defined as a type of visual learning process which deals with the recognition of a set of prototypic emotional expressions including anger, disgust, fear, joy, surprise and sadness [28]. The use of clustering methods has rapidly become a crucial computational approach to facial expression recognition problem. In this experiment, we investigate the problem of facial expression recognition using the proposed approach.

For this application, we adopted a similar methodology with the bag-of-visual words representation as for the face detection in the previous subsection. In order to reduce the influences of background, we applied a preprocessing step to normalize and crop original images into 110×150pixels and the cropped images remain the central part of human faces. We conducted our experiment on two challenging and publicly available databases: the Cohn–Kanade database [29]
                           
                              5
                              
                                 http://www.pitt.edu/∼jeffcohn/CKandCK+.htm.
                           
                           
                              5
                            and the Dollar facial expression database [30].
                              6
                              
                                 http://vision.ucsd.edu/∼pdollar/.
                           
                           
                              6
                            The Cohn–Kanade database is one of the most comprehensive databases widely used by the facial expression research community. It contains 486 image sequences from 97 subjects. In our case, we selected 300 image sequences from 94 subjects, with 16 basic emotions per subject in this database. The selected sequences are those that could be labeled as one of the six basic emotions, i.e. Angry, Disgust, Fear, Joy, Sadness, and Surprise. The neutral face and three peak frames of each sequence were used for facial expression recognition, resulting in 1200 images (90 Anger, 111 Disgust, 90 Fear, 270 Joy, 120 Sadness, 219 Surprise and 300 Neutral). Sample images from this database with different facial expressions can be viewed in Fig. 3
                           . The Dollar facial expression database is composed of 192 sequences performed by 2 individuals, each expressing 6 different basic emotions 8 times under 2 lighting setups. Each subject starts with a neutral expression, then expresses an emotion, and returns to neutral expression. In this experiment, three peak frames of each sequence (576 images in total) were used for 6-class expression recognition, i.e. Angry, Disgust, Fear, Joy, Sadness, and Surprise. Fig. 4
                            demonstrates sample images from the Dollar facial expression database.

@&#RESULTS@&#

We randomly divided each of the two databases into two partitions: one for training, another for testing. We evaluated the performance of the proposed approach by running it 30 times. The performance of our approach for recognizing facial expressions was measured using both confusion matrices and rates of overall recognition accuracy. Figs. 5 and 6
                           
                            present the confusion matrices calculated by Method 1 for each database. Each entry (
                              
                                 i
                                 ,
                                 j
                              
                           ) of the confusion matrix denotes the number of face frames in class i that are assigned into class j. As shown in these two figures, we observed that the overall average recognition accuracies were 84.33% (error rate of 15.67%) for the Dollar database and 82.43% (error rate of 17.57%) for the Cohn–Kanade database using the proposed approach. Table 2
                            illustrates the average recognition accuracy rates obtained by each tested approach over 30 runs. According to the results shown in this table, Method 1 and Method 2 have outperformed other tested approaches for recognizing facial expressions. Moreover, Method 1 was able to obtain comparable performances with Method 2 but with significantly improved computational efficiency for both databases. These results have demonstrated the advantages of using the proposed approach.

Human gestures (or actions) are the natural way for expressing intentions in people’s daily lives. Human gesture recognition in videos is an important topic in computer vision and pattern recognition with a number of potential applications (e.g. human–computer interactive systems, video-surveillance, security purposes, etc.). It has drawn increasingly attention and many approaches has been proposed in recent years [31]. Nevertheless, human gesture recognition remains a challenging research direction mainly due to the complexity of human movements which may be unpredictable and ambiguous. In this experiment, we focus on two specific types of gesture recognition including hand and body gesture recognition. A similar methodology was adopted in this application as for the two previous applications. The major difference is that in this case, instead of using DoG interest point detector to extract SIFT features, we applied the non-negative matrix factorisation (NNMF) interest point detector [32] to extract and select interest points in spatiotemporal domain from each video. Compared with other popular spatiotemporal interest point detectors which use local information only, the NNMF detector exploits global information from each video input and has demonstrated better results in motion recognition according to [32]. Therefore in this application, our first step was to detect spatiotemporal interest points and their locations from each video (or image sequence) using the NNMF interest point detector. The obtained interest points were encoded as spatiotemporal gradient features and were then modeled by the proposed approach.

For hand gesture recognition, we adopted a publicly available database namely the Cambridge-Gesture database
                              7
                              
                                 http://www.iis.ee.ic.ac.uk/icvl/ges_db.htm.
                           
                           
                              7
                            
                           [33]. It contains 900 image sequences of 9 hand gesture classes, which are defined by 3 primitive hand shapes (“Flat”, “Spread” and “V-shape”) and 3 primitive motions (Leftward, rightward and contract). Each class includes 100 image sequences with the size of 320×240pixels. In this case, half of the data was randomly chosen for training and the other half was used for testing. Sample hand gesture frames from this database can be viewed in Fig. 7
                           . Fig. 8
                            demonstrates the confusion matrix for the Cambridge-Gesture database calculated by the proposed approach. Table 3
                            illustrates the average recognition accuracy rates obtained by each tested approach. From this table, Method 1 is competitive to Method 2 and outperformed both Method 3 and Method 4.

We conducted body gesture recognition using the UMD Keck body-gesture database
                              8
                              
                                 http://www.umiacs.umd.edu/∼zhuolin/Keckgesturedataset.html.
                           
                           
                              8
                            
                           [34]. It consists of 14 different body gesture classes with 640×480 resolution, which are a subset of military signals. There are 126 video sequences collected using a fixed camera with the person viewed against a static background and 168 videos captured from the dynamic environment where the camera and subjects are moving during the performance of the gesture. We adopted the same experimental setting as in [34]. Specifically, we evaluated the performance for recognizing body gestures against static and dynamic background, respectively. For the static background gesture recognition, we performed gesture recognition using a leave-one-subject-out methodology on the 126 videos with static background. For the dynamic background gesture recognition, the 126 videos captured from the static scenario are used for training while the 168 videos collected from the dynamic environment are the testing videos. Examples of body gestures from the UMD Keck body-gesture database are shown in Fig. 9
                           . The average body gesture recognition results for both static and dynamic backgrounds are shown in Table 4
                            by running each approach 30 times. Once again, we may notice the merits of Method 1 in terms of comparable performance with Method 2 and better performance than both Method 3 and Method 4.

Textual documents represent a crucial source of evidence during forensics analysis [35]. They generally represent a rich source of information that should be taken into account. An important task when dealing with such documents is authorship identification. Machine learning and data mining techniques have been widely used in this case [36]. The main goal of authorship identification is the determination of the author of a sample handwriting from a set of authors. In this section, we apply our model to the task of off-line writer identification. Indeed, we use a hierarchical Dirichlet process of generalized Dirichlet distributions to model a person’s handwriting described via some feature vectors. Following [36] we consider the following pre-processing steps. The first step is to apply a series of normalization operations to each text line. Second, contrast is enhanced. Then, we scale the writing vertically using the approach in [37]. Generally writers use different pens that may have different widths. In order to eliminate variation that may be caused by pen width, text lines should be thinned using the MB2 thinning algorithm [38] which results in text lines that are at most two pixels wide.

For the extraction of features that will represent a given person’s handwriting, we consider a sliding window of 14 pixels that moves from left to right one pixel per step. Following [36], nine geometrical features are extracted for every column of pixels in the sliding window. These features are [39]: number of black pixels in the window, center of gravity, second order moment, position and contour direction of the upper and lower-most pixel, number of black-to-white transitions in the window, and fraction of pixels between the upper and lower-most pixel. Finally, the feature vector is obtained by averaging the feature vectors of every column in the sliding window. It is noteworthy that at this final step, the feature vectors which do not contain upper or lower-most black pixels are deleted.

For our simulations, we have used the handwritten text dataset from the IAM database [40] which is composed of over 1500 pages, containing between five and eleven text lines, of handwritten text from over 650 authors. Indeed, we have taken from this data set 4500 text lines from 120 writers and for each one we have used half of text lines for training and the other half for testing. The identification rates using Method 1, Method 2, Method 3 and Method 4 approaches were 93.27%, 93.02%, 92.12%, and 88.57%, respectively. These results show again the good performance of our model and the importance of feature selection in the identification process.

@&#DISCUSSION@&#

According to the experimental results, it is clear that our approach provides excellent modeling capabilities and classification results. These applications involve the extraction of high-dimensional feature vectors. A given feature could be relevant (i.e. useful to discover the clustering structure) or irrelevant (i.e. may compromise the structure). Thus, it is crucial to select relevant features. The problem becomes more challenging when the clustering is performed online. The advantage of our algorithm as compared to previous approaches is that it takes simultaneously both problems into account. The total computational time depends on the number of iterations required for converging. The computational complexity of the proposed online learning algorithm is 
                           
                              O
                              (
                              MTKD
                              )
                           
                        , whereas the batch algorithm requires 
                           
                              O
                              (
                              NMTKD
                              )
                           
                         in each iteration. Therefore, the online learning algorithm is much more computationally efficient than its batch counterpart. This is due to the fact that the batch algorithm updates the variational factors by using the whole data set in each iteration, and thus its estimation quality is improved much more slowly than in the case of the online one.

@&#CONCLUSION@&#

This paper has presented a unified framework for simultaneous clustering and feature selection by formulating data modeling using a hierarchical Dirichlet process of generalized Dirichlet distributions. The main goal is to analyze data to discover interesting structure. Besides providing a formal approach to clustering, the proposed framework also leads to principled solutions to model and feature selection and then avoids over- and under-fitting problems. Two different algorithms have been developed to learn the parameters of the proposed statistical model. The batch algorithm requires that all of the data be present before modeling. In the other hand, the online algorithm is suited for applications where data is an incoming stream of observations. Through extensive experiments involving the challenging problems of face detection, facial expression recognition, human gesture recognition and off-line writer identification we have shown that our non-parametric Bayesian framework leads to very natural procedure for inference, learning, and modeling. This is actually expected taking into account the fact that Bayesian inference allows to deal efficiently with uncertainty. Our approach reveals the overwhelming superiority of infinite mixtures over finite ones and could be deployed for many other challenging tasks such as text clustering, gene expressions analysis, and users profiling.

@&#ACKNOWLEDGMENTS@&#

The second author would like to thank King Abdulaziz City for Science and Technology (KACST), Kingdom of Saudi Arabia, for their funding support under Grant No. 11-INF1787-08. The authors would like to thank the anonymous referees and the associate editor for their comments.

The goal of this appendix is to derive the re-estimation equations needed in the expectation step.
                        
                           (33)
                           
                              
                                 
                                    ρ
                                 
                                 
                                    jit
                                 
                              
                              =
                              
                                 
                                    exp
                                    (
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          jit
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          f
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    exp
                                    (
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          jif
                                       
                                    
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (34)
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    jit
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              〈
                              
                                 
                                    W
                                 
                                 
                                    jtk
                                 
                              
                              〉
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       D
                                    
                                 
                              
                              〈
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                              〉
                              [
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              +
                              (
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              -
                              1
                              )
                              ln
                              
                                 
                                    X
                                 
                                 
                                    jil
                                 
                              
                              +
                              (
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              -
                              1
                              )
                              ln
                              (
                              1
                              -
                              
                                 
                                    X
                                 
                                 
                                    jil
                                 
                              
                              )
                              ]
                              +
                              〈
                              ln
                              
                                 
                                    π
                                 
                                 
                                    jt
                                 
                                 
                                    ′
                                 
                              
                              〉
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       =
                                       1
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                              
                              〈
                              ln
                              (
                              1
                              -
                              
                                 
                                    π
                                 
                                 
                                    js
                                 
                                 
                                    ′
                                 
                              
                              )
                              〉
                           
                        
                     
                     
                        
                           (35)
                           
                              
                                 
                                    R
                                 
                                 
                                    ∼
                                 
                              
                              =
                              ln
                              
                                 
                                    Γ
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          ¯
                                       
                                    
                                    +
                                    
                                       
                                          β
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    Γ
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    Γ
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                              
                              +
                              
                                 
                                    α
                                 
                                 
                                    ¯
                                 
                              
                              [
                              Ψ
                              (
                              
                                 
                                    α
                                 
                                 
                                    ¯
                                 
                              
                              +
                              
                                 
                                    β
                                 
                                 
                                    ¯
                                 
                              
                              )
                              -
                              Ψ
                              (
                              
                                 
                                    α
                                 
                                 
                                    ¯
                                 
                              
                              )
                              ]
                              (
                              
                                 
                                    
                                       ln
                                       α
                                    
                                 
                              
                              -
                              ln
                              
                                 
                                    α
                                 
                                 
                                    ¯
                                 
                              
                              )
                              +
                              
                                 
                                    β
                                 
                                 
                                    ¯
                                 
                              
                              [
                              Ψ
                              (
                              
                                 
                                    α
                                 
                                 
                                    ¯
                                 
                              
                              +
                              
                                 
                                    β
                                 
                                 
                                    ¯
                                 
                              
                              )
                              -
                              Ψ
                              (
                              
                                 
                                    β
                                 
                                 
                                    ¯
                                 
                              
                              )
                              ]
                              (
                              
                                 
                                    
                                       ln
                                       β
                                    
                                 
                              
                              -
                              ln
                              
                                 
                                    β
                                 
                                 
                                    ¯
                                 
                              
                              )
                              +
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              [
                              
                                 
                                    Ψ
                                 
                                 
                                    ′
                                 
                              
                              (
                              
                                 
                                    α
                                 
                                 
                                    ¯
                                 
                              
                              +
                              
                                 
                                    β
                                 
                                 
                                    ¯
                                 
                              
                              )
                              -
                              
                                 
                                    Ψ
                                 
                                 
                                    ′
                                 
                              
                              (
                              
                                 
                                    α
                                 
                                 
                                    ¯
                                 
                              
                              )
                              ]
                              
                                 
                                    
                                       
                                          
                                             (
                                             ln
                                             α
                                             -
                                             ln
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              [
                              
                                 
                                    Ψ
                                 
                                 
                                    ′
                                 
                              
                              (
                              
                                 
                                    α
                                 
                                 
                                    ¯
                                 
                              
                              +
                              
                                 
                                    β
                                 
                                 
                                    ¯
                                 
                              
                              )
                              -
                              
                                 
                                    Ψ
                                 
                                 
                                    ′
                                 
                              
                              (
                              
                                 
                                    β
                                 
                                 
                                    ¯
                                 
                              
                              )
                              ]
                              
                                 
                                    
                                       
                                          
                                             (
                                             ln
                                             β
                                             -
                                             ln
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    α
                                 
                                 
                                    ¯
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    ¯
                                 
                              
                              
                                 
                                    Ψ
                                 
                                 
                                    ′
                                 
                              
                              (
                              
                                 
                                    α
                                 
                                 
                                    ¯
                                 
                              
                              +
                              
                                 
                                    β
                                 
                                 
                                    ¯
                                 
                              
                              )
                              (
                              
                                 
                                    
                                       ln
                                       α
                                    
                                 
                              
                              -
                              ln
                              
                                 
                                    α
                                 
                                 
                                    ¯
                                 
                              
                              )
                              (
                              
                                 
                                    
                                       ln
                                       β
                                    
                                 
                              
                              -
                              ln
                              
                                 
                                    β
                                 
                                 
                                    ¯
                                 
                              
                              )
                           
                        
                     
                     
                        
                           (36)
                           
                              
                                 
                                    ϑ
                                 
                                 
                                    jtk
                                 
                              
                              =
                              
                                 
                                    exp
                                    (
                                    
                                       
                                          
                                             
                                                ϑ
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          jtk
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          f
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                    exp
                                    (
                                    
                                       
                                          
                                             
                                                ϑ
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          jtf
                                       
                                    
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (37)
                           
                              
                                 
                                    
                                       
                                          ϑ
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    jtk
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              〈
                              
                                 
                                    Z
                                 
                                 
                                    jit
                                 
                              
                              〉
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       D
                                    
                                 
                              
                              〈
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                              〉
                              [
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              +
                              (
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              -
                              1
                              )
                              ln
                              
                                 
                                    X
                                 
                                 
                                    jil
                                 
                              
                              +
                              (
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              -
                              1
                              )
                              ln
                              (
                              1
                              -
                              
                                 
                                    X
                                 
                                 
                                    jil
                                 
                              
                              )
                              ]
                              +
                              〈
                              ln
                              
                                 
                                    ψ
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              〉
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       =
                                       1
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                 
                              
                              〈
                              ln
                              (
                              1
                              -
                              
                                 
                                    ψ
                                 
                                 
                                    s
                                 
                                 
                                    ′
                                 
                              
                              )
                              〉
                           
                        
                     
                     
                        
                           (38)
                           
                              
                                 
                                    φ
                                 
                                 
                                    jil
                                 
                              
                              =
                              
                                 
                                    exp
                                    (
                                    
                                       
                                          
                                             
                                                φ
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          jil
                                       
                                    
                                    )
                                 
                                 
                                    exp
                                    (
                                    
                                       
                                          
                                             
                                                φ
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          jil
                                       
                                    
                                    )
                                    +
                                    exp
                                    (
                                    
                                       
                                          
                                             
                                                φ
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          jil
                                       
                                    
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (39)
                           
                              
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    jil
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              〈
                              
                                 
                                    Z
                                 
                                 
                                    jit
                                 
                              
                              〉
                              〈
                              
                                 
                                    W
                                 
                                 
                                    jtk
                                 
                              
                              〉
                              [
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              +
                              (
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              -
                              1
                              )
                              ln
                              
                                 
                                    X
                                 
                                 
                                    jil
                                 
                              
                              +
                              (
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              -
                              1
                              )
                              ln
                              (
                              1
                              -
                              
                                 
                                    X
                                 
                                 
                                    jil
                                 
                              
                              )
                              ]
                              +
                              〈
                              ln
                              
                                 
                                    ∊
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              〉
                           
                        
                     
                     
                        
                           (40)
                           
                              
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    jil
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              +
                              (
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              -
                              1
                              )
                              ln
                              
                                 
                                    X
                                 
                                 
                                    jil
                                 
                              
                              +
                              (
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              -
                              1
                              )
                              ln
                              (
                              1
                              -
                              
                                 
                                    X
                                 
                                 
                                    jil
                                 
                              
                              )
                              +
                              〈
                              ln
                              
                                 
                                    ∊
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              〉
                           
                        
                     
                     
                        
                           (41)
                           
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              〈
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                              〉
                              ,
                              
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              〈
                              1
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                              〉
                           
                        
                     
                     
                        
                           (42)
                           
                              
                                 
                                    a
                                 
                                 
                                    jt
                                 
                              
                              =
                              1
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              〈
                              
                                 
                                    Z
                                 
                                 
                                    jit
                                 
                              
                              〉
                              ,
                              
                              
                                 
                                    b
                                 
                                 
                                    jt
                                 
                              
                              =
                              
                                 
                                    λ
                                 
                                 
                                    jt
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       =
                                       t
                                       +
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              〈
                              
                                 
                                    Z
                                 
                                 
                                    jis
                                 
                              
                              〉
                           
                        
                     
                     
                        
                           (43)
                           
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                              =
                              1
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              〈
                              
                                 
                                    W
                                 
                                 
                                    jtk
                                 
                              
                              〉
                              ,
                              
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    γ
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       =
                                       k
                                       +
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              〈
                              
                                 
                                    W
                                 
                                 
                                    jts
                                 
                              
                              〉
                           
                        
                     
                     
                        
                           (44)
                           
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              =
                              
                                 
                                    u
                                 
                                 
                                    kl
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              〈
                              
                                 
                                    W
                                 
                                 
                                    jtk
                                 
                              
                              〉
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              〈
                              
                                 
                                    Z
                                 
                                 
                                    jit
                                 
                              
                              〉
                              〈
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                              〉
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              
                                 
                                    
                                       Ψ
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                       -
                                       Ψ
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       
                                          
                                             Ψ
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                       (
                                       〈
                                       ln
                                       
                                          
                                             β
                                          
                                          
                                             kl
                                          
                                       
                                       〉
                                       -
                                       ln
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (45)
                           
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              =
                              
                                 
                                    v
                                 
                                 
                                    kl
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              〈
                              
                                 
                                    W
                                 
                                 
                                    jtk
                                 
                              
                              〉
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              〈
                              
                                 
                                    Z
                                 
                                 
                                    jit
                                 
                              
                              〉
                              〈
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                              〉
                              ln
                              
                                 
                                    X
                                 
                                 
                                    jil
                                 
                              
                           
                        
                     
                     
                        
                           (46)
                           
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              =
                              
                                 
                                    g
                                 
                                 
                                    kl
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              〈
                              
                                 
                                    W
                                 
                                 
                                    jtk
                                 
                              
                              〉
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              〈
                              
                                 
                                    Z
                                 
                                 
                                    jit
                                 
                              
                              〉
                              〈
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                              〉
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              
                                 
                                    
                                       Ψ
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                       -
                                       Ψ
                                       (
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       
                                          
                                             Ψ
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                       (
                                       〈
                                       ln
                                       
                                          
                                             α
                                          
                                          
                                             kl
                                          
                                       
                                       〉
                                       -
                                       ln
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (47)
                           
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              =
                              
                                 
                                    h
                                 
                                 
                                    kl
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              〈
                              
                                 
                                    W
                                 
                                 
                                    jtk
                                 
                              
                              〉
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              〈
                              
                                 
                                    Z
                                 
                                 
                                    jit
                                 
                              
                              〉
                              〈
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                              〉
                              ln
                              (
                              1
                              -
                              
                                 
                                    X
                                 
                                 
                                    jil
                                 
                              
                              )
                           
                        
                     
                     
                        
                           (48)
                           
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    u
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              〈
                              1
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                              〉
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    
                                       Ψ
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       -
                                       Ψ
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             Ψ
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       (
                                       〈
                                       ln
                                       
                                          
                                             β
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       〉
                                       -
                                       ln
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (49)
                           
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    v
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              〈
                              1
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                              〉
                              ln
                              
                                 
                                    X
                                 
                                 
                                    jil
                                 
                              
                           
                        
                     
                     
                        
                           (50)
                           
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    g
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              〈
                              1
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                              〉
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    
                                       Ψ
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       -
                                       Ψ
                                       (
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             Ψ
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       (
                                       〈
                                       ln
                                       
                                          
                                             α
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       〉
                                       -
                                       ln
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (51)
                           
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    h
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              〈
                              1
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                              〉
                              ln
                              (
                              1
                              -
                              
                                 
                                    X
                                 
                                 
                                    jil
                                 
                              
                              )
                           
                        
                     where 
                        
                           Ψ
                           (
                           ·
                           )
                        
                      is the digamma function. The expected values in the above formulas are defined as
                        
                           (52)
                           
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          kl
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          kl
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          kl
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          kl
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          l
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          l
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          l
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          l
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              ,
                              
                              〈
                              
                                 
                                    Z
                                 
                                 
                                    jit
                                 
                              
                              〉
                              =
                              
                                 
                                    ρ
                                 
                                 
                                    jit
                                 
                              
                              ,
                              
                              〈
                              
                                 
                                    W
                                 
                                 
                                    jtk
                                 
                              
                              〉
                              =
                              
                                 
                                    ϑ
                                 
                                 
                                    jtk
                                 
                              
                           
                        
                     
                     
                        
                           (53)
                           
                              〈
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                              〉
                              =
                              
                                 
                                    φ
                                 
                                 
                                    jil
                                 
                              
                              ,
                              
                              〈
                              1
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    jil
                                 
                              
                              〉
                              =
                              1
                              -
                              
                                 
                                    φ
                                 
                                 
                                    jil
                                 
                              
                           
                        
                     
                     
                        
                           (54)
                           
                              
                                 
                                    
                                       ln
                                       
                                          
                                             α
                                          
                                          
                                             kl
                                          
                                       
                                    
                                 
                              
                              =
                              Ψ
                              (
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              )
                              -
                              ln
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       ln
                                       
                                          
                                             β
                                          
                                          
                                             kl
                                          
                                       
                                    
                                 
                              
                              =
                              Ψ
                              (
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              )
                              -
                              ln
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                           
                        
                     
                     
                        
                           (55)
                           
                              
                                 
                                    
                                       ln
                                       
                                          
                                             α
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                              =
                              Ψ
                              (
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              )
                              -
                              ln
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       ln
                                       
                                          
                                             β
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                              =
                              Ψ
                              (
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              )
                              -
                              ln
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                           
                        
                     
                     
                        
                           (56)
                           
                              
                                 
                                    
                                       ln
                                       
                                          
                                             ∊
                                          
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              Ψ
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                                 
                                    ∗
                                 
                              
                              )
                              -
                              Ψ
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                                 
                                    ∗
                                 
                              
                              +
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                                 
                                    ∗
                                 
                              
                              )
                              ,
                              
                              
                                 
                                    
                                       ln
                                       
                                          
                                             ∊
                                          
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              Ψ
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                                 
                                    ∗
                                 
                              
                              )
                              -
                              Ψ
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                                 
                                    ∗
                                 
                              
                              +
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                        
                     
                     
                        
                           (57)
                           
                              
                                 
                                    
                                       ln
                                       
                                          
                                             π
                                          
                                          
                                             jt
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                              =
                              Ψ
                              (
                              
                                 
                                    a
                                 
                                 
                                    jt
                                 
                              
                              )
                              -
                              Ψ
                              (
                              
                                 
                                    a
                                 
                                 
                                    jt
                                 
                              
                              +
                              
                                 
                                    b
                                 
                                 
                                    jt
                                 
                              
                              )
                              
                              
                                 
                                    
                                       ln
                                       (
                                       1
                                       -
                                       
                                          
                                             π
                                          
                                          
                                             jt
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 
                              
                              =
                              Ψ
                              (
                              
                                 
                                    b
                                 
                                 
                                    jt
                                 
                              
                              )
                              -
                              Ψ
                              (
                              
                                 
                                    a
                                 
                                 
                                    jt
                                 
                              
                              +
                              
                                 
                                    b
                                 
                                 
                                    jt
                                 
                              
                              )
                           
                        
                     
                     
                        
                           (58)
                           
                              
                                 
                                    
                                       ln
                                       
                                          
                                             ψ
                                          
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                              =
                              Ψ
                              (
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                              )
                              -
                              Ψ
                              (
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                              
                              )
                              
                              
                                 
                                    
                                       ln
                                       (
                                       1
                                       -
                                       
                                          
                                             ψ
                                          
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 
                              
                              =
                              Ψ
                              (
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                              
                              )
                              -
                              Ψ
                              (
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                              
                              )
                           
                        
                     
                  

The goal of this appendix is to derive the updating equations of the variational solutions. We update the variational solution to 
                        
                           q
                           (
                           
                              
                                 
                                    
                                       Z
                                    
                                    
                                       →
                                    
                                 
                              
                              
                                 r
                              
                           
                           )
                        
                      by maximizing the current lower bound 
                        
                           
                              
                                 L
                              
                              
                                 (
                                 r
                                 )
                              
                           
                           (
                           q
                           )
                        
                      with respect to 
                        
                           q
                           (
                           
                              
                                 
                                    
                                       Z
                                    
                                    
                                       →
                                    
                                 
                              
                              
                                 r
                              
                           
                           )
                        
                     , while other variational factors remains to their current values
                        
                           (59)
                           
                              q
                              (
                              
                                 
                                    
                                       
                                          Z
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    r
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    jrt
                                 
                                 
                                    
                                       
                                          Z
                                       
                                       
                                          jrt
                                       
                                    
                                 
                              
                           
                        
                     where
                        
                           (60)
                           
                              
                                 
                                    ρ
                                 
                                 
                                    jrt
                                 
                              
                              =
                              
                                 
                                    exp
                                    (
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          jrt
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          f
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    exp
                                    (
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          jrf
                                       
                                    
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (61)
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    jrt
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              〈
                              
                                 
                                    W
                                 
                                 
                                    jtk
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              〉
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       D
                                    
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    jrl
                                 
                              
                              [
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              +
                              (
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              -
                              1
                              )
                              ln
                              
                                 
                                    X
                                 
                                 
                                    jrl
                                 
                              
                              +
                              (
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              -
                              1
                              )
                              ln
                              (
                              1
                              -
                              
                                 
                                    X
                                 
                                 
                                    jrl
                                 
                              
                              )
                              ]
                              +
                              〈
                              ln
                              
                                 
                                    π
                                 
                                 
                                    jt
                                 
                                 
                                    ′
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              〉
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       =
                                       1
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                              
                              〈
                              ln
                              (
                              1
                              -
                              
                                 
                                    π
                                 
                                 
                                    js
                                 
                                 
                                    ′
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              )
                              〉
                           
                        
                     In the following step, we maximize the current lower bound 
                        
                           
                              
                                 L
                              
                              
                                 (
                                 r
                                 )
                              
                           
                           (
                           q
                           )
                        
                      with respect to 
                        
                           
                              
                                 q
                              
                              
                                 (
                                 r
                                 )
                              
                           
                           (
                           
                              
                                 W
                              
                              
                                 →
                              
                           
                           )
                        
                      and 
                        
                           
                              
                                 q
                              
                              
                                 (
                                 r
                                 )
                              
                           
                           (
                           
                              
                                 ∊
                              
                              
                                 →
                              
                           
                           )
                        
                      as
                        
                           (62)
                           
                              
                                 
                                    q
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              (
                              
                                 
                                    W
                                 
                                 
                                    →
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          ϑ
                                       
                                       
                                          jtk
                                       
                                       
                                          (
                                          r
                                          )
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          W
                                       
                                       
                                          jtk
                                       
                                       
                                          (
                                          r
                                          )
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (63)
                           
                              
                                 
                                    q
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              (
                              
                                 
                                    ∊
                                 
                                 
                                    →
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       D
                                    
                                 
                              
                              Dir
                              (
                              
                                 
                                    
                                       
                                          ∊
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              |
                              
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ∗
                                    (
                                    r
                                    )
                                 
                              
                              )
                           
                        
                     where the hyperparameters in the above equations are defined by
                        
                           (64)
                           
                              
                                 
                                    ϑ
                                 
                                 
                                    jtk
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    ϑ
                                 
                                 
                                    jtk
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    ζ
                                 
                                 
                                    r
                                 
                              
                              Δ
                              
                                 
                                    ϑ
                                 
                                 
                                    jtk
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (65)
                           
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                                 
                                    ∗
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                                 
                                    ∗
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    ζ
                                 
                                 
                                    r
                                 
                              
                              Δ
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                                 
                                    ∗
                                    (
                                    r
                                    )
                                 
                              
                              ,
                              
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                                 
                                    ∗
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                                 
                                    ∗
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    ζ
                                 
                                 
                                    r
                                 
                              
                              Δ
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                                 
                                    ∗
                                    (
                                    r
                                    )
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 ζ
                              
                              
                                 r
                              
                           
                        
                      is the learning rate which is used to reduce the earlier inaccurate estimation effects that contributed to the lower bound and accelerate the convergence of the learning process. In this work, we adopt a learning rate function introduced in [10], such that 
                        
                           
                              
                                 ζ
                              
                              
                                 r
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       η
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 r
                                 )
                              
                              
                                 -
                                 ς
                              
                           
                        
                     , subject to the constraints 
                        
                           ς
                           ∈
                           (
                           0.5
                           ,
                           1
                           ]
                        
                      and 
                        
                           
                              
                                 η
                              
                              
                                 0
                              
                           
                           ⩾
                           0
                        
                     . In Eq. (42), 
                        
                           Δ
                           
                              
                                 ϑ
                              
                              
                                 jtk
                              
                              
                                 (
                                 r
                                 )
                              
                           
                           ,
                           Δ
                           
                              
                                 ξ
                              
                              
                                 1
                              
                              
                                 ∗
                                 (
                                 r
                                 )
                              
                           
                        
                      and 
                        
                           Δ
                           
                              
                                 ξ
                              
                              
                                 2
                              
                              
                                 ∗
                                 (
                                 r
                                 )
                              
                           
                        
                      are the natural gradients of the hyperparameters 
                        
                           
                              
                                 ϑ
                              
                              
                                 jtk
                              
                              
                                 (
                                 r
                                 )
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 1
                              
                              
                                 ∗
                                 (
                                 r
                                 )
                              
                           
                        
                      and 
                        
                           
                              
                                 ξ
                              
                              
                                 2
                              
                              
                                 ∗
                                 (
                                 r
                                 )
                              
                           
                        
                     , respectively. The natural gradient of a hyperparameter is obtained by multiplying the gradient by the inverse of Riemannian metric, which cancels the coefficient matrix for the posterior parameter distribution. Thus, these natural gradients can be calculated as
                        
                           (66)
                           
                              Δ
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                                 
                                    ∗
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                                 
                                    ∗
                                    (
                                    r
                                    )
                                 
                              
                              -
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                                 
                                    ∗
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              =
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              N
                              
                                 
                                    φ
                                 
                                 
                                    jrl
                                 
                              
                              -
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                                 
                                    ∗
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (67)
                           
                              Δ
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                                 
                                    ∗
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                                 
                                    ∗
                                    (
                                    r
                                    )
                                 
                              
                              -
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                                 
                                    ∗
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              =
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              N
                              (
                              1
                              -
                              
                                 
                                    φ
                                 
                                 
                                    jrl
                                 
                              
                              )
                              -
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                                 
                                    ∗
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (68)
                           
                              Δ
                              
                                 
                                    ϑ
                                 
                                 
                                    jtk
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    ϑ
                                 
                                 
                                    jtk
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              -
                              
                                 
                                    ϑ
                                 
                                 
                                    jtk
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              =
                              
                                 
                                    exp
                                    (
                                    
                                       
                                          
                                             
                                                ϑ
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          jtk
                                       
                                       
                                          (
                                          r
                                          )
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          f
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                    exp
                                    (
                                    
                                       
                                          
                                             
                                                ϑ
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          jtf
                                       
                                       
                                          (
                                          r
                                          )
                                       
                                    
                                    )
                                 
                              
                              -
                              
                                 
                                    ϑ
                                 
                                 
                                    jtk
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                           
                        
                     where
                        
                           (69)
                           
                              
                                 
                                    
                                       
                                          ϑ
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    jtk
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              N
                              
                                 
                                    ρ
                                 
                                 
                                    jrt
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       D
                                    
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    jrl
                                 
                              
                              [
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              +
                              (
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              -
                              1
                              )
                              ln
                              
                                 
                                    X
                                 
                                 
                                    jrl
                                 
                              
                              +
                              (
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              -
                              1
                              )
                              ln
                              (
                              1
                              -
                              
                                 
                                    X
                                 
                                 
                                    jrl
                                 
                              
                              )
                              ]
                              +
                              〈
                              ln
                              
                                 
                                    ψ
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              〉
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       =
                                       1
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                 
                              
                              〈
                              ln
                              (
                              1
                              -
                              
                                 
                                    ψ
                                 
                                 
                                    s
                                 
                                 
                                    ′
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              )
                              〉
                           
                        
                     Next, the current lower bound 
                        
                           
                              
                                 L
                              
                              
                                 (
                                 r
                                 )
                              
                           
                           (
                           q
                           )
                        
                      is maximized with respect to 
                        
                           
                              
                                 q
                              
                              
                                 (
                                 r
                                 )
                              
                           
                           (
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       →
                                    
                                 
                              
                              
                                 ′
                              
                           
                           )
                           ,
                           
                              
                                 q
                              
                              
                                 (
                                 r
                                 )
                              
                           
                           (
                           
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       →
                                    
                                 
                              
                              
                                 ′
                              
                           
                           )
                           ,
                           
                              
                                 q
                              
                              
                                 (
                                 r
                                 )
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 →
                              
                           
                           )
                        
                      
                     
                        
                           
                              
                                 q
                              
                              
                                 (
                                 r
                                 )
                              
                           
                           (
                           
                              
                                 β
                              
                              
                                 →
                              
                           
                           )
                           ,
                           
                              
                                 q
                              
                              
                                 (
                                 r
                                 )
                              
                           
                           (
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       →
                                    
                                 
                              
                              
                                 ′
                              
                           
                           )
                        
                      and 
                        
                           
                              
                                 q
                              
                              
                                 (
                                 r
                                 )
                              
                           
                           (
                           
                              
                                 
                                    
                                       β
                                    
                                    
                                       →
                                    
                                 
                              
                              
                                 ′
                              
                           
                           )
                        
                     . The corresponding update equations are given by
                        
                           (70)
                           
                              
                                 
                                    q
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              Beta
                              (
                              
                                 
                                    π
                                 
                                 
                                    jt
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              |
                              
                                 
                                    a
                                 
                                 
                                    jt
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    jt
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              )
                              
                              
                                 
                                    q
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              Beta
                              (
                              
                                 
                                    β
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              |
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              )
                           
                        
                     
                     
                        
                           (71)
                           
                              
                                 
                                    q
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              (
                              
                                 
                                    α
                                 
                                 
                                    →
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       D
                                    
                                 
                              
                              G
                              (
                              
                                 
                                    α
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              |
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              )
                              
                              
                                 
                                    q
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              (
                              
                                 
                                    β
                                 
                                 
                                    →
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       D
                                    
                                 
                              
                              G
                              (
                              
                                 
                                    β
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              |
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              )
                           
                        
                     
                     
                        
                           (72)
                           
                              
                                 
                                    q
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       D
                                    
                                 
                              
                              G
                              (
                              
                                 
                                    α
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              |
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              )
                              
                              
                                 
                                    q
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       D
                                    
                                 
                              
                              G
                              (
                              
                                 
                                    β
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              |
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              )
                           
                        
                     where the hyperparameters are given by
                        
                           (73)
                           
                              
                                 
                                    a
                                 
                                 
                                    jt
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    a
                                 
                                 
                                    jt
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    ζ
                                 
                                 
                                    r
                                 
                              
                              Δ
                              
                                 
                                    a
                                 
                                 
                                    jt
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              ,
                              
                              
                                 
                                    b
                                 
                                 
                                    jt
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    b
                                 
                                 
                                    jt
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    ζ
                                 
                                 
                                    r
                                 
                              
                              Δ
                              
                                 
                                    b
                                 
                                 
                                    jt
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (74)
                           
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    ζ
                                 
                                 
                                    r
                                 
                              
                              Δ
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              ,
                              
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    ζ
                                 
                                 
                                    r
                                 
                              
                              Δ
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (75)
                           
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    ζ
                                 
                                 
                                    r
                                 
                              
                              Δ
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    ζ
                                 
                                 
                                    r
                                 
                              
                              Δ
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (76)
                           
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    ζ
                                 
                                 
                                    r
                                 
                              
                              Δ
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    ζ
                                 
                                 
                                    r
                                 
                              
                              Δ
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (77)
                           
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    ζ
                                 
                                 
                                    r
                                 
                              
                              Δ
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    ζ
                                 
                                 
                                    r
                                 
                              
                              Δ
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (78)
                           
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    ζ
                                 
                                 
                                    r
                                 
                              
                              Δ
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    ζ
                                 
                                 
                                    r
                                 
                              
                              Δ
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                           
                        
                     The corresponding natural gradients can be calculated as
                        
                           (79)
                           
                              Δ
                              
                                 
                                    a
                                 
                                 
                                    jt
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              1
                              +
                              N
                              
                                 
                                    ρ
                                 
                                 
                                    jrt
                                 
                              
                              -
                              
                                 
                                    a
                                 
                                 
                                    jt
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              
                              Δ
                              
                                 
                                    b
                                 
                                 
                                    jt
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    λ
                                 
                                 
                                    jt
                                 
                              
                              +
                              N
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       =
                                       t
                                       +
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    jsr
                                 
                              
                              -
                              
                                 
                                    b
                                 
                                 
                                    jt
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (80)
                           
                              Δ
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              1
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    ϑ
                                 
                                 
                                    jtk
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              -
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              
                              Δ
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    γ
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       =
                                       k
                                       +
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              
                                 
                                    ϑ
                                 
                                 
                                    jts
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              -
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (81)
                           
                              Δ
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    u
                                 
                                 
                                    kl
                                 
                              
                              +
                              N
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    ϑ
                                 
                                 
                                    jtk
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    jrt
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    jrl
                                 
                              
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              
                                 
                                    
                                       Ψ
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                          
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                          
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       )
                                       -
                                       Ψ
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                          
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                          
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       
                                          
                                             Ψ
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                          
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                          
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       )
                                       (
                                       〈
                                       ln
                                       
                                          
                                             β
                                          
                                          
                                             kl
                                          
                                          
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       〉
                                       -
                                       ln
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                          
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       )
                                    
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (82)
                           
                              Δ
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    v
                                 
                                 
                                    kl
                                 
                              
                              -
                              N
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    ϑ
                                 
                                 
                                    jtk
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    jrt
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    jrl
                                 
                              
                              ln
                              
                                 
                                    X
                                 
                                 
                                    jrl
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (83)
                           
                              Δ
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    g
                                 
                                 
                                    kl
                                 
                              
                              +
                              N
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    ϑ
                                 
                                 
                                    jtk
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    jrt
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    jrl
                                 
                              
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              
                                 
                                    
                                       Ψ
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                          
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                          
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       )
                                       -
                                       Ψ
                                       (
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                          
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                          
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       
                                          
                                             Ψ
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                          
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                          
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       )
                                       (
                                       〈
                                       ln
                                       
                                          
                                             α
                                          
                                          
                                             kl
                                          
                                          
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       〉
                                       -
                                       ln
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             kl
                                          
                                          
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       )
                                    
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (84)
                           
                              Δ
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    h
                                 
                                 
                                    kl
                                 
                              
                              -
                              N
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    ϑ
                                 
                                 
                                    jtk
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    jrt
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    jrl
                                 
                              
                              ln
                              (
                              1
                              -
                              
                                 
                                    X
                                 
                                 
                                    jrl
                                 
                              
                              )
                              -
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (85)
                           
                              Δ
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    u
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              +
                              N
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              (
                              1
                              -
                              
                                 
                                    φ
                                 
                                 
                                    jrl
                                 
                              
                              )
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              
                                 
                                    
                                       Ψ
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       )
                                       -
                                       Ψ
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       
                                          
                                             Ψ
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       )
                                       (
                                       〈
                                       ln
                                       
                                          
                                             β
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       〉
                                       -
                                       ln
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             (
                                             r
                                             -
                                             1
                                             )
                                             ]
                                          
                                       
                                       )
                                    
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (86)
                           
                              Δ
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    v
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              -
                              N
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              (
                              1
                              -
                              
                                 
                                    φ
                                 
                                 
                                    jrl
                                 
                              
                              )
                              ln
                              
                                 
                                    X
                                 
                                 
                                    jrl
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (87)
                           
                              Δ
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    g
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              +
                              N
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              (
                              1
                              -
                              
                                 
                                    φ
                                 
                                 
                                    jrl
                                 
                              
                              )
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                              
                                 
                                    
                                       Ψ
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       )
                                       -
                                       Ψ
                                       (
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       
                                          
                                             Ψ
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       )
                                       (
                                       〈
                                       ln
                                       
                                          
                                             α
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       〉
                                       -
                                       ln
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             ′
                                             (
                                             r
                                             -
                                             1
                                             )
                                          
                                       
                                       )
                                    
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (88)
                           
                              Δ
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    )
                                 
                              
                              =
                              
                                 
                                    h
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                              -
                              N
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              (
                              1
                              -
                              
                                 
                                    φ
                                 
                                 
                                    jrl
                                 
                              
                              )
                              ln
                              (
                              1
                              -
                              
                                 
                                    X
                                 
                                 
                                    jrl
                                 
                              
                              )
                              -
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    l
                                 
                                 
                                    ′
                                    (
                                    r
                                    -
                                    1
                                    )
                                 
                              
                           
                        
                     
                  

@&#REFERENCES@&#

