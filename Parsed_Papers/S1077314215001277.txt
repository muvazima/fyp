@&#MAIN-TITLE@&#Computational caricaturization of surfaces

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a caricaturization framework that is robust to natural poses and expressions.


                        
                        
                           
                           The proposed model links between the two schools of thoughts of computerized caricaturization.


                        
                        
                           
                           It is simple to implement and works efficiently as part of a realtime system.


                        
                        
                           
                           We used the proposed caricaturization method for generating musical video clips.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Poisson equation

Isometry/pose invariance

Gaussian curvature

Laplace–Beltrami operator

@&#ABSTRACT@&#


               
               
                  The question whether a caricature of a 2D sketch, or an object in 3D can be generated automatically is probably as old as the attempt to answer the question of what defines art. In an attempt to provide a partial answer, we propose a computational approach for automatic caricaturization. The idea is to rely on intrinsic geometric properties of a given model that are invariant to poses, articulations, and gestures. A property of a surface that is preserved while it undergoes such deformations is self-isometry. In other words, while smiling, running, and posing, we do not change much the intrinsic geometry of our facial surface, the area of our body, or the size of our hands. The proposed method locally amplifies the area of a given surface based on its Gaussian curvature. It is shown to produce a natural comic exaggeration effect which can be efficiently computed as a solution of a Poisson equation. We demonstrate the power of the proposed method by applying it to a variety of meshes such as human faces, statues, and animals. The results demonstrate enhancement and exaggeration of the shape’s features into an artistic caricature. As most poses and postures are almost isometries, the use of the Gaussian curvature as the scaling factor allows the proposed method to handle animated sequences while preserving the identity of the animated creature.
               
            

@&#INTRODUCTION@&#

A caricature is an illustration of an object in which some features are exaggerated. The terms feature exaggeration usually refers to an operation that relates measures of a given object to those of a reference one. For example, a small mouth, relates the size of a given mouth to its average in a given population. The procedure we have in mind is one that emphasizes and extends such discrepancies. An interesting question is what happens when there is no reference population or an average to relate to. At the other end, it would be intriguing to design a caricaturization procedure that would have the same effect on an articulated object which is not affected by its pose, or posture (Fig. 1).

The oldest caricatures known today were drawn in ancient Egypt at about 3000 BC [2]. Later, the Greek and the Roman Empires used caricatures to intimidate people and spread their propaganda. The characters in these ancient caricatures were often monstrous hybridizations of humans and animals, see for example Fig. 2. In the fifteenth century, there was a change in the attitude towards caricatures. It has probably started with Leonardo da-Vinci, who in his study and exploration for shapes and forms searched for people with extremely deformed facial characteristics, that he used for his scientific art. Followers of da-Vinci started to emphasize properties of faces by exaggerating features in their drawings.

Drawing professional caricatures is a skill that requires long practice and innate talent. Skilled caricaturists are intimately familiar with human faces and their saddle variations. They can perceptually differentiate key features in one’s face from an average one. Before drawing, a caricaturist finds the discrepancy of common parts and memorizes them. Then, she draws the subject while amplifying the more distinct characteristics. The process is described in Fig. 3. The choice of features and the ability to exaggerate while maintaining the identity is where art comes into play. Obviously, personal touch and drawing skills would lead to different projections onto different artists perceptions of reality.
                  

Several papers attempt to automate a process of caricature drawing. The main efforts in this area can be divided into model-based and geometry-based approaches. The model based procedures are usually designed specifically for human faces that are represented by some parametric model. The discrepancies between the representations of a given subject face and an average one are exaggerated. In the geometry-based approach, intrinsic features of a shape are exaggerated. Here, we show how the proposed framework bridges between these two models.
                  

While designing an automatic exaggeration procedure a fundamentally important property is robustness to isometric deformations, such as rigid body transformations, as well as changes of expressions and poses. Based on the above arguments, the two axioms we would like to have for an automatic shape caricaturization procedure are thereby

                        
                           •
                           The ability to extend discrepancies with respect to a reference model.

Robustness or invariance to isometric deformations.

Indeed, when exaggerating a shape in motion, a key principle is to ensure that the processed sequence of exaggerated shapes are all related in a similar fashion to the original one. This property would enable applying the algorithm to animated figures and 3D scans while preserving the identity of the modified creature. Here, we propose a caricaturization framework that obeys these guidelines. Our axiomatic construction is based on the analysis provided in [4] by which facial expressions and articulations are almost isometries. Next, the simplest differential isometry invariant measure is the Gaussian curvature. We show how to efficiently modify the geometry of a given surface such that its area is locally amplified by some scalar function of the Gaussian curvature. The proposed model links between the two schools of thoughts of computerized caricaturization. Given the correspondence between the subject shape and a reference average shape, the relation between the curvatures at corresponding points determines the local stretching of the shape. The results of the algorithm are demonstrated to be robust to almost isometric deformations. It is simple to incorporate the proposed framework as part of a real-time system using the implementation consideration we provide.
                  

The organization of this paper is as follows. We start by reviewing caricature generation related papers in Section 2. We next introduce the proposed approach by briefly reviewing a classical surface modification technique to which we apply our axiomatically designed amplification factor in Section 3. Details about discretization and boundary conditions are given in Section 5. Section 6 discusses experimental results of the model applied to synthetic and real surfaces, as well as potential applications. We conclude with future directions in Section 7.

@&#RELATED WORK@&#

The challenge of automatically generating caricatures occupied researchers since the 1980’s. Brennan [3] introduced the idea of exaggerating the discrepancies between a sketch of a subject and an average face. She developed an interactive system in which the user picks feature points on a facial image. Simple interpolation of these points provides a sketch of the faces. Then, the sketch is aligned and registered to an average one, and the distances between matched feature points are exaggerated to construct a caricature.

Blanz and Vetter [5] proposed an extension of Brennan’s concept to facial surfaces embedded in 
                        
                           R
                           3
                        
                     . By finding bijective correspondences between approximately 200 faces, they constructed a linear model for facial geometries and facial textures. The caricature construction procedure was implemented by increasing the distance of the sample from the statistical mean. Their algorithm was trained on many faces between which dense and accurate correspondences were manually provided.

Alkeman et al. [6] designed an interactive caricaturization framework. They provide a tool for manually tiling facial images with simplices (points, lines, and triangles) and translating some of them. Using blending functions, the deformation of each triangle is interpolated. They extended their system to 3D faces in [7]. In [8], Lim et al. developed a mobile system for real-time caricature generation out of facial images. A survey of these and other caricaturization techniques can be found in [9].

At the other end, Steiner et al. [10] developed a method for enhancing and exaggerating planar shapes based on intrinsic (geometric) properties. They used the level set method 
                     [11] to iteratively stabilize inverse geometric diffusion operators of a given curve. This exaggeration method was intrinsic and did not require a reference average model.

Eigensatz et al. [12] proposed a shape deformation technique that enables manipulating the principal curvatures at arbitrary points on the shape. The non-linear relation between the principal curvatures and the shape vertex positions lead the authors to a costly non-linear least-squares optimization process.

Kim et al. [13] proposed an interactive method for exaggerating shape features by manipulating parts of the mesh in the frequency domain of the Laplace–Beltrami operator. Lewiner et al. [14] developed a real-time interactive caricaturization framework that exaggerates spectral representation of the difference between a given face and a template one. Cimen et al. [15] developed a method for caricaturizing 3D meshes based on its saliency measure using Free Form Deformation techniques.

In [16], Yu et al. introduced a surface editing framework in which the surface embedding gradients are manipulated smoothly through a solution of a Poisson equation. Chuang et al. in [17] extended that approach to feature enhancement and smoothing. Their technique scales the same gradient fields and solves a modified version of the Poisson equation known as the screened Poisson equation. That equation enables balancing between the fidelity and enhancement regularization of the manipulated surface.
                  

Consider the boundary of a 3D shape as a surface or a two dimensional manifold 
                           
                              M
                              ⊂
                              
                                 R
                                 3
                              
                           
                         given in a parametric form as 
                           
                              S
                              :
                              Ω
                              ⊂
                              
                                 R
                                 2
                              
                              →
                              M
                           
                        . Throughout this exposition, the surface M will be described by its coordinates 
                           
                              S
                              (
                              u
                              ,
                              v
                              )
                              =
                              {
                              x
                              (
                              u
                              ,
                              v
                              )
                              ,
                              y
                              (
                              u
                              ,
                              v
                              )
                              ,
                              z
                              (
                              u
                              ,
                              v
                              )
                              }
                              ,
                           
                         where x, y, and z are the coordinate-functions of the manifold.

The first partial derivatives of the parametric form, Su
                         and Sv
                        , are two vectors that are tangent to the surface and linearly independent. Thus, one can set the basis for the tangent plane TpM, about a point p ∈ S on the surface, as {Su, Sv
                        }.

The Jacobian of the parametrization J is a 3 × 2 matrix whose columns are Su
                         and Sv
                        , respectively. We define the matrix 
                           
                              G
                              =
                              
                                 J
                                 T
                              
                              J
                           
                         as the regular metric of the surface. Clearly, G is invertible, positive definite, and can be written explicitly in terms of Su
                         and Sv
                         as

                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             G
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            〈
                                                            
                                                               S
                                                               u
                                                            
                                                            ,
                                                            
                                                               S
                                                               u
                                                            
                                                            〉
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               〈
                                                               
                                                                  S
                                                                  u
                                                               
                                                               ,
                                                               
                                                                  S
                                                                  v
                                                               
                                                               〉
                                                            
                                                            
                                                               〈
                                                               
                                                                  S
                                                                  v
                                                               
                                                               ,
                                                               
                                                                  S
                                                                  u
                                                               
                                                               〉
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            〈
                                                            
                                                               S
                                                               v
                                                            
                                                            ,
                                                            
                                                               S
                                                               v
                                                            
                                                            〉
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Since the basis {Su, Sv
                        } is not necessarily orthogonal, the inner product between two vectors 
                           a
                        , 
                           b
                         ∈TpM represented in this basis is given by

                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   〈
                                                   
                                                      a
                                                      ̲
                                                   
                                                   ,
                                                   
                                                      b
                                                      ̲
                                                   
                                                   〉
                                                
                                                G
                                             
                                             =
                                             
                                                
                                                   a
                                                   ̲
                                                
                                                T
                                             
                                             G
                                             
                                                b
                                                ̲
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Next, consider two surfaces M
                        1 and M
                        2, and suppose we are given a parametrization for the first surface S
                        1(u, v). Suppose we are given a bijective map between the surfaces ϕ: M
                        1 → M
                        2. We can then build a parametrization for the second surface M
                        2 by composing ϕ on S
                        1. That is, a parametrization for the second surface is given by

                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                S
                                                2
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                             =
                                             ϕ
                                             ∘
                                             
                                                S
                                                1
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Given the parametrizations for both surfaces, we can calculate the metric matrices, G
                        1 and G
                        2, at each point (u, v) in the parametrization domain ,see Eq. (1). If at each point (u, v) in the parametrization domain, 
                           
                              
                                 G
                                 1
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              =
                              
                                 G
                                 2
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              ,
                           
                         then ϕ is said to be an isometry. If there exists an isometry between two surfaces M
                        1 and M
                        2, they are said to be isometric.

A curve on one surface has the same length as that of its isometrically mapped version. An area of a patch on one surface is mapped by ϕ to a patch that has the same area. In fact, any geometric property that can be measured in terms of the metric G and its derivatives and integration with respect to u and v are preserved by the isometry ϕ. We call such properties isometric invariant or intrinsic.

For each function 
                           
                              f
                              :
                              S
                              →
                              R
                           
                         defined on the surface there exists a corresponding function in the parameter domain 
                           
                              
                                 f
                                 ˜
                              
                              :
                              Ω
                              ⊂
                              
                                 R
                                 2
                              
                              →
                              R
                              ,
                           
                         such that

                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                                ˜
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                             =
                                             f
                                             ∘
                                             S
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Similarly, we define a tangent vector field on the surface, 
                           
                              
                                 F
                                 →
                              
                              :
                              M
                              →
                              
                                 T
                                 p
                              
                              M
                              ,
                           
                         as an assignment of a tangent vector to each point on the surface. Since these fields are in the tangent plane, one can represent them in terms of the basis {Su, Sv
                        }. For each tangent vector field 
                           
                              F
                              →
                           
                         on the surface, there exists a corresponding vector field with identical coordinates in the parametrization domain 
                           
                              
                                 F
                                 ˜
                              
                              →
                           
                         represented by the natural basis of 
                           
                              R
                              2
                           
                        .

As defined in [18], the gradient of a function on the surface, which we term here as gradient with respect to the metric G is a differential operator that satisfies

                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   〈
                                                   
                                                      ∇
                                                      G
                                                   
                                                   f
                                                   
                                                      (
                                                      p
                                                      )
                                                   
                                                   ,
                                                   
                                                      w
                                                      →
                                                   
                                                   〉
                                                
                                                G
                                             
                                             =
                                             
                                                d
                                                p
                                             
                                             f
                                             =
                                             
                                                lim
                                                
                                                   h
                                                   →
                                                   0
                                                
                                             
                                             
                                                
                                                   f
                                                   
                                                      (
                                                      p
                                                      +
                                                      h
                                                      
                                                         w
                                                         →
                                                      
                                                      )
                                                   
                                                   −
                                                   f
                                                   
                                                      (
                                                      p
                                                      )
                                                   
                                                
                                                h
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        for each 
                           
                              
                                 w
                                 →
                              
                              ∈
                              
                                 T
                                 p
                              
                              M
                           
                        . It follows that

                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             f
                                             
                                                (
                                                p
                                                +
                                                h
                                                
                                                   w
                                                   →
                                                
                                                )
                                             
                                             =
                                             f
                                             
                                                (
                                                p
                                                )
                                             
                                             +
                                             h
                                             
                                                
                                                   〈
                                                   
                                                      ∇
                                                      G
                                                   
                                                   f
                                                   
                                                      (
                                                      p
                                                      )
                                                   
                                                   ,
                                                   
                                                      w
                                                      →
                                                   
                                                   〉
                                                
                                                G
                                             
                                             +
                                             O
                                             
                                                (
                                                
                                                   h
                                                   2
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        For the corresponding function in the parametrization domain 
                           
                              
                                 f
                                 ˜
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              ,
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                f
                                                ˜
                                             
                                             
                                                (
                                                
                                                   u
                                                   0
                                                
                                                +
                                                h
                                                
                                                   w
                                                   1
                                                
                                                ,
                                                
                                                   v
                                                   0
                                                
                                                +
                                                h
                                                
                                                   w
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             =
                                             
                                                f
                                                ˜
                                             
                                             
                                                (
                                                
                                                   u
                                                   0
                                                
                                                ,
                                                
                                                   v
                                                   0
                                                
                                                )
                                             
                                             +
                                             h
                                             
                                                〈
                                                
                                                   ∇
                                                   
                                                      u
                                                      ,
                                                      v
                                                   
                                                
                                                
                                                   f
                                                   ˜
                                                
                                                
                                                   (
                                                   
                                                      u
                                                      0
                                                   
                                                   ,
                                                   
                                                      v
                                                      0
                                                   
                                                   )
                                                
                                                ,
                                                
                                                   w
                                                   →
                                                
                                                〉
                                             
                                             +
                                             O
                                             
                                                (
                                                
                                                   h
                                                   2
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              p
                              =
                              S
                              (
                              
                                 u
                                 0
                              
                              ,
                              
                                 v
                                 0
                              
                              )
                              ,
                           
                         and 
                           
                              
                                 w
                                 →
                              
                              =
                              
                                 (
                                 
                                    w
                                    1
                                 
                                 ,
                                 
                                    w
                                    2
                                 
                                 )
                              
                           
                        . Since for some small enough h > 0, the left hand sides of (6) and (7) are equal, it follows that

                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   〈
                                                   
                                                      ∇
                                                      G
                                                   
                                                   f
                                                   
                                                      (
                                                      p
                                                      )
                                                   
                                                   ,
                                                   
                                                      w
                                                      →
                                                   
                                                   〉
                                                
                                                G
                                             
                                             =
                                             
                                                〈
                                                
                                                   ∇
                                                   
                                                      u
                                                      ,
                                                      v
                                                   
                                                
                                                
                                                   f
                                                   ˜
                                                
                                                
                                                   (
                                                   
                                                      u
                                                      0
                                                   
                                                   ,
                                                   
                                                      v
                                                      0
                                                   
                                                   )
                                                
                                                ,
                                                
                                                   w
                                                   →
                                                
                                                〉
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        And, therefore

                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                   →
                                                
                                                T
                                             
                                             G
                                             
                                                ∇
                                                G
                                             
                                             f
                                             
                                                (
                                                p
                                                )
                                             
                                             =
                                             
                                                
                                                   w
                                                   →
                                                
                                                T
                                             
                                             
                                                ∇
                                                
                                                   u
                                                   ,
                                                   v
                                                
                                             
                                             
                                                f
                                                ˜
                                             
                                             
                                                (
                                                
                                                   u
                                                   0
                                                
                                                ,
                                                
                                                   v
                                                   0
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        for each 
                           
                              
                                 w
                                 →
                              
                              ∈
                              
                                 T
                                 p
                              
                              M
                           
                        . This provides a formula for the gradient in terms of the gradient of its corresponding function in the parametrization domain 
                           
                              f
                              ˜
                           
                         and the parametrization S as

                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∇
                                                G
                                             
                                             f
                                             
                                                (
                                                p
                                                )
                                             
                                             =
                                             
                                                G
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                ∇
                                                
                                                   u
                                                   ,
                                                   v
                                                
                                             
                                             
                                                f
                                                ˜
                                             
                                             
                                                (
                                                
                                                   u
                                                   0
                                                
                                                ,
                                                
                                                   v
                                                   0
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Treating the space of functions and the space of fields on the surface as an Hilbert space, one can define inner product between two functions, f and g, as

                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   〈
                                                   f
                                                   ,
                                                   g
                                                   〉
                                                
                                                
                                                   L
                                                   2
                                                
                                             
                                             =
                                             
                                                ∫
                                                Ω
                                             
                                             f
                                             
                                                (
                                                x
                                                )
                                             
                                             g
                                             
                                                (
                                                x
                                                )
                                             
                                             d
                                             a
                                          
                                       
                                    
                                 
                              
                           
                        and the inner product between to vector fields, 
                           
                              F
                              →
                           
                         and 
                           
                              
                                 H
                                 →
                              
                              ,
                           
                         as

                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   〈
                                                   
                                                      F
                                                      →
                                                   
                                                   ,
                                                   
                                                      H
                                                      →
                                                   
                                                   〉
                                                
                                                
                                                   F
                                                   2
                                                
                                             
                                             =
                                             
                                                ∫
                                                Ω
                                             
                                             
                                                F
                                                →
                                             
                                             
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                T
                                             
                                             G
                                             
                                                H
                                                →
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             d
                                             a
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Here, 
                           
                              d
                              a
                              =
                              
                                 
                                    det
                                    G
                                 
                              
                              d
                              u
                              d
                              v
                           
                        .

The divergence is a differential operator that produces a function from a tangent field. It is defined as minus the adjoint operator of the gradient, with respect to the above inner products. That is, the divergence of fields on a manifold, denoted as ∇
                           G
                         ·, satisfies

                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   〈
                                                   
                                                      ∇
                                                      G
                                                   
                                                   ·
                                                   
                                                      F
                                                      →
                                                   
                                                   ,
                                                   g
                                                   〉
                                                
                                                
                                                   L
                                                   2
                                                
                                             
                                             =
                                             −
                                             
                                                
                                                   〈
                                                   
                                                      F
                                                      →
                                                   
                                                   ,
                                                   
                                                      ∇
                                                      G
                                                   
                                                   g
                                                   〉
                                                
                                                
                                                   F
                                                   2
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        for any function g and a field 
                           
                              F
                              →
                           
                         on the surface. By integration by parts and assuming that g vanishes on the boundaries, one can show that the divergence with respect to the metric of a tangent field can be calculated by

                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∇
                                                G
                                             
                                             ·
                                             
                                                F
                                                →
                                             
                                             =
                                             
                                                1
                                                
                                                   
                                                      det
                                                      G
                                                   
                                                
                                             
                                             
                                                ∇
                                                
                                                   u
                                                   ,
                                                   v
                                                
                                             
                                             ·
                                             
                                                (
                                                
                                                   
                                                      det
                                                      G
                                                   
                                                
                                                
                                                   
                                                      F
                                                      ˜
                                                   
                                                   →
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 F
                                 ˜
                              
                              →
                           
                         is the corresponding field of 
                           
                              F
                              →
                           
                         in the parameterization domain.

The Laplacian is a differential operator that maps functions to functions. The Laplacian of functions on the surface is called the Laplace–Beltrami operator and is denoted here as ΔG
                        . It is defined as minus the divergence of the gradient. Thereby, it can be written as

                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                Δ
                                                G
                                             
                                             ·
                                             f
                                             =
                                             
                                                1
                                                
                                                   
                                                      det
                                                      G
                                                   
                                                
                                             
                                             
                                                ∇
                                                
                                                   u
                                                   ,
                                                   v
                                                
                                             
                                             ·
                                             
                                                (
                                                
                                                   
                                                      det
                                                      G
                                                   
                                                
                                                
                                                   G
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∇
                                                   
                                                      u
                                                      ,
                                                      v
                                                   
                                                
                                                
                                                   f
                                                   ˜
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The gradient fields of the coordinate functions with respect to a given metric, ∇
                           G
                        
                        x, ∇
                           G
                        
                        y and ∇
                           G
                        
                        z, define three vector fields that reside in the tangent plane TpM, defined by Su
                         and Sv
                        , about each point s on the surface p ∈ M, see Fig. 5.

The gradient-based deformation method, proposed in [16], first transforms each field locally and arbitrarily, 
                           
                              
                                 ∇
                                 G
                              
                              x
                              
                                 (
                                 p
                                 )
                              
                              →
                              
                                 T
                                 p
                              
                              
                                 (
                                 
                                    ∇
                                    G
                                 
                                 x
                                 
                                    (
                                    p
                                    )
                                 
                                 )
                              
                           
                        . In order to derive the deformed surface, 
                           
                              
                                 S
                                 ˜
                              
                              =
                              
                                 {
                                 
                                    x
                                    ˜
                                 
                                 ,
                                 
                                    y
                                    ˜
                                 
                                 ,
                                 
                                    z
                                    ˜
                                 
                                 }
                              
                              ,
                           
                         whose coordinate-functions gradient fields mostly agree with the manipulated ones in a least-squares sense, the method minimizes the following term for each coordinate function separately

                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∫
                                                S
                                             
                                             
                                                
                                                   ∥
                                                   
                                                      ∇
                                                      G
                                                   
                                                   
                                                      x
                                                      ˜
                                                   
                                                   
                                                      (
                                                      p
                                                      )
                                                   
                                                   −
                                                   
                                                      T
                                                      p
                                                   
                                                   
                                                      (
                                                      
                                                         ∇
                                                         G
                                                      
                                                      x
                                                      
                                                         (
                                                         p
                                                         )
                                                      
                                                      )
                                                   
                                                   ∥
                                                
                                                2
                                             
                                             d
                                             a
                                             
                                                (
                                                p
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        with similar functionals for y and z. Here, da(p) is an area element about the point p ∈ S. The Euler–Lagrange equation of the above functional is the Poisson equation

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                Δ
                                                G
                                             
                                             
                                                x
                                                ˜
                                             
                                             =
                                             
                                                ∇
                                                G
                                             
                                             ·
                                             
                                                (
                                                
                                                   T
                                                   p
                                                
                                                
                                                   (
                                                   
                                                      ∇
                                                      G
                                                   
                                                   x
                                                   )
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        or in surface notation,

                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                Δ
                                                G
                                             
                                             
                                                S
                                                ˜
                                             
                                             =
                                             
                                                ∇
                                                G
                                             
                                             ·
                                             
                                                (
                                                
                                                   T
                                                   p
                                                
                                                
                                                   (
                                                   
                                                      ∇
                                                      G
                                                   
                                                   S
                                                   )
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

This simple method gave birth to a rich family of surface deformation techniques. For example, restricting the deformations to isometries, the set of local transformations 
                           
                              {
                              
                                 T
                                 p
                              
                              }
                           
                         is limited to rotation matrices. In the proposed exaggeration method, we restrict ourselves to simple scalar scaling.

Other linear mesh deformation techniques includes thin-shell [19] and Laplacian-based [20], to name just a few. The paper [21] reviews some of these techniques and compares between them. For a broader overview of these and other related deformation methods, we refer to [22].

Next, we define a model-based framework for relative exaggeration. Let S be the surface of a given object. In addition, assume we are given a bijective map 
                           
                              ϕ
                              :
                              S
                              →
                              
                                 S
                                 ^
                              
                              ,
                           
                         between S and the surface, 
                           
                              
                                 S
                                 ^
                              
                              ,
                           
                         of a given representative average object. Such maps can be obtained by surface registration algorithms like non-rigid ICP with a sparse correspondence [23].

Based on our assumptions, there are two requirements from a caricaturization process: First, it needs to exaggerate the discrepancies from a given model. Second, it needs to be invariant to pose or independent of the embedding. To satisfy the latter, we propose to scale the given surface gradient fields by some function of the absolute Gaussian curvature |K| of the surface S. The choice of the Gaussian curvature, the simplest isometry invariant differential quantity, as an amplification factor makes our method robust to isometries of the surface.

In order to exaggerate the discrepancies from the average model, we choose the following function as a local scaling factor

                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             f
                                             
                                                (
                                                p
                                                )
                                             
                                             =
                                             
                                                
                                                   |
                                                   K
                                                   
                                                      (
                                                      p
                                                      )
                                                   
                                                   |
                                                
                                                
                                                   β
                                                   log
                                                   
                                                      
                                                         d
                                                         a
                                                         (
                                                         p
                                                         )
                                                      
                                                      
                                                         d
                                                         
                                                            a
                                                            ^
                                                         
                                                         
                                                            (
                                                            ϕ
                                                            
                                                               (
                                                               p
                                                               )
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where β is some positive constant, da(p) is an area element about p ∈ S and 
                           
                              d
                              
                                 a
                                 ^
                              
                              
                                 (
                                 ϕ
                                 
                                    (
                                    p
                                    )
                                 
                                 )
                              
                           
                         is the corresponding area element about 
                           
                              ϕ
                              
                                 (
                                 p
                                 )
                              
                              ∈
                              
                                 S
                                 ^
                              
                           
                         - the average representative surface. Note that given ϕ the corresponding area elements can be easily computed by defining a corresponding parametrization.

In warped surface elements where there is no local scaling, that is 
                           
                              d
                              a
                              (
                              p
                              )
                              =
                              d
                              a
                              (
                              ϕ
                              (
                              p
                              )
                              )
                              ,
                           
                         no exaggeration is executed. Regions that were shrank with respect to the reference model will shrink even more, while those that were stretched will stretch more in the proposed method . In the case where no prior average model exists, we could assume, for example, that 
                           
                              log
                              
                                 
                                    d
                                    a
                                    (
                                    p
                                    )
                                 
                                 
                                    d
                                    
                                       a
                                       ^
                                    
                                    
                                       (
                                       ϕ
                                       
                                          (
                                          p
                                          )
                                       
                                       )
                                    
                                 
                              
                              =
                              ϵ
                           
                         and thereby scale the gradient fields by |K|
                           γ
                        , where 
                           
                              γ
                              =
                              ϵ
                              β
                           
                         is some non-negative constant.

In order to find a regular surface whose gradients with respect to the parametrization best fits the scaled ones, we minimize the squared difference between the tangent fields and end up with the following Poisson equation

                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             
                                                Δ
                                                G
                                             
                                             
                                                S
                                                ˜
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∇
                                                G
                                             
                                             ·
                                             
                                                (
                                                f
                                                
                                                   (
                                                   p
                                                   )
                                                
                                                
                                                   ∇
                                                   G
                                                
                                                S
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∇
                                                G
                                             
                                             ·
                                             
                                                (
                                                
                                                   
                                                      |
                                                      K
                                                      
                                                         (
                                                         p
                                                         )
                                                      
                                                      |
                                                   
                                                   
                                                      β
                                                      log
                                                      
                                                         
                                                            d
                                                            a
                                                            (
                                                            p
                                                            )
                                                         
                                                         
                                                            d
                                                            
                                                               a
                                                               ^
                                                            
                                                            
                                                               (
                                                               ϕ
                                                               
                                                                  (
                                                                  p
                                                                  )
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                ∇
                                                S
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Here, 
                           
                              S
                              ˜
                           
                         is the exaggerated surface we are looking for, and the differential operators are taken with respect to the metric of the given surface S (Fig. 6). When there is no reference surface 
                           
                              
                                 S
                                 ^
                              
                              ,
                           
                         the enhancement simplifies to the solution of the following Poisson equation

                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                Δ
                                                G
                                             
                                             
                                                S
                                                ˜
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∇
                                                G
                                             
                                             ·
                                             
                                                (
                                                
                                                   
                                                      |
                                                      K
                                                      |
                                                   
                                                   γ
                                                
                                                
                                                   ∇
                                                   G
                                                
                                                S
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We define two isometric surfaces as parametrized surfaces between which an isometric map exists (see Section 3.1). By construction, the proposed surface enhancement model is robust to isometric transformations. That is, given two isometric surfaces S
                     1 
                     
                        
                      
                     S
                     2, if we can find corresponding surfaces 
                        
                           
                              S
                              ˜
                           
                           1
                        
                      and 
                        
                           
                              S
                              ˜
                           
                           2
                        
                      that satisfy Eq. (20) we also have that 
                        
                           
                              S
                              ˜
                           
                           1
                        
                      
                     
                        
                     
                     
                        
                           
                              S
                              ˜
                           
                           2
                        
                     .

                        Theorem 4.1
                        
                           If the surfaces S
                           1 
                           and S
                           2 
                           are isometric, and there exist two surfaces
                           
                              
                                 
                                    S
                                    ˜
                                 
                                 1
                              
                            
                           and
                           
                              
                                 
                                    S
                                    ˜
                                 
                                 2
                              
                            
                           such that
                           
                              
                                 (21)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∇
                                                   
                                                      G
                                                      1
                                                   
                                                
                                                
                                                   
                                                      S
                                                      ˜
                                                   
                                                   1
                                                
                                                =
                                                
                                                   |
                                                   
                                                      K
                                                      1
                                                   
                                                   |
                                                
                                                
                                                   ∇
                                                   
                                                      G
                                                      1
                                                   
                                                
                                                
                                                   S
                                                   1
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           and
                           
                              
                                 (22)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∇
                                                   
                                                      G
                                                      2
                                                   
                                                
                                                
                                                   
                                                      S
                                                      ˜
                                                   
                                                   2
                                                
                                                =
                                                
                                                   |
                                                   
                                                      K
                                                      2
                                                   
                                                   |
                                                
                                                
                                                   ∇
                                                   
                                                      G
                                                      2
                                                   
                                                
                                                
                                                   S
                                                   2
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           then,
                           
                              
                                 
                                    S
                                    ˜
                                 
                                 1
                              
                            
                           and
                           
                              
                                 
                                    S
                                    ˜
                                 
                                 2
                              
                            
                           are isometric.
                        

By definition, the metric of 
                              
                                 
                                    S
                                    ˜
                                 
                                 1
                              
                            can be written in terms of the Jacobian of the parametrization as

                              
                                 (23)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      G
                                                      ˜
                                                   
                                                   1
                                                
                                                =
                                                
                                                   
                                                      J
                                                      ˜
                                                   
                                                   1
                                                   T
                                                
                                                
                                                   
                                                      J
                                                      ˜
                                                   
                                                   1
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    J
                                    ˜
                                 
                                 1
                              
                            is a matrix whose columns are 
                              
                                 
                                    S
                                    ˜
                                 
                                 
                                    1
                                    u
                                 
                              
                            and 
                              
                                 
                                    S
                                    ˜
                                 
                                 
                                    1
                                    v
                                 
                              
                           .

By writing the gradient of the coordinate functions of 
                              
                                 
                                    S
                                    ˜
                                 
                                 1
                              
                            as functions on the surface S
                           1 explicitly, we get

                              
                                 (24)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∇
                                                   
                                                      G
                                                      1
                                                   
                                                
                                                
                                                   
                                                      S
                                                      ˜
                                                   
                                                   1
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   G
                                                   1
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                ∇
                                                
                                                   
                                                      S
                                                      ˜
                                                   
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   G
                                                   1
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      J
                                                      ˜
                                                   
                                                   1
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Therefore

                              
                                 (25)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      G
                                                      ˜
                                                   
                                                   1
                                                
                                                =
                                                
                                                   ∇
                                                   
                                                      G
                                                      1
                                                   
                                                
                                                
                                                   
                                                      S
                                                      ˜
                                                   
                                                   1
                                                   T
                                                
                                                
                                                   G
                                                   1
                                                
                                                
                                                   G
                                                   1
                                                
                                                
                                                   ∇
                                                   
                                                      G
                                                      1
                                                   
                                                
                                                
                                                   
                                                      S
                                                      ˜
                                                   
                                                   1
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

By plugging relation (21) into the above equation, we get

                              
                                 (26)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   G
                                                   ˜
                                                
                                                1
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   |
                                                
                                                
                                                   K
                                                   1
                                                
                                                
                                                   
                                                      |
                                                   
                                                   2
                                                
                                                
                                                   ∇
                                                   
                                                      G
                                                      1
                                                   
                                                
                                                
                                                   S
                                                   1
                                                   T
                                                
                                                
                                                   G
                                                   1
                                                
                                                
                                                   G
                                                   1
                                                
                                                
                                                   ∇
                                                   
                                                      G
                                                      1
                                                   
                                                
                                                
                                                   S
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   |
                                                
                                                
                                                   K
                                                   1
                                                
                                                
                                                   
                                                      |
                                                   
                                                   2
                                                
                                                ∇
                                                
                                                   S
                                                   1
                                                   T
                                                
                                                ∇
                                                
                                                   S
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   |
                                                
                                                
                                                   K
                                                   1
                                                
                                                
                                                   
                                                      |
                                                   
                                                   2
                                                
                                                
                                                   G
                                                   1
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           By repeating the same derivation for 
                              
                                 
                                    
                                       S
                                       ˜
                                    
                                    2
                                 
                                 ,
                              
                            we similarly obtain

                              
                                 (27)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      G
                                                      ˜
                                                   
                                                   2
                                                
                                                =
                                                
                                                   
                                                      |
                                                      
                                                         K
                                                         2
                                                      
                                                      |
                                                   
                                                   2
                                                
                                                
                                                   G
                                                   2
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Since we assumed that the surfaces S
                           1 and S
                           2 are isometric, the metric and the Gaussian curvatures are equal for corresponding points on the these surfaces. Hence

                              
                                 (28)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   |
                                                
                                                
                                                   K
                                                   1
                                                
                                                
                                                   
                                                      |
                                                   
                                                   2
                                                
                                                
                                                   G
                                                   1
                                                
                                                =
                                                
                                                   
                                                      |
                                                      
                                                         K
                                                         2
                                                      
                                                      |
                                                   
                                                   2
                                                
                                                
                                                   G
                                                   2
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           We can conclude that

                              
                                 (29)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      G
                                                      ˜
                                                   
                                                   1
                                                
                                                =
                                                
                                                   
                                                      G
                                                      ˜
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           which proves that indeed the surfaces 
                              
                                 
                                    S
                                    ˜
                                 
                                 1
                              
                            and 
                              
                                 
                                    S
                                    ˜
                                 
                                 2
                              
                            are isometric.□

Since we minimize the difference between the fields on isometric surfaces, and the divergence is intrinsic, the exaggeration is robust to isometries in a least squares sense. In practice, surfaces which are isometric to one another are rigidly equivalent in the discrete case. However, experimentally, for almost isometric shapes, the isometric deviation of the resulting caricatures, i.e. the Gromov–Hausdorff distance, is negligible.

One possible implementation of the proposed framework is when approximate continuous surfaces by triangulated meshes. In what follows, we briefly review discrete approximations of a continuous function defined on the surface, its gradient, the surface Gaussian curvature, a discrete divergence operator [24], and a discrete Laplace–Beltrami operator [25]. We conclude by combining these elements together for solving the system of equations (20), with some additional constraints that would fix, for example, some surface points as boundary conditions.

For the discretization we use the finite element method (FEM), in which every function f defined on the surface is assumed to be piecewise linear. As such, it can be represented with the piecewise linear basis functions 
                        
                           
                              {
                              
                                 B
                                 i
                              
                              }
                           
                           
                              i
                              
                              
                              =
                              
                              
                              1
                           
                           n
                        
                      as

                        
                           
                              
                                 
                                    
                                       
                                          f
                                          
                                             (
                                             x
                                             )
                                          
                                          =
                                          
                                             ∑
                                             
                                                i
                                                
                                                
                                                =
                                                
                                                
                                                1
                                             
                                             n
                                          
                                          
                                             f
                                             i
                                          
                                          
                                             B
                                             i
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where n is the number of vertices, fi
                      is the value of the function f at the vertex vi
                     , and Bi
                     (x) is a linear B-spline function that is equal to 1 at the vertex vi
                      and 0 at the rest of the vertices. Within each triangle 
                        
                           T
                           =
                           (
                           
                              v
                              i
                           
                           ,
                           
                              v
                              j
                           
                           ,
                           
                              v
                              k
                           
                           )
                           ,
                        
                      
                     f is linearly interpolated only by fi, fj
                     , and fk
                     . It can be shown that the gradient of f within each triangle is constant [25], and given by


                     
                        
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       
                                          ∇
                                          f
                                          
                                             (
                                             T
                                             )
                                          
                                          =
                                          
                                             (
                                             
                                                f
                                                j
                                             
                                             −
                                             
                                                f
                                                i
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      s
                                                      i
                                                   
                                                   −
                                                   
                                                      s
                                                      k
                                                   
                                                   )
                                                
                                                ⊥
                                             
                                             
                                                2
                                                
                                                   A
                                                   T
                                                
                                             
                                          
                                          +
                                          
                                             (
                                             
                                                f
                                                k
                                             
                                             −
                                             
                                                f
                                                i
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      s
                                                      j
                                                   
                                                   −
                                                   
                                                      s
                                                      i
                                                   
                                                   )
                                                
                                                ⊥
                                             
                                             
                                                2
                                                
                                                   A
                                                   T
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where si, sj
                     , and sk
                      are the coordinates of the vertices vi, vj
                     , and vk
                     , respectively, ⊥ denotes the counterclockwise 900 rotation operator in the triangle plane, and AT
                      is the area of the triangle T (Fig. 7
                     ).

There are different computational schemes for locally estimating the Gaussian curvature of a triangulated mesh. See [26] for a review and evaluation. Introduced in [25] is the so called Gauss–Bonnet scheme given by


                     
                        
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       
                                          K
                                          
                                             (
                                             
                                                v
                                                i
                                             
                                             )
                                          
                                          =
                                          
                                             1
                                             
                                                A
                                                i
                                             
                                          
                                          
                                             (
                                             2
                                             π
                                             −
                                             
                                                ∑
                                                
                                                   j
                                                   :
                                                   
                                                      v
                                                      j
                                                   
                                                   ∈
                                                   
                                                      N
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         v
                                                         i
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                θ
                                                j
                                                i
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where Ai
                      is the Voronoi area about the vertex vi
                     , and 
                        
                           θ
                           j
                           i
                        
                     s are the incident angles to the vertex vi
                     . Another scheme, presented in [27], approximates the second fundamental form at each vertex vi
                     . The eigenvalues of the second fundamental form are the principal curvatures, k
                     1 and k
                     2, by which we derive the Gaussian curvature to be 
                        
                           K
                           
                              (
                              
                                 v
                                 i
                              
                              )
                           
                           =
                           
                              k
                              1
                           
                           
                              (
                              
                                 v
                                 i
                              
                              )
                           
                           ·
                           
                              k
                              2
                           
                           
                              (
                              
                                 v
                                 i
                              
                              )
                           
                        
                     . An implementation of this scheme in MATLAB is given in Gabriel Peyre’s Toolbox Graph [28]. We tested both schemes in our experiments.

A discrete
                     
                     
                      formulation of the divergence operator can be derived from the divergence theorem

                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                
                                                   ∫
                                                
                                                
                                                   ∫
                                                
                                                
                                             
                                             A
                                          
                                          ∇
                                          ·
                                          
                                             F
                                             →
                                          
                                          d
                                          a
                                          =
                                          
                                             ∮
                                             
                                                ∂
                                                A
                                             
                                          
                                          
                                             F
                                             →
                                          
                                          ·
                                          
                                             n
                                             ^
                                          
                                          d
                                          l
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           F
                           →
                        
                      is a given vector field, and 
                        
                           n
                           ^
                        
                      is an outward pointing unit vector normal to the boundary. We assume that 
                        
                           F
                           →
                        
                      is constant within each triangle of the mesh, and approximate its divergence at a vertex vi
                      by averaging the divergence over a
                     
                     
                     
                     
                      1-ring neighborhood


                     
                        
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       
                                          v
                                          a
                                          Div
                                          
                                             (
                                             
                                                F
                                                →
                                             
                                             )
                                          
                                          
                                             (
                                             
                                                v
                                                i
                                             
                                             )
                                          
                                       
                                    
                                    
                                       ≅
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                   
                                                      ∫
                                                   
                                                   
                                                      ∫
                                                   
                                                   
                                                
                                                
                                                   
                                                      N
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         v
                                                         i
                                                      
                                                      )
                                                   
                                                
                                             
                                             ∇
                                             ·
                                             
                                                F
                                                →
                                             
                                             d
                                             a
                                          
                                          
                                             
                                                
                                                   
                                                   
                                                      ∫
                                                   
                                                   
                                                      ∫
                                                   
                                                   
                                                
                                                
                                                   
                                                      N
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         v
                                                         i
                                                      
                                                      )
                                                   
                                                
                                             
                                             d
                                             a
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      T
                                                      j
                                                   
                                                   ∈
                                                   
                                                      N
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         v
                                                         i
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                      ∫
                                                   
                                                   
                                                      ∫
                                                   
                                                   
                                                
                                                
                                                   A
                                                   (
                                                   
                                                      T
                                                      j
                                                   
                                                   )
                                                
                                             
                                             ∇
                                             ·
                                             
                                                F
                                                →
                                             
                                             d
                                             a
                                          
                                          
                                             
                                                ∑
                                                
                                                   
                                                      T
                                                      j
                                                   
                                                   ∈
                                                   
                                                      N
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         v
                                                         i
                                                      
                                                      )
                                                   
                                                
                                             
                                             A
                                             
                                                (
                                                
                                                   T
                                                   j
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      T
                                                      j
                                                   
                                                   ∈
                                                   
                                                      N
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         v
                                                         i
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                ∮
                                                
                                                   ∂
                                                   A
                                                   (
                                                   
                                                      T
                                                      j
                                                   
                                                   )
                                                
                                             
                                             
                                                F
                                                →
                                             
                                             ·
                                             
                                                n
                                                ^
                                             
                                             d
                                             l
                                          
                                          
                                             
                                                ∑
                                                
                                                   
                                                      T
                                                      j
                                                   
                                                   ∈
                                                   
                                                      N
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         v
                                                         i
                                                      
                                                      )
                                                   
                                                
                                             
                                             A
                                             
                                                (
                                                
                                                   T
                                                   j
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         T
                                                         j
                                                      
                                                      ∈
                                                      
                                                         N
                                                         1
                                                      
                                                      
                                                         (
                                                         
                                                            v
                                                            i
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         e
                                                         k
                                                      
                                                      ∈
                                                      
                                                         T
                                                         j
                                                      
                                                   
                                                
                                                
                                                   F
                                                   →
                                                
                                                
                                                   (
                                                   
                                                      T
                                                      j
                                                   
                                                   )
                                                
                                                ·
                                                
                                                   e
                                                   k
                                                
                                                
                                                   
                                                      (
                                                      
                                                         T
                                                         j
                                                      
                                                      )
                                                   
                                                   ⊥
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         T
                                                         j
                                                      
                                                      ∈
                                                      
                                                         N
                                                         1
                                                      
                                                      
                                                         (
                                                         
                                                            v
                                                            i
                                                         
                                                         )
                                                      
                                                   
                                                
                                                A
                                                
                                                   (
                                                   
                                                      T
                                                      j
                                                   
                                                   )
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              N
                              1
                           
                           
                              (
                              
                                 v
                                 i
                              
                              )
                           
                        
                      is the 1-ring neighborhood comprised of the triangles incident to vi, A(Tj
                     ) is the area of the triangle Tj
                     , and ek
                     (Tj
                     )⊥ is an outwardly directed vector normal to the kth
                      edge of the triangle Tj
                      with similar length to the edge ek
                     (Tj
                     ).

For discretizing the Laplace–Beltrami operator, we use the cotangent weight scheme for triangulated meshes [25]. We plug the values of a given function at each vertex, 
                        
                           
                              f
                              i
                           
                           =
                           f
                           
                              (
                              
                                 v
                                 i
                              
                              )
                           
                           ,
                        
                      to a vector, and multiply it by 
                        
                           L
                           =
                           
                              A
                              
                                 −
                                 1
                              
                           
                           W
                           ,
                        
                      where A is the diagonal matrix of the Voronoi cell areas about each vertex, as introduced in [29]. W is the classic cotangent weight matrix


                     
                        
                           
                        
                     
                  


                     
                        
                           
                              
                                 
                                    
                                       
                                          
                                             W
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               j
                                                               :
                                                               
                                                                  v
                                                                  j
                                                               
                                                               ∈
                                                               
                                                                  N
                                                                  1
                                                               
                                                               
                                                                  (
                                                                  
                                                                     v
                                                                     i
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            cot
                                                            
                                                               α
                                                               
                                                                  i
                                                                  j
                                                               
                                                            
                                                            +
                                                            cot
                                                            
                                                               β
                                                               
                                                                  i
                                                                  j
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         if
                                                         
                                                         
                                                         i
                                                         =
                                                         j
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         cot
                                                         
                                                            α
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         −
                                                         cot
                                                         
                                                            β
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         
                                                         if
                                                         
                                                         
                                                         i
                                                         ≠
                                                         j
                                                         ,
                                                         
                                                            v
                                                            j
                                                         
                                                         ∈
                                                         
                                                            N
                                                            1
                                                         
                                                         
                                                            (
                                                            
                                                               v
                                                               i
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         
                                                         otherwise,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where αij
                      and βij
                      are the angles opposite to the edge (vi, vj
                     ).


                     Boundary conditions: one limitation of the proposed framework is the fact that the Gaussian curvature is undefined along the boundary of a surface. Still, many real world surfaces, like those acquired by depth sensors, have a boundary. In practice, applying our framework to meshes with boundaries results in shapes with distorted boundaries. We need to specify the boundary of the shapes and to set proper boundary conditions.

In order to find vertices on the boundary of the shape, we query the neighbor triangles of each edge. If an edge is neighbor to a single triangle, it is labeled as a boundary edge. The vertices that comprise this edge are labeled as boundary vertices.

There are various boundary conditions that could apply to the proposed model. Here, we describe three options, other alternatives could be used depending on the application. The boundary can be either hardly or softly constrained.

For hard constraints, we formulate the linear system as the constrained least-squares optimization problem

                        
                           (30)
                           
                              
                                 
                                    
                                       
                                          min
                                          
                                             x
                                             ˜
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             ∥
                                             L
                                          
                                          
                                             x
                                             ˜
                                          
                                          
                                             
                                                −
                                                b
                                                ∥
                                             
                                             A
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                          s.t.
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             
                                                x
                                                ˜
                                             
                                             j
                                          
                                          =
                                          
                                             x
                                             *
                                          
                                          ,
                                          
                                             v
                                             j
                                          
                                          ∈
                                          ∂
                                          S
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           b
                           =
                           Div
                           
                              (
                              
                                 
                                    |
                                    K
                                    |
                                 
                                 γ
                              
                              Grad
                              
                                 (
                                 x
                                 )
                              
                              )
                           
                        
                     . Note that the norm is weighted by the area of the Voronoi cells about any vertex. Therefore, the norm can be written as 
                        
                           
                              
                                 ∥
                                 F
                                 ∥
                              
                              A
                              2
                           
                           =
                           trace
                           
                              (
                              
                                 F
                                 T
                              
                              A
                              F
                              )
                           
                        
                     . The linear equality constraints can be written as 
                        
                           B
                           
                              x
                              ˜
                           
                           =
                           
                              x
                              *
                           
                           ,
                        
                      where B is a sampling matrix, in which each row is zero, besides those that correspond to the constrained vertices. x
                     * is a vector of the final positions of the constrained vertices. Using the Lagrange multipliers approach, the solution to the above problem is given by

                        
                           (31)
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      B
                                                   
                                                
                                                
                                                   
                                                      
                                                         B
                                                         T
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         x
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         λ
                                                         x
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         Div
                                                         (
                                                         |
                                                         K
                                                         
                                                            |
                                                            γ
                                                         
                                                         Grad
                                                         
                                                            (
                                                            x
                                                            )
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                         *
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Similar systems are solved for 
                        
                           y
                           ˜
                        
                      and 
                        
                           z
                           ˜
                        
                     .

For soft constraints, one can add a controllable quadratic term for manipulating the boundary vertices and minimize the following unconstrained optimization problem

                        
                           (32)
                           
                              
                                 
                                    
                                       
                                          min
                                          
                                             x
                                             ˜
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∥
                                             L
                                          
                                          
                                             x
                                             ˜
                                          
                                          
                                             
                                                −
                                                b
                                                ∥
                                             
                                             A
                                             2
                                          
                                          +
                                          μ
                                          
                                             
                                                ∥
                                                B
                                                
                                                   x
                                                   ˜
                                                
                                                −
                                                
                                                   x
                                                   *
                                                
                                                ∥
                                             
                                             A
                                             2
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     The solution to Problem (32) is as follows:

                        
                           (33)
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                             ˜
                                          
                                          =
                                          
                                             
                                                (
                                                L
                                                A
                                                L
                                                +
                                                μ
                                                
                                                   B
                                                   T
                                                
                                                A
                                                B
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             A
                                             L
                                             b
                                             +
                                             μ
                                             A
                                             
                                                B
                                                T
                                             
                                             
                                                x
                                                *
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

The third type of boundary constraints are set by fixing 
                        
                           γ
                           =
                           0
                        
                      on selected triangles. This technique enables keeping some regions fixed throughout the exaggeration.
                     
                     
                     
                     
                  

@&#RESULTS AND DISCUSSION@&#

We evaluate the proposed caricature generation framework by conducting and discussing several example use cases. First, we demonstrate its applicability by caricaturizing a number of synthetic surfaces and captured geometries. Then, we discuss the performance analysis of a real-time implementation of the proposed algorithm. Next, we examine the robustness of the method to almost isometric deformations. We conclude the section by proposing two possible applications.

We demonstrate the power of the self-caricaturization method by applying it to triangulated meshes. The color of the meshes in Figs. 8 and 9, represents the approximated Gaussian curvature at each point. The caricatures of the armadillo model in Fig. 8 and the face in Fig. 9 demonstrate how regions with high Gaussian curvature scale up, whereas, regions with small Gaussian curvature shrank. Regions with approximately constant Gaussian Curvature were scaled uniformly. These caricatures were created using the geometric driven approach. That is, without a reference model (Fig. 10).

We tested our method on faces and shapes with boundaries, see Figs. 9, 11, and 12. A printed three dimensional replica of the shapes in Fig. 12 are presented in Fig. 14. The resulting caricatures demonstrate an exaggeration of unique features and expressions of the subject’s face in a natural comical fashion. The nose was stretched while flat regions like the cheeks, shrank, suggesting the applicability of our method to face recognition (Fig. 13).

As with most mesh deformation techniques, the proposed method may introduce self-intersections, particularly for large exaggeration factors. However, since we solve a Poisson equation, this intersection occurs only globally. Using post-processing self-collision handling methods, such as [30], one can remove these intersections (Table 1).

The algorithm was implemented both in Matlab and in C++. For the C++ version, we used the open source version of Eigen Library [31]. All the experiments were executed on a 2.6 GHz Intel core i7 machine with 8 GB RAM. Run-times for various meshes from TOSCA dataset are shown in Table 1. The pre-processing stage includes calculating the Laplacian matrix, the Gaussian curvature, the gradient of the original shape, and matrices for calculating the discrete divergence efficiently. This stage could be implemented more efficiently and in parallel. The core runtime includes taking the power of the curvature in each triangle, multiplying the gradients fields by |K|
                           γ
                        , and solving the resulting sparse linear system.

To evaluate the robustness of the proposed method to almost isometric deformations of shapes, we applied it to shapes in two different poses. We calculated the histograms of normalized distortion of geodesic distances between corresponding points on the two shapes, before and after exaggeration was applied (see Figs. 15 and 16). The results demonstrate that caricaturizing two almost isometric shapes indeed produces two almost isometric caricatures.

To demonstrate the isometry preservation property, we exaggerated the centaur shape Fig. 4 in two different poses. Figs. 19–21 show examples of exaggerated shapes in various poses for different values for γ.

In order to explore the power of the proposed method on sequences of (naturally nearly isometric) shapes in motion, we generated an artificial motion by linearly interpolating between different poses of the same object. This interpolation was then projected onto the space of isometries by solving a Poisson equation, as described in [32,33]. A video demonstrating the applicability of the proposed framework to animated sequences was produced and is provided in the supplementary material.

A prominent task in shape analysis is the ability of a computer to classify shapes. To facilitate this task we propose to exaggerate the features of the query shapes as a preprocessing step before classification. This idea is justified by an experiment which shows that humans perform better in memorizing and recognizing caricaturized faces than regular ones, [34]. In his book about the human brain, Kurzweil [35] mentions the ability of the brain to recognize the subject behind a caricature. That is, the human pattern recognition ability is robust to some classes of exaggerations.

We now demonstrate the power of caricaturisation in facilitating recognition of shapes undergone various almost isometric deformations. First, we manually sampled corresponding points on quadruped mammals in various poses. We then normalize the shapes and calculate the geodesic distances between the corresponding points. In order to represent each shape as a point in the plane, we applied the Multidimensional Scaling to the geodesic distance matrices. We repeated the process after exaggerating the shapes. The embeddings of the shapes to the plane are presented in Figs. 17 and 18. The exaggeration is shown to separate the mammal classes, making the classification task simpler.

In order to demonstrate the smoothness of the exaggeration factor, we used the proposed caricaturization method for generating some musical video clips. We first construct a look-up table of caricatures for equally sampled values of the exaggeration parameter γ ∈ [0, 1]. For each video frame, we calculate the mean absolute value volume of the audio (sound) within the corresponding time-frame of the song. Then, we find its the closest exaggeration parameter γ in the look-up table and set the video frame to its corresponding rendered caricature. The resulting video clip shows a 3D shape caricaturized in synchronization with the played song that can be animated in real-time as an entertainment feature.

As an alternative to the volume, one can pick the self-exaggeration parameter at each time frame based, for example, on the dominant or median frequency of the sound track. In order for the shape to change temporally in a smooth fashion, we averaged the sound signal by filtering it using a causal low pass filter. The camera position in the shape rendering process can also change in correlation with the music. A video clip demonstrating the proposed application is provided as a supplemental material of this paper.

@&#CONCLUSIONS@&#

We introduced a novel caricature generation framework for surfaces. The method scales the gradient fields of the surface coordinates by a function of the Gaussian curvature of the surface, and solves a corresponding Poisson equation for finding the exaggerated shape. When a reference shape is provided, local discrepancies are used to amplify the scaling effect, while in the absence of a reference shape, the reference is assumed to be a scaled down version of the given one thereby letting the Gaussian curvature define the relative stretch. We justified analytically and demonstrated empirically that the proposed method is invariant to isometries and thus robust to poses, articulations and postures. This important property allows us to apply the same procedure to a shape in motion (articulation, expression, or pose) while keeping the same perceptual identity of the resulting exaggerated figure. The method was applied to faces and shown to emphasize unique features while reducing flat areas with few-flat details. In the future, we plan to explore alternative ways to scale the embedding gradients for providing a richer user-interface for computerized caricature generation.

@&#ACKNOWLEDGEMENT@&#

Model sources include: [37] Barack Obama : by Claudio Gasparini and Autodesk [36]; Athena : by Alex Baranov; Max Planck : by Christian Rssl and Jens Vorsatz of Max-Planck-Institut fr Informatik; Armadillo: Stanford Computer Graphics Laboratory; This work has been supported by grant agreement no. 267414 of the European Community’s FP7-ERC program.

Supplementary material associated with this article can be found, in the online version, at 10.1016/j.cviu.2015.05.013
.


                     
                        
                           
                              Test
                           
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

