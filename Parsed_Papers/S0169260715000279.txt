@&#MAIN-TITLE@&#Method for automatic adjustment of an insulin bolus calculator: In silico robustness evaluation under intra-day variability

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           A novel method that aims to automatically adjust the parameters of a bolus calculator is presented.


                        
                        
                           
                           A novel in silico evaluation under realistic intra-day variability was carried out.


                        
                        
                           
                           The proposed method has the potential to significantly improve glycemic control in diabetes.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Clinical decision support

Diabetes management

Glycaemic control

Insulin dosing

@&#ABSTRACT@&#


               
               
                  Background and objective
                  Insulin bolus calculators are simple decision support software tools incorporated in most commercially available insulin pumps and some capillary blood glucose meters. Although their clinical benefit has been demonstrated, their utilisation has not been widespread and their performance remains suboptimal, mainly because of their lack of flexibility and adaptability. One of the difficulties that people with diabetes, clinicians and carers face when using bolus calculators is having to set parameters and adjust them on a regular basis according to changes in insulin requirements. In this work, we propose a novel method that aims to automatically adjust the parameters of a bolus calculator. Periodic usage of a continuous glucose monitoring device is required for this purpose.
               
               
                  Methods
                  To test the proposed method, an in silico evaluation under real-life conditions was carried out using the FDA-accepted Type 1 diabetes mellitus (T1DM) UVa/Padova simulator. Since the T1DM simulator does not incorporate intra-subject variability and uncertainty, a set of modifications were introduced to emulate them. Ten adult and ten adolescent virtual subjects were assessed over a 3-month scenario with realistic meal variability. The glycaemic metrics: mean blood glucose; percentage time in target; percentage time in hypoglycaemia; risk index, low blood glucose index; and blood glucose standard deviation, were employed for evaluation purposes. A t-test statistical analysis was carried out to evaluate the benefit of the presented algorithm against a bolus calculator without automatic adjustment.
               
               
                  Results
                  The proposed method statistically improved (p
                     <0.05) all glycemic metrics evaluating hypoglycaemia on both virtual cohorts: percentage time in hypoglycaemia (i.e. BG<70mg/dl) (adults: 2.7±4.0 vs. 0.4±0.7, p
                     =0.03; adolescents: 7.1±7.4 vs. 1.3±2.4, p
                     =0.02) and low blood glucose index (LBGI) (adults: 1.1±1.3 vs. 0.3±0.2, p
                     =0.002; adolescents: 2.0±2.19 vs. 0.7±1.4, p
                     =0.05). A statistically significant improvement was also observed on the blood glucose standard deviation (BG SDmg/dL) (adults: 33.5±13.7 vs. 29.2±8.3, p
                     =0.01; adolescents: 63.7±22.7 vs. 44.9±23.9, p
                     =0.01). Apart from a small increase in mean blood glucose on the adult cohort (129.9±11.9 vs. 133.9±11.6, p
                     =0.03), the rest of the evaluated metrics, despite showing an improvement trend, did not experience a statistically significant change.
               
               
                  Conclusions
                  A novel method for automatically adjusting the parameters of a bolus calculator has the potential to improve glycemic control in T1DM diabetes management.
               
            

@&#INTRODUCTION@&#

Type 1 diabetes mellitus (T1DM) is a chronic metabolic disease characterised by an autoimmune destruction of the insulin-secreting beta-cells of the endocrine pancreas. The resulting absolute insulin deficiency results in hyperglycaemia (i.e. high blood glucose). At present, the majority of people with T1DM control their blood glucose levels by drawing blood from the fingertips and measuring glucose concentration with an electronic glucose metre (i.e. self-monitoring of blood glucose) [1], and by administering insulin through multiple daily injections (i.e. basal-bolus therapy) in order to mimic the natural insulin secretion of the pancreatic beta-cells. An alternative therapy to multiple daily injections is provided by continuous subcutaneous insulin infusion (insulin pump therapy), which allows variable basal rates of insulin and avoids uncomfortable injections.

Large intervention trials [2] have shown how tight glycaemic control, avoiding hyperglycaemia, can prevent long term microvascular (retinopathy, nephropathy and neuropathy) and macrovascular (coronary heart disease, stroke and peripheral vascular disease) complications. Such complications place a heavy burden on health services [3]. These trials also reported the associated risk of induced hypoglycaemia that highlights the crucial need for accurate and timely insulin dosage.

In practice, simple rules, mainly based upon empirical experience, are often used by people with T1DM to estimate the necessary amount of insulin. However, these rules fall short in optimising insulin therapy due to the complexity of glucose metabolism.

Insulin bolus calculators [4,5] are simple software tools incorporated in most of the commercially available insulin pumps [6], some blood glucose meters [7], personal digital assistants [8] and smartphones [9], aiming to provide decision support with calculation of insulin boluses. Gross et al [10] demonstrated the clinical benefit of using bolus calculators by reducing the number of correction boluses for elevated glucose levels as well as decreasing the amount of carbohydrates needed to recover from hypoglycaemic episodes. In a paediatric population using insulin pumps, Shashaj et al. [11] demonstrated that the bolus insulin dose calculated using a bolus calculator was more effective in improving pre- and postprandial glycaemic control with fewer correction boluses, without differences in the prandial insulin requirements and without restriction in the carbohydrate content of meals. In a study by Garg et al. [8], an insulin guidance software (ACCU-CHEK(r) Advisor, Roche, Indianapolis, IN) was tested in a crossover study of 12-month duration. The mean HbA1c was significantly lower from 3 to 12 months in the experimental group (p
                        <0.02) and an HbA1c reduction of 0.6% was maintained at 12 months in the experimental group. In a study by Lepore et al. [12], a bolus calculator was demonstrated to improve long-term metabolic control and reduce glucose variability in pump-treated subjects with T1DM. Finally, Barnard and colleagues [13] reported a reduced fear of hypoglycaemia and improved confidence in dosage accuracy in people with T1DM when using bolus calculators.

Although insulin bolus calculators have been proven to be clinically effective, they are still far from being widely used and achieving optimal glycaemic control. Different attempts have been carried out to improve the performance of such calculators [14–17], but thee have had varying success [18]. This is in part due to barriers such as requiring too many capillary blood glucose measurements or not contemplating realistic intra-subject variability. One of the main difficulties that people with diabetes, clinicians and carers face when using bolus calculators is having to set its parameters and adjust them on a regular basis according to changes in insulin requirements.

In this paper we present a novel approach to automatically adjust the parameters of a bolus calculator without requiring any initial tuning. Periodic usage of a continuous glucose monitoring (CGM) [19] device is required for this purpose.

@&#METHODS@&#

The most standard insulin bolus calculator consist of a relatively simple formula that uses subject-specific metabolic parameters to calculate an insulin dose [5]. This is described as
                           
                              (1)
                              
                                 B
                                 =
                                 
                                    CHO
                                    ICR
                                 
                                 +
                                 
                                    
                                       
                                          G
                                          c
                                       
                                       −
                                       
                                          G
                                          sp
                                       
                                    
                                    ISF
                                 
                                 −
                                 IOB
                                 ,
                              
                           
                        where B is the recommended dose of insulin (IU); CHO is the total amount of carbohydrate in the meal (g); ICR is the insulin-to-carbohydrate ratio (g/IU), which describes how many grams correspond to one unit of fast acting insulin; G
                        
                           c
                         is the current capillary blood glucose level (mg/dL); G
                        
                           sp
                         is the blood glucose set-point (mg/dL); ISF is the insulin sensitivity factor (mg/dL/IU), which is a personal relation describing how large a drop in blood glucose one unit of insulin gives rise to; and IOB is the insulin-on-board, which describes the amount of active insulin remaining from previous injections. Various formulas are used to estimate IOB (e.g. linear or curvilinear) [20]. The curvilinear formula employed in this work is described as
                           
                              (2)
                              
                                 IOB
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    B
                                    i
                                 
                                 exp
                                 
                                    
                                       
                                          −
                                          (
                                          t
                                          −
                                          
                                             T
                                             
                                                
                                                   B
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                       τ
                                    
                                 
                                 ,
                              
                           
                        where B
                        
                           i
                         is an administered bolus at time 
                           
                              T
                              
                                 
                                    B
                                    i
                                 
                              
                           
                        , n is the number of boluses previously delivered and τ is a predefined exponential decay constant (e.g. τ
                        =5h).

It is important to remark that parameters ISF and ICR may vary depending on different factors such as circadian rhythms, physical activity levels, hormone cycles, psychological stress, alcohol consumption and recurrent illness. Most of the available bolus calculators contemplate the variation of insulin sensitivity due to circadian rhythms by allowing different values to be set for these parameters along the day. Most recently, some of the most advanced bolus calculators consider the effect of hormone cycles, physical exercise and psychological stress by applying some predefined correction factors to the calculated dose [8].

To adjust the parameters of a bolus calculator, a performance metric is required to evaluate the glycaemic outcome corresponding to the administered insulin bolus. Depending on the available glucose information, different metrics have been proposed. If only capillary measurements are available, the glucose increment between two postprandial data points (e.g. at 90min and 120min) has been employed by Palerm et al. [14]. If continuous glucose monitoring (CGM) data is available, metrics such as area under the curve has been proposed [21]. An important drawback of these metrics is that they require an optimal reference to compare with, which is usually subject and meal dependent, and therefore not always easy to obtain. Furthermore, these metrics require a tuning gain that may also be subject or cohort specific.

In this work, we propose a new metric that uses CGM data and consists of evaluating the minimum postprandial glucose measurement within a predefined postprandial time window (e.g. from 2h to 5h postprandial). If the minimum postprandial glucose value is outside a predefined glycaemic target range (e.g. [80, 140]mg/dL), then an adjustment of the bolus calculator parameters ICR and ISF is required. Such a correction is proportional to the difference between the calculated minimum postprandial glucose value and the centre of the glucose target range, which should correspond to the bolus calculator glucose set-point (G
                        
                           sp
                        ). The main advantage of the proposed metric is that it is more robust for individual and meal variability and does not require any initialisation. The algorithm that implements such a metric is summarised as follows.

The minimum postprandial glucose value in a predefined time window is calculated as
                           
                              (3)
                              
                                 
                                    G
                                    min
                                 
                                 (
                                 k
                                 ,
                                 m
                                 )
                                 =
                                 
                                    min
                                    
                                       t
                                       ∈
                                       [
                                       
                                          t
                                          m
                                       
                                       +
                                       
                                          t
                                          1
                                       
                                       ,
                                       
                                          t
                                          m
                                       
                                       +
                                       
                                          t
                                          2
                                       
                                       ]
                                    
                                 
                                 
                                    G
                                    cgm
                                 
                                 (
                                 t
                                 )
                                 ,
                              
                           
                        where index k denotes the day (i.e. k
                        =1, …, n); index m denotes the meal (i.e. breakfast, lunch or dinner); G
                        
                           cgm
                         are the CGM measurements; t is the time variable; t
                        
                           m
                         is the time of the meal ingestion, t
                        
                           m
                        
                        +
                        t
                        1 and t
                        
                           m
                        
                        +
                        t
                        2 are time instants defining the postprandial time window, where t
                        1
                        <
                        t
                        2. It is important to remark that t
                        2 needs to be less or equal to the time of the next meal intake.

Let us assume that the additional insulin bolus required to bring G
                        
                           min
                         into the predefined glycaemic target range ([G
                        
                           l
                        , G
                        
                           h
                        ]) can be calculated by
                           
                              (4)
                              
                                 
                                    B
                                    add
                                 
                                 (
                                 k
                                 ,
                                 m
                                 )
                                 =
                                 
                                    
                                       (
                                       
                                          G
                                          min
                                       
                                       (
                                       k
                                       ,
                                       m
                                       )
                                       −
                                       
                                          G
                                          sp
                                       
                                       )
                                    
                                    
                                       ISF
                                       (
                                       k
                                       ,
                                       m
                                       )
                                    
                                 
                                 ,
                              
                           
                        where G
                        
                           sp
                         is the bolus calculator glucose set-point calculated as (G
                        
                           h
                        
                        +
                        G
                        
                           l
                        )/2.


                        Fig. 1
                         shows a graphical representation of a post-prandial excursion depicting the variables involved in the proposed metric.

Let us now assume the correlation between ICR and ISF stated in [22] and expressed by
                           
                              (5)
                              
                                 ISF
                                 =
                                 
                                    
                                       1960
                                       ICR
                                    
                                    
                                       2.6
                                       W
                                    
                                 
                                 ,
                              
                           
                        where W is the subject's weight in pounds.

Then, by replacing Eq. (5) into Eq. (1) and isolating ICR, it is possible to calculate the adjusted ICR required to deliver the insulin dose (B
                        +
                        IOB
                        +
                        B
                        
                           add
                        ) that brings G
                        
                           min
                         into the glycaemic target range. That is


                        
                           
                              (6)
                              
                                 ICR
                                 (
                                 k
                                 +
                                 1
                                 ,
                                 m
                                 )
                                 =
                                 
                                    
                                       CHO
                                       (
                                       k
                                       ,
                                       m
                                       )
                                       +
                                       
                                          
                                             
                                                G
                                                c
                                             
                                             (
                                             k
                                             ,
                                             m
                                             )
                                             −
                                             
                                                G
                                                sp
                                             
                                          
                                          
                                             (
                                             1960
                                             /
                                             
                                                2.6
                                                W
                                             
                                             )
                                          
                                       
                                    
                                    
                                       B
                                       (
                                       k
                                       ,
                                       m
                                       )
                                       +
                                       IOB
                                       (
                                       k
                                       ,
                                       m
                                       )
                                       +
                                       
                                          B
                                          add
                                       
                                       (
                                       k
                                       ,
                                       m
                                       )
                                    
                                 
                                 ,
                              
                           
                        where index k
                        +1 denotes the updated value for the next day. The corresponding ISF(k
                        +1, m) is then obtained by applying Eq. 5.

To make the adaptation more robust in front of noise and uncertainty, an average of the current and adjusted ICR is carried out. That is


                        
                           
                              (7)
                              
                                 
                                    ICR
                                    ˆ
                                 
                                 (
                                 k
                                 +
                                 1
                                 ,
                                 m
                                 )
                                 =
                                 
                                    
                                       
                                          ICR
                                          ˆ
                                       
                                       (
                                       k
                                       ,
                                       m
                                       )
                                       +
                                       ICR
                                       (
                                       k
                                       +
                                       1
                                       ,
                                       m
                                       )
                                    
                                    2
                                 
                                 ,
                              
                           
                        with 
                           
                              ICR
                              ˆ
                           
                           (
                           0
                           ,
                           m
                           )
                           =
                           ICR
                           (
                           0
                           ,
                           m
                           )
                        .

To reduce the effect of the sensor noise on the calculation of G
                        
                           min
                        , the CGM measurements (G
                        
                           cgm
                        ) are filtered using a moving average method implemented in the Matlab 2013b smooth function (with span 15) (Matlab 2013b, Mathworks Inc, Natick, MA, USA). It is worth noting that other filtering techniques, such as Kalman filter or Wiener filter, could have been employed for this purpose.

Finally, if additional capillary measurements are available inside the predefined postprandial time window ([t
                        
                           m
                        
                        +
                        t
                        1, t
                        
                           m
                        
                        +
                        t
                        2]), these measurements can be taken into account in the calculation of G
                        
                           min
                         (Eq. (3)) by adding them in the G
                        
                           cgm
                         vector. Also note that if a capillary measurement occurs at the same time of G
                        
                           min
                         inside [t
                        
                           m
                        
                        +
                        t
                        1, t
                        
                           m
                        
                        +
                        t
                        2], then G
                        
                           min
                         can be set to the capillary measurement, which is a more reliable measure of glucose.

The commercial version of the UVa-Padova T1DM simulator [23] was used to evaluate the proposed method for automatic adjustment of an insulin bolus calculator against a bolus calculator without adaptation. 10 adult subjects and 10 adolescent subjects were used for this purpose. The chosen basal insulin infusion rate for the in silico subjects was the one provided by the default insulin therapy of the simulator. The selected CGM and insulin pump models to perform the simulations were the Abbot Freestyle Navigator and Deltec Cozmo. Since the T1DM simulator does not incorporate intra-subject variability and uncertainty, this was emulated by introducing to following modifications to the simulator.

To simulate meal absorption variability, the 10 mixed meal models from each cohort where randomly assigned at each meal intake (i.e. breakfast, lunch and dinner). Meal times and carbohydrate amounts were randomly assigned (uniform distribution) between the ranges shown in Table 1
                           . Uncertainty on the carbohydrate estimation was assumed to be ±20% (uniform distribution) [24].

To emulate diurnal insulin sensitivity variations [25], the parameters V
                           
                              mx
                            and 
                              
                                 k
                                 
                                    
                                       p
                                       3
                                    
                                 
                              
                            
                           [26] of the glucose-insulin model [27] implemented in the simulator were modified as follows


                           
                              
                                 (8)
                                 
                                    p
                                    (
                                    t
                                    )
                                    =
                                    
                                       p
                                       0
                                    
                                    +
                                    
                                       p
                                       0
                                    
                                    ·
                                    K
                                    (
                                    t
                                    )
                                    ·
                                    sin
                                    
                                       
                                          
                                             2
                                             ·
                                             
                                                π
                                                
                                                   24
                                                   ·
                                                   60
                                                
                                             
                                             t
                                             +
                                             2
                                             π
                                             ·
                                             Rnd
                                          
                                       
                                    
                                    ,
                                 
                              
                           where p(t) is the corresponding time varying parameter (i.e. V
                           
                              mx
                            or 
                              
                                 k
                                 
                                    
                                       p
                                       3
                                    
                                 
                              
                           ); p
                           0 is the default parameter value in the simulator; K(t) is a time varying gain and Rnd is a randomly uniformly generated number between 0 and 1. In order to simulate a realistic percentage of time in the glycaemic range [70, 180]mg/dL and realistic ratio between hypoglycaemia and hyperglycaemia in an open-loop therapy [28], the gain K(t) was set as


                           
                              
                                 (9)
                                 
                                    K
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      0.7
                                                   
                                                   
                                                      p
                                                      (
                                                      t
                                                      )
                                                      ≤
                                                      
                                                         p
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                      0.3
                                                   
                                                   
                                                      otherwise
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

To emulate insulin absorption variability, a ±30% variability (randomly uniform) [29] in the parameter 
                              
                                 k
                                 
                                    
                                       d
                                       0
                                    
                                 
                              
                            of the insulin absorption model [27] was assumed.

An uncertainty of ±10% (uniform distribution) was assumed on the capillary blood glucose measurements [30].

Based on evidence obtained from clinical trials evaluating the performance of existing bolus calculators [12], a 3-month duration scenario with the variability and uncertainty described above was employed to evaluate the proposed method against the standard bolus without adaptation. The bolus calculator parameters were adjusted for each one of the three time periods corresponding to breakfast, lunch and dinner (see Table 1). It is important to remark that, in order to make a fair comparison between the standard bolus with and without adaptation, the same sequence of variable and uncertain events was employed (e.g. same sequence of meals). Parameter ICR was initialised to the default value provided in the T1DM simulator. Finally, the simulations were performed using the following tuning parameter values: t
                        1
                        =2h; t
                        2
                        =5h; G
                        
                           l
                        
                        =80mg/dL and G
                        
                           h
                        
                        =140mg/dL. A t-test statistical analysis was carried out to evaluate the benefit of the presented algorithm against a bolus calculator without automatic adjustment.

@&#RESULTS@&#


                     Table 2
                      shows the simulation results comparing of a standard bolus calculator without and with parameters adjustment on a cohort of 10 virtual adults (Table 2a) and on a cohort of 10 virtual adolescents (Table 2b). Mean results are expressed as MEAN±SD.

In summary, the proposed method statistically improved (p
                     <0.05) all glycemic metrics evaluating hypoglycaemia on both virtual cohorts: percentage time in hypoglycaemia (i.e. BG
                     <70mg/dl) (adults: 2.7±4.0 vs. 0.4±0.7, p
                     =0.03; adolescents: 7.05±7.4 vs. 1.3±2.4, p
                     =0.02) and low blood glucose index (LBGI) (adults: 1.1±1.3 vs. 0.3±0.2, p
                     =0.002; adolescents: 2.0±2.2 vs. 0.7±1.4, p
                     =0.05). A statistically significant improvement was also observed on the blood glucose standard deviation (BG SDmg/dL) (adults: 33.5±13.7 vs. 29.2±8.3, p
                     =0.01; adolescents: 63.7±22.7 vs. 44.9±23.9, p
                     =0.01). Apart from a small increase on mean blood glucose (BG) on the adult cohort (adults: 129.9±11.9 vs. 133.9±11.6, p
                     =0.03), the rest of the evaluated metrics, despite showing an improvement trend, did not experience a statistically significant change: mean blood glucose (BGmg/dL) (adolescents: 159.1±16.3 vs. 157.8±19.0, p
                     =0.92); percentage time in target (i.e. [70, 180]mg/dl) (adults: 87.2±13.9 vs. 90.1±8.9, p
                     =0.49; adolescents: 61.7±16.8 vs. 73.3±18.3, p
                     =0.16); percentage time in hyperglycaemia (i.e. BG
                     >180mg/dl) (adults: 10.1±10.5 vs. 9.4±8.8, p
                     =0.92; adolescents:31.2±12.3 vs. 25.3±16.6, p
                     =0.38); high blood glucose index (HBGI) (adults: 2.4±1.8 vs. 2.4±1.5; adolescents: 7.8±3.4 vs. 6.2±4.1, p
                     =0.32) risk index (RI) (adults: 3.6±2.9 vs. 2.7±1.5, p
                     =0.19; adolescents: 9.8±4.9 vs. 6.9±5.4, p
                     =0.28). It is worth noting that the observed increase in mean blood glucose can be explained by the fact that the bolus calculator parameters were initialised with values that were inducing long periods of hypoglycaemia. In order to avoid hypoglycaemia the algorithm appropriately reduces insulin delivery and the mean blood glucose inevitably rises slightly. Therefore, it is difficult to reduce significant hypoglycaemia without slightly increasing mean blood glucose levels.


                     Fig. 2
                      shows a graphical example of a 3-month simulation run of the bolus calculator without and with adaptation mechanism on an adolescent subject. It is worth noting that, with the adaptation mechanism, the blue dots representing the minimum postprandial CGM values (G
                     
                        min
                     ), are more concentrated in the glycaemic target range ([G
                     
                        l
                     , G
                     
                        h
                     ]) than without such mechanism. This is translated into a substantial improvement in glycaemic control.

Finally, Fig. 3
                      displays, for the two virtual cohorts combined, the population mean of percentage time in target (i.e. [70, 180]mg/dL) and the population mean of risk index along the 3-month simulation corresponding to the bolus calculator with parameters adjustment. On average, the proposed technique converges in about 20 days and remains stable along the rest of the simulation.

Based on the presented in silico results, the proposed method to automatically adjust the parameters of a bolus calculator has the potential to improve glycaemic control in T1DM diabetes management. However, it is important to note that, even if realistic intra-day variability and uncertainty has been taken into account, simulation environments tend to over-estimate the benefits of an intervention, since they do not incorporate all the perturbations that may occur in the real world. For this reason, randomised controlled clinical studies are required in order to fully validate the proposed method. It is also important to note that in a real-life setting the utilisation of CGM could be periodical, although it may take longer to converge to an optimal solution. This may be in some cases very important for user acceptance.

The proposed method has been used to simultaneously adjust the insulin-to-carbohydrate ratio and insulin sensitivity factor parameters of a bolus calculator to calculate meal insulin boluses. However, the same methodology could easily be applied to just adjust insulin sensitivity factor when a correction bolus is delivered.

Although the presented technique already distinguishes between different time intervals (i.e. breakfast, lunch and dinner) to cope with intra-day variations in insulin sensitivity, it cannot deal with perturbations such as physical exercise, recurrent illness or stress. In order to cope with such perturbations, the case-based reasoning approach proposed in [21] could be employed.

Long-term research goals in diabetes management include the development of technology such as the artificial pancreas [31], which is intended to totally, or partially, remove the subject with diabetes from the decision-making process, so that insulin dosing can be calculated and administered with no user intervention. However, despite significant progress [28], it will be many years until this technology becomes a reality and it may not be suitable everybody (e.g. lack of acceptability) [32]. It is worth remarking that the artificial pancreas is unique in taking responsibility for glucose concentrations, and it is this transfer of trust that makes it different from a bolus calculator, which just provides an advice that can be accepted or not by the user. Thus, even with an artificial pancreas, people relying on basal-bolus insulin therapy will still need to be supported in making complex therapeutic decisions such as calculating the right insulin doses. Furthermore, many artificial pancreas systems will have pre-meal boluses computed with bolus calculators, so methods as the one considered here will remain relevant. Therefore, there is a clear need to improve the performance of existing insulin bolus calculators, as it has been proposed in this work.

Nick Oliver has received honoraria for advisory roles from Abbott Diabetes.

@&#ACKNOWLEDGMENTS@&#

This work has been financially supported by the Wellcome Trust and by the National Institute for Health Research (NIHR) comprehensive biomedical research centres (BRCs) in England. J. Bondia acknowledges Generalitat Valenciana for the mobility grant BEST/2014/037 at Centre for Bio-inspired Technology, Imperial College London.

@&#REFERENCES@&#

