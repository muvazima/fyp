@&#MAIN-TITLE@&#ROI image retrieval based on multiple features of mean shift and expectation–maximisation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An image retrieval by using MS and EM to adaptively change the location and scale of the region of interest (ROI).


                        
                        
                           
                           EM-like merged into the colour and spatial features to detect the scale and position of the ROI.


                        
                        
                           
                           A novel similarity measure based on the colour and spatial histograms over the lattice structure.


                        
                        
                           
                           Huge speed up the EM-like iteration due to the proposed similarity measure.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image retrieval

Mean shift

EM

Colour histogram

Spatial distribution

@&#ABSTRACT@&#


               
               
                  In this paper, a novel region of interest (ROI) query method is proposed for image retrieval by combining a mean shift tracking (MST) algorithm and an improved expectation–maximisation (EM)-like (IEML) method. In the proposed combination, the MST is used to seek the initial location of the target candidate model and then IEML is used to adaptively change the location and scale of the target candidate model to include the relevant region and exclude the irrelevant region as far as possible. In order to improve the performance and effectiveness using IEML to track the target candidate model, a new similarity measure is built based on spatial and colour features and a new image retrieval framework for this new environment is proposed. Extensive experiments confirm that compared with the latest developed approaches, such as the generalized Hough transform (GHT) and EM-like tracking methods, our method can provide a much better performance in effectiveness. On the other hand, for the IEML, the new similarity measure model also substantially decreases computational complexity and improves the precision tracking of the target candidate model. Compared with the conventional ROI-based image retrieval methods, the most significant highlight is that the proposed method can directly find the target candidate model in the candidate image without pre-segmentation in advance.
               
            

@&#INTRODUCTION@&#

Image databases can be queried in many ways. So far, the region of interest, i.e. (ROI)-based query, among these is the most common method in research prototypes and commercial products [1,4,9,12–14,19,22]. Typically a query image contains not only the ROIs but also other irrelevant areas. These irrelevant regions limit the effectiveness of content-based image retrieval (CBIR) systems. For an ROI-based query method, a user constructs a query by selecting a target model from a given image. Then the method extracts the features of the target model and compares them with the features of the target candidate model based on a built similarity measure. After that, the method shows the database images, which contain a region most similar to the target model, to the user. As mentioned above, key problem for ROI-based query method is how to extract the features of the relevant region from the current image.

Existing CBIR techniques are not effective in processing ROI-based queries. Exclusion of irrelevant regions is not possible for whole-matching approaches based on the entire image, because the features of the entire image area are integrated into one or several global feature vectors. Local-matching approaches are useful if similarity can be quantified over each corresponding homogeneous image region. Approaches such as these are known as region-based. Each image is segmented into several regions and image matching proceeds by comparing visual features. Though this approach has some advantages, its effectiveness depends on image pre-segmentation techniques.

Recently, many ROI-based query methods have been developed, which include one method based on a conventional colour histogram (CCH) [2] and another based on the fuzzy colour histogram (FCH) [3]. These ROI query methods adopt hierarchical overlapping segmentation to partition the current image into several overlapping blocks. And both methods compare the colour histogram of the target model to one of each overlapping block to cut off the target candidate model from the current image. The disadvantage of both of these methods is that it is quite difficult to control exactly the hierarchical levels. Vu et al. [1] adopted a sampling-based approach (called SamMatch) to implement the ROI query. This method takes samples of 
                        16
                        ×
                        16
                     -pixel blocks at various locations in each image and assumes that this size of block is chosen since the correlation between pixels tends to decrease beyond 15 to 20 pixels. The method, however, has not considered the rotation of the ROI. In addition, all these aforementioned methods partition each database image into overlapping regions of several sizes, and assume that the query image has the same size as one of the overlapping regions. Nevertheless, the users may give arbitrarily sized query images. Hence, these methods cannot adaptively decide the size of the ROI.

Chan et al. [4] proposed an image retrieval method based on colour variance among adjacent objects (CVAAO), which determines the location and size of the ROI in the current image through features such as shape, area, and position of the largest object, and then cuts off the ROI from the image. The method is also compared to some conventional methods such as CCH, FCH, and SamMatch and confirms it outperforms these conventional methods. One of the latest and better researches is region-based object retrieval using the GHT and adaptive image segmentation proposed in [20], which claims that the GHT gives good performance in terms of retrieval accuracy, robustness, and execution speed. Godec et al. [26] proposed a novel tracking-by-detection approach based on the GHT and show that the GHT-based method can be used to better segment an image and then track the target object, however, the drawback is a higher computational complexity.

Furthermore, in the latest decade the MST algorithm has become a popular one due to its simplicity and efficiency. Mean shift is a nonparametric density estimator which iteratively computes the nearest mode of a sample distribution. After it was introduced to the field of computer vision, mean shift has been adopted to solve various problems, such as image filtering, segmentation [7,31] and object tracking [8,32,11,15,27–30]. While the performance of mean shift is promising, various articles have raised concerns about its drawbacks related to the scale and shape of the kernel. For instance, the biggest drawback is that traditional mean shift tracking maintains a constant scale while tracking the target candidate model. Against this drawback, in recent years a number of improved MST algorithms have been presented, which are devoted to investigating an adaptive scale change of the target candidate object during tracking. Amid those methods, the two, most highlighted methods are the EM-like algorithm [6,23] and the CAMShift algorithm [10,33–36], which efficiently solve the mode location and scale of the target candidate model in the process of tracking.

For the traditional ROI-based image retrieval methods mentioned above, in order to avoid completely depending on the pre-segmentation of an image prior to matching a target candidate model, in this paper we present a novel framework, which is motivated by the EM-like algorithm and the CAMShift algorithm. Both of these are used to adaptively change the location and scale of the target candidate model, i.e., once an initial location and scale of the target candidate model are given, the optimum mode and scale of this target candidate model must be achieved after the EM-like or CAMShift algorithm has been iterated several times. This implies that if a rough initial location and scale of the target candidate model can be provided in a current image, then the optimum location and scale must be achieved by using either EM-like or CAMShift method. The former is discussed in this paper and our experimental results confirm this assumption to be correct. Based on this idea, our framework is proposed as follows (see Fig. 1
                     ).

Given a target model 
                        
                           
                              Q
                           
                           
                              t
                           
                        
                     , for each image in the database it is a fact that it probably either contains or does not contains 
                        
                           
                              Q
                           
                           
                              t
                           
                        
                     . Since the candidate image 
                        
                           
                              I
                           
                           
                              c
                           
                        
                      is systematically read into the memory image by image, the image data set can be seen as audio video interleave (AVI) or video and each image amid that can be seen as a frame. Firstly, 
                        
                           
                              I
                           
                           
                              c
                           
                        
                      is simply partitioned into a few of sub-blocks according to 
                        
                           
                              Q
                           
                           
                              t
                           
                        
                     . Secondly, the scale window 
                        
                           
                              Q
                           
                           
                              t
                           
                        
                      is slid over these sub-blocks of 
                        
                           
                              I
                           
                           
                              c
                           
                        
                      to find the sub-block most similar to 
                        
                           
                              Q
                           
                           
                              t
                           
                        
                     . Thirdly, the most similar sub-block is taken as the target candidate model and denoted as 
                        
                           
                              Q
                           
                           
                              c
                           
                        
                     , the centroid and size of 
                        
                           
                              Q
                           
                           
                              c
                           
                        
                      are looked at as the rough initial location and scale of the MST and the IEML. Finally, the IEML is used to find the optimum location and scale of 
                        
                           
                              Q
                           
                           
                              c
                           
                        
                      and the similarity measure is calculated between 
                        
                           
                              Q
                           
                           
                              t
                           
                        
                      and the optimum 
                        
                           
                              Q
                           
                           
                              c
                           
                        
                     .

Note that each image in the database must contain such a sub-block that is most similar to the target model; therefore this block is taken as the rough initial target candidate model. By using the MST and IEML to iterate the rough initial candidate model, a much better target candidate model is achieved (in this paper, the iterative numbers of both the MST and the IEML are up to 6). Finally the similarity measure between the target model and the target candidate model is calculated. For the image data set, all image similarity measures are sorted and those images are displayed to the user with respect to the top similarity measures.

In summary, the proposed framework includes four major steps as follows: firstly, a simple image partition method is used to seek the rough initial location of the target candidate model; then, based on the rough initial location and scale, the IEML, which combines the colour and spatial features, is applied to optimize the location and scale of the target candidate model. Thirdly, the similarity measure between the target model and the target candidate model is defined, calculated and saved. Finally, according to the similarity measures' ranking, images containing the target candidate model most similar to the target model are exhibited to the user.

This paper provides three contributions as follows: the first is that a new framework, in which the MST and the IEML are combined to match the target model with its candidate model over the current image, is proposed. The second is a new colour histogram based on the lattice structure over an elliptical region, which efficiently speeds up the EM-like iteration. The third is that a spatial histogram is integrated into the EM-like procedure, which promotes the robustness of the EM-like tracking algorithm. Moreover, the proposed method also provides a research clue for the salient region detection proposed in [16–18], which recently has become a hot research area in image processing.

For this proposed framework there are two challenges to be solved: the first is to seek the rough initial location of the target candidate model, and the second is to define a new similarity measure to decrease the computational complexity and improve the precision using the EM-like to track the target candidate model.

The remainder of this paper is organised as follows. Section 2 introduces the new framework. Section 3 presents the representation of the target model and the target candidate model. In Section 4, ROI-based image retrieval with MST and IEML is described. In Section 5, experiments are carried out and compared with the GHT. The concluding remarks are given in Section 6.

Here, a completely novel framework is presented for ROI-based image retrieval as follows:
                        
                           Step 1.
                           Make some selections, such as a target image, a target model and a query image database, and then submit these selections to our system, as Fig. 1 shows.

The system reads an image into the memory from the specified database, and uses the image partition method to find the initial point of the target candidate model by computing the Bhattacharyya coefficient between the target model and the target candidate model, as Figs. 1(a) and (b) show.

Based on the initial point above, the system uses the two methods MST and IEML to adaptively change the candidate model, as Figs. 1(c), (d), (e) and (f) show.

Calculate the similarity measure between the elliptical region of the target model, as Fig. 1(2) shows, and one of the target candidate models as in Fig. 1(f) with the colour and spatial features.

Save the similarity measure into an array.

Loop Step 2 to Step 6 until each image in the database has been traversed and processed.

Sort the array of all similarity measures, and return the 24 images regarding the top 24 similarity measures.

In this section, in order to carry out the proposed framework, a new colour histogram model, which is exactly limited to the lattice structure of an elliptical region of the ROI, is presented to decrease the computational complexity of the whole rectangular region of the ROI in [6]. Meanwhile, to merge the spatial information of the ROI into the EM-like method, a new spatial histogram is also investigated based on the lattice structure of the elliptical region of the ROI.

Similar to [6], in this paper for the colour feature, the colour histogram is to be quantified into 
                           8
                           ×
                           8
                           ×
                           8
                         bins in the RGB space but in the Hue-Saturation-Value (HSV) space the objects are represented using 
                           8
                           ×
                           8
                         bins to be more robust to the light effects. The two colour histograms are very popular and effective. The former is sensitive to the light effects but the latter is not.

In order to facilitate computation during adaptively changing the location and scale of the target candidate model, the elliptical region of the target model and the target candidate model is latticed as shown in as Fig. 1. The centre of the elliptical region is taken as pole and a polar coordinate system can be set up. From inward to outward, a series of ellipses with different sizes are drawn with equal ratio increment Δρ along the polar axis; on the other hand the polar axis is rotated by the same angle increment Δθ in a clockwise direction. Then, a lattice distribution is constructed and each crossing point on the lattice structure is assigned an index. As Fig. 2
                         shows, each crossing point 
                           (
                           
                              
                                 ρ
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 i
                              
                           
                           )
                         may be transformed into the corresponding Cartesian coordinate 
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           )
                         over the elliptical region of the ROI, which in fact denotes a pixel position in the current image. Denote these pixel positions to be
                           
                              (1)
                              
                                 P
                                 =
                                 
                                    {
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    |
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                    }
                                 
                              
                           
                         where N is the number of crossing points on the lattice structure. Fig. 2 shows an instance where the target candidate model is latticed, and all cross points on the lattice structure are to be used for representing the target candidate model. Furthermore, Fig. 3
                         shows the effectiveness when a lattice structure of a target candidate model is projected onto the target candidate model.

MPEG-7 has done considerable work in designing efficient descriptors for these features for applications such as similarity retrieval. For this paper it seems to be a good choice that the dominant colour descriptor is used in describing the colour feature of ROI to enhance the application interoperability. However, in order to compute the dominant colour descriptor, the colours present in a given image or region are first clustered [37–40] but this leads to a much higher computational complexity. We define our colour histogram similarly to the colour histograms in [5–9]. However, compared with the former, our colour histogram is defined based on the lattice structure of the target candidate model; therefore, it is easy to see that during the EM-like iteration it substantially reduces the computational complexity.

The feature u representing the colour of the target model is assumed to have a density function 
                           
                              
                                 q
                              
                              
                                 u
                              
                           
                        , while the candidate model centred at location y has the distribution 
                           
                              
                                 p
                              
                              
                                 u
                              
                           
                           (
                           y
                           )
                         for the feature u. Tracking a target is equivalent to finding the position where the Bhattacharyya coefficient 
                           ρ
                           (
                           y
                           )
                         is maximised. The Bhattacharyya coefficient is defined as follows:
                           
                              (2)
                              
                                 ρ
                                 (
                                 y
                                 )
                                 =
                                 
                                    [
                                    
                                       
                                          q
                                       
                                       
                                          u
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          u
                                       
                                    
                                    (
                                    y
                                    )
                                    ]
                                 
                                 =
                                 
                                    ∑
                                    
                                       u
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             u
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       y
                                       )
                                       )
                                    
                                 
                              
                           
                         where m is the number of bins of the colour histogram and 
                           8
                           ×
                           8
                           ×
                           8
                         for the RGB colour space or 
                           8
                           ×
                           8
                         for the HSV colour space in this paper, and u the index with respect to each bin. 
                           p
                           (
                           y
                           )
                         and q stand for the colour histogram of the candidate (located at y) and target model respectively. Let b be a function that maps a pixel to its histogram bin. A kernel k is centred at the target model and a weighted colour histogram is computed as follows:
                           
                              (3)
                              
                                 
                                    
                                       q
                                    
                                    
                                       u
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          N
                                       
                                       
                                          q
                                       
                                    
                                 
                                 k
                                 
                                    (
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                                
                                                   q
                                                
                                             
                                             h
                                          
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 δ
                                 
                                    [
                                    b
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                          
                                             q
                                          
                                       
                                       )
                                    
                                    −
                                    u
                                    ]
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       p
                                    
                                    
                                       u
                                    
                                 
                                 (
                                 y
                                 )
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          N
                                       
                                       
                                          p
                                       
                                    
                                 
                                 k
                                 
                                    (
                                    
                                       
                                          ‖
                                          
                                             
                                                y
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                             h
                                          
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 δ
                                 
                                    [
                                    b
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                          
                                             p
                                          
                                       
                                       )
                                    
                                    −
                                    u
                                    ]
                                 
                              
                           
                         where 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         are normalization constants which make 
                           
                              
                                 q
                              
                              
                                 u
                              
                           
                         and 
                           
                              
                                 p
                              
                              
                                 u
                              
                           
                           (
                           y
                           )
                         integrate 1, 
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 q
                              
                           
                         and 
                           
                              
                                 N
                              
                              
                                 q
                              
                           
                         are the position of pixel i and the number of pixels over the lattice structure of the target model respectively, and 
                           
                              
                                 x
                              
                              
                                 j
                              
                              
                                 p
                              
                           
                         and 
                           
                              
                                 N
                              
                              
                                 p
                              
                           
                         are the position of pixel j and the number of pixels over the lattice structure of the target candidate model respectively. δ is the Kronecker delta function, which is defined as
                           
                              (5)
                              
                                 δ
                                 (
                                 x
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             if
                                             
                                             x
                                             =
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             otherwise
                                          
                                       
                                    
                                 
                              
                           
                         
                        h is the radius of the kernel profile. The kernel ensures that pixels closer to the centre are given a higher weight than pixels at the periphery of the object window.

Later experiments show that compared with the colour histogram and similarity measured in literature [6] the proposed colour histograms and similarity measure based on the lattice structure have been significantly improved in the computational complexity. In this paper experiments carried out show that the IEML's time is less than one third of the EM-like's, while both iteration numbers are taken as 6. Obviously, the computational complexity for the IEML also depends on the lattice structure division.

In MPEG-7, the colour structure descriptor (CSD) is designed to express local colour structure in an image or region using an 
                           8
                           ×
                           8
                        -structure element [37]. It counts the number of times a particular colour is contained within the structuring element as the structuring element scans the image. However, since CSD is used for the 
                           8
                           ×
                           8
                        -structure element in order to describe the colour spatial distribution for an image or region, obviously it is inflexible to describe an irregular region, especially the elliptical region in our paper. We investigate the way to construct a spatial histogram based on the lattice of the ROI. Suppose the colour space is divided into M bins, the lattice includes N pixels, and pixel i over the lattice is expressed by 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        . Also, let Z be the set of all N data points over the lattice and r their mean location [25].
                           
                              (6)
                              
                                 r
                                 =
                                 
                                    1
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                              
                           
                         It is well known that each pixel over the lattice is classified into a bin according to function 
                           b
                           (
                           x
                           )
                        , and let 
                           
                              
                                 r
                              
                              
                                 m
                              
                           
                         be the mean location of these pixels belong to bin m
                        
                           
                              (7)
                              
                                 
                                    
                                       r
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       
                                          N
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 δ
                                 
                                    (
                                    b
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    m
                                    )
                                 
                              
                           
                         where 
                           
                              
                                 N
                              
                              
                                 m
                              
                           
                         is the number of pixels over the lattice belonging to bin m.
                           
                              (8)
                              
                                 
                                    
                                       r
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       r
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    1
                                    N
                                 
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 δ
                                 
                                    (
                                    b
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    m
                                    )
                                 
                              
                           
                         
                        
                           
                              
                                 r
                              
                              
                                 T
                              
                           
                         is the total variance that N points over the lattice are mapped into M bins. For each, 
                           
                              
                                 r
                              
                              
                                 m
                              
                           
                         is normalized as follows:
                           
                              (9)
                              
                                 r
                                 (
                                 m
                                 )
                                 =
                                 
                                    
                                       r
                                    
                                    
                                       m
                                    
                                 
                                 /
                                 
                                    
                                       r
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 
                                 m
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 M
                              
                           
                         Obviously, 
                           
                              
                                 ∑
                              
                              
                                 m
                                 =
                                 1
                              
                              
                                 M
                              
                           
                           r
                           (
                           m
                           )
                           =
                           1
                        . So, corresponding to the colour histogram 
                           q
                           (
                           m
                           )
                         over the lattice, a spatial histogram 
                           r
                           (
                           m
                           )
                         which describes the spatial feature of colour distribution of the ROI, is defined over the lattice and owns the same properties as the colour histogram. For the spatial histogram, the Bhattacharyya coefficient can be defined as
                           
                              (10)
                              
                                 θ
                                 (
                                 y
                                 )
                                 =
                                 
                                    [
                                    s
                                    
                                       
                                          q
                                       
                                       
                                          m
                                       
                                    
                                    ,
                                    s
                                    
                                       
                                          p
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    y
                                    )
                                    ]
                                 
                                 =
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       (
                                       s
                                       
                                          
                                             q
                                          
                                          
                                             m
                                          
                                       
                                       s
                                       
                                          
                                             p
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       y
                                       )
                                       )
                                    
                                 
                              
                           
                         where 
                           s
                           
                              
                                 q
                              
                              
                                 m
                              
                           
                           ,
                           s
                           
                              
                                 p
                              
                              
                                 m
                              
                           
                           (
                           y
                           )
                         are the spatial histogram of the target model and one of the target candidate models respectively. Fig. 4
                         shows that using the IEML truly achieves a much better effectiveness than that of the EM-like.

In this section, we introduce a new framework with MST and IEML, referred to as MSIEM, into ROI-based image retrieval. One of the highlights is that multiple features are merged into the EM-like. The EM-like with multiple features (IEML) will sufficiently enhance the robustness and the precision of tracking the target candidate model. Especially, when two objects or many similar objects appear in an image, most ROI-based algorithms randomly match one object and drop the others. However, the MSIEM always seeks the optimum target candidate model. The proposed MSIEM consists two major stages as follows:
                        
                           1.
                           Stage 1 is to seek a rough initial location and scale of the target candidate model in the current image; this is carried out by the traditional MST.

Stage 2 is to iteratively and adaptively change the initial location and scale of the target candidate model by using IEML in the current image; this stage does not end until a given iterative condition for the IEML is satisfied. Here the iterative number is taken as 6.

Given an image I, divide it into arbitrary blocks, which depend on a user's requirement. Here, we choose to divide an image into four blocks and calculate their colour histograms as Fig. 5
                        (a) shows. The similarity between each sub-block and the target model is measured by the Bhattacharyya coefficient metric. The sub-block with the largest similarity as Fig. 5(b) shows is assumed to be the approximate position of the candidate model. The centroid coordinate of this sub-block is passed to the IEML algorithm as its initial position. The IEML is used to find the new location and scale of the target candidate model. The position is finally obtained where the Bhattacharyya coefficient is the largest in the whole candidate image. Looking at Fig. 5, an image is divided into four sub-blocks and the Bhattacharyya coefficient of each sub-block is calculated with respect to the target model. Bhattacharyya coefficients of the four sub-block are 
                           0.4439
                           ,
                           0.6092
                           ,
                           0.3259
                        , and 0.4427 respectively. Obviously, we would like to select sub-block 2 as the initial iteration window. Next, MST is used to adjust the scale window and the Bhattacharyya coefficient is attained at 0.74282, at the location of Fig. 5(c). The centroid and size of the scale window are taken as the initial location and scale of the IEML; further more the IEML is used to adaptively change its location and scale until the iterative condition is satisfied.

In order to adaptively change the initial location and scale of the target candidate model, let 
                           
                              
                                 q
                              
                              
                                 u
                              
                           
                        , 
                           s
                           
                              
                                 q
                              
                              
                                 u
                              
                           
                        , 
                           p
                           
                              
                                 (
                                 y
                                 )
                              
                              
                                 u
                              
                           
                        , 
                           s
                           p
                           
                              
                                 (
                                 y
                                 )
                              
                              
                                 u
                              
                           
                         be the colour histogram and spatial histogram of the target model and the target candidate model respectively; y is the initial location of the target candidate model. The Bhattacharyya coefficients of the colour histograms and the spatial histograms between the target model and the target candidate model are denoted as 
                           
                              
                                 ρ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 ρ
                              
                              
                                 2
                              
                           
                         respectively.
                           
                              (11)
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       u
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             u
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       y
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       u
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       s
                                       
                                          
                                             q
                                          
                                          
                                             u
                                          
                                       
                                       s
                                       
                                          
                                             p
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       y
                                       )
                                    
                                 
                              
                           
                         Here, a novel similarity measure with colour and spatial features is defined as:
                           
                              
                                 ρ
                                 (
                                 y
                                 )
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                 
                                 ×
                                 
                                    
                                       ρ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         Using a Taylor expansion around the values 
                           s
                           
                              
                                 p
                              
                              
                                 u
                              
                           
                           (
                           
                              
                                 y
                              
                              
                                 0
                              
                           
                           )
                         and 
                           
                              
                                 p
                              
                              
                                 u
                              
                           
                           (
                           
                              
                                 y
                              
                              
                                 0
                              
                           
                           )
                        , the Bhattacharyya coefficient is approximated by (see Appendix A):
                           
                              (13)
                              
                                 ρ
                                 (
                                 y
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             ρ
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    2
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 K
                                 (
                                 ⁎
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             ρ
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    2
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 K
                                 (
                                 ⁎
                                 )
                              
                           
                         In (13) 
                        
                           K
                           (
                           ⁎
                           )
                         is a kernel function and
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 =
                                 
                                    ∑
                                    u
                                 
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             u
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                u
                                             
                                          
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                    
                                 
                                 δ
                                 
                                    (
                                    b
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    u
                                    )
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 =
                                 
                                    ∑
                                    m
                                 
                                 
                                    
                                       
                                          s
                                          
                                             
                                                q
                                             
                                             
                                                u
                                             
                                          
                                       
                                       
                                          s
                                          
                                             
                                                p
                                             
                                             
                                                u
                                             
                                          
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                    
                                 
                                 δ
                                 
                                    (
                                    b
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    m
                                    )
                                 
                              
                           
                         Maximising (13) is equivalent to maximising 
                           
                              
                                 w
                              
                              
                                 i
                              
                              
                                 (
                                 1
                                 )
                              
                           
                           +
                           
                              
                                 w
                              
                              
                                 i
                              
                              
                                 (
                                 2
                                 )
                              
                           
                        . One intuitive interpretation for this result is that the overall MS vector is obtained by weighting each MS components with the Bhattacharyya coefficient. Therefore, the higher coefficient suppresses the other shift vector so that it can be maximised prior to other operations. 
                           
                              
                                 w
                              
                              
                                 i
                              
                              
                                 (
                                 1
                                 )
                              
                           
                         describes the weight of the colour features and 
                           
                              
                                 w
                              
                              
                                 i
                              
                              
                                 (
                                 2
                                 )
                              
                           
                         that of the spatial features. As Eq. (13) shows, the IEML algorithm can retrieve not only similar colour regions, but also similar spatial structure regions.

In this subsection, we show an algorithm which adaptively changes the location and scale of the target candidate model. We assume that the shape of the target candidate model is approximated by an elliptical region in an image. Initially the target model is selected manually or detected using some other algorithm, and then the target model is approximated to an elliptical region by using the affine transformation, as Fig. 1(2) shows. Let 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 →
                              
                           
                         denote pixel i over the lattice structure of the elliptical region of the target candidate model and 
                           
                              
                                 θ
                              
                              
                                 →
                              
                           
                         the centroid of the elliptical region. The second order moment can be used to approximate the shape of the target candidate model:
                           
                              (14)
                              
                                 
                                    
                                       θ
                                    
                                    
                                       →
                                    
                                 
                                 =
                                 
                                    1
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       →
                                    
                                 
                                 ;
                                 
                                 V
                                 =
                                 
                                    1
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 N
                                 (
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       →
                                    
                                 
                                 −
                                 
                                    
                                       θ
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             →
                                          
                                       
                                       −
                                       
                                          
                                             θ
                                          
                                          
                                             →
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                              
                           
                         The second-order moment V which includes scale and orientation is symmetric and positive. The 
                           
                              
                                 θ
                              
                              
                                 →
                              
                           
                         and V could represent an arbitrary elliptical region. The 
                           
                              
                                 scale
                              
                              
                                 x
                              
                           
                         and 
                           
                              
                                 scale
                              
                              
                                 y
                              
                           
                         are scaling and skew is the skew transformation obtained by using the unique Cholesky factorization.
                           
                              (15)
                              
                                 V
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      scale
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                             
                                                
                                                   skew
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      scale
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       T
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   scale
                                                
                                                
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                skew
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   scale
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                         If each data point has multiple weight factors 
                           
                              
                                 w
                              
                              
                                 i
                              
                              
                                 (
                                 1
                                 )
                              
                           
                           +
                           
                              
                                 w
                              
                              
                                 i
                              
                              
                                 (
                                 2
                                 )
                              
                           
                        , the probability density function is
                           
                              (16)
                              
                                 f
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       →
                                    
                                 
                                 ,
                                 V
                                 )
                                 =
                                 
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    )
                                 
                                 N
                                 (
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       →
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       →
                                    
                                 
                                 ,
                                 V
                                 )
                              
                           
                         where
                           
                              
                                 N
                                 (
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       →
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       →
                                    
                                 
                                 ,
                                 V
                                 )
                                 =
                                 
                                    
                                       |
                                       2
                                       π
                                       V
                                       |
                                    
                                    
                                       −
                                       
                                          1
                                          2
                                       
                                    
                                 
                                 exp
                                 ⁡
                                 
                                    (
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                →
                                             
                                          
                                          −
                                          
                                             
                                                θ
                                             
                                             
                                                →
                                             
                                          
                                          )
                                          
                                             
                                                V
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      →
                                                   
                                                
                                                −
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      →
                                                   
                                                
                                                )
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                         
                        
                           N
                           (
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 →
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 →
                              
                           
                           ,
                           V
                           )
                         is a Gaussian function. We would like to find the parameters 
                           
                              
                                 θ
                              
                              
                                 →
                              
                           
                         and V to maximise value of (19). This can be done iteratively by using EM-like iterations [6]. From Jensen's inequality we get:
                           
                              (17)
                              
                                 log
                                 ⁡
                                 f
                                 (
                                 θ
                                 ,
                                 V
                                 )
                                 ≥
                                 G
                                 (
                                 θ
                                 ,
                                 V
                                 ,
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 ⋯
                                 ,
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 log
                                 ⁡
                                 
                                    
                                       (
                                       
                                          
                                             (
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                             +
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                                
                                                   (
                                                   2
                                                   )
                                                
                                             
                                             )
                                             N
                                             (
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   →
                                                
                                             
                                             ,
                                             
                                                
                                                   θ
                                                
                                                
                                                   →
                                                
                                             
                                             ,
                                             V
                                             )
                                          
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                           =
                           1
                         and 
                           
                              
                                 q
                              
                              
                                 i
                              
                           
                           >
                           0
                        . Repeat the E and M steps described below until a convergence is achieved.

E step: find 
                           
                              
                                 q
                              
                              
                                 i
                              
                           
                         to maximise 
                           f
                           (
                           
                              
                                 θ
                              
                              
                                 →
                              
                           
                           ,
                           V
                           )
                         while keeping 
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       →
                                    
                                 
                              
                              
                                 (
                                 k
                                 )
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 (
                                 k
                                 )
                              
                           
                         fixed. It is easy to show that the maximum is achieved when
                           
                              (18)
                              
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       )
                                       N
                                       (
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             →
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   →
                                                
                                             
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       ,
                                       
                                          
                                             V
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       )
                                       N
                                       (
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             →
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   →
                                                
                                             
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       ,
                                       
                                          
                                             V
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

M step: maximise 
                           f
                           (
                           
                              
                                 θ
                              
                              
                                 →
                              
                           
                           ,
                           V
                           )
                         with respect to 
                           
                              
                                 θ
                              
                              
                                 →
                              
                           
                         and V while keeping 
                           
                              
                                 q
                              
                              
                                 i
                              
                           
                         constant. Now 
                           
                              
                                 q
                              
                              
                                 i
                              
                           
                         is fixed, we maximise the part of G according to parameters 
                           
                              
                                 θ
                              
                              
                                 →
                              
                           
                         and V
                        
                           
                              (19)
                              
                                 g
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       →
                                    
                                 
                                 ,
                                 V
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 log
                                 ⁡
                                 N
                                 (
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       →
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       →
                                    
                                 
                                 ,
                                 V
                                 )
                              
                           
                         From 
                           
                              ∂
                              
                                 ∂
                                 
                                    
                                       θ
                                    
                                    
                                       →
                                    
                                 
                              
                           
                           g
                           (
                           
                              
                                 θ
                              
                              
                                 →
                              
                           
                           ,
                           V
                           )
                           =
                           0
                        , we have
                           
                              (20)
                              
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       →
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             →
                                          
                                       
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       )
                                       N
                                       (
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             →
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   →
                                                
                                             
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       ,
                                       
                                          
                                             V
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       )
                                       N
                                       (
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             →
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   →
                                                
                                             
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       ,
                                       
                                          
                                             V
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

Note that this updated equation for the position estimation is equivalent to the mean-shift update for the Gaussian kernels. For Gaussian kernels Jensen's lower bound has a simple form and leads to simple equations for updating V for the Gaussian kernel. From 
                           
                              ∂
                              
                                 ∂
                                 V
                              
                           
                           g
                           (
                           
                              
                                 θ
                              
                              
                                 →
                              
                           
                           ,
                           V
                           )
                           =
                           0
                         we get:
                           
                              (21)
                              
                                 
                                    
                                       V
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                                 =
                                 β
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          →
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                →
                                             
                                          
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    )
                                 
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             →
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   →
                                                
                                             
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        
                     


                        Fig. 6
                         shows the performance of the scale algorithm, with a Gaussian mixture model with three distributions generating the simulated data points. The three modes are clearly visible as Fig. 6 shows, the result for the mean shift is shown in Fig. 6(a) and one for our scale algorithm in Fig. 6(b). We can also observe the position of the local mode and the covariance matrix that describes the shape of the mode. Fig. 7
                         shows a process by which the location and scale of the target candidate model is adaptively evolved by using the IEML to iterate six times. Fig. 8
                         also shows a performance comparison between the EM-like and the IEML with the spatial feature; we find that the target object car with a white side ellipse tracked by using our method is more exact than that with a blue sided ellipse by using the EM-like.

@&#EXPERIMENTAL RESULTS@&#

The aim of this section is to investigate the performance of our method and evaluate its robustness in resisting translating, rotating, scaling, distorting and so on. Secondly, in recent years the GHT-based methods have been widely used for ROI-based image retrieval and target tracking [20,26]; in later experiments our MSIEM method is to be compared with the GHT method proposed in [20], which is one of the typical GHT-based ROI image retrieval methods. In addition, the MSIEM is also to be compared with the MST to explore the performance as the spatial histogram is merged into the EM-like method.

In order to objectively evaluate our method, the four image databases, which are the image database built by ourselves, Wang's image collection [11], UKBench database [23] and California-ND database [24], are taken as the benchmark data sets.

The first database, which is collected from various web sites and referred to as DB1, contains about 12 000 natural colour images with 20 categories, such as lotus, horse, house, bus and so on.

The second database, referred to as DB2, contains about 18 000 complex colour images. For DB2 each image contains a meaningful visual object and all images are classified into 90 categories. The DB2 also comes from Wang's image collection and is widely used as a benchmarks database for CBIR.

The third database is the UKBench database, which is comprised of 10 200 images and is divided into 2550 groups, each group containing 4 images. Each image in the same group describes one of the different aspects of an objects, such as transformation, scaling, rotation, distorting, illumination and so on. It is to be used to evaluate the robustness in resisting the variations of images.

The California-ND database is used as the fourth database to assist researchers in testing algorithms for the detection of near duplicate images. Contrary to other existing datasets in this domain, the California-ND database contains 701 photos taken directly from a real user's personal photo collection. As a result, while including many challenging non-identical near-duplicate cases without the use of artificial image transformations, the original image sequence was maintained as much as possible.

For performance evaluation, there is no standard measure for a universal purpose. There are several evaluation measures such as rank, precision, recall, precision/recall graph, etc. presented in [21] and a kind of ranking measure, ANMRR (Average Normalized Modified Retrieval Rank) that is defined from the MPEG-7 research group [37,4]. In order to objectively evaluate the proposed method, in our experiments we use the two indicator groups. The first indicator group is composed of 
                           
                              
                                 Rank
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 Rank
                              
                              
                                 ˜
                              
                           
                        , 
                           P
                           (
                           20
                           )
                        , 
                           P
                           (
                           50
                           )
                        , 
                           P
                           (
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                           )
                         and PR graph which are defined as follows:
                           
                              1.
                              
                                 
                                    
                                       
                                          Rank
                                       
                                       
                                          1
                                       
                                    
                                  and 
                                    
                                       
                                          Rank
                                       
                                       
                                          ˜
                                       
                                    
                                 : rank at which first relevant image is retrieved, normalized average rank of relevant images is defined below.
                                    
                                       (22)
                                       
                                          
                                             
                                                Rank
                                             
                                             
                                                ˜
                                             
                                          
                                          =
                                          
                                             1
                                             
                                                N
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                             
                                                
                                                   R
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   −
                                                   1
                                                   )
                                                
                                                2
                                             
                                             )
                                          
                                       
                                    
                                  where 
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                  is the rank at which the ith relevant image is retrieved. N is the number of images and 
                                    
                                       
                                          N
                                       
                                       
                                          R
                                       
                                    
                                  the number of relevant images returned by a given query. For the indicator 
                                    
                                       
                                          Rank
                                       
                                       
                                          ˜
                                       
                                    
                                 , the measure is 0 for perfect performance, and approaches 1 as performance worsens. For random retrieval, the result would be 0.5.


                                 
                                    P
                                    (
                                    20
                                    )
                                 , 
                                    P
                                    (
                                    50
                                    )
                                 : precision after 20 and 50 images are retrieved. Precision is defined below.
                                    
                                       (23)
                                       
                                          
                                             Precision
                                          
                                          =
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             
                                                
                                                   N
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                  where 
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                  denotes the number of relevant images retrieved by a query. 
                                    
                                       
                                          N
                                       
                                       
                                          1
                                       
                                    
                                  is the number of images retrieved by a query.


                                 R: recall is defined as
                                    
                                       (24)
                                       
                                          
                                             Recall
                                          
                                          =
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             
                                                
                                                   N
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                  where 
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                  denotes the number of relevant images retrieved by a query, 
                                    
                                       
                                          N
                                       
                                       
                                          2
                                       
                                    
                                  is the number of relevant images specified as the target image by the user.


                                 PR graph: to summarize the precision-recall curve in one number.

The second indicator group is composed of only one indicator ANMRR, the ANMRR value is a normalized ranking method. This is defined as follows [8,9]
                        
                           
                              
                                 
                                    NMRR
                                 
                                 (
                                 q
                                 )
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             
                                                NG
                                             
                                             (
                                             q
                                             )
                                          
                                       
                                       
                                          
                                             
                                                Rank
                                             
                                             (
                                             k
                                             )
                                          
                                          
                                             
                                                NG
                                             
                                             (
                                             q
                                             )
                                          
                                       
                                       )
                                       −
                                       0.5
                                       −
                                       
                                          
                                             
                                                NG
                                             
                                             (
                                             q
                                             )
                                          
                                          2
                                       
                                    
                                    
                                       K
                                       (
                                       q
                                       )
                                       +
                                       0.5
                                       −
                                       
                                          
                                             
                                                NG
                                             
                                             (
                                             q
                                             )
                                          
                                          2
                                       
                                    
                                 
                              
                           
                         where 
                           
                              NG
                           
                           (
                           q
                           )
                         is the size of the ground truth set for a query image q, 
                           
                              Rank
                           
                           (
                           k
                           )
                         is the ranking of the ground truth images by the retrieval algorithm and 
                           K
                           (
                           q
                           )
                         specifies the “relevance rank” for each query. As the size of the ground truth set is normally unequal, a suitable 
                           K
                           (
                           q
                           )
                         is determined by
                           
                              
                                 K
                                 (
                                 q
                                 )
                                 =
                                 min
                                 ⁡
                                 
                                    (
                                    4
                                    ×
                                    
                                       NG
                                    
                                    (
                                    q
                                    )
                                    ,
                                    2
                                    ×
                                    
                                       GTM
                                    
                                    )
                                 
                                 ,
                              
                           
                         where GTM is the maximum of 
                           
                              NG
                           
                           (
                           q
                           )
                         for all queries. If 
                           
                              Rank
                           
                           (
                           k
                           )
                           >
                           K
                           (
                           q
                           )
                        , then 
                           
                              Rank
                           
                           (
                           k
                           )
                         is changed into 
                           K
                           (
                           q
                           )
                           +
                           1
                        . The NMRR is in the range of 
                           [
                           0
                           ,
                           1
                           ]
                        , and the smaller the NMRR, the better the retrieval performance will be. ANMRR is defined as the average NMRR over a range of queries, and is given by
                           
                              
                                 
                                    ANMRR
                                 
                                 =
                                 
                                    1
                                    
                                       NQ
                                    
                                 
                                 
                                    ∑
                                    
                                       q
                                       =
                                       1
                                    
                                    
                                       NQ
                                    
                                 
                                 
                                    NMRR
                                 
                                 (
                                 q
                                 )
                                 ,
                              
                           
                         where NQ is the number of query images.

As mentioned above, we will use the four different databases and the two different indicator groups to carry out our experiments, and compare the performance of our proposed method (referred to as MSIEM) with the performance of Chau's method [20] (referred to as MGHT).

The first experiments aims to evaluate the effectiveness of using the MSIEM to adaptively change the location and scale of the target candidate model. The DB1 is used for the experiment, since it has a smaller size and contains a more salient visual object, and it is easy for us to efficiently adjust and verify the proposed method. Meanwhile, in this paper the method proposed by [6] is called EMST, which contains an EM-like scale transformation and only uses the colour histogram to adaptively change the location and scale of the target candidate model.


                        Fig. 9
                         shows some results based on DB1. Looking at Fig. 9, the target candidate model is marked with a white rectangle. Fig. 9(a) shows that the candidate model in each query image is adequately encircled by the white rectangle while using the MSIEM method. Conversely, Fig. 9(b) shows that the candidate model in some images is not able to be adequately encircled by the white rectangle while using the EMST method. A video fragment tracking a car by using the EM-like and the IEML methods respectively is exhibited in Fig. 8. In this figure the target candidate car of each frame is marked by an ellipse with a white side while the IEML is used to track, in which both the colour histogram and the spatial histogram are merged. The target car of each frame is marked by an ellipse with a blue side, while the EM-like is used to track, in which only the colour histogram is used. Fig. 8 shows that the target candidate region marked by an ellipse with the white side is much more exact than that marked by an ellipse with a blue side. Experimental results indicate that it is very significant to integrate the spatial histogram into the EM-like for tracking the target candidate model exactly. Moreover, for the IEML since both the colour histogram and spatial histogram are used based on the lattice structure of the ROI, we have found that using it to calculate the target candidate model in the current frame takes much less time than using the EM-like; for this tracking instance the time that the former takes is just less than one third of the latter.

The second experiment aims to use the most commonly used database DB2 and evaluation indicators in the first group to evaluate our method and the MGHT method. The two methods MSIEM and MGHT have been implemented in our system. If a user runs the system to query a target model, it is to return the most relevant top 24 images (the number can be set by the user) and exhibits them to the user. Fig. 10
                         shows the interface during the system running with some results by using the two methods with respect to four image classes ancient building, horse, cow and motorbike within the DB2. Figs. 10(a), (c), (e), (g) exhibit some results returned by using the MSIEM, whereas Figs. 10(b), (d), (f), (g) show those from using the MGHT. In view of these experiments, we have found that for the target model with a complicated structure the results returned by the proposed method wholly outperform those returned by MGHT in effectiveness.

A quantitative analysis based on DB2 is made with respect to those indicators mentioned above. The purpose of the analysis is to test the affection of the spatial histogram to the result of ROI-based image retrieval. Five classes ancient building, horse, plane, motorbike and sparrow are queried and these indicators are calculated according to the first indicator group. Class ancient building contains about 30 ground true images, class horse about 50 ground true images, class planes about 33 ground true images, class motorbike about 20 ground true images. For each class and subset of DB2, when we successively select a target image and mark the target model and then submit the target model to the system, the image number of subset ranges from 
                           2000
                           ,
                           4000
                           ,
                           …
                           ,
                           18
                           
                           000
                        . According to the first indicator group, we count the values of these indicators for each class and subset, and then average these values. The statistical and analytical results are listed in Table 1
                        . Furthermore, the average PR-Graph on the four classes, i.e. ancient building, horse, plane and motorbike are calculated and plotted in Fig. 11
                        . As Table 1 and Fig. 11 show, our proposed method reflects that the more similar images to human perception are ranked at the top of the result set, whereas MGHT lacks such a result. The reason why our method can achieve such a good result is because in our method the spatial histogram is merged. The spatial histogram describes the colour spatial structure distribution. Looking at Figs. 10(a)–(g) and (b)–(h), in these target models of ancient building and motorbike there exists a rather complicated structure of colour spatial distribution. Since the spatial histogram is merged into our method, it is reasonable to believe that the retrieval effectiveness of our method overtakes the MGHT.

The last experiment is to investigate the capacities of the MSIEM-, GHT-based ROI image retrieval methods for resisting the variations of images. In this experiment, UKBench and California-ND are used as the test image databases. As mentioned previously, the UKBench database is divided into 2550 groups by each visual perceptional object. Fig. 12
                         shows three object groups in the UKBench database, group 151 shows that a traffic signal “stop” presents in each image in the group at a different state, such as scaling and flipping at a different angle. The object peanut box in group 554 presents in each image in the group at a different state such as scaling, rotation or occlusion, and the round object in group 567 presents in each image in the group at flip, scaling or illumination change. In a word, since the UKBench database is diverse, it significantly increases the evaluation difficulty for the ROI-based image retrieval.

Firstly, for the two methods MSIEM and MGHT experiments are carried out by group over a subset containing 2000 images in the UKBench, i.e., this subset contains 500 groups, which are randomly taken from the UKBench and for convenience denoted as 
                           
                              
                                 g
                              
                              
                                 501
                              
                           
                         to 
                           
                              
                                 g
                              
                              
                                 1000
                              
                           
                        , 
                           
                              
                                 q
                              
                              
                                 i
                                 j
                              
                           
                         denotes jth image of 
                           
                              
                                 g
                              
                              
                                 i
                              
                           
                        . For each 
                           
                              
                                 g
                              
                              
                                 i
                              
                           
                           
                           (
                           i
                           =
                           551
                           ,
                           …
                           ,
                           600
                           )
                        , 
                           
                              
                                 q
                              
                              
                                 i
                                 j
                              
                           
                           
                           (
                           j
                           =
                           1
                           ,
                           …
                           ,
                           4
                           )
                         is taken as a query image in turn and 
                           K
                           (
                           
                              
                                 q
                              
                              
                                 i
                                 j
                              
                           
                           )
                           ,
                           
                              NG
                           
                           (
                           
                              
                                 q
                              
                              
                                 i
                                 j
                              
                           
                           )
                           ,
                           
                              
                                 GTM
                              
                              
                                 i
                                 j
                              
                           
                           ,
                           
                              
                                 NQ
                              
                              
                                 i
                                 j
                              
                           
                         are, respectively, given to be 
                           24
                           ,
                           4
                           ,
                           4
                           ,
                           4
                         and the total NQ is 
                           500
                           ×
                           4
                        . The 
                           
                              
                                 ANMRR
                              
                              
                                 
                                    total
                                 
                              
                           
                         in Table 2
                         shows the average of ANMRR for the 500 groups. Moreover, 
                           
                              
                                 ANMRR
                              
                              
                                 551
                              
                           
                         to 
                           
                              
                                 ANMRR
                              
                              
                                 558
                              
                           
                         are the results with respect to the ANMRRs of 
                           
                              
                                 g
                              
                              
                                 551
                              
                           
                         to 
                           
                              
                                 g
                              
                              
                                 558
                              
                           
                        .

For these experiments we also carry out a statistics classification for transformation, scaling, rotation, flipping, illumination change and list the results in Table 3
                        .

The experimental results indicate that the MSIEM-based ROI image retrieval method totally performs much better than the GHT-based ROI image retrieval methods; in particular, for distorting, flipping and illumination change, our method show a robust performance. As indicated in Figs. 13
                        (a)–(c) and (b)–(d), (b) and (d) show that the MGHT is sensitive to flipping and illumination change and its retrieval effectiveness is not good.

Next, we are to explore the robustness or stability of the two methods based on different scale databases. In order to obtain different scale databases, we take 
                           
                              
                                 g
                              
                              
                                 001
                              
                           
                         to 
                           
                              
                                 g
                              
                              
                                 500
                              
                           
                         as the first database and denoted as 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 g
                              
                              
                                 001
                              
                           
                         to 
                           
                              
                                 g
                              
                              
                                 1000
                              
                           
                         as the second database 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           ,
                           …
                         , recurrently, 
                           
                              
                                 g
                              
                              
                                 001
                              
                           
                         to 
                           
                              
                                 g
                              
                              
                                 2500
                              
                           
                         as the fifth database 
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                        , then the numbers of images in these databases are 2000, 4000, 6000, 8000, 10 000 respectively.

For the 500 groups we carry out experiments based on these image databases 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                         respectively. For each group, 
                           K
                           (
                           
                              
                                 q
                              
                              
                                 i
                                 j
                              
                           
                           )
                           ,
                           
                              NG
                           
                           (
                           
                              
                                 q
                              
                              
                                 i
                                 j
                              
                           
                           )
                           ,
                           
                              
                                 GTM
                              
                              
                                 i
                                 j
                              
                           
                           ,
                           
                              
                                 NQ
                              
                              
                                 i
                                 j
                              
                           
                         are, respectively, given to be 
                           24
                           ,
                           4
                           ,
                           4
                           ,
                           4
                        , and 
                           
                              
                                 NQ
                              
                              
                                 j
                              
                           
                         are, respectively, given to be 
                           2000
                           ,
                           4000
                           ,
                           6000
                           ,
                           8000
                           ,
                           10
                           
                           000
                        . ANMRRs are obtained as shown in Table 4
                        .

Finally, we also carry out the experiments of the detection of near duplicate images based on California-ND. As Fig. 13 shows, (e) is our method's result and (f) the MGHT's result. These results reflect that for the detection of near duplicate images, since it is an intrinsic advantage of our method, the effectiveness of our method far outperforms that of the MGHT.

@&#CONCLUSIONS@&#

In this paper, a novel ROI-based image retrieval method with MST and IEML is presented. We have demonstrated that since the colour and spatial features are integrated into the proposed method and both the colour and spatial histograms are based on the lattice structure of the ROI, so that it can more exactly and rapidly adapt to changes of the shape and scale of the ROI during the EM-like iteration. Further more, based on the IEML, the proposed MSIEM method can more robustly and effectively retrieve the image containing the ROI from the image database. The proposed method is used for the ROI-based image retrieval, while the IEML's iteration which takes six times the computational cost is also much less than that of the MGHT. Moreover, compared with the EM-like, if the IEML with the colour and spatial features based on the lattice structure of the ROI is used for tracking the target model, it will be able to significantly reduce the computation cost and hugely promote the tracking precision. In future, we plan to investigate, using the proposed method, the detection and extraction of the salient object in an image, and to explore the differences between the CAMShift, the EM-like and the Hough-based tracking methods.

@&#ACKNOWLEDGEMENTS@&#

This work was supported in part by the national industry special project under Grant GYHY201306043.

Proof of Eq. (13)
                     
                        
                           
                              ρ
                              (
                              y
                              )
                              =
                              
                                 
                                    ρ
                                 
                                 
                                    1
                                 
                              
                              ×
                              
                                 
                                    ρ
                                 
                                 
                                    2
                                 
                              
                           
                        
                      using Taylor expansion around the value 
                        
                           
                              p
                           
                           
                              u
                           
                        
                        (
                        
                           
                              y
                           
                           
                              0
                           
                        
                        )
                      and 
                        s
                        
                           
                              p
                           
                           
                              u
                           
                        
                        (
                        
                           
                              y
                           
                           
                              0
                           
                        
                        )
                     
                     
                        
                           
                              ρ
                              (
                              y
                              )
                              =
                              
                                 [
                                 
                                    ∑
                                    u
                                 
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             u
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                                 ]
                              
                              
                                 [
                                 
                                    ∑
                                    m
                                 
                                 
                                    
                                       s
                                       
                                          
                                             q
                                          
                                          
                                             m
                                          
                                       
                                       s
                                       
                                          
                                             p
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                                 ]
                              
                              +
                              
                                 1
                                 2
                              
                              
                                 ∑
                                 u
                              
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          u
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          u
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                              
                              ×
                              
                                 ∑
                                 m
                              
                              s
                              
                                 
                                    q
                                 
                                 
                                    m
                                 
                              
                              (
                              y
                              )
                              −
                              s
                              
                                 
                                    p
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              )
                              
                                 
                                    
                                       s
                                       
                                          
                                             q
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       s
                                       
                                          
                                             p
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                              
                              +
                              
                                 1
                                 2
                              
                              
                                 ∑
                                 m
                              
                              
                                 
                                    s
                                    
                                       
                                          q
                                       
                                       
                                          m
                                       
                                    
                                    s
                                    
                                       
                                          p
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                              
                              ×
                              
                                 ∑
                                 u
                              
                              
                                 
                                    q
                                 
                                 
                                    u
                                 
                              
                              (
                              y
                              )
                              −
                              
                                 
                                    p
                                 
                                 
                                    u
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              )
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          u
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                      It is equivalent to
                        
                           
                              ρ
                              (
                              y
                              )
                              =
                              
                                 
                                    ρ
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 2
                              
                              
                                 ∑
                                 m
                              
                              s
                              
                                 
                                    q
                                 
                                 
                                    m
                                 
                              
                              (
                              y
                              )
                              
                                 
                                    
                                       s
                                       
                                          
                                             q
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       s
                                       
                                          
                                             p
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 2
                              
                              
                                 ∑
                                 m
                              
                              
                                 
                                    q
                                 
                                 
                                    u
                                 
                              
                              (
                              y
                              )
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          u
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                      As 
                        
                           
                              ρ
                           
                           
                              0
                           
                        
                      is dependent on y, the first term is constant. For Eq. (11),
                        
                           
                              
                                 
                                    r
                                 
                                 
                                    m
                                 
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              
                                 
                                    ‖
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    m
                                    ‖
                                 
                                 
                                    2
                                 
                              
                              δ
                              
                                 (
                                 b
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 −
                                 u
                                 )
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    r
                                 
                                 
                                    m
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              K
                              (
                              ⁎
                              )
                              δ
                              
                                 (
                                 b
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 −
                                 m
                                 )
                              
                           
                        
                      where 
                        K
                        (
                        ⁎
                        )
                      is the kernel function, and bandwidth is the unit matrix. It follows that
                        
                           
                              ρ
                              (
                              y
                              )
                              =
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 2
                              
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              K
                              (
                              ⁎
                              )
                              +
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 2
                              
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    ″
                                 
                              
                              K
                              (
                              ⁎
                              )
                           
                        
                      where
                        
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 ∑
                                 u
                              
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          u
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                              
                              δ
                              
                                 (
                                 b
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 −
                                 u
                                 )
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    ″
                                 
                              
                              =
                              
                                 ∑
                                 m
                              
                              
                                 
                                    
                                       s
                                       
                                          
                                             q
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       s
                                       
                                          
                                             p
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                              
                              δ
                              
                                 (
                                 b
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 −
                                 m
                                 )
                              
                           
                        
                     
                  

@&#REFERENCES@&#

