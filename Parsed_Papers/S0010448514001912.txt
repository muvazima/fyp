@&#MAIN-TITLE@&#Knot calculation for spline fitting via sparse optimization

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We reduce the computation time dramatically by solving convex optimization problem.


                        
                        
                           
                           We can simultaneously find a good combination of the knot number and knot locations.


                        
                        
                           
                           The algorithm has less knots with good fitting performance compared to other methods.


                        
                        
                           
                           We can recover the ground truth knots when data is sampled enough from a B-spline.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Spline fitting

Knot calculation

Sparse optimization

@&#ABSTRACT@&#


               
               
                  Curve fitting with splines is a fundamental problem in computer-aided design and engineering. However, how to choose the number of knots and how to place the knots in spline fitting remain a difficult issue. This paper presents a framework for computing knots (including the number and positions) in curve fitting based on a sparse optimization model. The framework consists of two steps: first, from a dense initial knot vector, a set of active knots is selected at which certain order derivative of the spline is discontinuous by solving a sparse optimization problem; second, we further remove redundant knots and adjust the positions of active knots to obtain the final knot vector. Our experiments show that the approximation spline curve obtained by our approach has less number of knots compared to existing methods. Particularly, when the data points are sampled dense enough from a spline, our algorithm can recover the ground truth knot vector and reproduce the spline.
               
            

@&#INTRODUCTION@&#

Curve fitting with splines is a traditional and fundamental problem in many engineering practices. In Computer Aided Design (CAD) and Geometric Modeling, curves are fitted with splines to reconstruct geometric models from measurement data  [1–4]. In signal processing and image processing, splines are often adopted to process noisy signals or to approximate complicated functions  [5,6].

The intuitive idea of curve fitting with splines is to formulate it as a least-square problem when knots are fixed. However, the fitting result is not always satisfactory. Actually, it has long been known that freeing knots in fitting improves the result dramatically  [7–10]. But spline fitting with free knots is still a challenging problem. The reasons are as follows. First, analytic expressions for optimal knot locations, or even for general characteristics of optimal knot distributions, are not easy to derive  [11]. Second, the unknown number and position of knots result in a large and nonlinear optimization problem, which is computationally very difficult.

In the literature many methods have been proposed to optimize knots with a given number of knots. The problem of knot placement is formulated as a nonlinear optimization problem with the constraint that knots should form a nondecreasing sequence. The first type of techniques transforms the constrained optimization problem into an unconstrained problem, then local gradient-based method or Gauss–Newton method are employed for minimization  [11–13]. However, local optimization methods require a good initial guess and cannot guarantee global optimality. The second type of techniques applies global optimization to avoid the drawbacks of local methods, but it is computationally more expensive  [14–16]. There are also some works which utilize the underlying feature information of the data to select knots, instead of solving a nonlinear optimization problem  [1,17,18]. However, in such methods the number of knots is determined beforehand and the results are sensitive to measurement noises.

Another approach for knot calculation is based on knot-removal strategy which is to reduce the number of knots of a given spline by perturbing the spline within a given tolerance  [19,20]. The main idea of the technique is to remove interior knots according to assigned weights. For data approximation, a piecewise linear approximation of the data is computed, then knot removal strategy is performed on the linear approximation, and finally the data is approximated by a smooth spline with computed knots.

A new development in recent years for knot calculation is based on sparse optimization  [21,22]. Sparsity is the core of compressed sensing which is widely used in computer vision and signal processing  [23–27]. Sparsity means that a signal can be represented in a linear combination of some bases or dictionaries such that most of the combination coefficients are zero. In  [21], the authors formulated the spline fitting problem as a convex optimization problem, where the 
                        
                           
                              l
                           
                           
                              1
                           
                        
                      norm of jump of third order derivatives of 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      cubic splines is minimized; while in  [22], the authors first selected a subset of basis functions from the pre-specified multi-resolution basis set using the statistical variable selection method-Lasso, then identified a concise knot vector that is sufficient to characterize the vector space spanned by the selected basis functions to fit the data. These two methods can compute the number and positions of the knots simultaneously, yet they still produce a lot of redundant knots.

Targeting on the limitations of existing methods, we propose a computationally efficient framework to calculate knots for splines fitting via sparse optimization. The framework is composed of two stages: firstly we solve a convex sparse optimization model starting from a dense initial knot vector. The output is those knots (which we call active knots) at which a certain order derivatives of the fitting spline is discontinuous. The idea to formulate the optimization model in this step is the same as that in  [21] but with a distinct formulation. Secondly, we adjust the active knots in the first stage by certain rules to remove redundant knots. Furthermore, several theoretical results about the algorithm are established in this paper. In particular, when the data points are sampled dense enough from a spline, the knots of this spline can be recovered by the proposed framework in any given precision.

The remainder of the current paper is organized as follows. In Section  2, we review some preliminary knowledge about B-splines and least-square fitting with B-splines. In Section  3, a two-stage framework of curve fitting with B-splines is described. Some related theoretical results are also presented. In Section  4, we illustrate the effectiveness of the proposed method through numerical experiments and comparisons with existing methods. Finally, in Section  5, we conclude the paper with discussions on future research problems.

We refer to the fundamental book  [1] for a complete treatment of splines. Here we simply introduce the adopted notations which are needed for presenting our results.

Let 
                           
                              
                                 
                                    {
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 n
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                         be 
                           n
                           +
                           1
                         control points, and 
                           
                              
                                 N
                              
                              
                                 i
                              
                              
                                 p
                              
                           
                           
                              (
                              t
                              )
                           
                         be the B-spline basis functions of degree 
                           p
                         defined on a knot vector 
                           U
                           =
                           
                              {
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                    +
                                    p
                                    +
                                    1
                                 
                              
                              }
                           
                         with 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           ≤
                           
                              
                                 t
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           ,
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                           +
                           p
                        , then a B-spline curve of degree 
                           p
                         is defined by 
                           
                              (1)
                              
                                 c
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                    
                                       p
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 N
                              
                              
                                 i
                              
                              
                                 p
                              
                           
                           
                              (
                              t
                              )
                           
                         is defined recursively as follows: 
                           
                              
                                 (2)
                                 
                                    
                                       
                                          N
                                       
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                                ,
                                             
                                             
                                                t
                                                ∈
                                                
                                                   [
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 (3)
                                 
                                    
                                       
                                          N
                                       
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          t
                                          −
                                          
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                +
                                                p
                                             
                                          
                                          −
                                          
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          i
                                       
                                       
                                          p
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    +
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                +
                                                p
                                                +
                                                1
                                             
                                          
                                          −
                                          t
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                +
                                                p
                                                +
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                       
                                          p
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    
                                    p
                                    ≥
                                    1
                                    .
                                 
                              
                           
                         When 
                           d
                           =
                           1
                        , 
                           c
                           
                              (
                              t
                              )
                           
                         is called a B-spline function and the control points are called spline coefficients. In this paper, we only consider data fitting with B-spline functions.


                        
                           U
                         is often chosen as an open knot vector, namely boundary knots are set to 
                           a
                           =
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           =
                           ⋯
                           =
                           
                              
                                 t
                              
                              
                                 p
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 n
                                 +
                                 1
                              
                           
                           =
                           ⋯
                           =
                           
                              
                                 t
                              
                              
                                 n
                                 +
                                 p
                                 +
                                 1
                              
                           
                           =
                           b
                        . The knots 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           p
                           +
                           1
                           ,
                           …
                           ,
                           n
                         are called interior knots of 
                           U
                        . The multiplicity of an interior knot 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                         is denoted by 
                           
                              
                                 m
                              
                              
                                 i
                              
                           
                           
                           
                              (
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              ≤
                              p
                              +
                              1
                              )
                           
                        . An interior knot 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                         is called an active knot of 
                           c
                           
                              (
                              t
                              )
                           
                         if the 
                           
                              (
                              p
                              +
                              1
                              −
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        th order derivative of 
                           c
                           
                              (
                              t
                              )
                           
                         is discontinuous at 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                        , otherwise it is called an inactive knot of 
                           c
                           
                              (
                              t
                              )
                           
                        . Fig. 1
                         shows a 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         continuous cubic B-spline function and its first three derivatives. The spline has 9 interior knots (marked by crosses) and 3 active knots (marked by black crosses) where the third order derivatives are discontinuous.

The 
                           k
                        th order derivative of 
                           c
                           
                              (
                              t
                              )
                           
                         is a B-spline of degree 
                           p
                           −
                           k
                        : 
                           
                              (4)
                              
                                 
                                    
                                       c
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       Π
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    p
                                    +
                                    1
                                    −
                                    i
                                    )
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                    
                                       p
                                       −
                                       k
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                              
                           
                         with 
                           
                              (5)
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                          
                                          
                                             i
                                             f
                                             
                                             k
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         
                                                            (
                                                            k
                                                            −
                                                            1
                                                            )
                                                         
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                         −
                                                         1
                                                      
                                                      
                                                         
                                                            (
                                                            k
                                                            −
                                                            1
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         i
                                                         +
                                                         p
                                                         +
                                                         1
                                                         −
                                                         k
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                          
                                             i
                                             f
                                             
                                             k
                                             >
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The Fourier transform of the 
                           j
                        th basis function 
                           
                              
                                 N
                              
                              
                                 j
                              
                              
                                 p
                              
                           
                           
                              (
                              t
                              )
                           
                         is defined as
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       −
                                       ∞
                                    
                                    
                                       −
                                       ∞
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       w
                                       t
                                    
                                 
                                 d
                                 t
                                 =
                                 
                                    
                                       
                                          (
                                          p
                                          +
                                          1
                                          )
                                       
                                       !
                                    
                                    
                                       
                                          
                                             
                                                (
                                                i
                                                w
                                                )
                                             
                                          
                                          
                                             p
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       j
                                    
                                    
                                       p
                                       +
                                       1
                                       +
                                       j
                                    
                                 
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             i
                                             w
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           θ
                           
                              (
                              t
                              )
                           
                           =
                           
                              
                                 Π
                              
                              
                                 k
                                 =
                                 j
                              
                              
                                 p
                                 +
                                 1
                                 +
                                 j
                              
                           
                           
                              (
                              t
                              −
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              )
                           
                        , 
                           w
                           ∈
                           R
                         represents frequency. For uniformly distributed knots, the Fourier transform can be simplified as: 
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                      
                                                         |
                                                         τ
                                                         |
                                                      
                                                      w
                                                   
                                                
                                                −
                                                1
                                             
                                             
                                                i
                                                
                                                   |
                                                   τ
                                                   |
                                                
                                                w
                                             
                                          
                                          )
                                       
                                    
                                    
                                       p
                                       +
                                       1
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              |
                              τ
                              |
                           
                         is defined as 
                           
                              |
                              τ
                              |
                           
                           =
                           
                              
                                 max
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        .

Given a set of data 
                           
                              
                                 
                                    {
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                        , and corresponding parameter values 
                           
                              
                                 
                                    {
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                        , the least square approximation with splines is defined 
                           
                              (8)
                              
                                 
                                    
                                       min
                                    
                                    
                                       c
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          (
                                          c
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where 
                           c
                           
                              (
                              t
                              )
                           
                         is a spline function defined by (1). When the knot vector 
                           U
                         of the spline function 
                           c
                           
                              (
                              t
                              )
                           
                         is fixed, problem (8) is reduced to 
                           
                              (9)
                              
                                 
                                    
                                       min
                                    
                                    
                                       C
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          P
                                          −
                                          A
                                          C
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where 
                           P
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          N
                                       
                                    
                                    )
                                 
                              
                              
                                 T
                              
                           
                        , 
                           A
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    )
                                 
                              
                              
                                 N
                                 ×
                                 
                                    (
                                    n
                                    +
                                    1
                                    )
                                 
                              
                           
                         with 
                           
                              
                                 a
                              
                              
                                 i
                                 j
                              
                           
                           =
                           
                              
                                 N
                              
                              
                                 j
                              
                              
                                 p
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        , and 
                           C
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                              
                              
                                 T
                              
                           
                         is the coefficient vector.

If 
                           A
                         has rank 
                           n
                           +
                           1
                        , then 
                           
                              
                                 A
                              
                              
                                 T
                              
                           
                           A
                         is nonsingular, thus the solution 
                           C
                         of problem (9) is obtained uniquely by 
                           
                              (10)
                              
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 A
                                 C
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 P
                                 .
                              
                           
                         The sufficient and necessary conditions for 
                           A
                         to have rank 
                           n
                           +
                           1
                         are stated by Schoenberg and Whitney  [28]. If 
                           A
                         does not have full rank, the solution 
                           C
                         is defined as the solution which minimizes 
                           
                              
                                 
                                    ‖
                                    C
                                    ‖
                                 
                              
                              
                                 2
                              
                           
                         among all the solutions of (10).

In this section, we will present a two-stage framework of knot calculation for spline fitting in detail. We start with an outline of the algorithm. Then the sparse optimization model and knot adjustment strategy are described respectively.

For data fitting with spline, it is often expected that the number of knots should be as few as possible under the condition that the fitting performance is good enough. Suppose 
                           c
                           
                              (
                              t
                              )
                           
                         is defined as in (1) with an initial knot vector 
                           U
                           =
                           
                              {
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                    +
                                    p
                                    +
                                    1
                                 
                              
                              }
                           
                        , then the number of valid knots can be described by the number of nonzero elements in the vector 
                           v
                           =
                           
                              
                                 
                                    (
                                    
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             
                                                (
                                                p
                                                )
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                j
                                             
                                             
                                                +
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             
                                                (
                                                p
                                                )
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                j
                                             
                                             
                                                −
                                             
                                          
                                          )
                                       
                                       |
                                    
                                    )
                                 
                              
                              
                                 j
                                 =
                                 p
                                 +
                                 1
                              
                              
                                 j
                                 =
                                 n
                              
                           
                         which describes the jumps of 
                           p
                        th order derivatives of 
                           c
                           
                              (
                              t
                              )
                           
                         at the interior knots, because 
                           
                              
                                 c
                              
                              
                                 
                                    (
                                    p
                                    )
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         now is a piecewise constant function and the breakpoints are interior knots. Thus to minimize the number of knots, one can apply 
                           
                              
                                 l
                              
                              
                                 0
                              
                           
                        -norm minimization technique to vector 
                           v
                        , which has been widely used in computer vision and signal processing.

Let 
                           
                              
                                 
                                    {
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                         be given data points with corresponding parameters 
                           
                              
                                 
                                    {
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                        , and 
                           c
                           
                              (
                              t
                              )
                           
                         be a B-spline function defined by Eq. (1). Then the fitting problem is formulated as 
                           
                              
                                 (11a)
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ∈
                                                   R
                                                   ,
                                                   i
                                                   =
                                                   0
                                                   …
                                                   n
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ,
                                                   j
                                                   =
                                                   p
                                                   +
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   n
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             J
                                             
                                                
                                                   c
                                                
                                                
                                                   
                                                      (
                                                      p
                                                      )
                                                   
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              
                                 (11b)
                                 
                                    s
                                    .
                                    t
                                    .
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          
                                             (
                                             c
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ≤
                                    N
                                    ε
                                 
                              
                           
                         where the 
                           
                              
                                 l
                              
                              
                                 0
                              
                           
                         norm 
                           
                              
                                 
                                    ‖
                                    ⋅
                                    ‖
                                 
                              
                              
                                 0
                              
                           
                         indicates the number of nonzero elements in the vector, 
                           ε
                           >
                           0
                         is a fixed tolerance to control the quality of fit and 
                           J
                           
                              
                                 c
                              
                              
                                 
                                    (
                                    p
                                    )
                                 
                              
                           
                         is the jump vector of 
                           p
                        th order derivatives of 
                           c
                           
                              (
                              t
                              )
                           
                         at the interior knots, defined as 
                           
                              
                                 J
                                 
                                    
                                       c
                                    
                                    
                                       
                                          (
                                          p
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    (
                                    J
                                    
                                       
                                          c
                                       
                                       
                                          
                                             (
                                             p
                                             )
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             p
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                    ,
                                    …
                                    ,
                                    J
                                    
                                       
                                          c
                                       
                                       
                                          
                                             (
                                             p
                                             )
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    )
                                 
                              
                           
                         with 
                           J
                           
                              
                                 c
                              
                              
                                 
                                    (
                                    p
                                    )
                                 
                              
                           
                           
                              (
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           =
                           
                              
                                 c
                              
                              
                                 
                                    (
                                    p
                                    )
                                 
                              
                           
                           
                              (
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                                 
                                    +
                                 
                              
                              )
                           
                           −
                           
                              
                                 c
                              
                              
                                 
                                    (
                                    p
                                    )
                                 
                              
                           
                           
                              (
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                                 
                                    −
                                 
                              
                              )
                           
                           ,
                           j
                           =
                           p
                           +
                           1
                           ,
                           …
                           ,
                           n
                        . For small 
                           p
                        , an explicit formula for 
                           J
                           
                              
                                 c
                              
                              
                                 
                                    (
                                    p
                                    )
                                 
                              
                           
                         can be written down based on (5). In this paper, we will restrict our experiments on fitting with cubic spline functions.

Problem (11) has three parts of unknowns: spline coefficients 
                           
                              
                                 
                                    {
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 n
                              
                           
                        , knot number 
                           n
                         and interior knot vector 
                           
                              
                                 
                                    {
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                              
                              
                                 i
                                 =
                                 p
                                 +
                                 1
                              
                              
                                 n
                              
                           
                        . Since a spline is a non-convex and nonlinear function of knot values, problem (11) is a non-convex and nonlinear optimization problem which is very difficult to compute. To find an optimal solution, we start from a dense knot vector to search for the best possible number of knots and their locations simultaneously by solving a convex optimization problem, followed by a further knot adjustment strategy, see Fig. 2
                         for reference.

For the first step, an initial knot vector containing enough knots for representing the details of data is provided. We then find a spline function with provided initial knots to fit the data with least square approximation by solving problem (11) except that the knots are fixed. That means we find a spline approximation with fewest number of 
                           p
                        th order derivative jumps. The nonzero jumps correspond to some active knots which are used as the input for the second step.

For the second step, our goal is to further decrease the knot number while keeping the fitting quality. Only pruning knots from the input knot vector cannot fix redundant knot problem. So here we adopt the following adjustment strategy. For each interval 
                           
                              [
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                              ]
                           
                         of the input active knot vector 
                           
                              
                                 U
                              
                              
                                 ̃
                              
                           
                           =
                           
                              
                                 
                                    {
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    }
                                 
                              
                              
                                 k
                                 =
                                 1
                              
                              
                                 m
                              
                           
                        , we insert the middle point 
                           
                              
                                 t
                              
                              
                                 ∗
                              
                           
                         in the interval to obtain a new vector 
                           
                              
                                 U
                              
                              
                                 ∗
                              
                           
                         and compute the approximated degree 
                           p
                         spline function 
                           
                              
                                 c
                              
                              
                                 ∗
                              
                           
                           
                              (
                              t
                              )
                           
                         by solving problem (11) with 
                           
                              
                                 U
                              
                              
                                 ∗
                              
                           
                        . If 
                           
                              
                                 t
                              
                              
                                 ∗
                              
                           
                         is an active knot of 
                           
                              
                                 c
                              
                              
                                 ∗
                              
                           
                           
                              (
                              t
                              )
                           
                        , then we replace the interval 
                           
                              [
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                              ]
                           
                         with one of the following two intervals 
                           
                              [
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    ∗
                                 
                              
                              ]
                           
                         and 
                           
                              [
                              
                                 
                                    t
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                              ]
                           
                        . This process is repeated until the length of the interval is small enough or the interval does not contain any parameters 
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                        . We then merge the interval to a single knot.

As an illustration example shown in Fig. 2, data points are uniformly sampled in 
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                         with 
                           N
                           =
                           101
                         from the function 
                           f
                           
                              (
                              t
                              )
                           
                           =
                           1.0
                           /
                           
                              (
                              
                                 
                                    
                                       (
                                       x
                                       −
                                       0.5
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              0.02
                              )
                           
                        . The tolerance 
                           ε
                           =
                           0.005
                         and the initial knots are chosen as 11 equidistant points in 
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                        . Fig. 2(a) shows the approximated B-spline (red curve) and the corresponding active knots (blue triangles) obtained in the first step. Fig. 2(b) depicts the approximated B-spline together with the final five interior knots by the second step. The five interior knots are (0.2000, 0.3941, 0.5000, 0.6066, 0.8000), where the knots 0.3941 and 0.6066 are the results of performing adjustment strategy on the two intervals (0.3, 0.4) and (0.6, 0.7) respectively.

In this section, we firstly present details of formulating and solving the sparse optimization model, then we provide some theoretic results about the properties of such a problem, which are helpful for understanding and designing strategy in second stage.

Suppose we have fixed an initial knot vector 
                              U
                              =
                              
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       n
                                       +
                                       p
                                       +
                                       1
                                    
                                 
                                 }
                              
                           , then problem (11) can be reformulated as 
                              
                                 
                                    (12a)
                                    
                                       
                                          
                                             min
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             R
                                             ,
                                             i
                                             =
                                             0
                                             …
                                             n
                                          
                                       
                                       
                                          
                                             
                                                ‖
                                                J
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      
                                                         (
                                                         p
                                                         )
                                                      
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    (12b)
                                    
                                       s
                                       .
                                       t
                                       .
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       
                                          
                                             
                                                (
                                                c
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                −
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ≤
                                       N
                                       ε
                                       .
                                    
                                 
                              
                            Here we change 
                              
                                 
                                    l
                                 
                                 
                                    0
                                 
                              
                            norm of objective function to 
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                            norm for the ease of solve: 
                              
                                 
                                    
                                       
                                          
                                             ‖
                                             J
                                             
                                                
                                                   c
                                                
                                                
                                                   
                                                      (
                                                      p
                                                      )
                                                   
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ≡
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          p
                                          +
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             
                                                (
                                                p
                                                )
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                j
                                             
                                             
                                                +
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             
                                                (
                                                p
                                                )
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                j
                                             
                                             
                                                −
                                             
                                          
                                          )
                                       
                                       |
                                    
                                    .
                                 
                              
                           
                        

We call (12) as sparse optimization model. Since it is a convex optimization problem, it can be solved efficiently. For initial knots in 
                              U
                           , they are usually chosen uniformly in domain 
                              
                                 [
                                 a
                                 ,
                                 b
                                 ]
                              
                           . The authors  [22] proposed a way of estimating the number of knots for given sample points according to the Fourier transformation of B-splines and Nyquist–Shannon sampling theorem  [29]. The idea is as follows. A basis function can be treated approximately as a band limited signal with band width 
                              
                                 [
                                 −
                                 2
                                 π
                                 /
                                 
                                    |
                                    τ
                                    |
                                 
                                 ,
                                 2
                                 π
                                 /
                                 
                                    |
                                    τ
                                    |
                                 
                                 ]
                              
                            from Eq. (7). Additionally, there are 
                              N
                            data points in the interval 
                              
                                 [
                                 a
                                 ,
                                 b
                                 ]
                              
                           , so the sampling rate 
                              ω
                            equals 
                              
                                 
                                    N
                                 
                                 
                                    
                                       (
                                       b
                                       −
                                       a
                                       )
                                    
                                 
                              
                           . If we want to capture all the information contained in the given data, then the basis functions should contain frequency components with frequency at least 
                              ω
                              /
                              2
                            according to Nyquist–Shannon sampling theorem, that is 
                              2
                              π
                              /
                              
                                 |
                                 τ
                                 |
                              
                              ≥
                              ω
                              /
                              2
                           , hence 
                              
                                 |
                                 τ
                                 |
                              
                              ≤
                              4
                              π
                              /
                              ω
                           . Then the number of interior knots of the knot vector should be at least 
                              1
                              /
                              
                                 |
                                 τ
                                 |
                              
                              ≥
                              
                                 
                                    N
                                 
                                 
                                    4
                                    π
                                    
                                       (
                                       b
                                       −
                                       a
                                       )
                                    
                                 
                              
                           . For example, suppose 
                              a
                              =
                              0
                              ,
                              b
                              =
                              1
                              ,
                              N
                              =
                              1001
                           , then there should be at least 80 interior knots.

It should be pointed out that the above estimate only provides a lower bound for initial knot number. In practice, initial knots are often selected more than the lower bound to capture the fine features of data points.

When the jump 
                              
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       
                                          (
                                          p
                                          )
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                       
                                          +
                                       
                                    
                                    )
                                 
                                 −
                                 
                                    
                                       c
                                    
                                    
                                       
                                          (
                                          p
                                          )
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                       
                                          −
                                       
                                    
                                    )
                                 
                                 |
                              
                            is close to zero, the corresponding knot 
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                            is pruned. The remaining knots are called active knots. When problem (12) is solved, the active knots of 
                              c
                              
                                 (
                                 t
                                 )
                              
                            can be consequently determined. The objective function in problem (12) favors 
                              c
                              
                                 (
                                 t
                                 )
                              
                            has few number of active knots. Consequently most of the initial knots are pruned. Notice that 
                              c
                              
                                 (
                                 t
                                 )
                              
                            can be represented as a spline defined over the active knots, that is, inactive knots can be deleted without changing the spline function.

In this section, we study the solution of problem (12) when data points are sampled dense enough from a spline function. We illustrate it with 
                              p
                              =
                              0
                           . Suppose data points 
                              
                                 
                                    
                                       {
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                            with corresponding parameter values 
                              
                                 
                                    
                                       {
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                            are sampled from a piecewise constant function with breakpoints 
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              <
                              ⋯
                              <
                              
                                 
                                    k
                                 
                                 
                                    l
                                 
                              
                           , and a B-spline 
                              c
                              
                                 (
                                 t
                                 )
                              
                            of degree 
                              p
                              =
                              0
                            defined over an initial knot vector 
                              U
                              =
                              
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 }
                              
                            is used to fit the data points via problem (12). We are interested in the characteristic of spline 
                              c
                              
                                 (
                                 t
                                 )
                              
                            at the interval 
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              =
                              
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 ]
                              
                            which contains a breakpoint.

Without loss of generality, suppose 
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 ]
                              
                            and the value sampled at 
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                            is shown in Fig. 3
                           (a). For convenience, 
                              
                                 
                                    c
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              <
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                            is assumed. The value of 
                              c
                              
                                 (
                                 t
                                 )
                              
                            at the three intervals 
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    1
                                 
                              
                              ,
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    1
                                 
                              
                            are denoted by 
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    3
                                 
                              
                            respectively. We also suppose the data points in the two adjacent intervals of 
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                            have been fitted well, that is 
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    c
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    3
                                 
                              
                              =
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                           , see Fig. 3(b) for reference. Notice that the optimal value of problem (12) does not depend on 
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                            as long as 
                              
                                 
                                    c
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              ≤
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              ≤
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                            since the sum of the jump in 
                              c
                              
                                 (
                                 t
                                 )
                              
                            at 
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    1
                                 
                              
                            equals 
                              
                                 |
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 |
                              
                              +
                              
                                 |
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 |
                              
                              =
                              
                                 
                                    d
                                 
                                 
                                    3
                                 
                              
                              −
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              −
                              
                                 
                                    c
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                           . But the fitting error 
                              E
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    
                                       (
                                       c
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                            depends on 
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                           . Particularly, the fitting error at an interval 
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                            is defined by 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    
                                       
                                          I
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       (
                                       c
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                           . We are going to study how the fitting error 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                           , thus 
                              E
                           , changes when a midpoint is inserted in 
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                           . There are two cases.

(1) First case: none of the parameters 
                              
                                 
                                    
                                       {
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                            lies in 
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                           . Fig. 3(b) shows this case, where the horizontal dashed (solid) line segments are marked for the value of true solution (approximated solution) on 
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                           . For this case, we merge the endpoints 
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    1
                                 
                              
                            as the midpoint 
                              
                                 
                                    t
                                 
                                 
                                    ∗
                                 
                              
                              =
                              0.5
                              
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 )
                              
                           , and the resulting knot vector is denoted by 
                              
                                 
                                    
                                       
                                          U
                                       
                                       
                                          ∗
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   0
                                                
                                             
                                             −
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                       }
                                    
                                    .
                                 
                              
                            A spline 
                              
                                 
                                    c
                                 
                                 
                                    ∗
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            defined on 
                              
                                 
                                    U
                                 
                                 
                                    ∗
                                 
                              
                            is constructed as shown in Fig. 3(c). Substituting 
                              
                                 
                                    c
                                 
                                 
                                    ∗
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            in problem (12), it can be seen that both the objection value and fitting error do not change comparing to that of 
                              c
                              
                                 (
                                 t
                                 )
                              
                           . But the number of knots of 
                              
                                 
                                    c
                                 
                                 
                                    ∗
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            is one less than that of 
                              c
                              
                                 (
                                 t
                                 )
                              
                           .

(2) Second case: among 
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                           , 
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              N
                           , there are 
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                            parameters in 
                              
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 ]
                              
                            and 
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                            parameters in 
                              
                                 [
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 ]
                              
                           . Then the value 
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                            should be 
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            to minimize the fitting error 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                            and consequently we have 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           . For this case, we insert the midpoint 
                              
                                 
                                    t
                                 
                                 
                                    ∗
                                 
                              
                              =
                              0.5
                              
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 )
                              
                            in 
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                            and the resulting knot vector is denoted by 
                              
                                 
                                    U
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 }
                              
                           . A spline 
                              
                                 
                                    c
                                 
                                 
                                    ∗
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            defined on 
                              
                                 
                                    U
                                 
                                 
                                    ∗
                                 
                              
                            is constructed as shown in Fig. 3(d), where 
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            and the corresponding fitting error at 
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                            is denoted by 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           , where 
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                            is the number of parameters of 
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                            lying in 
                              
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 ]
                              
                            (or 
                              
                                 [
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       ∗
                                    
                                 
                                 ]
                              
                           ). Comparing to 
                              c
                              
                                 (
                                 t
                                 )
                              
                           , the objection value of problem (12) do not change, but the fitting error 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                              <
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                            if 
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                              <
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                           .

The above analysis inspires us to subdivide 
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                            into two subintervals 
                              
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       ∗
                                    
                                 
                                 ]
                              
                            and 
                              
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 ]
                              
                           , then replace 
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                            by one of the subintervals to make the fitting error decrease. This process can be repeated until the length of the interval is small enough or the interval does not contain any parameter 
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                           . The two end points of the interval is then merged into one single knot.

For general case 
                              p
                              ≠
                              0
                           , when the given data points are sampled from a B-spline of degree 
                              p
                           , we have a similar conclusion. We summarize the observation in the following theorem.


                           
                              Theorem 3.1
                              
                                 Suppose the data points are sampled dense enough from a B-spline of degree 
                                 
                                    p
                                  
                                 with true knots 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    <
                                    ⋯
                                    <
                                    
                                       
                                          k
                                       
                                       
                                          l
                                       
                                    
                                 
                                 , 
                                 
                                    ε
                                    >
                                    0
                                  
                                 is small enough, and the initial knot vector is 
                                 
                                    U
                                    =
                                    
                                       {
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             n
                                             +
                                             p
                                             +
                                             1
                                          
                                       
                                       }
                                    
                                  
                                 . The active knots selected by problem   (12)   are collected increasingly in a vector 
                                 
                                    
                                       
                                          U
                                       
                                       
                                          ˜
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                       }
                                    
                                  
                                 . Then for each 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                 
                                 , 
                                 
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    l
                                 
                                 , there exists 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    1
                                    ≤
                                    
                                       
                                          j
                                       
                                       
                                          1
                                       
                                    
                                    ≤
                                    m
                                    −
                                    1
                                  
                                 such that 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          j
                                       
                                    
                                    ∈
                                    
                                       [
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       ]
                                    
                                  
                                 and 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    +
                                    1
                                    =
                                    
                                       
                                          i
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          1
                                       
                                    
                                 
                                 .
                              


                           
                              Proof
                              We prove the conclusion by contradiction. Without loss of generality, suppose 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    ∈
                                    
                                       [
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 , but 
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    1
                                    ≠
                                    
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 . 
                                    c
                                    
                                       (
                                       t
                                       )
                                    
                                  is the approximated B-spline solved by problem (12) with knot vector 
                                    U
                                  and parameter 
                                    ε
                                 . The optimal value of problem (12) with respect to 
                                    c
                                    
                                       (
                                       t
                                       )
                                    
                                  is denoted as 
                                    T
                                    V
                                 . As assumed 
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    1
                                    ≠
                                    
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 , then there exists a knot 
                                    
                                       
                                          t
                                       
                                       
                                          ∗
                                       
                                    
                                  in 
                                    U
                                  such that 
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    <
                                    
                                       
                                          t
                                       
                                       
                                          ∗
                                       
                                    
                                    <
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 . And 
                                    
                                       
                                          t
                                       
                                       
                                          ∗
                                       
                                    
                                  must be an inactive knot of 
                                    c
                                    
                                       (
                                       t
                                       )
                                    
                                 .

Now we consider a new B-spline 
                                    
                                       
                                          c
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  of degree 
                                    p
                                  defined on a knot vector 
                                    
                                       
                                          U
                                       
                                       
                                          ∗
                                       
                                    
                                  which is defined as follows: If 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    ∈
                                    
                                       [
                                       
                                          
                                             t
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 , 
                                    
                                       
                                          U
                                       
                                       
                                          ∗
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             t
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                       }
                                    
                                 ; otherwise 
                                    
                                       
                                          U
                                       
                                       
                                          ∗
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                       }
                                    
                                  (here for simplicity, we ignore the boundary knots of 
                                    
                                       
                                          U
                                       
                                       
                                          ∗
                                       
                                    
                                 ). Let 
                                    T
                                    
                                       
                                          V
                                       
                                       
                                          ∗
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ‖
                                             J
                                             
                                                
                                                   c
                                                
                                                
                                                   ∗
                                                   
                                                      (
                                                      p
                                                      )
                                                   
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             ‖
                                          
                                       
                                       
                                          1
                                       
                                    
                                  as defined in problem (12), then 
                                    
                                       
                                          c
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  is determined by solving a least square approximation of the given data points with the constraint 
                                    T
                                    
                                       
                                          V
                                       
                                       
                                          ∗
                                       
                                    
                                    =
                                    T
                                    V
                                 .

Notice that the sampled B-spline function is a piecewise polynomial in 
                                    
                                       [
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ]
                                    
                                  since there is an active knot 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    ∈
                                    
                                       [
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 . The constructed new spline 
                                    
                                       
                                          c
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  happens to be a piecewise polynomial in the interval 
                                    
                                       [
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 , while 
                                    c
                                    
                                       (
                                       t
                                       )
                                    
                                  is a continuous polynomial. This means 
                                    
                                       
                                          c
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  has one more degree of freedom than 
                                    c
                                    
                                       (
                                       t
                                       )
                                    
                                  when they approximate the sampled data points. So the fitting error of 
                                    
                                       
                                          c
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  is less than or equal to the one of 
                                    c
                                    
                                       (
                                       t
                                       )
                                    
                                 , that is 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ≤
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   c
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ≤
                                          N
                                          ε
                                          .
                                       
                                    
                                 
                              

Firstly, it can be asserted that the fitting error of 
                                    
                                       
                                          c
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  is less than that of 
                                    c
                                    
                                       (
                                       t
                                       )
                                    
                                 , otherwise there will be two different solutions with the same optimal value for the problem (12) which contradicts with the uniqueness of solution of problem (12).

Then, because problem (12) is a convex optimization, so the fitting error of the optimal solution must be equal to 
                                    N
                                    ε
                                 . Thus 
                                    T
                                    
                                       
                                          V
                                       
                                       
                                          ∗
                                       
                                    
                                  cannot be an optimal value, then 
                                    T
                                    V
                                  is not an optimal value because 
                                    T
                                    V
                                    =
                                    T
                                    
                                       
                                          V
                                       
                                       
                                          ∗
                                       
                                    
                                 , then 
                                    c
                                    
                                       (
                                       t
                                       )
                                    
                                  is not the optimal solution of problem (12) which contradicts with the assumption.

Above all, if 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    ∈
                                    
                                       [
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ]
                                    
                                  with 
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    1
                                    ≠
                                    
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 , then 
                                    c
                                    
                                       (
                                       t
                                       )
                                    
                                  is not the optimal solution to the problem (12). In other words, if 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    ∈
                                    
                                       [
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 , then it must have 
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    1
                                    =
                                    
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 . Hence the theorem is proved.□


                           
                              Remark 3.1
                              
                                 
                                    
                                       1.
                                       For 
                                             p
                                             =
                                             0
                                          , we have 
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          . Suppose 
                                             
                                                |
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                                −
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                |
                                             
                                             <
                                             η
                                          , then 
                                             
                                                |
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                                |
                                             
                                             =
                                             
                                                |
                                                
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               i
                                                               −
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                             <
                                             η
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             <
                                             η
                                          . Analogously, we have 
                                             
                                                |
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                |
                                             
                                             <
                                             η
                                          . If 
                                             η
                                           is small enough, then 
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             ≈
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                           or 
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             ≈
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                          . Additionally, when 
                                             
                                                
                                                   n
                                                
                                                
                                                   1
                                                
                                             
                                             ≪
                                             
                                                
                                                   n
                                                
                                                
                                                   2
                                                
                                             
                                           or 
                                             
                                                
                                                   n
                                                
                                                
                                                   2
                                                
                                             
                                             ≪
                                             
                                                
                                                   n
                                                
                                                
                                                   1
                                                
                                             
                                          , we also have 
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             ≈
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                           or 
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             ≈
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                          . For such two cases, we may not have the conclusion in Theorem 3.1, that is the two knots 
                                             
                                                
                                                   t
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   1
                                                
                                             
                                           which are adjacent to 
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                           may not be contained in 
                                             
                                                
                                                   U
                                                
                                                
                                                   ˜
                                                
                                             
                                          . For general degree 
                                             p
                                          , when the jump at 
                                             
                                                
                                                   k
                                                
                                                
                                                   j
                                                
                                             
                                           is too small or the parameters of data points around 
                                             
                                                
                                                   k
                                                
                                                
                                                   j
                                                
                                             
                                           are distributed unevenly, it may have 
                                             
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             +
                                             1
                                             ≠
                                             
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   1
                                                
                                             
                                          , that is 
                                             
                                                
                                                   t
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                           or 
                                             
                                                
                                                   t
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                           may not be in 
                                             
                                                
                                                   U
                                                
                                                
                                                   ˜
                                                
                                             
                                          . Thus in the second step the true knots cannot be recovered precisely or even omitted in some cases. Fortunately such kinds of knots always have little effect on fitting performance and there is no redundancy phenomenon around them from the experiments.

If some true knots are contained in several adjacent intervals, such as 
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             
                                                [
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                
                                                ]
                                             
                                          , 
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             ∈
                                             
                                                [
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      +
                                                      2
                                                   
                                                
                                                ]
                                             
                                          , 
                                             …
                                          , then the conclusion in Theorem 3.1 may not be true. So the initial knots are always chosen dense enough to avoid this case.

We take Fig. 4
                            as an illustration for Theorem 3.1. Data points are randomly sampled in 
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                            with 
                              N
                              =
                              101
                            from a B-spline associated with three interior knots 0.21, 0.5, and 0.93. The tolerance 
                              ε
                              =
                              1
                              
                                 
                                    0
                                 
                                 
                                    −
                                    6
                                 
                              
                            and the 201 initial knots are chosen uniformly from 
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           . Fig. 4(a) shows the approximated B-spline (red curve) and the associated active knots (blue triangles) selected in the first step. For each true knot, the two initial knots adjacent to it are selected as active knots. It should be pointed out that the requirement (
                              ε
                            should be small enough) in Theorem 3.1 is necessary. Fig. 4(b) shows the active knots and the corresponding approximated B-spline for the case 
                              ε
                              =
                              0.001
                           , where the two knots adjacent to knot 0.93 are not included in the active knots set.


                           Fig. 4 also illustrates that the knots of the approximated splines only by the first step are still much more than expected. Fortunately these active knots are clustered into three groups cleanly and are distributed intensively around a true knot. Such characteristic is not special when the data are sampled from a spline function. The following subsection will discuss how to design the knot adjustment strategy on account of this characteristic.

Let 
                           U
                         be the initial knot vector, 
                           
                              
                                 U
                              
                              
                                 ˜
                              
                           
                         be the set of active knots selected by problem (12) and 
                           
                              
                                 k
                              
                              
                                 1
                              
                           
                           <
                           
                              
                                 k
                              
                              
                                 2
                              
                           
                           <
                           ⋯
                           <
                           
                              
                                 k
                              
                              
                                 l
                              
                           
                         be the real knots of a given B-spline function 
                           f
                           
                              (
                              t
                              )
                           
                         as defined in Theorem 3.1. Obviously 
                           
                              
                                 U
                              
                              
                                 ˜
                              
                           
                         is a subset of 
                           U
                        . And if 
                           
                              [
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                              ]
                           
                         contains a knot of the given B-spline, then 
                           
                              
                                 t
                              
                              
                                 j
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 j
                                 +
                                 1
                              
                           
                         must be in 
                           
                              
                                 U
                              
                              
                                 ˜
                              
                           
                         based on Theorem 3.1. And such interval can be narrowed down to a single knot of the B-spline function. In this subsection, we will discuss how to find such interval and how to merge such interval to a single knot.

For each interval 
                           
                              [
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                              ]
                           
                        , we insert the middle point 
                           
                              
                                 t
                              
                              
                                 ∗
                              
                           
                         of the interval in 
                           
                              
                                 U
                              
                              
                                 ˜
                              
                           
                         to get a new knot vector 
                           
                              
                                 
                                    
                                       U
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          ∗
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                         And the sparse optimization problem (12) is solved again with 
                           
                              
                                 U
                              
                              
                                 ∗
                              
                           
                        . According to Theorem 3.1, if there is a real knot of 
                           f
                           
                              (
                              t
                              )
                           
                         in 
                           
                              [
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                              ]
                           
                        , then 
                           
                              
                                 t
                              
                              
                                 ∗
                              
                           
                         will be selected as an active knot, and, 
                           
                              
                                 t
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         or 
                           
                              
                                 t
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                              
                           
                         will become an inactive knot. For convenience and numerical stability, we usually find the minimal one of three jumps of the 
                           p
                        th derivative of the approximated B-spline at three knots 
                           
                              
                                 t
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 ∗
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                              
                           
                         and if the jump at 
                           
                              
                                 t
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         or 
                           
                              
                                 t
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                              
                           
                         is the minimal one, then the interval 
                           
                              [
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                              ]
                           
                         is considered as the candidate interval which will be narrowed down to a single knot. We conclude this idea in the function 
                           f
                           l
                           a
                           g
                           =
                           IsCandidateInterval (
                           i
                           ,
                           
                              t
                           
                           ,
                           E
                           r
                           r
                        ).

For each candidate interval 
                           
                              [
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                              ]
                           
                        , we replace interval 
                           
                              [
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                              ]
                           
                         with either 
                           
                              [
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    ∗
                                 
                              
                              ]
                           
                         or 
                           
                              [
                              
                                 
                                    t
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                              ]
                           
                         depending on the local fitting error, where 
                           
                              
                                 t
                              
                              
                                 ∗
                              
                           
                         is the middle point of the interval 
                           
                              [
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                              ]
                           
                        . Or in other words, we replace either knot 
                           
                              
                                 t
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         or 
                           
                              
                                 t
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                              
                           
                         with 
                           
                              
                                 t
                              
                              
                                 ∗
                              
                           
                        . This process is repeated until the interval does not contain any parameters 
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                         or the length of the interval is small enough. We then merge the two end points of the interval into a single knot.

The detailed procedure for adjusting knots is summarized in Algorithm 1.


                        
                           
                              
                           
                        
                     


                        
                           
                              
                           
                        
                     


                        
                           
                              
                           
                        
                     

In general, for data points sampled from a spline function, the strategy of finding a candidate interval can be simplified. The simplification is based on the observation that the selected active knots by the first step are separated into several groups naturally. So firstly we separate the input knots 
                           
                              
                                 U
                              
                              
                                 ˜
                              
                           
                         by the function 
                           G
                           =
                        
                        ClusterClassify(
                           δ
                           ,
                           
                              
                                 U
                              
                              
                                 ˜
                              
                           
                        ) according to knot spacing 
                           δ
                        . In detail, suppose 
                           
                              
                                 U
                              
                              
                                 ˜
                              
                           
                           
                              (
                              i
                              )
                           
                         belongs to the 
                           j
                        th group 
                           
                              
                                 G
                              
                              
                                 j
                              
                           
                        , if 
                           
                              
                                 U
                              
                              
                                 ˜
                              
                           
                           
                              (
                              i
                              +
                              1
                              )
                           
                           −
                           
                              
                                 U
                              
                              
                                 ˜
                              
                           
                           
                              (
                              i
                              )
                           
                           >
                           δ
                        , then 
                           
                              
                                 U
                              
                              
                                 ˜
                              
                           
                           
                              (
                              i
                              +
                              1
                              )
                           
                         belongs to the 
                           
                              (
                              j
                              +
                              1
                              )
                           
                        th group 
                           
                              
                                 G
                              
                              
                                 j
                                 +
                                 1
                              
                           
                        . The knot spacing 
                           δ
                         equals the length of two adjacent interior knots in the initial knot vector 
                           U
                        . With this function, the candidate intervals are found without solving problem (12) again.

In addition, in order to allow inserting multiple knots in an interval, a comparison between 
                           
                              
                                 E
                              
                              
                                 d
                              
                           
                         and 
                           
                              
                                 E
                              
                              
                                 p
                              
                           
                         is added, where 
                           
                              
                                 E
                              
                              
                                 d
                              
                           
                         and 
                           
                              
                                 E
                              
                              
                                 p
                              
                           
                         are the fitting errors of the least square approximated B-spline defined on 
                           
                              Mdt
                           
                         and 
                           
                              Mpt
                           
                         respectively. Here 
                           
                              Mdt
                           
                         and 
                           
                              Mpt
                           
                         are the knot vectors obtained by inserting a single knot and a double knot in 
                           
                              
                                 U
                              
                              
                                 ˜
                              
                           
                        , which are defined in Algorithm 4. We summarize this adjustment strategy in Algorithm 4.


                        
                           
                              
                           
                        
                     


                        
                           
                              
                           
                        
                     

Now we are ready to describe the algorithm to fit data points by a B-spline.


                        
                           Input
                           
                              data points 
                                    
                                       
                                          
                                             {
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             }
                                          
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 , degree 
                                    p
                                 , initial knot vector 
                                    U
                                 , tolerance 
                                    ε
                                 .

approximated B-spline 
                                    
                                       
                                          c
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 .

Solve optimization problem (12) and the resulting active knots are denoted by 
                                    
                                       
                                          U
                                       
                                       
                                          ˜
                                       
                                    
                                 .

Locally adjust the knots in 
                                    
                                       
                                          U
                                       
                                       
                                          ˜
                                       
                                    
                                  by Algorithm 1 or Algorithm 4. The resulting knot vector is regarded as 
                                    
                                       
                                          U
                                       
                                       
                                          ∗
                                       
                                    
                                 .

Solve least squares problem (9) and the approximated spline is the output 
                                    
                                       
                                          c
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 .

The proposed Algorithm of fitting with B-splines have the following convergence property.


                        
                           Theorem 3.2
                           
                              Suppose the data points are sampled dense enough from a B-spline of degree 
                              
                                 p
                               
                              with true knots 
                              
                                 K
                                 =
                                 
                                    {
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    ≤
                                    ⋯
                                    ≤
                                    
                                       
                                          k
                                       
                                       
                                          l
                                       
                                    
                                    }
                                 
                              
                              , then the final knot vector 
                              
                                 
                                    
                                       U
                                    
                                    
                                       ∗
                                    
                                 
                               
                              obtained by the above algorithm is an approximation of the true knots 
                              
                                 K
                               
                              with the given tolerance 
                              
                                 t
                                 o
                                 l
                               
                              . More precisely, for every true knot 
                              
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                              
                              , there is a knot 
                              
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 ∈
                                 
                                    
                                       U
                                    
                                    
                                       ∗
                                    
                                 
                               
                              satisfying 
                              
                                 
                                    |
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                    |
                                 
                                 <
                                 t
                                 o
                                 l
                              
                              , where 
                              
                                 t
                                 o
                                 l
                               
                              is the input parameter in Algorithm  1.
                           


                        
                           Proof
                           This is obviously true based on Theorem 3.1 and Algorithm 1. □


                        
                           Remark 3.2
                           
                              
                                 
                                    1.
                                    When the data points are sampled from spline function, Algorithm 4 is much faster and more effective than Algorithm 1. For general given data points, the selected knots by the first step do not have obvious phenomenon of cluster, so it is better to use Algorithm 1. Above all, if the knots selected by the first step are separated into several groups obviously, then Algorithm 4 is preferred.

For all numerical examples in this section, we use cubic B-splines (
                        p
                        =
                        3
                     ) for least square fitting. The mean squared error (MSE for short) and the maximum error (ME for short), defined as 
                        M
                        S
                        E
                        =
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              N
                           
                        
                        
                           
                              
                                 (
                                 c
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                           
                              2
                           
                        
                        /
                        N
                      and 
                        M
                        E
                        =
                        
                           
                              max
                           
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              N
                           
                        
                        
                           ‖
                           c
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           −
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           ‖
                        
                      respectively, are used to measure the fitting equality.

In Section  4.1, the Titanium heat data are fitted by our method to show the advantage of our method which favors fewer knots. In Section  4.2, the data points sampled from a Chebyshev polynomial of degree 10 are approximated by our method to demonstrate the effectiveness of approximation of functions. In Section  4.3, the proposed method is applied to the data points which are sampled from a B-spline. This example shows the exclusive property of recovering knots of a sampled spline with enough sampling by our method. We have implemented our algorithm on a PC with four-core Intel i5 CPU and 4GB RAM. All computations are done in Matlab and the CVX  [30] package is called for solving sparse optimization problem (12).

Firstly we consider the Titanium heat data with 49 observations  [31]. The data are hard to fit well by traditional techniques due to the sharp peak in the data, and have therefore often been used to test spline fitting algorithms  [11,12,31,32]. The data originally ranged from 
                           
                              [
                              595
                              ,
                              1075
                              ]
                           
                         and are normalized to 
                           
                              [
                              0
                              ,
                              75
                              ]
                           
                         in this paper. The normalization using linear change of scale has no effect on the optimal knot distribution.

The initial knots are chosen as 101 equidistant knots in 
                           
                              [
                              0
                              ,
                              75
                              ]
                           
                         and 
                           ε
                           =
                           0.0017
                        . Fig. 5
                        (a) shows the eight active knots (triangles) selected in the first step and the corresponding fitted spline (dashed line). Fig. 5(b) shows the approximated B-spline together with five interior knots by the second step. The fitting error 
                           M
                           S
                           E
                         of our fit is 0.014128.


                        Table 1
                         lists the interior knots and residual error of the approximated spline using our method and other two works  [21,22]. The residual error is defined by 
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   c
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          N
                                          −
                                          1
                                       
                                    
                                    )
                                 
                              
                              
                                 1
                                 /
                                 2
                              
                           
                         with 
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 w
                              
                              
                                 N
                              
                           
                           =
                           1
                           /
                           2
                           ,
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           =
                           1
                           ,
                           i
                           =
                           2
                           ,
                           …
                           ,
                           N
                           −
                           1
                        . From the comparisons in Table 1, we can see that the second step of our method indeed reduces redundant knots and favors one less knot comparing to the other two methods  [21,22], which indicates the significance of the second step. Additionally, the five knots calculated by our method are very close to the five knots selected by Jupp’s method  [11] in which it has been identified that the five interior knots are optimal when the knots number is 5. However, the knots number is fixed in advance by Jupp’s method while is found automatically by our method. The last line in Table 1 shows the five optimal knots selected by Jupp’s method.

In this subsection, we approximate the Chebyshev polynomial 
                           
                              
                                 T
                              
                              
                                 10
                              
                           
                         of degree 10 on the interval 
                           
                              [
                              −
                              1
                              ,
                              1
                              ]
                           
                         which has been considered by T. Lyche and K. Mørken  [20]. The data points are sampled from 
                           
                              
                                 T
                              
                              
                                 10
                              
                           
                         at 401 uniformly spaced points. In the paper  [20], firstly the knot removal strategy was used for the linear interpolate of the data points, then the knot removal strategy was used again for the cubic spline which was transformed from the reduced linear interpolate. We recompute the approximated cubic spline by the method in  [20] which has built in SISL package(https://github.com/SINTEF-Geometry/SISL) and the approximated spline together with 13 interior knots is shown in Fig. 6
                        (b), where the knots are marked by triangles.


                        Fig. 6(a) shows the approximated spline together with 14 interior knots calculated by our method. The 14 interior knots are marked by triangles and the fitting error is 
                           M
                           S
                           E
                           =
                           3.4745
                           
                              e
                           
                           −
                           5
                        . The initial knots are chosen uniformly 25 equidistant points in 
                           
                              [
                              −
                              1
                              ,
                              1
                              ]
                           
                         and the parameter is chosen as 
                           ε
                           =
                           0.003
                        . By the way, for this function, the second step is not performed. The final fourteen interior knots of the approximated spline are selected automatically only by the first step.

The approximated error 
                           M
                           E
                         computed by our algorithm with 14 interior knots is 0.017258 compared with 0.037530, which is computed by the knot removal algorithm  [20] with 13 interior knots. As seen from Fig. 6(a), the one more knot by our algorithm is around zero and contributes to the smaller approximated error 
                           M
                           E
                         comparing to the algorithm in  [20]. And the interior knots calculated by our method distribute regularly in the domain 
                           
                              [
                              −
                              1
                              ,
                              1
                              ]
                           
                         and are selected adaptively according to the underlying curvature structures of the unknown function. By the way, as the SISL algorithm was developed with a great deal of optimization, the SISL implementation is faster than our algorithm.

In this subsection, we consider a B-spline function with the following knots: 
                           
                              
                                 
                                    (
                                    0.0439
                                    ,
                                    0.0653
                                    ,
                                    0.2293
                                    ,
                                    0.2367
                                    ,
                                    0.4821
                                    ,
                                    0.4907
                                    ,
                                    0.5408
                                    ,
                                    0.5408
                                    ,
                                    0.6209
                                    ,
                                    0.7051
                                    ,
                                    0.9407
                                    )
                                 
                                 ,
                              
                           
                         where 0.5408 is a double knot. Fig. 7
                        (a) shows this spline function. The data points are sampled uniformly 1001 points from this B-spline function. The parameter 
                           ε
                         is set to be 2.0e−5 and the initial knots are chosen uniformly 501 equidistant points in 
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                        .


                        Fig. 7(b) shows the approximated B-spline function (red curve) together with the active knots (blue triangles) selected by the first step. Notice that the active knots are clustered into several groups and especially around the double knot 0.5408. Fig. 7(c) shows the knots of the approximated B-spline function after the second step. The 
                           M
                           S
                           E
                         of our fit is 3.7596e−6. The obtained interior knots are 
                           
                              
                                 
                                    (
                                    0.043969
                                    ,
                                    0.065281
                                    ,
                                    0.229406
                                    ,
                                    0.236594
                                    ,
                                    0.482094
                                    ,
                                    0.490906
                                    ,
                                    0.496031
                                    ,
                                    0.540859
                                    ,
                                    0.540859
                                    ,
                                    0.620969
                                    ,
                                    0.705031
                                    ,
                                    0.940844
                                    )
                                 
                                 .
                              
                           
                         If we remove the knot 0.496031 which is not in the true knot vector, the fitting error 
                           M
                           S
                           E
                         increases to 1.469837e−4.

We compared our method with the three methods in the work  [20–22]. Fig. 7(d) shows the approximated B-spline function together with the knots using the method in  [20]. The resulting spline has 28 interior knots (0.49 is a double knot and 0.54 is a triple knot) and the maximum fitting error 
                           M
                           E
                         is 1.49802e−2. The fitting error of our fit is 
                           M
                           E
                           =
                           1.2769
                           
                              e
                           
                           −
                           2
                         which is smaller than that of the method in  [20] and also the knots number determined by our method is fewer than that of the method in  [20]. Fig. 8
                         illustrates the fitting result using the method in  [21,22]. It can be seen that there are still much redundant knots in the approximated spline function, especially the redundant knots around the double knot 0.5408.

From the above comparison, for the data points sampled from a spline function, our method shows a significant superiority of removing redundant knots and recovering the true knots of the given spline.

Finally we discuss the effect of non-uniform sampling on recovering the true knots of a given spline function. We take the above ground truth as an illustration. Fig. 9
                         shows the fitting result when the data points are sampled randomly. The final interior knots are
                           
                              
                                 
                                    (
                                    0.043969
                                    ,
                                    0.065282
                                    ,
                                    0.229406
                                    ,
                                    0.236598
                                    ,
                                    0.482031
                                    ,
                                    0.490906
                                    ,
                                    0.531969
                                    ,
                                    0.537969
                                    ,
                                    0.537969
                                    ,
                                    0.620099
                                    ,
                                    0.705406
                                    ,
                                    0.940531
                                    )
                                 
                                 .
                              
                           
                         It can be seen that now the true double knot 0.5408 is recovered with a larger error than that of the uniform sampling. The worst case of non-uniform sampling is some of the true knots especially the multiple knots cannot be recovered. The reason can be explained as in Remark 3.1. The random sampling results in nonuniform distribution of data points in an interval, consequently some of the candidate intervals cannot be found exactly in the second step, leading to some true knots omitted.


                        
                           Remark 4.1
                           
                              
                                 
                                    1.
                                    The code of our algorithm is not optimized thoroughly. Therefore the time cost is expensive. The time cost of the first step is about 0.22 s while the time cost of the second step is about 40 s for the above three examples. It can be seen that the time cost of first step is much smaller than that of the second step. Generally speaking, the time cost of the first step depends on the given data points and the time cost of the second step depends on the number of input active knots.

@&#CONCLUSIONS@&#

In this paper, we propose a framework for computing knots number and position in curve fitting with splines based on a sparse optimization model. The knots number and position can be found automatically by two steps. In the first step, several knots are selected from the initial knots by solving a sparse optimization problem. There are still much more redundant knots after the first step. We further remove redundant knots and adjust the positions of active knots to obtain the final knot vector. So the resulting knot vector in the second step is not a subset of the initial knot vector given in the first step any more. This is the main difference between our method and the two methods in  [21,22]. Our experiments show that the approximation spline curve obtained by our approach has less number of knots compared to existing methods. Particularly, when the data points are sampled dense enough from a spline, our algorithm can recover the ground truth knot vector and reproduce the spline.

There are a few problems worthy of further investigation. First, the time cost now is expensive and the method can only handle data with small noise. We will investigate how to optimize the code to decrease the time cost and how to add penalty term in the sparse optimization model to deal with noisy data. Second, how to design a much more effective strategy to deal with multiple knots? A possible way is to estimate the derivatives information from given data points to locate the multiple knots. Third, how to extend the idea to parametric curves and surfaces will be an interesting but a challenging problem.

@&#ACKNOWLEDGMENTS@&#

The authors thank the reviewers for providing useful comments and suggestion. The work is supported by 973 Program
                  2011CB302400, the National Natural Science Foundation of China (Nos. 11031007, 11371341, 11171322) and the Program NCET-11-08815.

@&#REFERENCES@&#

