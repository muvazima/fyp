@&#MAIN-TITLE@&#An Unlinkable Anonymous Payment Scheme based on near field communication

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose an anonymous mobile payment protocol to protect users’ privacy.


                        
                        
                           
                           Using anonymizing schemes to improve anonymity and unlinkability in a mobile transaction.


                        
                        
                           
                           Users can use mobile phones with NFC to perform commercial transactions.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Unlinkability

Anonymity

Mobile payment

@&#ABSTRACT@&#


               
               
                  A number of mobile payment studies have been proposed in recently years. Most of the schemes are largely focused on transaction security, not on users’ privacy. In this paper, we propose an Unlinkable Anonymous Payment Scheme to provide a secure and anonymous mobile commerce environment. In the proposed protocol, a user applies an anonymous virtual credit card from a trusted service manager. The sensitive information of the applied credit card is stored in the secure elements of user’s mobile device. Our proposed protocol ensures various imperative security properties such as anonymity, unlinkability, and non-repudiation etc.
               
            

@&#INTRODUCTION@&#

With the rapid development of wireless communication, users can perform electronic payment on their mobile devices such as smartphones. Mobile devices have high computing and communication ability, and large storage; therefore, money transfer services are shifting from traditional methods (such as pay on arrival, ATM transfer, or credit cards) to mobile devices. For consumers, it is much more convenient to use smartphones instead of traditional computers in mobile commerce activities. In 1982, Chaum [2] proposed the concept of anonymous payment. Since then, more and more mobile payment schemes have been proposed. Chen et al. [4] propose a payment scheme that is based on 3G/UMTS security services. Toorani and Beheshti [20] propose a small amount payment scheme based on short message service (SMS).

Near field communication (NFC) is a short-range wireless communication technology that enables communication between two devices in close proximity to each other (e.g., within 10cm). NFC devices have a higher degree of security because both sniffing communications and man-in-the-middle attacks are then harder if not impossible to accomplish. In recent years, NFC technology is being increasingly considered as a solution for contactless mobile payment services.

Saeed and Pourghomi [19] integrate NFC into mobile transaction by using Global System for Mobile Communications (GSM) authentication. Kumari et al. [15] propose anonymous withdrawal and payment in small amount transactions. In Martínez-Peláez et al.’s scheme, a customer’s identity is kept anonymous. This scheme prevents double spending and forgery attacks. As the banks keep customers’ transaction records, they may breach their privacy. Molloy et al. [16] propose a virtual credit card mechanism that utilizes a dynamic virtual credit card number to mitigate the loss in card theft. The virtual credit card accounts are derived from a user’s existing physical credit card account. Grønli et al. [12] propose architecture to support the concept of mobile wallet. The most well-known NFC mobile payment applications include Google Wallet and Apple pays, which are all based on the EMV standard. EMV is a technical standard for smart payment cards, which stands for Europay, MasterCard, and Visa, the three companies which originally created the standard [10].

However, these schemes are largely focused on transaction security, not on users’ anonymity. In this paper, we propose an NFC-Based Unlinkable Anonymous Payment Scheme. In our scheme, sensitive data such as users’ real identities and the encrypted keys are stored in the trusted element (the secure element) of a Mobile Trusted Module (MTM) [7,10,11]. The host applications on the mobile phone should be verified by the remote attestation services. The users have to open a financial bank account to get a virtual bank account identifier. Then the users apply for an anonymous transaction account from the TSM, which will issue an EMV-compatible virtual credit card that has limited valid time and credits. The card will be stored in the smartphone’s secure elements. If the card expires or if the virtual account’s balance reaches the limits, the users must apply for another virtual bank account and a new virtual credit card.

The main contributions of our scheme include convenience, anonymity, unlinkability, and non-repudiation.
                        
                           •
                           Convenience: users can simply take their NFC phones for transactions. Traditional credit cards are not required.

Anonymity: the user’s real identity is hide. Except the bank, no entities in the payment procedure can determine the users’ real identity.

Unlinkability: unlinkability is also called strong anonymity. In our scheme, merchants can only retrieve a temporary virtual credit card’s information of a user. The adversary cannot trace the mobile phone by using interactions with the phone. Even though TSM has users’ payment information, it can only track to their anonymous virtual accounts. The information of users’ real identities will not be revealed to TSM. As for the issuing bank, it is unable to know their transaction records.

Non-repudiation: in our scheme, all the messages of registration, transactions, and card issuance are signed to guarantee non-repudiation.

The rest of the paper is organized as follows. Section 2 describes our propose anonymous scheme. Section 3 analyses our scheme’s security strength by using the common security attack models. Section 4 then compares our protocol with other related studies. Finally, Section 5 presents our conclusions.

Our propose anonymous payment scheme consists of four phases: (1) registration; (2) anonymous virtual bank account generation phase; (3). anonymous transaction account generation phase; and (4) virtual credit card generation phase. The following introduces the roles in our system:
                        
                           1.
                           Bank: it provides accounts for users.

Trusted Service Manager (TSM): TSM is a trusted third party (TTP) that provides services and management of anonymous credit cards; requests payment from and verifies anonymous authority with banks; and provides transaction services.

Host: it is the execution environment in an NFC-enabled mobile phone. In the mobile phone, an application issued from the service provider is responsible for the payment process.

Secure element (SE): SE is a secure storage in an NFC-enabled mobile phone.

Merchant (M): denotes a merchant in a mobile transaction.

The four phases of our scheme are described as follow:
                        
                           1.
                           Registration phase: At this stage, the system generates parameters that are required for the payment process.

Anonymous virtual bank account generation phase: A user applies for an anonymous account to be used for payment from his bank.

Anonymous transaction account generation phase: A user takes his virtual bank account identifier to the TSM to create a transaction account. After the TSM verifies the user’s allowed credits with his bank, it issues a service account to him.

Virtual credit card generation phase: A user requests a temporary virtual credit card from the TSM and stores it into the SE.


                        Table 1
                         lists the notations used in our scheme.

When a user opens a bank account with a valid identification document and commits to his attributes and public key, the bank issues a certificate 
                           
                              
                                 
                                    CERT
                                 
                                 
                                    U
                                 
                                 
                                    B
                                 
                              
                           
                         corresponding to the user’s public key PKU
                        . The bank generates a shared key 
                           
                              
                                 
                                    K
                                 
                                 
                                    B
                                    ,
                                    U
                                 
                              
                           
                         between the bank and the user. The key is delivered over an out-of-band secure channel, and stored in the NFC phone’s SE. The key agreement can be done by the key-establishment protocols [1,8,15,18].

In this stage, a user applies for an anonymous account identifier 
                           
                              
                                 
                                    AID
                                 
                                 
                                    i
                                 
                              
                           
                         from the bank, as shown in Fig. 1
                        . After the bank authenticates the user, the bank issues a digital certificate that corresponds to 
                           
                              
                                 
                                    AID
                                 
                                 
                                    i
                                 
                              
                           
                         ’s public key. Detailed steps are as follow:
                           
                              Step 1.
                              
                                 The user takes his identifier 
                                    
                                       
                                          
                                             ID
                                          
                                          
                                             U
                                          
                                       
                                    
                                  and a nonce Nonce
                                 1 to sign a request SIGN(SKU
                                 , IDU
                                 || Nonce
                                 1) and then encrypts the signed request to the bank, i.e. E(KB,U
                                 , SIGN(SKU
                                 , IDU
                                 || Nonce
                                 1)).

The bank decrypts and verifies the request by using the shared key KB,U
                                 , and generates a virtual account identifier 
                                    
                                       
                                          
                                             AID
                                          
                                          
                                             i
                                          
                                       
                                    
                                  and a nonce Nonce2.

The bank encrypts IDU
                                 , AIDi
                                 , and Nonce2
                                  with the session key KB,U
                                 , and sends back IDB
                                 || E(KB,U
                                 , IDU
                                 || AIDi
                                 || Nonce2
                                 ) to the user.

The user decrypts the message, and sends IDU
                                 || AIDi
                                 || Nonce2
                                  to SE.

The SE generates a pair of asymmetric keys (
                                    
                                       
                                          
                                             PK
                                          
                                          
                                             
                                                
                                                   AID
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 , 
                                    
                                       
                                          
                                             SK
                                          
                                          
                                             
                                                
                                                   AID
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 ) that corresponds to the identifier AIDi
                                 . These keys are stored in the SE.

The SE sends the public key PKAIDi
                                    
                                  to the user with a self-signed message SIGN(SKAIDi
                                    
                                 , IDU
                                 || AIDi
                                 || PKAIDi
                                    
                                 || Nonce2
                                 )|| PKAIDi
                                    
                                 .

The user encrypts the self-signed message with the shared key 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             B
                                             ,
                                             U
                                          
                                       
                                    
                                  and sends (IDU
                                 || E(KB,U
                                 , SIGN(SKU
                                 , IDU
                                 || AIDi
                                 || SIGN(SKAIDi
                                    
                                 , IDU
                                 || AIDi
                                 || PKAIDi
                                    
                                 || Nonce2
                                 )|| Nonce2
                                 )) to the bank.

The bank decrypts the received message and retrieves 
                                    
                                       
                                          
                                             PK
                                          
                                          
                                             
                                                
                                                   AID
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 . Next it creates a certificate 
                                    
                                       
                                          
                                             CERT
                                          
                                          
                                             
                                                AID
                                             
                                             
                                                i
                                             
                                          
                                          
                                             B
                                          
                                       
                                    
                                  that corresponds to the public key 
                                    
                                       
                                          
                                             PK
                                          
                                          
                                             
                                                
                                                   AID
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 . The bank sends the certificate, 
                                    
                                       
                                          
                                             AID
                                          
                                          
                                             i
                                          
                                       
                                    
                                  ’s expiry time AIDi_ExpTime, 
                                    
                                       
                                          
                                             AID
                                          
                                          
                                             i
                                          
                                       
                                    
                                  ’s credit limit AIDi_Limit, and the certificate 
                                    
                                       
                                          
                                             CERT
                                          
                                          
                                             
                                                AID
                                             
                                             
                                                i
                                             
                                          
                                          
                                             B
                                          
                                       
                                    
                                 , to the SE by using the public key PKAIDi
                                    
                                  to encrypt the message; and sends the session key 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             
                                                
                                                   AID
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             B
                                          
                                       
                                    
                                  to the user by using the session key KB,U
                                 , i.e. (IDB
                                 || E(PKAIDi
                                    
                                 , AIDi
                                 || AIDi_ExpTime|| AIDi_Limit|| 
                                    
                                       
                                          
                                             CERT
                                          
                                          
                                             
                                                AID
                                             
                                             
                                                i
                                             
                                          
                                          
                                             B
                                          
                                       
                                    
                                  || KAIDi,B
                                 ) || E(KB,U, AIDi
                                 || 
                                    
                                       
                                          
                                             CERT
                                          
                                          
                                             
                                                AID
                                             
                                             
                                                i
                                             
                                          
                                          
                                             B
                                          
                                       
                                    
                                 || KAIDi,B
                                 )).

The user sends the encrypted message to SE. SE retrieves the session key 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             
                                                
                                                   AID
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             B
                                          
                                       
                                    
                                  and the certificate 
                                    
                                       
                                          
                                             CERT
                                          
                                          
                                             
                                                AID
                                             
                                             
                                                i
                                             
                                          
                                          
                                             B
                                          
                                       
                                    
                                  from the encrypted message.

As Fig. 2
                         shows, after a user opens a virtual bank account, he has to register to TSM for a virtual credit card. At this stage, the user needs to create a pre-paid account first, and sets a limit to a transaction’s maximum amount. This pre-paid account will be charged from the user’s virtual bank account. To secure the payment, the user takes the bank-user shared key 
                           
                              
                                 
                                    K
                                 
                                 
                                    
                                       
                                          AID
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    B
                                 
                              
                           
                         to encrypt the payment info BINFO, 
                           
                              
                                 
                                    AID
                                 
                                 
                                    i
                                 
                              
                           
                        , 
                           
                              
                                 
                                    AID
                                 
                                 
                                    i
                                 
                              
                           
                         ’s expiry time AIDi_ExpTime, and 
                           
                              
                                 
                                    AID
                                 
                                 
                                    i
                                 
                              
                           
                         ’s allowed credits AIDi_Limit. He uses 
                           
                              
                                 
                                    SK
                                 
                                 
                                    
                                       
                                          AID
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         to sign the encrypted message and sends it to the bank through the TSM. Also, the user encrypts the payment info BINFO with the TSM-user shared key 
                           
                              
                                 
                                    K
                                 
                                 
                                    
                                       
                                          TID
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    TSM
                                 
                              
                           
                        , uses 
                           
                              
                                 
                                    SK
                                 
                                 
                                    
                                       
                                          TID
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         to sign the encrypted message, and sends it to TSM.

Subsequently, the TSM decrypts the payment info TSMINFO and uses the bank’s public key 
                           
                              
                                 
                                    PK
                                 
                                 
                                    B
                                 
                              
                           
                         to encrypt it and uses 
                           
                              
                                 
                                    SK
                                 
                                 
                                    TSM
                                 
                              
                           
                         to sign it. Then the TSM sends the encrypted and signed TSMINFO to the bank, along with the TSMBINFO that the user sends to the bank through the TSM. After the bank decrypts TSMBINFO, it compares the two messages’ payment info. If the two match, the bank sends the virtual bank account’s credit info to the TSM.

Detailed steps are as follow:
                           
                              Step 1. User sends a registration request.
                                    
                                       1.
                                       The user creates an account identifier 
                                             
                                                
                                                   
                                                      TID
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          , generates a pair of asymmetric keys (
                                             
                                                
                                                   
                                                      PK
                                                   
                                                   
                                                      
                                                         
                                                            TID
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          , 
                                             
                                                
                                                   
                                                      SK
                                                   
                                                   
                                                      
                                                         
                                                            TID
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          ), signs and encrypts the message: E(PKTSM
                                          , SIGN(SKTIDi
                                          , TIDi
                                           || PKTIDi
                                             
                                           || TimeStamp)). He requests to generate a 
                                             
                                                
                                                   
                                                      TID
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                           message E(PKTID
                                          , SID || TIDi
                                           || KTIDi
                                             
                                          ,TSM) and sends the message to TSM.

When the TSM receives the request, it decrypts the message, generates a shared key 
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      
                                                         
                                                            TID
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      TSM
                                                   
                                                
                                             
                                          , returns it to the user, and requires him to provide credit info so as to access the service.

Step 2. User provides virtual bank account information
                                    
                                       1.
                                       The user requests a session identifier SID, 
                                             
                                                
                                                   
                                                      AID
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                           and 
                                             
                                                
                                                   
                                                      AID
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                           ’s bank, and nonce 
                                             
                                                
                                                   
                                                      Nonce
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                           to be sent to 
                                             
                                                
                                                   
                                                      ID
                                                   
                                                   
                                                      SE
                                                   
                                                
                                             
                                          .

The SE generates BINFO and 
                                             
                                                
                                                   
                                                      Nonce
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                           to the user, where BINFO
                                          =
                                          SIGN(SAIDi
                                             
                                          , E(KAIDi,B
                                          , SID || AIDi
                                           || IDTSM
                                           || IDB
                                           || AIDi_ExpTime || AIDi_Limit || Nonce
                                          2)).


                                          
                                             
                                                
                                                   
                                                      ID
                                                   
                                                   
                                                      U
                                                   
                                                
                                             
                                           generates TSMINFO, where TSMINFO
                                          =
                                          SIGN(SKTIDi
                                             
                                          , E(KTIDi,TSM
                                          , SID || AIDi
                                           || IDTSM
                                           || IDB
                                           || Nonce
                                          2 || AIDi_ExpTime || AIDi_Limit)).


                                          BINFO, TSMINFO and 
                                             
                                                
                                                   
                                                      Nonce
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                           are encrypted, signed with 
                                             
                                                
                                                   
                                                      SK
                                                   
                                                   
                                                      
                                                         
                                                            TID
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          , and sent to 
                                             
                                                
                                                   
                                                      ID
                                                   
                                                   
                                                      TSM
                                                   
                                                
                                             
                                          .

The TSM receives 
                                             
                                                
                                                   
                                                      TID
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                           ’s identity information.

Step 3. TSM requests verification from the bank.

After receiving 
                           
                              
                                 
                                    TID
                                 
                                 
                                    i
                                 
                              
                           
                         ’s identity info, the TSM requests the bank to verify the identity info.
                           
                              1.
                              The TSM decrypts the message and derives 
                                    
                                       
                                          
                                             AID
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , 
                                    
                                       
                                          
                                             ID
                                          
                                          
                                             B
                                          
                                       
                                    
                                 , SID, AIDi_ExpTime and AIDi_Limit.

The TSM uses 
                                    
                                       
                                          
                                             AID
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , AIDi_ExpTime and AIDi_Limit to generate TSMBINFO, where TSMBINFO
                                 =
                                 SIGN(SKTSM
                                 , E(PKB
                                 , SID || AIDi
                                  || Nonce
                                 2 || AIDi_ExpTime || AIDi_Limit || KTSM,B
                                 )).

The TSM encrypts 
                                    
                                       
                                          
                                             AID
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , BINFO and TSMBINFO with the bank’s public key and sends the message E(PKB
                                 , IDB
                                 || AIDi
                                 || BINFO|| SID|| IDTSM
                                 || TSMBINFO) to the bank.

The bank decrypts the message and compares BINFO with TSMBINFO. If the two are identical, 
                                    
                                       
                                          
                                             ID
                                          
                                          
                                             B
                                          
                                       
                                    
                                  sends 
                                    
                                       
                                          
                                             AID
                                          
                                          
                                             i
                                          
                                       
                                    
                                  ’s credit info to TSM.

Step 4. The TSM verifies that 
                                    
                                       
                                          
                                             TID
                                          
                                          
                                             i
                                          
                                       
                                    
                                  is authorized to access the services, and sends 
                                    
                                       
                                          
                                             TID
                                          
                                          
                                             i
                                          
                                       
                                    
                                  ’s expiry time and the allowed credits to the user, i.e. (TIDi
                                 || E(KTIDi,TSM
                                 , Status|| TIDi_ExpTime|| TIDi_limit)).

As shown in Fig. 3
                        , after a user is authorized to apply for an anonymous transaction account from the TSM, the TSM can issue the user an EMV-compatible virtual credit card that has a shorter expiry time and lower credits. The virtual credit card is stored in SE. If the card expires, he can request TSM to generate another card. Detailed steps are as follow:
                           
                              Step 1.
                              The user sends a request to SE with his anonymous transaction account identifier 
                                    
                                       
                                          
                                             TID
                                          
                                          
                                             i
                                          
                                       
                                    
                                 .

The SE generates a new asymmetric key pair (
                                    
                                       
                                          
                                             PK
                                          
                                          
                                             
                                                
                                                   TID
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 , 
                                    
                                       
                                          
                                             SK
                                          
                                          
                                             
                                                
                                                   TID
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 ) that corresponds to 
                                    
                                       
                                          
                                             TID
                                          
                                          
                                             i
                                          
                                       
                                    
                                 .

The user encrypts the message and forwards the self-signed message E(KTIDi,TSM
                                 , SIGN(SKTIDi
                                    , AIDi Nonce1
                                 || TIDi
                                 || PTIDi
                                    
                                 || Nonce2
                                 )|| PTIDi
                                    
                                 || Nonce1
                                 ) to TSM.

The TSM issues a virtual credit card TIDi_CreditINFO that is protected by 
                                    
                                       
                                          
                                             SK
                                          
                                          
                                             
                                                
                                                   TID
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 , and a certificate 
                                    
                                       
                                          
                                             CERT
                                          
                                          
                                             
                                                
                                                   TID
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             TSM
                                          
                                       
                                    
                                 . Last, 
                                    
                                       
                                          
                                             CERT
                                          
                                          
                                             
                                                
                                                   TID
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             TSM
                                          
                                       
                                    
                                  and TIDi_CreditINFO are stored into SE.

The rest transaction process follows EMV standards and uses an NFC phone’s card emulation mode to serve as a virtual credit card for mobile payment.

This section analyses our scheme’s security based on confidentiality, integrity, anonymity, non-repudiation, replay attacks prevention, and man-in-the-middle (MITM) attacks prevention.

When a user applies for a virtual bank account, the messages between the SE and the bank are all encrypted with asymmetric keys. Because SE protects the keys and encrypts/decrypts the messages, the messages during the application can remain confidential. A shared key between the bank and the user also encrypts the messages following the application. Since attackers are unable to access the encrypted messages, they cannot acquire the transaction information. And the application information is stored in SE too, accessible to authorized entities only.

When a user applies for a virtual bank account, the bank generates a shared key 
                           
                              
                                 
                                    K
                                 
                                 
                                    
                                       
                                          AID
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    B
                                 
                              
                           
                        , which is stored in SE. Meanwhile, SE also generates a key pair (
                           
                              
                                 
                                    PK
                                 
                                 
                                    
                                       
                                          AID
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    SK
                                 
                                 
                                    
                                       
                                          AID
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        ) for account authorization. Because the key pair is unique and changes in every session, attackers cannot modify it. When the bank sends the public key 
                           
                              
                                 
                                    PK
                                 
                                 
                                    
                                       
                                          AID
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        , the user’s private key signature and the shared key 
                           
                              
                                 
                                    K
                                 
                                 
                                    
                                       
                                          AID
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    B
                                 
                              
                           
                         are used to secure the message’s integrity. Therefore, their communications are tamper-proof.

When a user registers to TSM, he self-signs his registration info and encrypts it with the TSM’s public key. Only TSM can access the message, so any modified messages are unable to pass verification. Besides, this registration requires establishment of a link with the user’s virtual bank account. By this, the TSM verifies the user’s legitimacy and prevents a masquerade and authorized modifications. Because the TSM cannot know a user’s real identity, the bank must help verify the user’s legitimacy. For application, a user’s SE will generate BINFO to the bank. The message is encrypted with 
                           
                              
                                 
                                    K
                                 
                                 
                                    
                                       
                                          AID
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    B
                                 
                              
                           
                         and signed with 
                           
                              
                                 
                                    SK
                                 
                                 
                                    
                                       
                                          AID
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        , so as to remain tamper-proof. Also, the user generates a pay message TSMBINFO to TSM. Likewise, the message is encrypted with 
                           
                              
                                 
                                    K
                                 
                                 
                                    
                                       
                                          TID
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    TSM
                                 
                              
                           
                         and signed with 
                           
                              
                                 
                                    SK
                                 
                                 
                                    
                                       
                                          AID
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         to prevent forgery and modification. All the communications are encrypted and signed to prevent forgery and modification.

As for the message integrity during the issuance of a virtual credit card, because a user and the TSM’s communications are all signed with 
                           
                              
                                 
                                    SK
                                 
                                 
                                    
                                       
                                          TID
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         and encrypted with 
                           
                              
                                 
                                    K
                                 
                                 
                                    
                                       
                                          TID
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    TSM
                                 
                              
                           
                        , adversaries cannot access or modify the messages. Besides, the key pairs and the card information are stored in the SE. The expiry time and credits must be renewed by the TSM within a specific timeframe. Therefore, attackers cannot tamper with these messages.

During users’ application for a virtual bank account, mutual authentication is performed only with the bank. Therefore, only the bank knows users’ real identity. After the virtual bank account generation phase, the bank issues a virtual bank account 
                           
                              
                                 
                                    AID
                                 
                                 
                                    i
                                 
                              
                           
                         to the user. When the user uses the 
                           
                              
                                 
                                    AID
                                 
                                 
                                    i
                                 
                              
                           
                         to apply for an anonymous transaction account from the TSM, the TSM does not know user’s identity. When the user applies for a virtual credit card from the TSM, the TSM issues a temporary EMV-compatible virtual credit card that is to be stored in his SE. The merchants do not know user’s identity, too.

In our scheme, when the user uses the 
                           
                              
                                 
                                    AID
                                 
                                 
                                    i
                                 
                              
                           
                         to apply for an anonymous transaction account from the TSM, the TSM only receives the authorization information of the virtual bank account, i.e., the expiration time AIDi_ExpTime and the account balance AIDi_Limit from the bank. As shown in Table 2
                        , a pre-paid account contains the virtual account’s identifier, the expiry time and the account balance. TSM only knows the user has been authorized by the bank to access a virtual bank account, but it cannot know the user’s real identity. Also, the user’s bank cannot know the user’s anonymous transaction account information.

When the user applies for a virtual credit card from the TSM, the TSM issues a temporary EMV-compatible virtual credit card that is to be stored in his SE. Users can take this virtual credit card for transactions. Because the card is anonymous, the acquiring bank cannot access users’ transaction info and the merchants cannot know the users’ real identity, either.

In our scheme, all the messages of account application or registration, card issuance, and transactions must be signed. The TSM and the bank record all the transactions.

When a user applies for a virtual bank account, his phone’s SE generates a pair of keys (
                           
                              
                                 
                                    PK
                                 
                                 
                                    
                                       
                                          AID
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    SK
                                 
                                 
                                    
                                       
                                          AID
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        ) for the account’s identifier 
                           
                              
                                 
                                    AID
                                 
                                 
                                    i
                                 
                              
                           
                        . Therefore, in the rest transaction process, messages are all signed with 
                           
                              
                                 
                                    SK
                                 
                                 
                                    
                                       
                                          AID
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         to guarantee non-repudiation.

During the anonymous transaction account generation phase, the TSM creates a pre-paid account, and generates a new key pair (
                           
                              
                                 
                                    PK
                                 
                                 
                                    
                                       
                                          TID
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    SK
                                 
                                 
                                    
                                       
                                          TID
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        ). The message BINFO must be signed with 
                           
                              
                                 
                                    SK
                                 
                                 
                                    
                                       
                                          AID
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         and sent to the bank through TSM. Also, the user’s TSMINFO for the TSM is signed with 
                           
                              
                                 
                                    SK
                                 
                                 
                                    
                                       
                                          TID
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         to prove that the applicant is 
                           
                              
                                 
                                    TID
                                 
                                 
                                    i
                                 
                              
                           
                        . After decrypting TSMINFO, the TSM signs it with 
                           
                              
                                 
                                    SK
                                 
                                 
                                    TSM
                                 
                              
                           
                         and sends it along with TSMBINFO to the bank. The messages during the registration are all signed with the user’s virtual bank account and 
                           
                              
                                 
                                    SK
                                 
                                 
                                    
                                       
                                          TID
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        , so the user cannot deny his registration to the TSM. Besides, the registration requires association with the user’s virtual bank account.

When a user applies for a virtual credit card from the TSM, he has to use his private key to sign his 
                           
                              
                                 
                                    TID
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ID
                                 
                                 
                                    SE
                                 
                              
                           
                         and then sends them to the TSM for certification issuance. During transactions, the private key signature in the card will be used to achieve non-repudiation. If disputes arise when a user using his virtual credit card for transactions, the transaction records can help verify whether the card is used by this user. The TSM and the bank can also prove that a transaction has been signed by the user’s credit, hence non-repudiation.

In our scheme, every message is encrypted with a nonce. With the change of random values in each session, the attackers cannot replay previous messages to pass our authentication.

In fact, it is futile for the attackers to replay the messages that the user uses to apply for a virtual account because the messages are all encrypted. The nonce in the messages can also prevent asynchronous replay attacks. Even though the bank’s authorization message is replayed, attackers are not able to access the encrypted bank-SE messages or any account information.

During the virtual credit card generation phase, the transmission messages are all encrypted as well, and the TSM-issued credit card has an expiry time and limited credits. Thus, replayed messages here cannot be used to apply for another credit card.

In this section, we compare our scheme with other related works [1,3–6,9,13–15,17,18,21,22] in terms of functions, as shown in Table 3
                     . The functions include authentication, anonymity, limited credits, unlinkability, offline transactions, double-spending detection, NFC, and EMV-compatible.

All the schemes meet the requirement of user authentication.

Only [9,14,15] and our scheme achieve anonymity. Both [3,4] uses GSM/3G’s SIM and USIM cards as authentication token. [13] uses pseudonyms to protect privacy. Other works require user’s real identity.


                        [9,14,15] provide partial unlinkability. [9]: uses pseudonyms technique, the merchant cannot link two transaction. [15] focus on withdrawal and payment anonymous, but the TTP keeps all the records. Our scheme provide full unlinkability mechanisms. Even the TTP and the bank know partial information about the transaction.

In [1,6,14], the replay attack is possible. In [5,17], the protocol details are absent. [3,4] use the random challenge (RAND) as a nonce to prevent replay attack. In [18,21], they verify the transaction online to prevent replay attack. Our scheme resist to replay attack, as described in Section 3.

Only [14,22] and our scheme accept offline transactions. [14] is focus on small amount payment, and [22] uses voucher as payment token.


                        [1,3–6,9,17,18,21,22] and our scheme are NFC-based. But [1,6] did not use NFC for payment, they use QR code.

Among all the NFC-based protocols, only [21] and our scheme are compatible with EMV standards.

Double-spending is the result of successfully spending some money more than one. The double-spending attack happened at offline transactions, whereby the merchant cannot verify the transaction message with the bank. [1,6] uses QR code in the transaction, which can be forged by attackers easily. In [5,13–15], the other parties cannot detect double-spending.

In our scheme, the transaction can be either EMV-compatible online or offline transactions [8]. However, our scheme protects against double spending because we use SE to generate the transaction messages. The SE is running under a secure OS, which will not forge the transaction.

In our scheme, the TSM issue virtual credit cards to the user, with a short expiry time and limited small mount of credits to reduce the risk, as shown in Section 2.5. If the credit is reached, the user should request for another credit card number. [3,4]: small amount payment.

According to Table 3, only our scheme can achieve authentication, anonymity, unlinkability, offline, double-spending detection, credit limitations, NFC compatibility, and EMV compatibility.

@&#CONCLUSION@&#

In this paper, we propose an Unlinkable Anonymous Payment Scheme based on near field communication technology to protect users’ privacy. The information of users’ real identities will not be revealed. Moreover, the one-time based virtual credit card prevents any attacker to trace users’ transaction records. In our scheme, a user only needs to take his mobile phone to request a virtual credit card from a trusted service manager, the rest of the payment process is compatibles with the EMV standard. Compares to other works, our scheme provide both anonymity and unlinkability. In addition, the security analyses shows our scheme satisfy necessary security properties.

@&#ACKNOWLEDGMENT@&#

This research was supported by the Ministry of Science and Technology of Taiwan under grant No. MOST104-2221-E130-009.

@&#REFERENCES@&#

