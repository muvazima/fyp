@&#MAIN-TITLE@&#A level-set based multi-material topology optimization method using a reaction diffusion equation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A multi-material topology optimization method using a reaction diffusion equation.


                        
                        
                           
                           Modified Multi-material Level Set (MM-LS) topology description model.


                        
                        
                           
                           Controllable geometrical complexity of optimal solutions.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Multi-material topology optimization

Level set method

Reaction diffusion equation

Topology description model

@&#ABSTRACT@&#


               
               
                  A level-set based multi-material topology optimization method using a reaction diffusion equation is proposed in this paper. Each phase is represented by a combined formulation of different level set functions. This description model is modified from Multi-Material Level Set (MM-LS) topology description model. With a total number of 
                        M
                      level set functions, this approach provides a representation of 
                        M
                      materials and one void phase (totally 
                        M
                        +
                        1
                      phases). By this approach, the mathematic model of the multi-material topology optimization problem using a reaction diffusion equation is established. With this model, the geometrical complexity of optimal solutions can be easily controlled by appropriately setting a regularization parameter. Some implementation details for solving this model are also presented in this paper. Finally, several typical numerical examples are shown to confirm the effectiveness of the proposed method.
               
            

The 
                           k
                        th level set function

Design domain

The 
                           k
                        th material region

The boundary of the 
                           k
                        th material

A point located in 
                           D
                        
                     

The number of the level set functions

Object functional

Constraint functional concerning the volume constraint

Upper limit of the volume constraint

Characteristic function

Lagrange multiplier

The Lagrangian

The fictitious time

Regularization parameter

The 
                           k
                        th material

Displacement field

Virtual displacement

The strain

Material elasticity tensor

The total number of level set nodes

Traction force

Values refer to displacements of the structure

Kronecker’s delta functions

Poisson’s ratio

Young’s modulus of the 
                           k
                        th material

Young’s modulus in void domain

@&#INTRODUCTION@&#

Topology optimization is often employed to determine the distribution of material in a fixed design domain such that an objective function is minimized under certain constraints at the early design stage. It has been widely studied during the past decades. Several typical methods have already been constructed  [1]. Among these methods, the following two have attracted more attention. The homogenization method and its variant, the Solid Isotropic Microstructure with Penalization (SIMP) method are two of the most popular approaches  [2,3]. The SIMP method attains great success for its efficient implementation, simple concept and less dependence on predefined parameters. Level set methods for structural topology optimization  [4–6] define the structural boundary by level-set function, and they create smooth boundaries. It should be noted that most level set methods for structural topology optimization do not involve mesh-dependent problems which are often encountered in density-based methods.

Most of the research papers are confined to single-material problems. In fact it may be difficult to acquire the best structure by using a single material. For instance, in a problem taking minimum stress as the target function, we can use strong material in domain where the value of the stress is high and weak material in other domain. In recent years there are growing interests in multi-material topology optimization problems, as will be briefly reviewed in the following.

There are a few methods focused on multi-material topology optimization problems. Based on the material distribution concept, Bendsøe and Sigmund  [7] proposed a mixture rule of multi-material model in the SIMP method. This model has been used to design multi-physics compliant mechanisms  [8]. There are other multi-material models based on density-based methods  [9]. In the design of smart structures, various multi-material models were developed to seek the best distribution of the piezoelectric and elastic materials  [10–12]. Stegmann and Lund  [13] presented two multi-material interpolation schemes as direct generalizations of the well-known SIMP and RAMP material interpolation schemes originally developed for isotropic mixtures of two isotropic material phases. Based on the phase field method and the algorithm combining the binary phase, Tavakoli and Mohseni  [14] proposed an alternating active-phase algorithm for multi-material topology optimization problems. Zhou and Wang  [15] proposed a general method to solve multiphase structural topology optimization problems, where multi-material phase-field approach based on Cahn–Hilliard equation was employed. Based on the penalization of the objective functional by the multiphase volume constrained Ginzburg–Landau energy functional and the update procedure utilizing the gradient flow of the objective functional by a fractional step projected steepest descent method, Tavakoli  [16] introduced a new algorithm to solve multi-material topology optimization problems.

As previously mentioned, level set methods have shown their merits for structural topology optimization. So there is a great potential to apply level set methods in solving multi-material topology optimization problems. Wang and Wang  [17] first proposed a ‘color’-level set method for the compliance minimization problem involving multiple materials. The method was further applied to the design of multi-material compliant mechanisms  [18] and stress-related optimization problem  [19]. Incorporating the piecewise constant level set model into topology optimization, a multiphase level set method of piecewise constants for shape and topology optimization of multi-material piezoelectric actuators with in-plane motion was presented  [20]. In addition, Wang and Wang proposed a level-set based variational approach for the design of this class of heterogeneous objects  [21]. G. Allaire et al. have enhanced the treatment of material interfaces, a key feature introduced in multi-phase models that is nevertheless typically ignored  [22] and Vermaak et al. studied the effects of including material interface properties in the optimization of multi-phase elastic and thermoelastic structures  [23].

There are several challenges in solving multiphase structural topology optimization problems as compared to single-material problems. One of the most important challenges is how to set an appropriate topology description model that is able to effectively indicate each distinct phase inside the design domain and avoid overlaps between different phases. Recently Y. Wang et al. proposed a new Multi-Material Level Set (MM-LS) topology description model for topology and shape optimization of structures involving multiple materials  [24]. This model has the following advantages: (1) it can effectively indicate each distinct phase; (2) it has an explicit mathematical formulation, which facilitates the sensitivity analysis; (3) it naturally avoids overlaps between each two phases, and guarantees that the design domain contains no redundant phase.

A level-set based topology optimization method using a reaction diffusion equation was proposed by Yamada et al.  [25,26]. The novel aspect of this method is the incorporation of level-set based boundary expressions and fictitious interface energy in the topology optimization problem, and the replacement of the original topology optimization problem with a procedure to solve a reaction diffusion equation. It is found that optimal solutions obtained by this method show minimal dependency upon the initial configurations and almost no mesh-dependent problems.

Generally, there are two popular approaches for solving level-set based topology optimization problems  [6]. One is the conventional method in which optimization problem is solved by updating the Hamilton–Jacobi partial differential equation (PDE) using shape sensitivities. Another is the method in which parameterization techniques are employed to convert the Hamilton–Jacobi PDE into a simpler set of ordinary differential equations (ODEs). In this work, a multi-material topology optimization method based on the level-set based topology optimization method using a reaction diffusion equation is proposed, which is different from the two above-mentioned approaches. The description model of multi-material topology optimization problems presented here is also different, which is modified from the MM-LS topology description model. In this model, each material should be represented by a combined formulation of all level set functions. The introduced reaction diffusion term allows topological changes that generate new boundaries during the optimization procedure, and re-initialization of the level set function is not required. Furthermore, the geometrical complexity of optimal solutions can be easily controlled.

The rest of this paper is arranged as follows. The model for multi-material topology optimization problems is described in Section  2. Several illustrative examples are given in Section  3. Conclusions are eventually provided in Section  4.

The level set function is originally developed by Osher and Sethian  [27] with the fundamental goal of tracking the motion of curves and surfaces. In this work, the structural boundary is implicitly represented by the zero level sets. For the multi-material structures, multiple level set functions 
                           
                              
                                 ϕ
                              
                              
                                 k
                              
                           
                           ,
                           k
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           M
                         are employed to denote different phases. These level set functions are utilized to define the following subdomains: 
                           
                              (1)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                
                                                )
                                             
                                             >
                                             0
                                          
                                          
                                             ∀
                                             
                                                x
                                             
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   k
                                                
                                             
                                             ∖
                                             
                                                
                                                   Γ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                
                                                )
                                             
                                             =
                                             0
                                          
                                          
                                             ∀
                                             
                                                x
                                             
                                             ∈
                                             
                                                
                                                   Γ
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                
                                                )
                                             
                                             <
                                             0
                                          
                                          
                                             ∀
                                             
                                                x
                                             
                                             ∈
                                             D
                                             ∖
                                             
                                                
                                                   Ω
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                    k
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    M
                                 
                              
                           
                         where 
                           D
                         represents the design domain including all admissible shapes. 
                           
                              
                                 Ω
                              
                              
                                 k
                              
                           
                         denotes the 
                           k
                        th material region with positive value of the 
                           k
                        th level set function, 
                           
                              
                                 Γ
                              
                              
                                 k
                              
                           
                         is the boundary of the 
                           k
                        th material, negative value of the 
                           k
                        th level set function signifies the domain not containing the 
                           k
                        th material. 
                           
                              x
                           
                         represents a point located in 
                           D
                        . 
                           M
                         is the number of the level set functions. An example for the design domain containing three level set functions is illustrated in Fig. 1
                        .

Firstly, a structural optimization problem that determines the optimal configuration of a domain filled with a solid material is considered. Using a material domain 
                           Ω
                        , a void domain, and boundaries 
                           Γ
                        , the optimization problems to minimize functional 
                           F
                         under a constraint functional 
                           G
                         concerning the volume constraint can be formulated as follows: 
                           
                              
                                 (2)
                                 
                                    
                                       
                                          inf
                                       
                                       
                                          Ω
                                       
                                    
                                    F
                                    
                                       (
                                       Ω
                                       )
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          d
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    d
                                    Ω
                                    +
                                    
                                       
                                          ∫
                                       
                                       
                                          Γ
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          b
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    d
                                    Γ
                                 
                              
                              
                                 (3)
                                 
                                    subject to  
                                    G
                                    
                                       (
                                       Ω
                                       )
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          Ω
                                       
                                    
                                    d
                                    Ω
                                    −
                                    
                                       
                                          V
                                       
                                       
                                          
                                             max
                                          
                                       
                                    
                                    ≤
                                    0
                                 
                              
                           
                         where 
                           
                              
                                 f
                              
                              
                                 d
                              
                           
                           
                              (
                              ⋅
                              )
                           
                         and 
                           
                              
                                 f
                              
                              
                                 b
                              
                           
                           
                              (
                              ⋅
                              )
                           
                         are arbitrary real functions defined for domain 
                           Ω
                         and boundary 
                           Γ
                        , respectively. 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                           
                         is the upper limit of the volume constraint.

In the conventional single-material topology optimization, the problem is replaced with a material distribution problem within a fixed design domain 
                           D
                        , using the characteristic function 
                           
                              
                                 χ
                              
                              
                                 Ω
                              
                           
                        , the optimization problem is then defined as: 
                           
                              
                                 (4)
                                 
                                    
                                       
                                          inf
                                       
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                Ω
                                             
                                          
                                       
                                    
                                    F
                                    
                                       (
                                       
                                          
                                             χ
                                          
                                          
                                             Ω
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          d
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       ,
                                       
                                          
                                             χ
                                          
                                          
                                             Ω
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       )
                                    
                                    d
                                    Ω
                                    +
                                    
                                       
                                          ∫
                                       
                                       
                                          Γ
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          b
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       ,
                                       
                                          
                                             χ
                                          
                                          
                                             Ω
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       )
                                    
                                    d
                                    Γ
                                 
                              
                              
                                 (5)
                                 
                                    subject to  
                                    G
                                    
                                       (
                                       
                                          
                                             χ
                                          
                                          
                                             Ω
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       
                                          χ
                                       
                                       
                                          Ω
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    d
                                    Ω
                                    −
                                    
                                       
                                          V
                                       
                                       
                                          
                                             max
                                          
                                       
                                    
                                    ≤
                                    0
                                 
                              
                           
                         where 
                           Ω
                           ∈
                           D
                         is the material domain, 
                           Γ
                         is the boundary of the material domain, certainly, there exists another complementary domain 
                           D
                           ∖
                           Ω
                         representing void region, and the 
                           
                              
                                 χ
                              
                              
                                 Ω
                              
                           
                         is defined as: 
                           
                              (6)
                              
                                 
                                    
                                       χ
                                    
                                    
                                       Ω
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             ∀
                                             
                                                x
                                             
                                             ∈
                                             Ω
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             ∀
                                             
                                                x
                                             
                                             ∈
                                             D
                                             ∖
                                             Ω
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         In the above optimization problem, topological changes as well as shape change are allowed during the optimization procedure. Since the characteristic function 
                           
                              
                                 χ
                              
                              
                                 Ω
                              
                           
                         is defined as a subset of a bounded Lebesgue space 
                           
                              
                                 L
                              
                              
                                 ∞
                              
                           
                         which is only assured integrability, the obtained solutions may be discontinuous anywhere in the fixed design domain  [25,26]. To overcome this problem, the design domain is relaxed using various regularization techniques, such as homogenization-based approaches, SIMP method and level-set based method.

In the level-set based topology optimization method using a reaction diffusion equation, first, the definition of the level set function in Eq. (1) is modified per the following equation to introduce the fictitious interface energy in the phase field model to regularize the topology optimization problem. So Eq. (1) can be modified as: 
                           
                              (7)
                              
                                 
                                    {
                                    
                                       
                                          
                                             1
                                             ≥
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                
                                                )
                                             
                                             >
                                             0
                                          
                                          
                                             ∀
                                             
                                                x
                                             
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   k
                                                
                                             
                                             ∖
                                             
                                                
                                                   Γ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                
                                                )
                                             
                                             =
                                             0
                                          
                                          
                                             ∀
                                             
                                                x
                                             
                                             ∈
                                             
                                                
                                                   Γ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             −
                                             1
                                             ≤
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                
                                                )
                                             
                                             <
                                             0
                                          
                                          
                                             ∀
                                             
                                                x
                                             
                                             ∈
                                             D
                                             ∖
                                             
                                                
                                                   Ω
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                                 
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 M
                                 .
                              
                           
                        
                     

It is assumed that the distribution of the level set function 
                           
                              
                                 ϕ
                              
                              
                                 k
                              
                           
                         must have the same property of distribution as the phase field variable in the phase field method. Based on this assumption, the level set function 
                           
                              
                                 ϕ
                              
                              
                                 k
                              
                           
                         has upper and lower limit constraints imposed in Eq. (7). In addition, in sufficiently distant regions from the structural boundaries, the value of the level set function must be equivalent to 1 or −1.

Using the above level set functions, a multi-material topology optimization problem containing 
                           M
                         materials is considered, the sub-problem of the 
                           k
                        th material is to minimize functional 
                           
                              
                                 F
                              
                              
                                 k
                              
                           
                           
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         under a constraint functional 
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                         concerning the volume constraint, which can be specified as: 
                           
                              
                                 (8)
                                 
                                    
                                       
                                          inf
                                       
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          k
                                       
                                    
                                    
                                       [
                                       
                                          
                                             χ
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          d
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       ,
                                       
                                          
                                             χ
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       )
                                    
                                    d
                                    
                                       
                                          Ω
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          ∫
                                       
                                       
                                          
                                             
                                                Γ
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          b
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       ,
                                       
                                          
                                             χ
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       )
                                    
                                    d
                                    
                                       
                                          Γ
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              
                                 (9)
                                 
                                    subject to  
                                    
                                       
                                          G
                                       
                                       
                                          k
                                       
                                    
                                    
                                       [
                                       
                                          
                                             χ
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    g
                                    
                                       (
                                       
                                          x
                                       
                                       ,
                                       
                                          
                                             χ
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       )
                                    
                                    d
                                    
                                       
                                          Ω
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          G
                                       
                                       
                                          
                                             max
                                          
                                       
                                       
                                          k
                                       
                                    
                                    ≤
                                    0
                                    
                                    k
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    M
                                 
                              
                           
                         where 
                           g
                           
                              (
                              ⋅
                              )
                           
                         is the density function and 
                           
                              
                                 G
                              
                              
                                 
                                    max
                                 
                              
                              
                                 k
                              
                           
                         is the upper limit value of the response 
                           
                              
                                 ∫
                              
                              
                                 D
                              
                           
                           g
                           
                              (
                              
                                 x
                              
                              ,
                              
                                 
                                    χ
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              )
                           
                           d
                           
                              
                                 Ω
                              
                              
                                 k
                              
                           
                         of the 
                           k
                        th level set function. Here, the characteristic function 
                           
                              
                                 χ
                              
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         is defined as: 
                           
                              (10)
                              
                                 
                                    
                                       χ
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             if  
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             if  
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                             <
                                             0
                                          
                                       
                                    
                                 
                                 
                                 
                                    (
                                    k
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    M
                                    )
                                 
                                 .
                              
                           
                        
                     

Using Lagrange’s method of undetermined multipliers, the above optimization problem is now replaced with an unconstrained optimization problem: 
                           
                              (11)
                              
                                 
                                    
                                       inf
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             F
                                          
                                          ¯
                                       
                                    
                                    
                                       k
                                    
                                 
                                 
                                    [
                                    
                                       
                                          χ
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          ϕ
                                       
                                       
                                          k
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       G
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                 
                                    (
                                    k
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    M
                                    )
                                 
                              
                           
                         where 
                           
                              
                                 λ
                              
                              
                                 k
                              
                           
                         is the Lagrange multiplier and 
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 k
                              
                           
                         is the Lagrangian. So the KKT (Karush–Kuhn–Tucker) conditions of this optimization problem can be described as: 
                           
                              (12)
                              
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       G
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 
                                    
                                       G
                                    
                                    
                                       k
                                    
                                 
                                 ≤
                                 0
                                 ,
                                 
                                 
                                    (
                                    k
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    M
                                    )
                                 
                              
                           
                         where 
                           
                              
                                 d
                              
                              
                                 t
                              
                           
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 k
                              
                           
                         represents the derivative of 
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 k
                              
                           
                        . We note here in the rest of the paper the derivative of 
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 k
                              
                           
                         is represented by 
                           
                              
                                 d
                              
                              
                                 t
                              
                           
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 k
                              
                           
                        .

The level set function is then updated by solving an equation which introduces a fictitious time 
                           t
                        . 
                           
                              (13)
                              
                                 ∂
                                 
                                    
                                       ϕ
                                    
                                    
                                       k
                                    
                                 
                                 /
                                 ∂
                                 t
                                 =
                                 −
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 
                                 
                                    (
                                    k
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    M
                                    )
                                 
                              
                           
                         where 
                           
                              
                                 B
                              
                              
                                 k
                              
                           
                           >
                           0
                         is a coefficient of proportionality. It is assumed that the variation of the level set function is proportional to the gradient of Lagrangian 
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 k
                              
                           
                        .

The above formulation is ill-posed, so a diffusive term is added to regularize it. Set appropriate boundary conditions, the time evolution equation is obtained: 
                           
                              (14)
                              
                                 
                                    {
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                             /
                                             ∂
                                             t
                                             =
                                             −
                                             
                                                
                                                   B
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            ̄
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                   
                                                
                                                −
                                                τ
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             in  
                                             D
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             0
                                          
                                          
                                             on  
                                             ∂
                                             D
                                          
                                       
                                    
                                 
                                 
                                 
                                    (
                                    k
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    M
                                    )
                                 
                              
                           
                         where 
                           D
                         is the design domain and 
                           ∂
                           D
                         is the boundary. The above equation is a reaction diffusion equation, and the diffusive term 
                           
                              
                                 ∇
                              
                              
                                 2
                              
                           
                           
                              
                                 ϕ
                              
                              
                                 k
                              
                           
                         ensures the smoothness of the level set function in this method. 
                           τ
                         is a regularization parameter, which affects the degree of the diffusivity. An appropriately set value of 
                           τ
                         can prevent the generation of structures that have excessive geometrical complexity, so that an optimized configuration that has a desired degree of geometrical simplicity can be obtained.

To overcome the challenges faced in the multi-material problems, each material is represented by a combination of different level set functions, rather than by a particular level set function. Inspired by the work of Y. Wang et al.  [24], we present a different model which is fit for the level-set based topology optimization method using a reaction diffusion equation. For instance, for the cases with one, two or three materials, the elastic stiffness 
                           
                              
                                 
                                    D
                                 
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           ,
                           
                              (
                              i
                              =
                              1
                              ,
                              2
                              ,
                              3
                              )
                           
                         at the computational point 
                           
                              x
                           
                         can be calculated by: 
                           
                              
                                 
                                    One material
                                    :
                                    
                                    
                                       
                                          
                                             D
                                          
                                       
                                       
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       ,
                                       ϕ
                                       )
                                    
                                    =
                                    H
                                    
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             D
                                          
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 (15)
                                 
                                    Two materials
                                    :
                                    
                                    
                                       
                                          
                                             D
                                          
                                       
                                       
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       ,
                                       ϕ
                                       )
                                    
                                    =
                                    H
                                    
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       [
                                       H
                                       
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                D
                                             
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          (
                                          1
                                          −
                                          H
                                          
                                             (
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       
                                          
                                             
                                                D
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                 
                              
                              
                                 
                                    Three materials:
                                    
                                    
                                       
                                          
                                             D
                                          
                                       
                                       
                                          
                                             (
                                             3
                                             )
                                          
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       ,
                                       ϕ
                                       )
                                    
                                    =
                                    H
                                    
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       [
                                       H
                                       
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       H
                                       
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                D
                                             
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          (
                                          1
                                          −
                                          H
                                          
                                             (
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       H
                                       
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                D
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          (
                                          1
                                          −
                                          H
                                          
                                             (
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       
                                          (
                                          1
                                          −
                                          H
                                          
                                             (
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       
                                          
                                             
                                                D
                                             
                                          
                                          
                                             3
                                          
                                       
                                       ]
                                    
                                 
                              
                              
                                 
                                    …
                                 
                              
                           
                         where 
                           H
                           
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         is the Heaviside function of the 
                           i
                        th level set function, and 
                           
                              
                                 
                                    D
                                 
                              
                              
                                 i
                              
                           
                         is the elastic stiffness of the 
                           i
                        th material. For the case with 
                           k
                           
                           
                              (
                              k
                              >
                              3
                              )
                           
                         materials, the elastic stiffness 
                           
                              
                                 
                                    D
                                 
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              ,
                              ϕ
                              )
                           
                         can be obtained according to similar rules as above.

The model given in Eq. (15) can be used to describe the distribution of multiple materials in the design domain. A schematic illustration is given in Fig. 2
                        , in which three level set functions are combined together to describe three materials. The combination of positive value of level set functions 
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 ϕ
                              
                              
                                 3
                              
                           
                         denotes material 1(red regions), then the negative value of 
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                           
                         is used to determine material 2(green regions) from material 1, finally, the negative value of 
                           
                              
                                 ϕ
                              
                              
                                 3
                              
                           
                         is applied to distinguish material 3(blue regions) and material 2. So in this description model, we only need to change the value of a single level set function every time to denote materials from 1 to 3. Moreover, each material is related to all the level set functions. In this case, the elastic stiffness at each point is calculated using the third equation in Eq. (15).

In this work, the following exact Heaviside function is utilized: 
                           
                              (16)
                              
                                 H
                                 
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             if  
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             if  
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                             <
                                             0
                                          
                                       
                                    
                                 
                                 
                                 
                                    (
                                    k
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    M
                                    )
                                 
                              
                           
                         where 
                           
                              
                                 ϕ
                              
                              
                                 k
                              
                           
                         denotes the 
                           k
                        th level set function. 
                           
                              
                                 φ
                              
                              
                                 k
                              
                           
                         is used to denote the 
                           k
                        th material, so the relationship between 
                           
                              
                                 φ
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 ϕ
                              
                              
                                 k
                              
                           
                         (taking 
                           M
                           =
                           3
                         as an example) can be formulated as follows: 
                           
                              
                                 
                                    Material 1
                                    :
                                    
                                    
                                       
                                          φ
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    H
                                    
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    H
                                    
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    H
                                    
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 (17)
                                 
                                    Material 2
                                    :
                                    
                                    
                                       
                                          φ
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    H
                                    
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       1
                                       −
                                       H
                                       
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    H
                                    
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    Material 3
                                    :
                                    
                                    
                                       
                                          φ
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    H
                                    
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       1
                                       −
                                       H
                                       
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    
                                       (
                                       1
                                       −
                                       H
                                       
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

With all the previous work, the compliance minimization problem for linear elastic structures is studied by using the proposed model. The topology optimization problem with multiple materials can be formulated as:
                           
                              (18)
                              
                                 
                                    {
                                    
                                       
                                          
                                             find
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             
                                             
                                                (
                                                k
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                M
                                                ;
                                                i
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                N
                                                )
                                             
                                          
                                       
                                       
                                          
                                             min.
                                          
                                          
                                             F
                                             =
                                             
                                                
                                                   ∫
                                                
                                                
                                                   D
                                                
                                             
                                             
                                                ε
                                             
                                             
                                                (
                                                
                                                   u
                                                
                                                )
                                             
                                             :
                                             
                                                D
                                             
                                             
                                                (
                                                ϕ
                                                )
                                             
                                             :
                                             
                                                ε
                                             
                                             
                                                (
                                                
                                                   u
                                                
                                                )
                                             
                                             d
                                             Ω
                                          
                                       
                                       
                                          
                                             s.t.
                                          
                                          
                                             a
                                             
                                                (
                                                
                                                   u
                                                
                                                ,
                                                
                                                   v
                                                
                                                ,
                                                ϕ
                                                )
                                             
                                             =
                                             l
                                             
                                                (
                                                
                                                   v
                                                
                                                ,
                                                ϕ
                                                )
                                             
                                             ,
                                             
                                             ∀
                                             
                                                v
                                             
                                             ∈
                                             
                                                
                                                   U
                                                
                                                
                                                   
                                                      ad
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   k
                                                
                                             
                                             ≤
                                             
                                                
                                                   V
                                                
                                                
                                                   
                                                      max
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             −
                                             1
                                             ≤
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   k
                                                
                                             
                                             ≤
                                             1
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                              
                                 k
                              
                           
                         is the value of the 
                           k
                        th level set function at node 
                           i
                        , 
                           
                              u
                           
                         is the displacement field, 
                           
                              v
                           
                         is the virtual displacement and 
                           
                              
                                 U
                              
                              
                                 
                                    ad
                                 
                              
                           
                           ∈
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           
                              (
                              D
                              )
                           
                         is the set of kinematically admissible displacements, 
                           
                              ε
                           
                           
                              (
                              
                                 u
                              
                              )
                           
                         is the strain, 
                           
                              D
                           
                         is the material elasticity tensor computed by Eq. (15), 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 k
                              
                           
                         denotes the upper limit of the volume fraction applied to the 
                           k
                        th volume constraint 
                           
                              
                                 V
                              
                              
                                 k
                              
                           
                        , 
                           N
                         is the total number of level set nodes within the design domain.

For the sake of simplicity, we consider only the case with a fixed traction force 
                           
                              f
                           
                         on the external boundaries 
                           
                              
                                 Γ
                              
                              
                                 
                                    f
                                 
                              
                           
                         of the design domain. In this situation, the energy bilinear form 
                           a
                           
                              (
                              
                                 u
                              
                              ,
                              
                                 v
                              
                              ,
                              ϕ
                              )
                           
                         and the load linear form 
                           l
                           
                              (
                              
                                 v
                              
                              ,
                              ϕ
                              )
                           
                         are given by: 
                           
                              
                                 (19)
                                 
                                    a
                                    
                                       (
                                       
                                          u
                                       
                                       ,
                                       
                                          v
                                       
                                       ,
                                       ϕ
                                       )
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       ε
                                    
                                    
                                       (
                                       
                                          u
                                       
                                       )
                                    
                                    :
                                    
                                       D
                                    
                                    
                                       (
                                       ϕ
                                       )
                                    
                                    :
                                    
                                       ε
                                    
                                    
                                       (
                                       
                                          v
                                       
                                       )
                                    
                                    d
                                    Ω
                                 
                              
                              
                                 (20)
                                 
                                    l
                                    
                                       (
                                       
                                          v
                                       
                                       ,
                                       ϕ
                                       )
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          
                                             
                                                Γ
                                             
                                             
                                                
                                                   f
                                                
                                             
                                          
                                       
                                    
                                    
                                       f
                                    
                                    ⋅
                                    
                                       v
                                    
                                    d
                                    Γ
                                    .
                                 
                              
                           
                        
                     

Using Lagrange’s method of undetermined multipliers, the above optimization problem can be replaced with 
                           M
                         unconstrained optimization problems: 
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                          ¯
                                       
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    ¯
                                 
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       D
                                    
                                 
                                 
                                    ε
                                 
                                 
                                    (
                                    
                                       u
                                    
                                    )
                                 
                                 :
                                 
                                    D
                                 
                                 
                                    (
                                    ϕ
                                    )
                                 
                                 :
                                 
                                    ε
                                 
                                 
                                    (
                                    
                                       u
                                    
                                    )
                                 
                                 d
                                 Ω
                                 −
                                 a
                                 
                                    (
                                    
                                       u
                                    
                                    ,
                                    
                                       v
                                    
                                    ,
                                    ϕ
                                    )
                                 
                                 +
                                 l
                                 
                                    (
                                    
                                       v
                                    
                                    ,
                                    ϕ
                                    )
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          V
                                       
                                       
                                          
                                             max
                                          
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 M
                              
                           
                         where 
                           
                              
                                 
                                    
                                       F
                                    
                                    ¯
                                 
                              
                              
                                 k
                              
                           
                         is the Lagrangian and 
                           
                              
                                 λ
                              
                              
                                 k
                              
                           
                         is the Lagrange multiplier.

In the optimization problem defined in Eq. (18), the volume constraints are given to restrict the allowable material usage. For the topology description model presented in this work, the formulation of volume constraints is different. Here, the following volume constraints are applied. 
                           
                              (22)
                              
                                 
                                    
                                       V
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ∫
                                                
                                                
                                                   D
                                                
                                             
                                             H
                                             
                                                (
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             d
                                             Ω
                                             ,
                                             
                                             
                                                (
                                                k
                                                =
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∫
                                                
                                                
                                                   D
                                                
                                             
                                             H
                                             
                                                (
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      ∏
                                                   
                                                   
                                                      i
                                                      =
                                                      2
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                   (
                                                   1
                                                   −
                                                   H
                                                   
                                                      (
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                )
                                             
                                             d
                                             Ω
                                             ,
                                             
                                             
                                                (
                                                k
                                                =
                                                2
                                                ,
                                                …
                                                ,
                                                M
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The overall material usage as well as the volume of each individual material is defined by Eq. (22). For the case with three materials, the volume fractions can be expressed by: 
                           
                              (23)
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    H
                                    
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    d
                                    Ω
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    H
                                    
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       1
                                       −
                                       H
                                       
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    d
                                    Ω
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    H
                                    
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       1
                                       −
                                       H
                                       
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    
                                       (
                                       1
                                       −
                                       H
                                       
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    d
                                    Ω
                                    ,
                                 
                              
                           
                         where, the first constraint defines the overall usage of the total materials, the second one restricts the usage of the materials except material 1, and the third one restricts the volume constraint of material 3.

The topological derivative is a measure of the influence when a hole 
                           
                              
                                 Ω
                              
                              
                                 r
                              
                           
                         with radius 
                           r
                         is created at a certain point in the domain 
                           Ω
                        . The topological derivative 
                           
                              
                                 d
                              
                              
                                 t
                              
                           
                           F
                         of objective functional 
                           F
                         is defined as: 
                           
                              (24)
                              
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 F
                                 =
                                 
                                    
                                       lim
                                    
                                    
                                       r
                                       →
                                       0
                                    
                                 
                                 
                                    [
                                    
                                       (
                                       F
                                       +
                                       δ
                                       F
                                       )
                                    
                                    −
                                    F
                                    ]
                                 
                                 /
                                 
                                    [
                                    
                                       meas
                                    
                                    
                                       (
                                       Ω
                                       ∖
                                       
                                          
                                             Ω
                                          
                                          
                                             r
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       meas
                                    
                                    
                                       (
                                       Ω
                                       )
                                    
                                    ]
                                 
                              
                           
                         where 
                           
                              meas
                           
                           
                              (
                              ⋅
                              )
                           
                         is the function of measure. The topological derivative of 
                           
                              
                                 F
                              
                              
                                 ̄
                              
                           
                         in Eq. (21) is then given as follows: 
                           
                              (25)
                              
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       ̄
                                    
                                 
                                 =
                                 
                                    
                                       lim
                                    
                                    
                                       r
                                       →
                                       0
                                    
                                 
                                 
                                    [
                                    δ
                                    
                                       
                                          F
                                       
                                       
                                          ̄
                                       
                                    
                                    /
                                    
                                       (
                                       4
                                       π
                                       
                                          
                                             r
                                          
                                          
                                             3
                                          
                                       
                                       /
                                       3
                                       )
                                    
                                    ]
                                 
                                 =
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       i
                                       j
                                       m
                                       n
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       m
                                       ,
                                       n
                                    
                                    
                                       0
                                    
                                 
                                 −
                                 λ
                              
                           
                         where the superscript 0 indicates the value without creating holes, 
                           λ
                         is the Lagrange multiplier, 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 u
                              
                              
                                 m
                                 ,
                                 n
                              
                              
                                 0
                              
                           
                         are values refer to displacements of the structure. 
                           
                              
                                 A
                              
                              
                                 i
                                 j
                                 m
                                 n
                              
                           
                         is defined as follows: 
                           
                              (26)
                              
                                 
                                    
                                       A
                                    
                                    
                                       i
                                       j
                                       m
                                       n
                                    
                                 
                                 =
                                 
                                    [
                                    3
                                    
                                       (
                                       1
                                       −
                                       ν
                                       )
                                    
                                    /
                                    
                                       (
                                       2
                                       
                                          (
                                          1
                                          +
                                          ν
                                          )
                                       
                                       
                                          (
                                          7
                                          −
                                          5
                                          ν
                                          )
                                       
                                       )
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       (
                                       −
                                       1
                                       +
                                       14
                                       ν
                                       −
                                       15
                                       
                                          
                                             ν
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          m
                                          n
                                       
                                    
                                    /
                                    
                                       
                                          
                                             (
                                             1
                                             −
                                             2
                                             ν
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    5
                                    
                                       (
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                             m
                                          
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             j
                                             n
                                          
                                       
                                       +
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                             n
                                          
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             j
                                             m
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 E
                              
                           
                         where, 
                           
                              
                                 δ
                              
                              
                                 i
                                 j
                              
                           
                           ,
                           
                              
                                 δ
                              
                              
                                 m
                                 n
                              
                           
                           ,
                           
                              
                                 δ
                              
                              
                                 i
                                 m
                              
                           
                           ,
                           
                              
                                 δ
                              
                              
                                 j
                                 n
                              
                           
                           ,
                           
                              
                                 δ
                              
                              
                                 i
                                 n
                              
                           
                           ,
                           
                              
                                 δ
                              
                              
                                 j
                                 m
                              
                           
                         are the Kronecker’s delta functions, 
                           ν
                         is the Poisson’s ratio, and 
                           E
                         is the Young’s modulus  [25,26].

To make it be able to solve the multi-material problems using the method proposed in this work, we revise Eqs. (25) and (26) respectively as: 
                           
                              
                                 (27)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          lim
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                k
                                             
                                          
                                          →
                                          0
                                       
                                    
                                    
                                       [
                                       δ
                                       
                                          
                                             
                                                
                                                   F
                                                
                                                
                                                   ̄
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                       /
                                       
                                          (
                                          4
                                          π
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                3
                                             
                                          
                                          /
                                          3
                                          )
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          i
                                          j
                                          m
                                          n
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          m
                                          ,
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    
                                       
                                          λ
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                    
                                       (
                                       k
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       M
                                       )
                                    
                                 
                              
                              
                                 (28)
                                 
                                    
                                       
                                          A
                                       
                                       
                                          i
                                          j
                                          m
                                          n
                                       
                                    
                                    =
                                    
                                       [
                                       3
                                       
                                          (
                                          1
                                          −
                                          ν
                                          )
                                       
                                       /
                                       
                                          (
                                          2
                                          
                                             (
                                             1
                                             +
                                             ν
                                             )
                                          
                                          
                                             (
                                             7
                                             −
                                             5
                                             ν
                                             )
                                          
                                          )
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          (
                                          −
                                          1
                                          +
                                          14
                                          ν
                                          −
                                          15
                                          
                                             
                                                ν
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             m
                                             n
                                          
                                       
                                       /
                                       
                                          
                                             
                                                (
                                                1
                                                −
                                                2
                                                ν
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       5
                                       
                                          (
                                          
                                             
                                                δ
                                             
                                             
                                                i
                                                m
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                j
                                                n
                                             
                                          
                                          +
                                          
                                             
                                                δ
                                             
                                             
                                                i
                                                n
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                j
                                                m
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                 
                              
                           
                         where, 
                           
                              
                                 λ
                              
                              
                                 k
                              
                           
                         is the Lagrange multiplier of the 
                           k
                        th level set function, 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 k
                              
                           
                         is defined as: 
                           
                              (29)
                              
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   k
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   φ
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      i
                                                   
                                                
                                                −
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      
                                                         min
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   E
                                                
                                                
                                                   
                                                      min
                                                   
                                                
                                             
                                          
                                          
                                             if  
                                             k
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   k
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   φ
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   E
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             if  
                                             k
                                             =
                                             2
                                             ,
                                             3
                                             ,
                                             …
                                             ,
                                             M
                                          
                                       
                                    
                                 
                              
                           
                         where, 
                           
                              
                                 E
                              
                              
                                 i
                              
                           
                         is the Young’s modulus of the 
                           i
                        th material, 
                           
                              
                                 E
                              
                              
                                 
                                    min
                                 
                              
                           
                         is Young’s modulus in void domain, and 
                           
                              
                                 φ
                              
                              
                                 i
                              
                           
                           ,
                           
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           M
                         represents the 
                           i
                        th material, the relationship between 
                           
                              
                                 φ
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                         is described by Eq. (17).

Some implementation details are presented in the following. In the time evolution equation (14), to ensure that the value of 
                           τ
                         can be chosen regardless of the particular problem being solved, a parameter 
                           
                              
                                 C
                              
                              
                                 k
                              
                           
                         is introduced to normalize the sensitivities, so Eq. (14) can be replaced as: 
                           
                              (30)
                              
                                 
                                    {
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                             /
                                             ∂
                                             t
                                             =
                                             −
                                             
                                                (
                                                −
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            ̄
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                   
                                                
                                                −
                                                τ
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             in  
                                             D
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             0
                                          
                                          
                                             on  
                                             ∂
                                             D
                                          
                                       
                                    
                                 
                                 
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 M
                              
                           
                         where, the value of 
                           
                              
                                 B
                              
                              
                                 k
                              
                           
                         in Eq. (14) is set to 1, 
                           τ
                         is the regularization parameter. To clearly describe the relationship between the definitions of topological derivative and the sign of level set function, negative signs are retained in the equation. 
                           
                              
                                 C
                              
                              
                                 k
                              
                           
                         is defined as:
                           
                              (31)
                              
                                 
                                    
                                       C
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    d
                                    Ω
                                    )
                                 
                                 /
                                 
                                    (
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       |
                                       
                                          
                                             d
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             k
                                          
                                       
                                       |
                                    
                                    d
                                    
                                       
                                          Ω
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

Then topology optimization problems can be solved by the numerical computation method.

In this section, several widely studied numerical examples of topology optimization for structural compliance are presented to confirm the effectiveness of the proposed optimization method. Due to the diffusive term in the time evolution equation, it is difficult to guarantee that the objective functional monotonically decreases. It is also found near the optimal solution the structural compliance will have numerical oscillation, furthermore, the amplitude of the numerical oscillation is positively correlated with the regularization parameter 
                        τ
                     . The numerical oscillation is also related to the particular numerical example, different topology optimization problems having different amplitudes. The local change of the structural compliance is smaller than a user-defined threshold in the last 50 iterations is set as termination criterion, and here the threshold is set to hundredth the value of the final compliance. However, sometimes it is hard to reach termination criterion for the numerical oscillation. In this work, the maximum iteration number is set as 600, which is used as an additional terminal condition in all numerical examples.


                        Fig. 3
                         shows the design domain of a cantilever beam, where the ratio of length and width is 2:1. The left side of the domain is fixed as the Dirichlet boundary, and a downward force 
                           f
                           =
                           1
                         is applied at the lower right corner. The right side is treated as a non-homogeneous Neumann boundary. The objective function is to minimize the compliance. The Young’s moduli of material 1 and material 2 are 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                           =
                           1
                         (red regions) and 
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                           =
                           10
                         (green regions), respectively. Both materials have the same Poisson’s ratio 
                           ν
                           =
                           0.3
                        . The volume fractions are given by 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 1
                              
                           
                           =
                           0.5
                         and 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 2
                              
                           
                           =
                           0.4
                        , which means that the maximum volume usages for material 1 and material 2 are 0.1 and 0.4, respectively. The design domain is discretized into 120×60 rectangular grid and the regularization parameter 
                           τ
                         in Eq. (30) is set to be 2×10−4. The topology optimization process of two-material structure is illustrated with Fig. 4
                        . To differentiate from the next case, this case is called case 1.

In Fig. 4, (a) and (d) indicate the initial design and the optimal design respectively, (b)–(c) show in sequence the design solution after different number of iterations. It is found that the proposed method can obtain reasonable distribution of materials under volume constraints. Fig. 5
                         shows the convergence history of structural compliance and the changes of the volume fractions of two materials during the optimization process.

To study the influence of the initial material distribution on the optimal solution, we give a different case in Fig. 6
                        , which is called case 2. In this case, all the parameters are the same as the previous case but the initial distribution of materials shown in Fig. 6(a). The optimal design is shown in Fig. 6(b).

From Figs. 4 and 6, it can be seen that different optimal solutions are obtained under different initial configurations. However, both results provide reasonable distribution of both materials, where the strong material is mainly distributed in the force transmission path. So a reasonable initial configuration can guarantee a desired design solution, and generally each material should as far as possible evenly distribute in the design domain.

To make a further study, the optimal designs obtained with two different stiffness ratios between the two materials are given in Fig. 7
                        . Here, the Young’s modulus of the weak material (material 1) is kept unchanged as 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                           =
                           1
                        , and that of the strong material (material 2) is given as 
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                           =
                           3
                           ,
                           
                           100
                         (Fig. 7(a), (b)). The results show that the optimal design depends on the stiffness ratio of the two materials. In the cases where the stiffness of the strong material is comparable to that of the weak material, the two materials form independent load-bearing structural members (Figs. 4, 6 and 7(a)). However, if material 2 is much stronger than material 1, material 2 will be used to bear more loads, while material 1 mostly acts as an enhancing material (Fig. 7(b)).

Further, the optimal solutions with different material volume fractions are compared. Here, the Young’s Moduli of the two materials are set to be 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                           =
                           1
                         and 
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                           =
                           10
                        . The total material usage is chosen as 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 1
                              
                           
                           =
                           0.5
                        , and the second constraint is chosen as 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 2
                              
                           
                           =
                           0.3
                         and 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 2
                              
                           
                           =
                           0.2
                        , which means the strong material occupies 30% and 20% of the design domain. The optimal designs are presented in Fig. 8
                        . It can be found that both optimal results provide reasonable distribution of materials.

With this method, we now examine the effect that different regularization parameter 
                           τ
                         have upon the resulting optimal configurations. Here, the Young’s Moduli of the two materials are set to be 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                           =
                           1
                         and 
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                           =
                           5
                        . The total material usage is chosen as 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 1
                              
                           
                           =
                           0.5
                        , and the second constraint is chosen as 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 2
                              
                           
                           =
                           0.4
                        , which means the strong material occupies 40% of the design domain. To observe the influence of 
                           τ
                         on the optimal design, we set 
                           τ
                         to be 2×10−5, 2×10−4, 6×10−4 and 1×10−3, respectively. Fig. 9
                         shows the optimal configuration for each 
                           τ
                         value. It can be seen that the geometrical complexity of optimal solutions can be easily controlled by appropriately setting a regularization parameter.

To examine the performance of the proposed method in problems involving three materials, we now consider the cantilever beam with three materials. The Young’s moduli of the materials are set to be 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                           =
                           1
                         (red regions), 
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                           =
                           3
                         (green regions) and 
                           
                              
                                 E
                              
                              
                                 3
                              
                           
                           =
                           9
                         (blue regions). The volume constraints are set to be 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 1
                              
                           
                           =
                           0.5
                        , 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 2
                              
                           
                           =
                           0.4
                        , and 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 3
                              
                           
                           =
                           0.3
                        , which means the material volume fractions of the three materials are specified as 10%, 10% and 30%. The topology optimization design process is shown in Fig. 10
                        .

In Fig. 10, (a) and (d) indicate the initial design and the optimal configuration respectively, (b) and (c) show in sequence the configuration after 40 and 80 iterations. It is found that the proposed method can also obtain reasonable distribution of materials under volume constraints in the three materials case. Fig. 11
                         shows the convergence history of structural compliance and the changes of the volume fractions of different materials during the optimization process.

This example is to design a two-bar bracket structure with two materials. As shown in Fig. 12
                        , the geometrical dimension of the design domain is 80×160. The left edge of the structure is fixed, and a unit concentrated force (
                           f
                           =
                           1
                        ) is applied at the middle point of the right edge. The Young’s moduli of the two materials are 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                           =
                           1
                         (red regions) and 
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                           =
                           5
                         (green regions), and both the Poisson’s ratios are 
                           ν
                           =
                           0.3
                        . The volume fractions are set to be 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 1
                              
                           
                           =
                           0.3
                         and 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 2
                              
                           
                           =
                           0.15
                        , which means the maximum volume ratios of both materials are 15%. The regularization parameter is set to be 
                           τ
                           =
                           2
                           ×
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 4
                              
                           
                        . The topology optimization design process is shown in Fig. 13
                        .

In Fig. 13, (a) and (f) indicate the initial design and the optimal design respectively, (b)–(e) show in sequence the design solution after different number of iterations. Fig. 14
                         shows the convergence history of structural compliance and the changes of the volume fractions of two materials during the optimization process. From Fig. 14(a), it can be found that it is hard to reach the termination criterion in this numerical example for the numerical oscillation caused by the diffusive term.

We also give the example of designing the two-bar bracket structure with three materials. The Young’s moduli of the materials are 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                           =
                           1
                         (red regions), 
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                           =
                           3
                         (green regions) and 
                           
                              
                                 E
                              
                              
                                 3
                              
                           
                           =
                           9
                         (blue regions). The volume constraints are 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 1
                              
                           
                           =
                           0.4
                        , 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 2
                              
                           
                           =
                           0.3
                         and 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 3
                              
                           
                           =
                           0.2
                        , which means that the material volume fractions of the three materials are specified as 10%, 10% and 20%. The optimal process is shown in Fig. 15
                        .

In Fig. 15, (a) and (f) indicate the initial design and the optimal design respectively, (b)–(f) show in sequence the design solution after different number of iterations. Fig. 16
                         shows the convergence history of structural compliance and the changes of the volume fractions of different materials during the optimization process.


                        Fig. 17
                         shows the design domain and boundary conditions of bridge. A load (
                           f
                           =
                           1
                        ) is applied at the bottom center of the design domain. Vertical and horizontal displacements at the bottom left corner of the design domain are fixed, as is the horizontal displacement at the bottom right corner of the analysis domain. The design domain is symmetric along the 
                           y
                        -axis and a roller constraint is imposed on the boundary at the bottom right corner, so only the right half of the design domain is considered in the optimization problem. The objective function is to minimize the compliance. The design domain is discretized into 240×120 (half 120×120) rectangular grid and the regularization parameter 
                           τ
                         is set to be 4×10−4. The Young’s moduli of material 1 and material 2 are 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                           =
                           1
                         (red regions) and 
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                           =
                           3
                         (green regions), respectively. Both materials have the same Poisson’s ratio 
                           ν
                           =
                           0.3
                        . The volume fractions are given by 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 1
                              
                           
                           =
                           0.5
                         and 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 2
                              
                           
                           =
                           0.3
                        , which means that the maximum volume usages for material 1 and material 2 are 20% and 30%, respectively. The topology optimization design process is shown in Fig. 18
                        .

In Fig. 18, (a) and (d) indicate the initial design and the optimal configuration respectively, (b) and (c) show in sequence the configuration after 60 and 120 iterations. Fig. 19
                         shows the convergence history of structural compliance and the changes of the volume fractions of two materials during the optimization process. From Fig. 19(a), it can be found that it is hard to reach the termination criterion in this numerical example for the numerical oscillation caused by the diffusive term.

An example of designing the bridge structure with three materials is also given here. The Young’s moduli of the materials are 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                           =
                           1
                         (red regions), 
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                           =
                           2
                         (green regions) and 
                           
                              
                                 E
                              
                              
                                 3
                              
                           
                           =
                           4
                         (blue regions). The volume constraints are 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 1
                              
                           
                           =
                           0.5
                        , 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 2
                              
                           
                           =
                           0.4
                         and 
                           
                              
                                 V
                              
                              
                                 
                                    max
                                 
                              
                              
                                 3
                              
                           
                           =
                           0.3
                        , which means that the material volume fractions of the three materials are specified as 10%, 10% and 30%. The topology optimization design process is shown in Fig. 20
                        .

In Fig. 20, (a) and (d) indicate the initial design and the optimal configuration respectively, (b) and (c) show in sequence the configuration after 60 and 120 iterations. Fig. 21
                         shows the convergence history of structural compliance and the changes of the volume fractions of different materials during the optimization process.

@&#CONCLUSIONS@&#

An approach for topology optimization of multi-material structures is proposed in this paper. The proposed method describes each phase by a combination of different level set functions. The representation model is modified from MM-LS topology description model, so it still can effectively indicate each distinct phase and avoid overlaps between each two phases. Moreover, here multi-material topology optimization problems are solved via the level-set based topology optimization method using a reaction diffusion equation. With the proposed method, the geometrical complexity of optimal solutions can be easily controlled by appropriately setting a regularization parameter. Then a suitable structure for manufacture can be provided by this method. The effectiveness and feasibility of the proposed method are demonstrated by using a couple of typical numerical examples. The manufacturability issue of an optimized multi-material structure is an inevitable problem, which may be addressed by the approach in Ref.  [28].

@&#ACKNOWLEDGMENTS@&#

This research is supported by the Project of China Scholarship Council (201506965015). The authors are also grateful to the anonymous reviewers for their valuable suggestions for improving the manuscript.

@&#REFERENCES@&#

