@&#MAIN-TITLE@&#Segmentation of uterine fibroid ultrasound images using a dynamic statistical shape model in HIFU therapy

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           The dynamic-based SSM is proposed to improve the performance of conventional SSM.


                        
                        
                           
                           Dynamic-based prior shape can describe the more detailed shape information of ROI.


                        
                        
                           
                           Radial profile feature model makes active contour robust to false edges.


                        
                        
                           
                           Obtained 95.90%, 1.73%, 1.59mm and 2.82mm for TP, FP, AMED and HD, respectively in the test set.


                        
                        
                           
                           Our method is potential for clinical application in HIFU therapy.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Dynamic model

Shape statistical model

Active contour

HIFU ultrasound image segmentation

Uterine fibroid

@&#ABSTRACT@&#


               
               
                  Segmenting the lesion areas from ultrasound (US) images is an important step in the intra-operative planning of high-intensity focused ultrasound (HIFU). However, accurate segmentation remains a challenge due to intensity inhomogeneity, blurry boundaries in HIFU US images and the deformation of uterine fibroids caused by patient's breathing or external force. This paper presents a novel dynamic statistical shape model (SSM)-based segmentation method to accurately and efficiently segment the target region in HIFU US images of uterine fibroids. For accurately learning the prior shape information of lesion boundary fluctuations in the training set, the dynamic properties of stochastic differential equation and Fokker–Planck equation are incorporated into SSM (referred to as SF-SSM). Then, a new observation model of lesion areas (named to RPFM) in HIFU US images is developed to describe the features of the lesion areas and provide a likelihood probability to the prior shape given by SF-SSM. SF-SSM and RPFM are integrated into active contour model to improve the accuracy and robustness of segmentation in HIFU US images. We compare the proposed method with four well-known US segmentation methods to demonstrate its superiority. The experimental results in clinical HIFU US images validate the high accuracy and robustness of our approach, even when the quality of the images is unsatisfactory, indicating its potential for practical application in HIFU therapy.
               
            

@&#INTRODUCTION@&#

Uterine fibroids are commonly occurring benign tumors that can trouble females. The incidence of uterine fibroids in women over the age of 30 years is 20–25% [1]. Ultrasound (US) imaging has becoming the main imaging modality for uterine fibroids diagnosis and treatment, due to its inexpensive diagnostic value compared with computed tomography (CT) or magnetic resonance imaging (MRI) and able to follow anatomical deformations in real-time.

In recent years, HIFU therapy is a new computer aided-therapy that has been successfully applied to the treatment of uterine fibroids [2,3]. The major advantage of HIFU is its non-invasive. As shown in Fig. 1
                     , surgeons need only operate the HIFU probe to transmit HIFU focusing on the lesion areas and provided a slice by slice view of the uterine fibroids according to the US imaging. The accuracy of the lesion areas segmentation from the US images directly affects the HIFU therapy's final result. However, the US images uterine fibroids segmentation is not always efficient and accurate due to the images’ low SNR (signal to noise ratio), fuzzy boundaries and inhomogeneity gray distribution. More serious noise and blurry boundaries have been observed in images used in HIFU therapy because of water interference in the treatment process (see Fig. 2
                     ). Beyond that, the other potential challenge is that the patient's breathing or unexpected body movement easily causes the deformation of uterine fibroids during the US imaging process, which gives rise to the deformable shapes of lesion areas in HIFU US images. These factors have prevented the conventional segmentation methods from yielding desired results for uterine fibroids in HIFU US images. Until now, manual segmentation by radiologists is still frequently used in HIFU therapy, even though it is a tedious and time-consuming. For these reasons, development of a highly effective and precise US images segmentation method for HIFU therapy is urgently needed.

During these decades, a series of segmentation method for ROI from US images have been proposed [4,5]. Among the reported methods, active contour model-based methods have demonstrated the most promising segmentation results. Active contour models can be classified into two categories: parametric active contour models (e.g., [6–9]) and geometric active contour models (e.g., [10–13]). Parametric active contour models adopt the image's gradient information as “external force” and the curvature of contour as “internal force” to push the initial contour toward the region of interest (ROI), and achieve a good segmentation. However, this kind of model has two major limitations. First, the results are sensitive to the noise in the images and the location of initial contours. Second, the ROI can be hardly segmented when its shape in images is complex and deformable. Due to more serious noise and blurry boundaries in HIFU US images, the problem of edge leakage is easily produced when this model is applied to HIFU US images. Geometric active contour model, which was firstly proposed by [10], uses a 3-D continuous surface function to represent a 2-D contour's curve. The evolution of the curve can be determined by a zero level set of the high dimensional function and driven by the forces formed using statistical information about the foreground and background regions. The most advantage of this model is that the curve is evolved by numerical calculation and need not parameterize the curve to track complex topology. In [14], the proposed C–V model can effectively segment US with noise and weak edges as a consequence of not using the image's gradient information. However, incorrect results are produced on HIFU images with inhomogeneity intensity, because the C–V model assumes that regions of intensity in the image are homogeneously distributed and utilized global statistical information [14,15].

To overcome the shortcoming of US image, the texture priors of the ROI have been researched to guide the evolution of active contour to the object's boundary by clustering, sparse coding [16–20]. Other researchers utilize the prior shape of ROI to avoid the active contour evolves to the false areas [21–25]. Among these models, ASM (active shape model), which was systematically presented by [23], has been widely applied in medical image segmentation. This model has three parts: (1) building a SSM (statistical shape model) to generate a prior shape of object from training set; (2) constructing an observation model of the ROI from the image to provide the confidence to the prior shape and (3) balancing the energies of the prior shape and observation model to drive the active contour to the ROI. In its SSM part, [26] popularizes the PDM (point distribution model), which represents an object boundary by interactively defining an ordered list of N position vectors P
                     ={x
                     
                        i
                     , y
                     
                        i
                     }, i
                     =0, …, N
                     −1 that correspond to the same position among all training shapes. Then, PCA (principal component analysis) [27] is used to reduce the dimensionality and shape modeling. This model represents the average location of points and the main deformation of the shapes in the training set. However, there are still drawbacks in ASM: (1) aligning mark points among training shapes is a time-consuming and inaccurate; (2) PCA is only useful in the case where all the shapes change lie in or at least approximately near the linear subspace; If this assumption does not exist, some importance deformable information of contour could be lost, which may influence the accuracy of the prior shape estimation considerable; (3) the prior shape needs be manually located nearby the object region, which may cause the incorrect instable segmentation results. Therefore, new prior statistical shape was proposed in the segmentation algorithm without requiring explicit correspondence points [28]. However, this model uses an implicit shape representation rather than parametric shape boundaries to remove the need for explicit correspondence point. Training shapes are still implicitly aligned, and the model maintains the assumption of correspondence. To overcome the limitation of PCA, manifold learning based methods [29,30] attempt to train the prior shape of the ROI in the nonlinear subspace. The similarity of the ROI in the image sequence is modeled as prior knowledge to constrain the evolution of the contour [31–34]. The sparse representation and dictionary learning are applied in the ASM framework to detect ROI in echocardiographic sequences [35,36]. Recently, the dynamics-based models (e.g., Newton's second law, Gaussian process, fluid dynamics) are introduced to segment and track the boundaries of the ROI [37–40].

As mentioned above, we find that a good prior knowledge of the ROI is a powerful tool for improving the segmentation results in US images. In this paper, we propose a novel dynamics-based SSM to estimate the prior shape to achieve more accurate segmenting uterine fibroids in HIFU US images. In order to avoid the aligning operation in the training set, a new parametric shape representation model (radius time series) is designed. Then, the dynamic properties of stochastic difference equation (SDE) and Fokker–Planck equation (FPE) are firstly employed to construct the SSM (referred as to SF-SSM) which produces the prior shape and prior probability of ROI. Furthermore, an observation model, named radial profile feature model (RPFM), is developed to provide the confidence areas of the ROI to the prior shape in the procedure of refining segmentation results.

The remainder of this paper is organized as follows. In Section 2, the proposed radius time series and the derivation of SF-SSM are described in detail. A detailed description about RPFM is given in Section 3. The SF-SSM based segmentation method is explained in Section 4. In Section 5, numerous experiments and comparisons are shown, and several performances of the compared methods are also analyzed and discussed. Finally, in Section 6, we summarize our work and give some directions for future research.

In [41], a closed shape is represented by a series of successive radii. For building the statistical shape model (SSM) of uterine fibroids, a radius time series is proposed to be a parametric model to represent the shape of lesion areas in the US image. The parametric model is formalized as Eq. (1). Fig. 3
                        a shows an example of uterine fibroids US images, where the red solid line is drawn by the interactive tool to represent the contour of the lesion areas. A radius time series is constructed on the basis of the contour (see Fig. 3b), where the yellow point denotes the pixel coordinate of central point x
                        
                           c
                         inside the ROI, the blue solid lines are a series of successive radii R by measuring the Euclidean distance from the x
                        
                           c
                         to the boundary of contour, the angle t between the radii is specified as a constant, and the “Markers” represent the points M which are on the boundary by intersected the radii. This model represents any two-dimensional closed shape with a discrete time series. This discrete time series models the discrete time evolution of a state variation, but the state variable is radius r, and the time variable is replaced by t (see Fig. 3c). The most advantage is that this model allows us to express multiple closed shapes in polar coordinate space without the need to align these shapes in the sample set.


                        
                           
                              (1)
                              
                                 
                                    
                                       Q
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       R
                                    
                                 
                                 ,
                                 
                                    
                                       M
                                    
                                 
                                 ,
                                 t
                                 ,
                                 
                                    
                                       
                                          x
                                       
                                    
                                    c
                                 
                                 }
                                 =
                                 {
                                 {
                                 
                                    r
                                    0
                                 
                                 ,
                                 …
                                 ,
                                 
                                    r
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 }
                                 ,
                                 {
                                 
                                    
                                       
                                          m
                                       
                                    
                                    0
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          m
                                       
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 }
                                 ,
                                 t
                                 ,
                                 {
                                 
                                    x
                                    c
                                 
                                 ,
                                 
                                    y
                                    c
                                 
                                 }
                                 }
                                 .
                              
                           
                        
                     

To train the shape information of lesion boundary fluctuations, SF-SSM is constructed through incorporating the dynamics properties of SDE and FPE into statistical learning from the field of nonlinear time series analysis, which is used to produce the shape priors and prior probability of the ROI. As described in Section 2.1, a radius time series can be seen as a nonlinear discrete stochastic series which is used as the generative model of the prior shapes. In [42], one-dimensional stochastic variable nonlinear discrete stochastic series is usually represented by a stochastic different equation (SDE). A radius time series can be generated by Eq. (2),


                        
                           
                              (2)
                              
                                 r
                                 (
                                 t
                                 +
                                 Δ
                                 t
                                 )
                                 =
                                 r
                                 (
                                 t
                                 )
                                 +
                                 A
                                 (
                                 r
                                 (
                                 t
                                 )
                                 ,
                                 
                                    
                                       a
                                    
                                 
                                 )
                                 ·
                                 dt
                                 +
                                 B
                                 (
                                 r
                                 (
                                 t
                                 )
                                 ,
                                 
                                    
                                       b
                                    
                                 
                                 )
                                 ·
                                 
                                    dW
                                    t
                                 
                                 ·
                                 dt
                                 ,
                              
                           
                        where r(t) is a state variable at time t, A(r(t), a) and B(r(t), b) are the deterministic and stochastic terms respectively, a and b represent those coefficients, and W
                        
                           t
                         is an uncorrelated, time dependent noise with an expected value of zero. The state of r(t) is dependent on the state of r(t
                        −Δt) and the forms of A(r(t), a) and B(r(t), b). According to the character of nonlinear dynamics, the state variation of r(t) meets Markov property, i.e.,


                        
                           
                              (3)
                              
                                 Pr
                                 (
                                 r
                                 (
                                 t
                                 )
                                 )
                                 =
                                 f
                                 (
                                 Pr
                                 (
                                 r
                                 (
                                 t
                                 −
                                 Δ
                                 t
                                 )
                                 )
                                 )
                                 ,
                              
                           
                        where Pr(·) is the probability of state variable r(t), f denotes a probability transition equation of state variable.

FPE, was firstly proposed by two researchers (Fokker and Planck), is a famous equation in statistical mechanics, the function of which is to describe the time evolution of the probability density function of the velocity of a particle under the influence of drag forces and random forces. In this paper, FPE is utilized to deduce the form of f, since its function meets our assumption about the variation of ROI. The formula of FPE is shown as follows,


                        
                           
                              (4)
                              
                                 
                                    ∂
                                    
                                       ∂
                                       t
                                    
                                 
                                 f
                                 (
                                 x
                                 ,
                                 t
                                 )
                                 =
                                 −
                                 
                                    ∂
                                    
                                       ∂
                                       x
                                    
                                 
                                 [
                                 
                                    D
                                    1
                                 
                                 (
                                 x
                                 ,
                                 t
                                 )
                                 f
                                 (
                                 x
                                 ,
                                 t
                                 )
                                 ]
                                 +
                                 
                                    
                                       
                                          ∂
                                          2
                                       
                                    
                                    
                                       ∂
                                       
                                          x
                                          2
                                       
                                    
                                 
                                 [
                                 
                                    D
                                    2
                                 
                                 (
                                 x
                                 ,
                                 t
                                 )
                                 f
                                 (
                                 x
                                 ,
                                 t
                                 )
                                 ]
                                 ,
                              
                           
                        where f(x, t) is a probability density function, D
                        (1) and D
                        (2) are called the drift and the diffusion coefficients respectively. We substitute Eq. (3) into Eq. (4), the probability of state variable r(t) is given by Eq. (5).


                        
                           
                              (5)
                              
                                 
                                    ∂
                                    
                                       ∂
                                       t
                                    
                                 
                                 Pr
                                 (
                                 r
                                 (
                                 t
                                 )
                                 |
                                 r
                                 (
                                 t
                                 −
                                 Δ
                                 t
                                 )
                                 )
                                 =
                                 
                                    
                                       
                                          −
                                          
                                             ∂
                                             
                                                ∂
                                                r
                                             
                                          
                                          
                                             D
                                             
                                                (
                                                1
                                                )
                                             
                                          
                                          (
                                          r
                                          (
                                          t
                                          )
                                          )
                                          +
                                          
                                             
                                                
                                                   ∂
                                                   2
                                                
                                             
                                             
                                                ∂
                                                
                                                   r
                                                   2
                                                
                                             
                                          
                                          
                                             D
                                             
                                                (
                                                2
                                                )
                                             
                                          
                                          (
                                          r
                                          (
                                          t
                                          )
                                          )
                                       
                                    
                                 
                                 Pr
                                 (
                                 r
                                 (
                                 t
                                 )
                                 |
                                 r
                                 (
                                 t
                                 −
                                 Δ
                                 t
                                 )
                                 )
                                 .
                              
                           
                        The forms of D
                        1(r(t)) and D
                        2(r(t)) are decided by the value of state variable r(t) in the state space while time variable t is under the stable condition. With the discrete data in the sample space, we use Eq. (6) to approximately estimate the forms of D
                        1(r(t)) and D
                        2(r(t)).


                        
                           
                              (6)
                              
                                 
                                    D
                                    
                                       (
                                       n
                                       )
                                    
                                 
                                 (
                                 r
                                 (
                                 t
                                 )
                                 )
                                 =
                                 
                                    lim
                                    
                                       Δ
                                       t
                                       →
                                       0
                                    
                                 
                                 
                                    1
                                    
                                       Δ
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       [
                                       r
                                       (
                                       t
                                       +
                                       Δ
                                       t
                                       )
                                       −
                                       r
                                       (
                                       t
                                       )
                                       ]
                                    
                                    n
                                 
                                 |
                                 r
                                 (
                                 t
                                 )
                                 =
                                 t
                                 )
                                 .
                              
                           
                        The A(x, t) and B(x, t) can be deduced by Eq. (7), the details of derivation are described in Refs. [43,44].


                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          A
                                          (
                                          r
                                          (
                                          t
                                          )
                                          )
                                          =
                                          
                                             
                                                
                                                   D
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                (
                                                r
                                                )
                                             
                                             
                                                Δ
                                                t
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          B
                                          (
                                          r
                                          (
                                          t
                                          )
                                          )
                                          =
                                          
                                             
                                                
                                                   D
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                                (
                                                r
                                                )
                                             
                                             
                                                
                                                   
                                                      Δ
                                                      t
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        According to Eq. (6), the forms of D
                        
                           n
                        (r(t)) can be approximately fitted, and then the deterministic and stochastic terms of Eq. (2) are given by Eq. (7).

In [45], the discrete observation data from training data are utilized to estimate the forms and parameters of candidate functions. Inspired by this method, we design a radius transition histogram to train the observation data (see Fig. 4
                        a). This radius transition histogram is not only employed to approximately estimate the drift and diffusion functions and the radius transition probability, but also provide the radius transition probability at each time t. The details of training steps are described in Algorithm 1.


                        
                           Algorithm 1
                           Training radius transition histogram


                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                Input:
                                             
                                          
                                          
                                             
                                             Training set 
                                                   
                                                      
                                                         ℝ
                                                      
                                                   
                                                   =
                                                   {
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                      
                                                      1
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                      
                                                      j
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                      
                                                      M
                                                   
                                                   }
                                                , r
                                                
                                                   j
                                                (t)∈
                                                R
                                                
                                                   j
                                                , r
                                                
                                                   j
                                                (t)>0, 0≤
                                                t
                                                ≤2π
                                             
                                          
                                          
                                             
                                                Output
                                             
                                          
                                          
                                             
                                             Radius transition histogram
                                          
                                          
                                             1:
                                             Transform the training set 
                                                   
                                                      ℝ
                                                   
                                                 into the state space
                                                R
                                                ={r
                                                
                                                   min
                                                , …, r
                                                
                                                   max
                                                }.
                                          
                                          
                                             2:
                                             Set the radius increment Δr and divide the state space R into N
                                                bins by 
                                                   N
                                                   =
                                                   ⌈
                                                   
                                                      
                                                         
                                                            r
                                                            max
                                                         
                                                         −
                                                         
                                                            r
                                                            min
                                                         
                                                      
                                                      
                                                         Δ
                                                         r
                                                         −
                                                         1
                                                      
                                                   
                                                   ⌉
                                                .
                                          
                                          
                                             3:
                                             Compute the center values r
                                                
                                                   i
                                                
                                                ∈{r
                                                1, …, r
                                                
                                                   N
                                                } for every bins.
                                          
                                          
                                             4:
                                             Set up N sets x
                                                
                                                   i
                                                , i
                                                ∈{1, …, N}, which correspond to N bins.
                                          
                                          
                                             5:
                                             
                                                for
                                                
                                                R
                                                
                                                   j
                                                , j
                                                =1:
                                                M
                                                
                                                do
                                             
                                          
                                          
                                             6:
                                             
                                                
                                                for
                                                
                                                bins, i
                                                =1:
                                                N
                                                
                                                do
                                             
                                          
                                          
                                             7:
                                             
                                                  find r
                                                
                                                   j
                                                (t)∈[r
                                                
                                                   i
                                                
                                                −Δr/2, r
                                                
                                                   i
                                                
                                                +Δr/2], t
                                                ∈[0:Δt
                                                :2π]
                                          
                                          
                                             8:
                                             
                                                  
                                                if
                                                
                                                t
                                                +Δt
                                                <2π
                                                
                                                then
                                             
                                          
                                          
                                             9:
                                             
                                                    put r
                                                
                                                   j
                                                (t
                                                +Δt)into set
                                                x
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             10:
                                             
                                                  
                                                else
                                             
                                          
                                          
                                             11:
                                             
                                                    put r
                                                
                                                   j
                                                (t
                                                +Δt)into set
                                                x
                                                1
                                             
                                          
                                          
                                             12:
                                             
                                                  
                                                end if
                                             
                                          
                                          
                                             13:
                                             
                                                
                                                end for
                                             
                                          
                                          
                                             14:
                                             
                                                end for
                                             
                                          
                                       
                                    
                                 
                              
                           

As shown in Fig. 4b, we find that the observed data in each bins follow a normal distribution, which denotes the transition probability of state variable r(t) (see Eq. (8)). The mean μ
                        
                           i
                         and variance σ
                        
                           i
                         are given by kernel density estimation.


                        
                           
                              (8)
                              
                                 Pr
                                 
                                    
                                       
                                          r
                                          (
                                          t
                                          +
                                          Δ
                                          t
                                          )
                                          |
                                          r
                                          (
                                          t
                                          )
                                          ∈
                                          
                                             r
                                             i
                                          
                                          ±
                                          
                                             
                                                Δ
                                                r
                                             
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 N
                                 (
                                 
                                    μ
                                    i
                                 
                                 ,
                                 
                                    σ
                                    i
                                 
                                 )
                                 .
                              
                           
                        Eq. (8) can be used to approximately represent the prior probability of each radius r(t
                        +Δt) as follows:


                        
                           
                              (9)
                              
                                 Pr
                                 (
                                 r
                                 (
                                 t
                                 +
                                 Δ
                                 t
                                 )
                                 |
                                 r
                                 (
                                 t
                                 )
                                 =
                                 
                                    r
                                    i
                                 
                                 )
                                 =
                                 N
                                 (
                                 
                                    μ
                                    i
                                 
                                 ,
                                 
                                    σ
                                    i
                                 
                                 )
                                 .
                              
                           
                        To estimate the forms of the drift and diffusion functions, Eq. (6) is represented as the discrete form (see Eq. (10)),


                        
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                (
                                                
                                                   r
                                                   i
                                                
                                                (
                                                t
                                                )
                                                )
                                                =
                                                (
                                                
                                                   μ
                                                   i
                                                
                                                −
                                                
                                                   r
                                                   i
                                                
                                                )
                                                Δ
                                                t
                                             
                                          
                                          
                                             
                                                
                                                   D
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                                (
                                                
                                                   r
                                                   i
                                                
                                                (
                                                t
                                                )
                                                )
                                                =
                                                
                                                   σ
                                                   i
                                                
                                                
                                                   
                                                      Δ
                                                      t
                                                   
                                                
                                                ,
                                                
                                                
                                                   r
                                                   i
                                                
                                                ∈
                                                {
                                                
                                                   r
                                                   min
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   r
                                                   max
                                                
                                                }
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Then, the candidate functions A(r(θ), a) and B(r(θ), b) are computed by Eq. (7), the parameters of which can be estimated by using Levenberg Marquardt routine with the lowest χ
                        2. The prior shape is generated, when the deterministic and stochastic terms of Eq. (2) are determined. The probability of the prior shape is also provided by computing a joint probability distribution as follows,


                        
                           
                              (11)
                              
                                 
                                    E
                                    
                                       SF
                                       -
                                       SSM
                                    
                                 
                                 =
                                 
                                    ∏
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 Pr
                                 (
                                 r
                                 (
                                 t
                                 +
                                 Δ
                                 t
                                 )
                                 |
                                 r
                                 (
                                 t
                                 )
                                 =
                                 
                                    r
                                    i
                                 
                                 )
                                 ,
                              
                           
                        which is used to derive a probability for a test image from the log of Eq. (11),


                        
                           
                              (12)
                              
                                 
                                    E
                                    
                                       SF
                                       -
                                       SSM
                                    
                                 
                                 =
                                 
                                    1
                                    N
                                 
                                 ×
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                log
                                                
                                                Pr
                                                (
                                                r
                                                (
                                                t
                                                +
                                                Δ
                                                t
                                                )
                                                |
                                                r
                                                (
                                                t
                                                )
                                                =
                                                
                                                   r
                                                   i
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

In active contour based methods, the observation model of the target region is critical for the segmentation performances. In order to overcome the complex image texture around the contour parts in HIFU US images, the most noticeable feature of the lesion areas which is the dark-to-bright transition from the inside to the outside of lesion areas in US images is utilized to develop a new distinctive observation model of the lesion areas for HIFU US segmentation. To describe the local image appearance of the radius r in the radius time series, we select the proper number and locations of sample points along the radial direction for each mark point and use a one-dimension normalized radial second order derivative profile to form a radial profile feature vector of each mark point. In addition, the characteristic that the gray distribution around lesion areas in US images follows Rayleigh distribution, which was proven in [46,47], is incorporated into the radial profile feature vectors to train the radial profile feature model (RPFM) which provides a likelihood probability that the radii and the true boundary intersect. Fig. 5
                      shows the schematic of how to construct RPFM, its detailed implementations are described as follows:
                        Step 1
                        
                           For each image in the training set, construct the radius time series of the ROI by a pixel-selected tool.

For each mark point m
                              
                                 i
                               on the radius r(t
                              
                                 i
                              ), sample η points using a fixed spacing δ evenly from both sides along the radial direction (see Fig. 5b). The location of jth point is


                              
                                 
                                    (13)
                                    
                                       
                                          
                                             
                                                m
                                             
                                          
                                          i
                                          j
                                       
                                       =
                                       
                                          
                                             
                                                m
                                             
                                          
                                          i
                                       
                                       +
                                       j
                                       ·
                                       
                                          δ
                                          
                                             cos
                                             (
                                             t
                                             )
                                          
                                       
                                       .
                                    
                                 
                              
                           

The values of η and δ will be discussed in Section 5.1.

Let 
                                 
                                    
                                       
                                          g
                                       
                                    
                                    i
                                 
                                 =
                                 (
                                 |
                                 
                                    g
                                    i
                                    1
                                 
                                 |
                                 ,
                                 …
                                 ,
                                 |
                                 
                                    g
                                    i
                                    j
                                 
                                 |
                                 ,
                                 …
                                 ,
                                 |
                                 
                                    g
                                    i
                                    η
                                 
                                 |
                                 )
                               denote the radial profile feature vector of r(t
                              
                                 i
                              ), where 
                                 |
                                 
                                    g
                                    i
                                    j
                                 
                                 |
                               is the gradient magnitude of sample point 
                                 
                                    
                                       
                                          m
                                       
                                    
                                    i
                                    j
                                 
                              .

The normalized value of 
                                 |
                                 
                                    g
                                    i
                                    j
                                 
                                 |
                               is given by


                              
                                 
                                    (14)
                                    
                                       |
                                       
                                          g
                                          i
                                          j
                                       
                                       |
                                       =
                                       
                                          
                                             |
                                             2
                                             ·
                                             
                                                
                                                   V
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                i
                                                j
                                             
                                             )
                                             −
                                             
                                                
                                                   V
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                i
                                                
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             )
                                             −
                                             
                                                
                                                   V
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                i
                                                
                                                   j
                                                   −
                                                   1
                                                
                                             
                                             )
                                             |
                                          
                                          
                                             |
                                             
                                                
                                                   V
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                i
                                                j
                                             
                                             )
                                             |
                                          
                                       
                                       ,
                                    
                                 
                              where V(·) denotes the pixel value of 
                                 
                                    
                                       
                                          m
                                       
                                    
                                    i
                                    j
                                 
                              .

With the values of {g
                              1, …, g
                              
                                 i
                              , …, g
                              
                                 n
                              }, RPFM can be trained through estimating the coefficients of the Rayleigh distribution, which provides a likelihood probability that the radius r(t
                              
                                 i
                              ) and the true boundary intersect (see Eq. (15)).


                              
                                 
                                    (15)
                                    
                                       Pr
                                       (
                                       
                                          
                                             
                                                g
                                             
                                          
                                          i
                                       
                                       |
                                       r
                                       (
                                       
                                          t
                                          i
                                       
                                       )
                                       )
                                       =
                                       
                                          
                                             r
                                             (
                                             
                                                t
                                                i
                                             
                                             )
                                          
                                          
                                             
                                                σ
                                                2
                                             
                                          
                                       
                                       
                                          exp
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         (
                                                         r
                                                         (
                                                         
                                                            t
                                                            i
                                                         
                                                         )
                                                         −
                                                         a
                                                         )
                                                      
                                                      2
                                                   
                                                
                                                
                                                   2
                                                   σ
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           


                     
                        
                           (16)
                           
                              
                                 E
                                 RPFM
                              
                              =
                              
                                 ∏
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              Pr
                              (
                              
                                 
                                    
                                       g
                                    
                                 
                                 i
                              
                              |
                              r
                              (
                              
                                 t
                                 i
                              
                              )
                              )
                              .
                           
                        
                     
                  

As shown in Fig. 6
                     , the workflow of our method is summarized as three parts: (1) train SF-SSM to generate the prior shape and probability of uterine fibroids; (2) build RPFM to provide a likelihood probability of the target areas; (3) after RPFM is trained, it is incorporated into the prior shape by computing the maximum a posteriori probability to segment the uterine fibroids in HIFU US image. The pseudo codes of our method are represented in Algorithm 2, the details of implementation are described as follows:
                        
                           1.
                           For each US image, the radius time series is constructed from the sample set I
                              =[I
                              1, …, I
                              
                                 j
                              , …, I
                              
                                 s
                              ]). In the procedure of constructing radius time series, the central point x
                              
                                 c
                               is defined which has maximum distance to any contour pixel inside the ROI, and then successively computed the Euclidean distance between 
                                 
                                    
                                       
                                          x
                                       
                                    
                                    c
                                    j
                                 
                               and 
                                 
                                    
                                       
                                          m
                                       
                                    
                                    i
                                    j
                                 
                               as radius 
                                 
                                    r
                                    i
                                    j
                                 
                              . To normalize the variables 
                                 
                                    r
                                    i
                                    j
                                 
                              , each radius 
                                 
                                    r
                                    i
                                    j
                                 
                               is represented as difference from a mean radial 
                                 
                                    
                                       
                                          r
                                          i
                                       
                                    
                                    ¯
                                 
                              , where 
                                 
                                    
                                       
                                          r
                                          i
                                       
                                    
                                    ¯
                                 
                                 =
                                 (
                                 1
                                 /
                                 s
                                 )
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    s
                                 
                                 
                                    
                                       r
                                       i
                                       j
                                    
                                 
                              . In order to eliminate the estimation error of x
                              
                                 c
                               as far as possible, we define 
                                 Δ
                                 
                                    x
                                    c
                                 
                                 =
                                 (
                                 1
                                 /
                                 s
                                 )
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    s
                                 
                                 (
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                          
                                          x
                                          j
                                       
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       
                                          x
                                       
                                    
                                    cx
                                    j
                                 
                                 )
                               and 
                                 Δ
                                 
                                    y
                                    c
                                 
                                 =
                                 (
                                 1
                                 /
                                 s
                                 )
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    s
                                 
                                 (
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                          
                                          y
                                          j
                                       
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       
                                          x
                                       
                                    
                                    cy
                                    j
                                 
                                 )
                               as the offset of the central point (see Eq. (17)),


                              
                                 
                                    (17)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         c
                                                         ′
                                                      
                                                      =
                                                      
                                                         x
                                                         c
                                                      
                                                      +
                                                      Δ
                                                      
                                                         x
                                                         c
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                         c
                                                         ′
                                                      
                                                      =
                                                      
                                                         y
                                                         c
                                                      
                                                      +
                                                      Δ
                                                      
                                                         y
                                                         c
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

On the base of the radius time series, SF-SSM is constructed by Algorithm 1, which generate the prior shape and probability on the test image by Eqs. (2) and (12) respectively.

As described in Section 3, RPFM is built from the sample set, which provide a likelihood probability of ROI by Eq. (16).

According to Bayesian theory, the maximum a posteriori probability of each radius r
                              
                                 i
                               is computed by Eq. (18),


                              
                                 
                                    (18)
                                    
                                       E
                                       (
                                       
                                          r
                                          i
                                       
                                       )
                                       =
                                       Pr
                                       (
                                       
                                          r
                                          i
                                       
                                       |
                                       r
                                       =
                                       
                                          r
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       )
                                       ×
                                       Pr
                                       (
                                       
                                          
                                             
                                                g
                                             
                                          
                                          i
                                       
                                       |
                                       
                                          r
                                          i
                                       
                                       )
                                       .
                                    
                                 
                              
                           

The segmentation result is produced in case that the active contour is refined by Eq. (19) until the posteriori probability less than a threshold,


                              
                                 
                                    (19)
                                    
                                       E
                                       (
                                       
                                          
                                             Q
                                          
                                       
                                       )
                                       ∝
                                       
                                          E
                                          
                                             SF
                                             -
                                             SSM
                                          
                                       
                                       ×
                                       
                                          E
                                          RPFM
                                       
                                       .
                                    
                                 
                              
                           


                     
                        Algorithm 2
                        SF-SSM based segmentation method


                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             Input:
                                          
                                       
                                       
                                          
                                          A uterine fibroids HIFU US image and set a maximum iteration threshold 
                                                T
                                             .
                                       
                                       
                                          
                                             Output:
                                          
                                       
                                       
                                          
                                          Uterine fibroids segment.
                                       
                                       
                                          1:
                                          Define the central point x
                                             
                                                c
                                              in the lesion area and eliminate the errors of the x
                                             
                                                c
                                              by Eq. (17);
                                       
                                       
                                          2:
                                          Initialize the prior shape Q
                                             
                                                SF-SSM
                                              and prior probability E
                                             
                                                SF-SSM
                                              of the ROI by SF-SSM;
                                       
                                       
                                          
                                             Optimization:
                                          
                                       
                                       
                                          3:
                                          
                                             while
                                             
                                             
                                                E
                                                (
                                                
                                                   
                                                      Q
                                                   
                                                
                                                )
                                                ≤
                                                T
                                             
                                             
                                             do
                                          
                                       
                                       
                                          4:
                                          
                                             
                                             for
                                             
                                             t
                                             =0:2π
                                             
                                             do
                                          
                                       
                                       
                                          5:
                                          
                                               
                                             for
                                             
                                             k
                                             =1:2η
                                             +1
                                             do
                                          
                                       
                                       
                                          6:
                                          
                                                 Computer 
                                                E
                                                (
                                                
                                                   r
                                                   t
                                                   k
                                                
                                                )
                                                =
                                                Pr
                                                (
                                                
                                                   r
                                                   t
                                                   k
                                                
                                                )
                                                ×
                                                Pr
                                                (
                                                
                                                   
                                                      
                                                         g
                                                      
                                                   
                                                   t
                                                   k
                                                
                                                |
                                                
                                                   r
                                                   t
                                                   k
                                                
                                                )
                                              by Eq. (18);
                                       
                                       
                                          7:
                                          
                                               
                                             end for
                                          
                                       
                                       
                                          8:
                                          
                                               Find 
                                                k
                                                =
                                                
                                                   argmax
                                                   k
                                                
                                                
                                                   E
                                                   (
                                                   
                                                      r
                                                      t
                                                      k
                                                   
                                                   )
                                                
                                             ;
                                       
                                       
                                          9:
                                          
                                               
                                             r
                                             
                                                t
                                             
                                             ←
                                             r
                                             
                                                t
                                             
                                             +
                                             k
                                             ·
                                             δ;
                                       
                                       
                                          10:
                                          
                                               
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                   
                                                   t
                                                
                                                ←
                                                
                                                   
                                                      
                                                         m
                                                      
                                                   
                                                   t
                                                   k
                                                
                                             ;
                                       
                                       
                                          11:
                                          
                                             
                                             end for
                                          
                                       
                                       
                                          12:
                                          
                                             Computer E(Q) by Eq. (19);
                                       
                                       
                                          13:
                                          
                                             end while
                                          
                                       
                                       
                                          14:
                                          Interpolate {m
                                             
                                                t
                                             |0≤
                                             t
                                             ≤2π} and generate a closed segmentation region.
                                       
                                    
                                 
                              
                           
                        

@&#RESULTS AND DISCUSSION@&#

In this section, all experiments were implemented using the Matlab 2013a on an Intel Dual-Core 2.7GHz with 8GB of RAM. The 150 clinical uterine fibroids US images were obtained from the HIFU Center of The Second Affiliated Hospital of Chongqing Medical University to validate the performance of the proposed method. One hundred of the uterine fibroids US images were used as a training set and the remaining US images were used as a test set. For ease of statistical analysis, each US image was adjusted to 524×413 with a resolution of 0.15mm×0.15mm. The manual segmentation results obtained by the experienced radiologists were considered as the ground truth for the validation.

The segmentation accuracy of our method was evaluated by the region-based error measures. Two overlapping area error metrics [48]: the true position (TP), the false position (FP) were adopted and they are defined as


                        
                           
                              (20)
                              
                                 TP
                                 =
                                 
                                    
                                       |
                                       
                                          Ω
                                          m
                                       
                                       ∩
                                       
                                          Ω
                                          a
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          Ω
                                          m
                                       
                                       |
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (21)
                              
                                 FP
                                 =
                                 
                                    
                                       |
                                       
                                          Ω
                                          m
                                       
                                       ∪
                                       
                                          Ω
                                          a
                                       
                                       −
                                       
                                          Ω
                                          m
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          Ω
                                          m
                                       
                                       |
                                    
                                 
                                 .
                              
                           
                        Here Ω
                           m
                         and Ω
                           a
                         represent the pixel sets inside the manual and computerized segmentation respectively. Higher TP values indicate that more target regions are covered and lower FP values mean that the computerized segmentation better fits to the manual segmentation. We further employed boundary-based error measures to compare the difference between manual and computerized segmentation. Denoting two contours as sets of ordered points, A
                        ={a
                        1, …, a
                        
                           m
                        } and B
                        ={b
                        1, …, b
                        
                           n
                        }, the minimum Euclidean distance (MED) from a point a
                        
                           i
                         in A to B is computed as


                        
                           
                              (22)
                              
                                 MED
                                 (
                                 
                                    a
                                    i
                                 
                                 ,
                                 B
                                 )
                                 =
                                 
                                    min
                                    
                                       j
                                       ∈
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       }
                                    
                                 
                                 dis
                                 (
                                 
                                    a
                                    i
                                 
                                 ,
                                 
                                    b
                                    j
                                 
                                 )
                                 .
                              
                           
                        Then the average minimum Euclidean distance (AMED) [49] and the Hausdorff distance (HD) [50] are defined as


                        
                           
                              (23)
                              
                                 AMED
                                 (
                                 A
                                 ,
                                 B
                                 )
                                 =
                                 
                                    1
                                    
                                       2
                                       m
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 MED
                                 (
                                 
                                    a
                                    i
                                 
                                 ,
                                 B
                                 )
                                 +
                                 
                                    1
                                    
                                       2
                                       n
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    n
                                 
                                 MED
                                 (
                                 
                                    b
                                    j
                                 
                                 ,
                                 A
                                 )
                              
                           
                        and
                           
                              (24)
                              
                                 HD
                                 (
                                 A
                                 ,
                                 B
                                 )
                                 =
                                 max
                                 
                                    
                                       
                                          
                                             max
                                             
                                                i
                                                ∈
                                                {
                                                1
                                                ,
                                                …
                                                ,
                                                m
                                                }
                                             
                                          
                                          MED
                                          (
                                          
                                             a
                                             i
                                          
                                          ,
                                          B
                                          )
                                          ,
                                          
                                             max
                                             
                                                j
                                                ∈
                                                {
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                }
                                             
                                          
                                          MED
                                          (
                                          
                                             b
                                             j
                                          
                                          ,
                                          A
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        Accordingly, AMED measures the average distance while HD measures the maximum distance between the two contours.

In Algorithm 1, the t and Δr are two important parameters. The parameter t (in Eq. (2)) determines the smoothness of the contour. The important information of shapes may be lost if t is large, but if t is overly small, the redundant information would be recorded, which affects the efficiency of Algorithm 1. The parameter Δr determines the deformable range of the radius transition. The more deformable information of shapes can be reflected in the prior shapes when proper Δr is used. Use of smaller Δr causes extreme observed data in the state space and over-fitting of the candidate functions A(r(t), a) and B(r(t), b). With the clinical specialists’ experience in the HIFU therapy, we chose t
                        =
                        π/9 and Δr
                        =10mm in our experiments. In Algorithm 2, the parameters η and δ determine the numbers of iterations and the search scope of the prior shapes respectively. The two parameters affect the accuracy and the number of iterations, we chose TP and AMED to analyze the parameters setting. Through experimental analyzing and balancing the influence of η and δ on the efficiency and accuracy of the segmentation results, the η and δ were set to 40 and 0.4mm respectively in our experiments (see Fig. 7
                        ).

From the sets x
                        
                           i
                         in Algorithm 1, the values of {μ
                        
                           i
                        
                        −
                        r
                        
                           i
                        } and {σ
                        
                           i
                        } in Eq. (10) are computed, and then the forms of A(r(t), a) and B(r(t), b) can be estimated (see Eq. (25)). Fig. 8
                         presents the fitting results of {μ
                        
                           i
                        
                        −
                        σ
                        
                           i
                        } and {σ
                        
                           i
                        } by using the Levenberg Marquardt routine with the lowest χ
                        2. In order to avoid over-fitting to the drift and diffusion functions, we omit the observations at the extremes of the state space, as these data are under-represented in the training data.


                        
                           
                              (25)
                              
                                 
                                    
                                       
                                          
                                             
                                                A
                                                (
                                                r
                                                (
                                                t
                                                )
                                                ,
                                                
                                                   
                                                      a
                                                   
                                                
                                                )
                                                =
                                                
                                                   a
                                                   0
                                                
                                                r
                                                exp
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     (
                                                                     r
                                                                     −
                                                                     
                                                                        a
                                                                        1
                                                                     
                                                                     )
                                                                  
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  a
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                −
                                                
                                                   a
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                B
                                                (
                                                r
                                                (
                                                t
                                                )
                                                ,
                                                
                                                   
                                                      b
                                                   
                                                
                                                )
                                                =
                                                
                                                   b
                                                   0
                                                
                                                
                                                   
                                                      (
                                                      r
                                                      −
                                                      
                                                         b
                                                         1
                                                      
                                                      )
                                                   
                                                   3
                                                
                                                +
                                                
                                                   b
                                                   2
                                                
                                                .
                                             
                                          
                                          
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

To demonstrate the advantage of SF-SSM, we compared the prior shapes given by SF-SSM to the shapes estimated by the classical PDM using the above measure metrics respectively. In our experiments, the test images were classified into three categories (high, medium and low quality) by the experts according to the SNR, shape deformations, boundary blur and inhomogeneous areas. The number of test images in each group is shown in Table 1
                        . The high quality images exhibit sharp edges in the entire contour and regular contours, whereas the medium quality images display blurred boundaries and low SNR in the images. In the low quality group, the intensity distribution of lesion areas is extremely inhomogeneous and the shapes were highly deformable. The number of marked points in PDM was set as same as that in the radius time series. Quantitative evaluation of the performance between SF-SSM and PDM is displayed in Table 2
                        . Fig. 9
                         shows the bar plots of the four measured values in the three groups respectively. It shows that the TP values of SF-SSM are slightly higher than that of PDM in the high quality images, but SF-SSM performs better than PDM in the other measurements, which demonstrates that the prior shapes given by SF-SSM were closer to the ROI than the PDM's prior shapes. Fig. 10
                         illustrates that the prior shapes given by SF-SSM are able to adapt to the deformation of the ROI, whereas the prior shapes of PDM cannot.

In order to further validate the proposed method, we compared our method with four typical segmentation methods which are GVF [7], DRLSE [51], ASM
                        
                           NVFP
                         
                        [52] and MultiScale GAC [33]. Without other specifically stating, the values of parameters in Section 5.1 were used in our experiments. The number of marked points and iteration in ASM
                        
                           NVFP
                         was chose as same as our method. In the other methods, we used the parameters that produce the best results. Box plots of the four error measurements in all test HIFU US images are presented in Fig. 11
                        . Quantitative analysis of the segmentation accuracy of these methods in the high, medium, low groups is listed in Table 3
                        . Compared with the average and middle values of each measurement in Fig. 11, GVF gives the worse results than the other methods. As can be seen in Fig. 12
                        a, GVF roughly detects the object contour, however, the contours detected by GVF becomes quite irregular especially in the medium and low groups. Our method captures the object boundaries despite the low SNR and inhomogeneous exist in the different quality images (see Fig. 12e). The main reason is that the low SNR and serious inhomogeneous intensity distribution in HIFU US images can provide the false boundaries information of the ROI, which affect the main orientations of GVF, which easily drive the active contour toward the false areas of the ROI. The active contour is constrained by the prior shape in the process of segmentation so that our results are hardly disturbed by the false boundaries information of the ROI. We find that DRLSE provides the best results in the high quality group (see the values of TP, FP, AMED and HD in Table 3). However, its performance degrades in the medium and low groups. It is shown in Fig. 12b that the method becomes unstable and the contour leaks out weak boundaries in the medium and low groups. Table 3 validates that the measuring values of DRLSE are lower than ours in the medium and low groups. With the help of the prior shape given by the conventional PDM and use of the modified SIFT feature to describe the local intensity information of ROI. ASM
                        
                           NVPF
                         performs better than GVF and DRLSE in the medium and low quality groups, nevertheless, compared with SF-SSM, the limitation of PDM prevented the performance of ASM
                        
                           NVPF
                         from segmenting the part deformable areas in the low quality group (see Fig. 12c). By adopting the similarity of shape of ROI in a multi-scale space as the prior knowledge to aid deformable contour, MultiScale GAC also produce satisfactory results (see Fig. 11d). However, it is interesting to find in Table 3 that the TP values of MultiScale GAC are higher than our method's, but the FP and HD values are higher than ours, which indicates that the parts of the target regions are wrongly covered by MultiScale GAC. The reasons are that: (1) the assumption that the gray distribution of ROI is homogeneous is not met in HIFU US images; (2) the boundaries of the ROI are blurred in the procedure of constructing multi-scale space of the image, so that the similarity of shape includes the information of false boundaries. In contrast, as shown in Table 3, our method precisely captures the lesion contour despite the quality of images worsen and the segmentation results are almost identical to the manual segmentation (see Fig. 12e).

Besides that, initializing the prior shape in our method only requires manually defining a central point inside the target region. The other methods all need manually put the initial contour nearby the target areas of the image as far as possible, which effect the instability of the segmentation results. Thus, the segmenting results of our method are more stable than the compared methods, which can be demonstrated in Table 3 that the SD values of our method are lower than the other methods in each measurement. Table 4
                         shows the average running time of our method is higher than GVF's, but lower than the other methods.

In this paper, a novel dynamic-based SSM, called SF-SSM, has been proposed to perform the semi-automatic segmentation of uterine fibroids in US images for HIFU therapy. Based on the previous experiments and discussion, our conclusions are as the follows:
                        
                           •
                           For the problems of the low SNR, weak boundaries and intensity inhomogeneity in the HIFU ultrasound images, the prior knowledge-based segmentation methods achieve better segmentation results than the image information only based on segmentation methods.

Compared with the conventional linear-based SSM, the dynamics properties of the SF-SSM ensure that the generative prior shape can describe the more detailed shape information of ROI in the training set, which is helpful to improve the segmentation accuracy in the case of the complex variable shape of ROI in the images.

The simple and friendly initialization of prior shape can improve the efficiency and stability of segmentation, which is significantly useful to HIFU therapy.

In future work, we will further improve the efficiency of our method by GPU acceleration and extend SF-SSM to the segmentation of 3-D US images to improve the efficiency and effect of HIFU therapy. We also try to extend the proposed idea to other related areas, such as computer-aided design, computer graphics and natural image manipulation [53–60].

@&#ACKNOWLEDGMENTS@&#

We would like to thank Professor Yuanyi Zheng of The Second Affiliated Hospital of Chongqing Medical University for kindly providing us with the HIFU ultrasound images of uterine fibroids as well as manually segmenting the target regions of HIFU ultrasound images of uterine fibroids.

This presented research work is supported by the National Basic Research Program of China (973 Program) (Grant No. 2011CB707904) and the National Natural Science Foundation of China (Grant No. 61472289).

@&#REFERENCES@&#

