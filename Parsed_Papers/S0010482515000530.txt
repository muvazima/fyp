@&#MAIN-TITLE@&#Software for analysing multifocal visual evoked potential signal latency progression

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           New software application with which to process mfVEP signal latency.


                        
                        
                           
                           Several important parameters can be configured before starting analysis.


                        
                        
                           
                           Signal display comparing different tests.


                        
                        
                           
                           Detects which zone of the eye is most affected.


                        
                        
                           
                           Achieves high latency measurement accuracy.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

mfVEP

Latency analysis

Cross-correlation

Progression studies

Quadrants

Rings

Hemispheres

@&#ABSTRACT@&#


               
               
                  Background
                  This paper describes a new non-commercial software application (mfVEP2) developed to process multifocal visual-evoked-potential (mfVEP) signals in latency (monocular and interocular) progression studies.
               
               
                  Method
                  The software performs analysis by cross-correlating signals from the same patients. The criteria applied by the software include best channels, signal window, cross-correlation limits and signal-to-noise ratio (SNR). Software features include signal display comparing different tests and groups of sectors (quadrants, rings and hemispheres).
               
               
                  Results
                  The software׳s performance and capabilities are demonstrated on the results obtained from a patient with acute optic neuritis who underwent 9 follow-up mfVEP tests. Numerical values and graphics are presented and discussed for this case.
               
               
                  Conclusions
                  The authors present a software application used to study progression in mfVEP signals. It is also useful in research projects designed to improve mfVEP techniques. This software makes it easier for users to manage the signals and allows them to choose various ways of selecting signals and representing results.
               
            

@&#INTRODUCTION@&#

Objective assessment of the visual pathway is usually carried out by recording and analysing neurophysiological signals. The most common technique is to perform the visual-evoked-potential (VEP) test, which measures the potentials obtained by stimulating the complete visual field using the flash or checkerboard visual stimuli. This technique produces an overall response, but it does not provide specific topographical information about the retina and visual cortex.

The advantage of the mfVEP test is that it allows practitioners to analyse the topographical features of different sectors of the visual field represented in the primary visual cortex [1].

Improvements to various aspects related to the mfVEP technique, such as multi-focal stimulation [1], electrode number and position [2,3], filter and processing method [4], signal analysis and classification [5], etc., have enhanced its clinical utility in the diagnosis of diseases such as glaucoma, optic neuritis, multiple sclerosis and other pathologies that affect the visual pathway.

The number of sectors into which the visual field is divided depends on the instrument used to record the mfVEPs. Possible values include 56 [6], 58 [7], 60 [8] and 120 [9]. The number of signals obtained in each sector depends on the number of electrodes (physical channels) and on the number of derived channels computed as the combination of the direct channels. Derived channels help to improve signal quality. For example, in [10] three channels are recorded and three derived channels are computed, thereby obtaining 6 channels for each sector.

The mfVEP technique requires processing of a huge quantity of information. For example, 
                     Fig. 1 shows a representation of the visual field divided into 56 sectors. Two channels (vertical and horizontal) are recorded in each sector. Consequently, the number of signals per patient is 2⁎56⁎2=224.

The parameters most widely used to characterise mfVEP signals are amplitude and latency. In patients with optic neuritis, increased signal-propagation time (latency) is thought to reflect demyelination of the optic nerve fibres, with the subsequent shortening of latency thought to represent the process of remyelination of the optic nerve [11].

Multifocal VEP signal latency can be measured manually [12] [13]. Under this approach, the signals from the mfVEP map sector are grouped and latency is measured independently by three different observers within an 80–135ms window. The median of the three measurements is then selected. This method requires several specialists and the task takes a significant amount of time. It is a subjective decision and, as the sectors are grouped, spatial resolution is lost in mfVEP analysis.

In monocular (single eye) analysis, two different automated techniques are used to compute absolute latency from an mfVEP signal. The first technique compares the signal with a reference template by performing cross-correlation. Hood et al. [14] perform cross-correlation with a template created for each location, eye and channel obtained from a normative group of 100 individuals — the Portland database [8]. In [15], the authors define an artificial template using wavelet kernels that model the mfVEP trace profile.

The second technique uses a set of algorithms to identify the waveform-defined characteristics and measure the moment of time in which these are presented. These characteristics may be the start of response [16] or maximum and minimum values in a period of time [12]. In [17], latency is quantified by first selecting the mfVEP trace with the largest peak-to-peak amplitude, then using the timing of the second peak (minimum or maximum) as the trace latency.

Two different techniques may be used to analyse latency progression. The first option is to subtract the absolute latencies obtained by the monocular method in baseline and follow-up tests [18,19]. The second option is to compare (correlate) signals between baseline and follow-up tests without using an external template.

The authors have developed a new non-commercial software package named mfVEP2 (means Multifocal VEP applied to Progression) that adopts the latter option. It is an analysis tool with potential application in both clinical practice and research.

The capabilities of mfVEP2 are as follows:
                        
                           •
                           It facilitates study of latency progression and analyses data from different tests. This is very useful in routine clinical practice and clinical trials. It is designed to analyse latency progression in a subject by comparing recordings from different sessions (dates) and allows users to identify variations in latencies in monocular and interocular data.

It permits selection of analysis parameters, such as the cross-correlation window, the SNR threshold, channel selection, etc. This option may be useful in research to study the effect of analysis parameters when computing latency.

It displays the values and processed data to facilitate their study.

It permits selection of visual field by area/quadrant/ring to allow study of specific regions of the eye.

@&#METHOD@&#

The application was developed in MATLAB® (R2012, The MathWorks Inc., Natick, MA, 2000). The first step is to select the channels to be used and discard all channels with an SNR below the threshold. The next step is to define the cross-correlation window and compute cross-correlation using the standard Xcorr function of Matlab. This function returns the instant of maximum correlation between the two inputs. The maximum is considered to represent the shift between input signals. The final step is to check the polarity of the signals and discard all sectors with opposite polarity.

The current version of mfVEP2 accepts signals obtained using the equipment and method described in the next paragraph. Nonetheless, it can be easily adapted to process signals recorded by systems using other parameters (number of sectors in the visual fields, number of channels per sector, length of recording, etc.).

In this study, the mfVEP test was performed using Vision Search1 perimetry (VisionSearch, Sydney, Australia) controlled by TerraTM software (VisionSearch, Sydney, Australia), as previously described in detail [2]. Briefly, the visual stimulus (generated on a 19″ high-resolution LCD display) consisted of a cortically scaled dartboard pattern of 56 sectors, each containing a 4×4 grid of black and white checks that opposite patterns according to a pseudorandom sequence. Four gold cup electrodes (Grass Technologies, West Warwick, RI, USA) were used to take bipolar recordings (2 electrodes placed 4cm either side of the inion; and 1 electrode placed 2.5cm above and 1 electrode placed 4.5cm below the inion in the midline). Electrical signals were recorded along 2 channels as the difference between the superior and inferior (vertical channel) and left and right electrodes (horizontal channel). Visual evoked responses were amplified 1×105 times and band-pass filtered at 1–20Hz. The sample rate was 600Hz and the length of each recording was 1000ms. To obtain responses for each sector, correlations between pattern reversal sequences and recorded electrical signals were automatically performed using TerraTM software.

Due to the presence of electrical noise from the environment, muscle activity and spontaneous brain activity (such as alpha waves and other contributions unrelated to visual processing), the SNR parameter is used to assess signal quality. The SNR of each trace is calculated as the ratio between the Root Mean Squared (RMS) value of the signal window (45–150ms) and the RMS value of the averaged noise window (325–450ms) [10].

In the mfVEP2 programme, users can adjust the SNR threshold. All traces with SNR values below the threshold are marked and are not analysed. A trade-off between false-positive-rate values (2%) and a high percentage of values above this criterion (87%) in control patients was obtained when the SNR threshold was set at 1.7 [20].

The programme allows users to analyse latency progression in monocular and interocular measurements. In monocular latency analysis, one of the tests is used as the reference for the others. In interocular analysis, the time difference between the recordings from the right eye (OD: Oculum Dexter) and left eye (OS: Oculum Sinister) is obtained for the same session.

In both cases, latency measurements are always taken between signals from the same sector of the visual field. As two different channels (horizontal and vertical) are available in each sector, it is possible to compute latency in the following cases:
                              
                                 •
                                 
                                    Select vertical channel or horizontal channel for all cases: This option is available for both monocular and interocular measurements.


                                    Best Channel Method: For each sector, the channel with the highest mean SNR for all sessions is selected to compute the latency. If N is the number of tests or sessions from a subject, then:
                                       
                                          ○
                                          
                                             In monocular measurements: First, channel quality for all sessions is computed for a particular sector: 
                                                S
                                                N
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      H
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                S
                                                N
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      N
                                                   
                                                   
                                                      H
                                                   
                                                
                                                ,
                                                
                                                
                                                S
                                                N
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      V
                                                   
                                                
                                                ,
                                                S
                                                N
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      N
                                                   
                                                   
                                                      V
                                                   
                                                
                                             . The next step is to calculate the mean value for the horizontal and vertical channels (Eqs. (1) and (2)). The channel with the highest mean SNR is selected to compute the latency.
                                                
                                                   (1)
                                                   
                                                      
                                                         
                                                            S
                                                            N
                                                            
                                                               
                                                                  R
                                                               
                                                               H
                                                            
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      =
                                                      
                                                         1
                                                         N
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         N
                                                      
                                                      S
                                                      N
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            H
                                                         
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   (2)
                                                   
                                                      
                                                         
                                                            S
                                                            N
                                                            
                                                               
                                                                  R
                                                               
                                                               V
                                                            
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      =
                                                      
                                                         1
                                                         N
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         N
                                                      
                                                      S
                                                      N
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            V
                                                         
                                                      
                                                      .
                                                   
                                                
                                             
                                          


                                             In interocular measurements: The first step for a particular sector is to calculate the SNR for each eye, channel and session. The second step is to compute the mean SNR for each channel (Eqs. (3) and (4)). The channel with the highest mean SNR is selected to compute the latency.
                                                
                                                   (3)
                                                   
                                                      
                                                         
                                                            S
                                                            N
                                                            
                                                               
                                                                  R
                                                               
                                                               H
                                                            
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      =
                                                      
                                                         1
                                                         N
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         N
                                                      
                                                      S
                                                      N
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            H
                                                         
                                                      
                                                      _
                                                      O
                                                      D
                                                      +
                                                      
                                                         1
                                                         N
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         N
                                                      
                                                      S
                                                      N
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            H
                                                         
                                                      
                                                      _
                                                      O
                                                      S
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   (4)
                                                   
                                                      
                                                         
                                                            S
                                                            N
                                                            
                                                               
                                                                  R
                                                               
                                                               V
                                                            
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      =
                                                      
                                                         1
                                                         N
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         N
                                                      
                                                      S
                                                      N
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            V
                                                         
                                                      
                                                      _
                                                      O
                                                      D
                                                      +
                                                      
                                                         1
                                                         N
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         N
                                                      
                                                      S
                                                      N
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            V
                                                         
                                                      
                                                      _
                                                      O
                                                      S
                                                      .
                                                   
                                                
                                             
                                          

Best Channel Mix Method.
                                       
                                          ○
                                          In monocular measurements, the latency is always computed between recordings from two sessions (one of which is the reference session). For example, recordings from three sessions — T1, T2 and T3 — are analysed (T3 being the reference session). The relative latencies are computed between (T1, T3) and (T2, T3) in two different steps. In each step, the best channel is selected according to Eqs. (1) and (2). This option is named the Mix Method because it is possible to select one channel for the first step (T1, T3) and another channel for the second step (T2, T3). For example, it is possible to select the vertical channel for one and the horizontal channel for the other.

In interocular measurements, to compute the relative latency between one eye and the other in a sector, the channel with the highest SNR is selected according to Eqs. (3) and (4) (N=1).

The latency between the two signals (S
                           1 and S
                           2) is obtained by applying cross-correlation and selecting the highest value according to the following equations:
                              
                                 (5)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                   c
                                                   o
                                                   r
                                                   r
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         j
                                                         =
                                                         B
                                                         E
                                                         G
                                                         I
                                                         
                                                            N
                                                            
                                                               W
                                                               I
                                                               N
                                                               D
                                                               O
                                                               W
                                                            
                                                         
                                                      
                                                      
                                                         j
                                                         =
                                                         E
                                                         N
                                                         
                                                            D
                                                            
                                                               W
                                                               I
                                                               N
                                                               D
                                                               O
                                                               W
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         S
                                                         1
                                                      
                                                      
                                                         (
                                                         
                                                            k
                                                            +
                                                            j
                                                         
                                                         )
                                                      
                                                      
                                                         S
                                                         2
                                                      
                                                      
                                                         (
                                                         j
                                                         )
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   k
                                                   =
                                                   -
                                                   M
                                                   a
                                                   
                                                      x
                                                      
                                                         S
                                                         H
                                                         I
                                                         F
                                                         T
                                                      
                                                   
                                                   ,
                                                   …
                                                   +
                                                   M
                                                   a
                                                   
                                                      x
                                                      
                                                         S
                                                         H
                                                         I
                                                         F
                                                         T
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           The latency value for signals S
                           1 and S
                           2 is defined as the shift (k) that produces the highest Xcorr value:
                              
                                 (6)
                                 
                                    
                                       
                                          
                                             
                                                L
                                                a
                                                t
                                                e
                                                n
                                                c
                                                y
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   )
                                                
                                                =
                                                k
                                                ,
                                             
                                          
                                          
                                             
                                                k
                                                |
                                                
                                                m
                                                a
                                                x
                                                
                                                   (
                                                   
                                                      X
                                                      c
                                                      o
                                                      r
                                                      r
                                                      
                                                         (
                                                         k
                                                         )
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                 
                              
                           In Eq. (5), users define the minimum (BEGIN
                           
                              WINDOW
                           ) and maximum (END
                           
                              WINDOW
                           ) temporal values of the cross-correlation window and the interval of values of k (Max
                           
                              SHIFT
                           ).

The length of the mfVEP recordings is 1000ms, but the correlation is only computed in the period defined by the parameters (BEGIN
                           
                              WINDOW
                           , END
                           
                              WINDOW
                           ). For example, in [20], the best cross-correlation was obtained by shifting the response in the window from 5 to 215ms against the other eye׳s response from the same window. In [15], cross-correlation between the signal and the template is performed between 0 and 284ms.

The k value is the shift between the two signals. The maximum value of shift (Max
                           
                              SHIFT
                            parameter) fixes the maximum latency value that the cross-correlation method obtains. In [14] the authors explain that the Xcorr function was limited to a maximum shift of 40ms, the upper limit of changes seen with diseases such as optic neuritis/multiple sclerosis.

The final step is to check that the waveforms involved in the cross-correlation do not present opposite polarity. To determine this, the correlation coefficient between the two correlation windows is calculated. If this value is negative, the two signals are considered to present opposite polarity. The signals are then discarded and the sector is marked as non-analysable [20].

A sector is considered non-analysable if the SNR value of at least one of the selected signals is below the SNR threshold (thres), or if the selected signals present opposite polarity (OPPOSITE_POL). The number of analysable sectors is calculated for each session and each eye (monocular; Eq. (7)) or OD–OS pair (interocular; Eq. (8)) according to the number of sectors with an SNR above the threshold and without opposite polarity.
                              
                                 (7)
                                 
                                    
                                       
                                          N
                                       
                                       
                                          M
                                          O
                                          N
                                          O
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          S
                                          N
                                          
                                             
                                                R
                                             
                                             
                                                S
                                                1
                                             
                                          
                                          >
                                          t
                                          h
                                          r
                                          e
                                          s
                                       
                                       )
                                    
                                    ∧
                                    
                                       (
                                       
                                          S
                                          N
                                          
                                             
                                                R
                                             
                                             
                                                S
                                                R
                                                E
                                                F
                                             
                                          
                                          >
                                          t
                                          h
                                          r
                                          e
                                          s
                                       
                                       )
                                    
                                    ∧
                                    N
                                    O
                                    _
                                    O
                                    P
                                    P
                                    O
                                    S
                                    I
                                    T
                                    E
                                    _
                                    P
                                    O
                                    L
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          S
                                       
                                       
                                          R
                                          E
                                          F
                                       
                                    
                                    )
                                 
                              
                           
                           
                              
                                 (8)
                                 
                                    
                                       
                                          N
                                       
                                       
                                          I
                                          N
                                          T
                                          E
                                          R
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          S
                                          N
                                          
                                             
                                                R
                                             
                                             
                                                O
                                                D
                                             
                                          
                                          >
                                          t
                                          h
                                          r
                                          e
                                          s
                                       
                                       )
                                    
                                    ∧
                                    
                                       (
                                       
                                          S
                                          N
                                          
                                             
                                                R
                                             
                                             
                                                O
                                                S
                                             
                                          
                                          >
                                          t
                                          h
                                          r
                                          e
                                          s
                                       
                                       )
                                    
                                    ∧
                                    N
                                    O
                                    _
                                    O
                                    P
                                    P
                                    O
                                    S
                                    I
                                    T
                                    E
                                    _
                                    P
                                    O
                                    L
                                    (
                                    O
                                    D
                                    ,
                                    O
                                    S
                                    )
                                 
                              
                           
                        

To run this application it is only needed to download freely and install the Matlab Compiler Runtime (MCR) from Matlab web [21].

The recordings were exported by TERRA™ software to a.csv file. All data generated by various channels in the same test must be saved in the same folder.

This application comprises a series of analysis and plotting report generation modules, all of which are accessible from the main screen (
                        Fig. 2). The main options are as follows: Select Patient & View, Select Analysis Parameters, Launch Analysis, Graphical Representation and Numerical Results.
                     

The “Select Data Folder Patient” button opens a menu allowing users to select the patient and sessions to be analysed. A minimum of two sessions must be selected for each patient in a monocular test.

This section allows users to configure the latency analysis parameters. The first item (Cross Correlation Analysis Params) contains the following parameters: SNR threshold of each signal, length of cross-correlation window and maximum latency variability (maximum shift).

The next item is Reference progression. The example in 
                           Table 1 explains this capability. Data from four different sessions (S1, S2, S3 and S4) have been recorded from a patient. If the “Last Test” option is selected, three latency values are obtained using S4 as the reference for S1, S2 and S3. If the “Test(n)−Test(n+1)” option is selected, three latency values are obtained, but the reference for each session is the consecutive test. As interocular latencies are absolutes in progression studies, this parameter does not affect interocular latency computation.

The last item, Type of Analysis, selects the processed channels, as explained above.

Once the analysis parameters have been selected, users launch analysis by clicking on either the Monocular or Interocular button.

The mfVEP2 programme offers a wide range of signal display options and numerical results.
                              
                                 •
                                 
                                    One sector waveform MONOCULAR/INTEROCULAR: The waveforms used to compute the latency for a selected sector and between two different tests are plotted. This provides detailed information about computation, showing the latency value, number of samples corresponding to the latency value, and the correlation coefficient value.


                                    Latency plots: All latency plot options can be selected independently or concurrently. Once selected, the graphs are plotted when Plot MONO or Plot INTER is clicked. In both cases, the following graphs can be produced:
                                       
                                          •
                                          
                                             Latency plots. Progression plots: In this case, latency progression over time is displayed. Analysis can be performed on the full eye, on four quadrants (
                                             Fig. 3a), on concentric rings (Fig. 3b) or on two concentric rings (Fig. 3c).


                                             Latency plots. All sectors plots: This option displays the values and waveforms used to compute the latency between two specific sessions. If the Sectors Waveforms box is checked, all the waveforms from the two sessions selected to compute the latency are plotted by their position in the visual field for each sector and eye. If a sector is non-analysable, no trace is plotted. If the user checks the Sectors Values box, the programme displays the numerical variation in latency between two different tests (
                                             Fig. 7) by position in the visual field for each sector and eye. If a sector is non-analysable, the value shown is NaN. The mean value and standard deviation for the entire eye are shown above each graphical item.

Once analysis has been performed, the final data calculated by the programme are displayed in a table (see 
                           Fig. 4). The Mon OD and Mon OS columns show the monocular latency variation between the test and the reference test for the right and left eyes. The N OD and N OS columns show the number of analysable sectors for each calculation. The Inter column shows the interocular value for each test, and the N Inter column shows the number of analysable sectors.

The last option allows users to save the numerical values displayed in the NUMERICAL RESULTS table in comma-separated-value (⁎.csv) files, one for the monocular values (Export Mono) and another for the interocular values (Export Inter).

@&#RESULTS@&#

To demonstrate performance of the programme and its capabilities, this section describes results obtained from a patient with acute optic neuritis who underwent 9 follow-up mfVEP tests (1 month apart).

Application of the first option, One sector waveform MONOCULAR, is shown in 
                     Fig. 5 for sector 12 of the right eye. The latency measured is 1.667ms, which is equivalent to 1 sample. The correlation coefficient between the two signals is 0.7948 (no opposite polarity).

The Progression Plots-Full Eye option shows the latency progression for the OD and OS. For this patient (
                     Fig. 6), latency in the OS is very stable over the time interval (always close to 0ms). However, the OD recovers 7ms between the first and fourth sessions. The variation is close to 0ms in the last three sessions. The values shown in Fig. 6 are the same as the monocular values shown in Fig. 4. In addition, if a detailed study of the eye is needed, mfVEP2 allows users to display the progression latency by various sector groups (rings, quadrants, 2 rings; see Fig. 3) in the same way as in Fig. 6.


                     Fig. 6 is a typical progression plot [19]. The worst latencies values (bigger) are produced when the patient is in a neuritis optic inflammation process. Along the time, the optic neuritis disappears and the eyes recover the small latencies values.

If users select the All Sector Plots option, a figure is displayed for each eye and session (see Fig. 7). In this example, 9 sessions×2 eyes=18 figures. The left-hand graph shows the numerical latency values by position. The right-hand graph shows the waveform by position. The average latency variation value and the standard deviation are shown above each graph (mean value of 1.0163ms and SD value of 6ms).

@&#DISCUSSION@&#

A new programme designed to analyse mfVEP in latency progression studies has been presented. The programme is based on cross-correlation function and allows practitioners and researchers to analyse huge quantity of data registered in mfVEP test. Therefore it may be useful in clinical practice and also in research projects. The software has been developed in MATLAB® programming language and is compatible with multiple operating systems. Only MATLAB Compiler Runtime (MCR) needs to be installed in the system. The software can import and analyse data obtained from various mfVEP recording systems and commercial packages.

Although various software packages can be used to analyse mfVEP data, e.g. [Veris, EDI, San Mateo, CA], [Accumap, ObjectiVision Pty Ltd, Sydney, Australia], and [VisionSearch], there is no widely accepted methodology for computing latency in mfVEP signals. Furthermore, progression analysis is not currently implemented in these commercial programs.

mfVEP2 provides four different methods for selecting the channels to be used. This allows users to assess which channel is most suitable in analysing latency delays in mfVEP signals in research applications.

In the case of interocular analysis, other methods of channel selection have been used in previous papers. The differences between methods are explained with an example (
                     Table 2). In [20], at each location for each subject the response with the highest parameter (SNR or PoE) was selected from the 12 responses (2 eyes×6 channels; in this example, OD, CH3, SNR=2.2). The corresponding response from the other eye from that same channel completed the pair of responses at that location (in this case, OS, CH3, SNR=1.6, non-analysable). The problem with this method is that the response from the other eye could be of very low quality.

The method implemented in mfVEP2 selects the pair of channels in which both responses are above the SNR threshold and in which the sum of the SNR (OD+OS) is highest (in this case, SNR_CH4_OD=2, SNR_CH4_OS=2). This choice is optimal because it ensures that the quality of both channels is high enough to permit analysis.

In the case of a monocular channel, in our previous paper [22] the channels selected for analysis were the pair which, between two tests, presented the highest SNR and lowest latency variability. As this paper now makes several tests available, the strategy for selecting channels has been improved and extended. 
                     Table 3 shows the median±SD number of analysable sectors obtained for monocular and interocular analysis, according to the channel selection method used, for 13 patients.

The BestCH MIX obtains the highest number of analysable sectors. The advantage of the BestCH method is that the number of analysable sectors is close to that obtained with BestCH MIX, while the variability associated with the channel type is lower because the channel is always the same for a sector. The horizontal and vertical methods obtain fewer analysable sectors. As shown in [23], the number of analysable sectors is higher for the vertical channel than it is for the horizontal channel.

Latency is obtained by performing cross-correlation [20] between the selected channels. Other methods based on cross-correlation have been used in previous papers to compute latency in mfVEP signals [15,22].

The cross-correlation method is a more robust means of measuring latencies between mfVEP signals than other techniques. One problem associated with latency computation using second-peak identification [19] is shown in 
                     Fig. 8. Two signals are displayed and second peaks are marked with a vertical line. The latency between the two signals, computed as the difference between the two second peaks, is 237−167=77ms. The advantage of using the Xcorr function is that an implicit time of 1.667ms. It is easy to check in Fig. 8 that the main waves of session 1 and session 2 are clearly superimposed, so due to this the value of 1.667ms is considered more realistic than 77ms.

One advantage of mfVEP2 is that it is not affected by the issue of ‘double humps’, encountered and widely explained in [15]. In that paper, latency is calculated as the cross-correlation between the signal and a template based on wavelet signals. The authors describe a rare problem encountered in this method: ‘double humps’ (see 
                     Fig. 9). In this case, if an external template is used it is difficult to determine if one of the peaks is an artefact. In fact, it could be one wide peak but is “pulled down” by a negative artefact signal at 210ms. This problem is solved in mfVEP2 using Xcorr function with signals from the same patient. This is because if this artefact appears in both signals, it does not affect to the final calculation.

The reference selected to compute latency does not affect the latency values in control subjects. However, if a patient starts testing when suffering an optic neuritis episode, then the first tests will be affected by the inflammation of the optic nerve. The optimal reference will be the last test, because at that point the amplitudes and latencies recover, and the number of analysable sectors will be highest.

In conclusion, we have presented a software application used to study progression in mfVEP signals. It is also useful in research projects designed to improve mfVEP techniques. This software makes it easier for users to manage the signals and allows them to choose various ways of selecting signals and displaying results. The high accuracy of the latency measurements obtained using this method is based on cross-correlation between signals from the same patients.

The authors claim no conflicts of interest.

@&#ACKNOWLEDGEMENTS@&#

This research has been supported by Spain׳s Ministerio de Ciencia e Innovación under the “Advanced analysis of multifocal ERG and visual evoked potentials applied to the diagnosis of optic neuropathies” project (ref. TEC2011-26066) and Grant BES-2012-056999 to L. de Santiago.

@&#REFERENCES@&#

