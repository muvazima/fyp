@&#MAIN-TITLE@&#Locating a single facility and a high-speed line

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study a highway and facility location problem.


                        
                        
                           
                           We give a characterization of the optimal solution.


                        
                        
                           
                           Type of solution depends on the highway’s speed.


                        
                        
                           
                           We provide 
                                 
                                    O
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                               algorithms that work in both cases.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Facility location

Highway location

Geometric optimization

Transportation

Time distance

@&#ABSTRACT@&#


               
               
                  In this paper we study a facility location problem in the plane in which a single point (facility) and a rapid transit line (highway) are simultaneously located in order to minimize the total travel time from the clients to the facility, using the 
                        
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                        
                      or Manhattan metric. The rapid transit line is given by a segment with any length and orientation, and is an alternative transportation line that can be used by the clients to reduce their travel time to the facility. We study the variant of the problem in which clients can enter and exit the highway at any point. We provide an 
                        
                           O
                           (
                           
                              
                                 n
                              
                              
                                 3
                              
                           
                           )
                        
                     -time algorithm that solves this variant, where n is the number of clients. We also present a detailed characterization of the solutions, which depends on the speed given along the highway.
               
            

@&#INTRODUCTION@&#

Suppose we are given a set of clients represented as a set of points in the plane, and a service facility represented as a point to which all clients have to move. Every client can reach the facility directly, or use an alternative rapid transit line called highway in order to reduce the travel time. The highway is a straight line segment of arbitrary orientation and length. If a client moves directly to the facility, it moves at unit speed and the distance traveled is the Manhattan or 
                        
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                        
                      distance to the facility. In the case where a client uses the highway, it travels the 
                        
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                        
                      distance at unit speed to one point of the highway, traverses with a speed 
                        
                           v
                           >
                           1
                        
                      the Euclidean distance to another highway point, and finally travels the 
                        
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                        
                      distance from that point to the facility at unit speed. All clients traverse the highway at the same speed. The highway is used by a client point whenever it saves time to reach the facility. Given the set of points representing the clients, the facility location problem consists in determining at the same time the facility point and the highway in order to minimize the total weighted travel time from the clients to the facility. The weighted travel time of a client is its travel time multiplied by a weight representing the intensity of its demand.

Geometric problems related to transportation networks have been recently considered, and simplified mathematical models have been widely studied in order to investigate basic geometric properties of urban transportation systems. Abellanas et al. (2003) introduced the time metric model: Given an underlying metric, the user can travel at speed 
                        
                           ν
                           (
                           h
                           )
                        
                      when moving along a highway h or unit speed elsewhere. The particular case in which the underlying metric is the 
                        
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                        
                      metric and all highways are axis-parallel segments of the same speed, is called the city metric (Aichholzer, Aurenhammer, & Palop, 2002; Görke, Shin, & Wolff, 2008). The optimal positioning of transportation systems that minimize the maximum travel time among a set of points has been investigated in detail in recent papers (Ahn et al., 2007; Aloupis et al., 2010; Cardinal, Collette, Hurtado, Langerman, & Palop, 2008; Cardinal, Labbé, Langerman, & Palop, 2009). Other similar and more general models are studied by Bae, Korman, and Tokuyama (2009) and Korman and Tokuyama (2008).

A similar problem of simultaneously locating a service facility point and a highway of fixed length was recently studied by Espejo and Rodríguez-Chía (2011, 2012) and Díaz-Báñez, Korman, Pérez-Lantero, and Ventura (2013). The authors considered locating a turnpike (Bae et al., 2009), that is, a highway in which clients can enter and exit the highway only at the endpoints. A first solution running in 
                        
                           O
                           (
                           
                              
                                 n
                              
                              
                                 3
                              
                           
                           log
                           n
                           )
                        
                      time, where n denotes the number of clients, was introduced by Espejo and Rodríguez-Chía (2011, 2012), and an 
                        
                           O
                           (
                           
                              
                                 n
                              
                              
                                 3
                              
                           
                           )
                        
                     -time improved one was given by Díaz-Báñez, Korman, Pérez-Lantero, and Ventura (2012b). The problem aims to minimize the total weighted travel time from the demand points to the facility service. Díaz-Báñez, Korman, Pérez-Lantero, and Ventura (2012a) continued the study of this variant by considering the min–max optimization criterion. They minimize the maximum time distance from the clients to the facility point.

The following notation is introduced in order to formulate the problem. Let S be the set of n demand points, f be the service facility point, h be the highway, and 
                           
                              v
                              >
                              1
                           
                         be the speed in which demand points move along h. Given a demand point 
                           
                              p
                              ,
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              >
                              0
                           
                         denotes the weight of p. The travel time between a demand point p and the service facility f is denoted by
                           
                              (1)
                              
                                 
                                    
                                       d
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 p
                                 ,
                                 f
                                 )
                                 
                                 ≔
                                 
                                 
                                    min
                                 
                                 
                                    
                                       
                                          ‖
                                          p
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ∈
                                                   h
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ‖
                                                   p
                                                   -
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         ‖
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ‖
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               ‖
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                   +
                                                   ‖
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   -
                                                   f
                                                   
                                                      
                                                         ‖
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The problem can be formulated as follows:

Given a set S of n demand points, the weight 
                           
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              >
                              0
                           
                         of each point p of S, and fixed speed 
                           
                              v
                              >
                              1
                           
                        , locate the facility point f and the highway h that minimizes the function
                           
                              (2)
                              
                                 Φ
                                 (
                                 f
                                 ,
                                 h
                                 )
                                 
                                 ≔
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          S
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       p
                                    
                                 
                                 ·
                                 
                                    
                                       d
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 p
                                 ,
                                 f
                                 )
                                 .
                              
                           
                        We consider the case in which a highway is a straight object (that is, a segment or a line). Note that we have complete liberty on where to locate f, whereas the location of S (and the value of v) is fixed by the problem instance.

@&#MOTIVATION@&#

This metric tries to model the time needed for a person to travel between any two points in a modern city. In most cases, a person walks (or drives) on streets, thus a path usually consists of orthogonal (i.e., north–south or east–west) roads. Thus, we use 
                           
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                              
                           
                         as the underlying metric. However, there are a few exceptional non-orthogonal roads that one can use as a short-cut (i.e., Broadway Avenue in Manhattan). These roads make non-orthogonal paths feasible (thus, we allow 
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           
                         metric within the highway). Moreover, people on these roads are normally given priority, hence we can even travel faster while on these roads (i.e., 
                           
                              v
                              >
                              1
                           
                        ). This type of non-orthogonal road is often called freeway (Bae et al., 2009) or simply highway (Korman & Tokuyama, 2008) in the literature.

Shortest path computation within a city with several highways (and even possibly obstacles) is well understood (Bae et al., 2009). However, the constructive variations of this problem (i.e., deciding where to locate a highway) have been barely studied. As mentioned before, there has been an interest in simultaneously locating a facility and a highway (Díaz-Báñez et al., 2012a, 2012b; Espejo & Rodríguez-Chía, 2011). In this paper, we study the natural combination of Díaz-Báñez et al. (2012b) and Espejo and Rodríguez-Chía (2011) (where the total weighted transportation time is the function to minimize), and Díaz-Báñez et al. (2012a) (where the highway can have any arbitrary length).

@&#RESULTS@&#

We first show that there exists an optimal solution of the FFL-problem in which the facility point f is located on h, and the highway h has infinite length (i.e., it is a line). We also characterize the way in which demand points travel to such a solution. This discretization on the shortest path shapes allows us to simplify the expression of 
                           
                              
                                 
                                    d
                                 
                                 
                                    h
                                 
                              
                              (
                              p
                              ,
                              f
                              )
                           
                         and to obtain a clear expression of the objective function 
                           
                              Φ
                              (
                              f
                              ,
                              h
                              )
                           
                        . Using geometric observations, we discretize the search space, and give an 
                           
                              O
                              (
                              
                                 
                                    n
                                 
                                 
                                    3
                                 
                              
                              )
                           
                        -time algorithm to solve the FFL-problem.

As a surprising result, our characterization of the search space depends on the highway’s speed. To the best of our knowledge, this is the first time in the study of this kind of location problems that a detailed characterization of the solutions, depending on the highway’s speed, is given. We conclude by presenting several examples that justify our characterization.

The discretization on the shapes of the shortest paths from the demand points to the facility, and properties of the objective function, are stated in Section 2 and in Section 3, respectively. In Section 4 we show how the search space of optimal solutions can be reduced. In Section 5 the algorithm to solve the FFL-problem is presented and in Section 6 we give the refinement of it. In Section 7, the examples are presented. Finally, in Section 8, we present the conclusions and further research.

Any solution to our problem will be encoded by a pair of elements 
                        
                           (
                           f
                           ,
                           h
                           )
                        
                     , where f is the facility point and h is the highway. Given f and h, we say that a demand point p does not use h (or goes directly to f) if 
                        
                           
                              
                                 d
                              
                              
                                 h
                              
                           
                           (
                           p
                           ,
                           f
                           )
                        
                      is equal to 
                        
                           ‖
                           p
                           -
                           f
                           
                              
                                 ‖
                              
                              
                                 1
                              
                           
                        
                     . Otherwise we say that p uses h. Given a point u of the plane, let 
                        
                           
                              
                                 x
                              
                              
                                 u
                              
                           
                        
                      and 
                        
                           
                              
                                 y
                              
                              
                                 u
                              
                           
                        
                      denote the x- and y-coordinates of u, respectively.

Observe from Eqs. (1) and (2) that there always exists an optimal solution 
                        
                           (
                           f
                           ,
                           h
                           )
                        
                      of the FFL-problem in which the length of h is infinite. We then assume from this point forward that every solution satisfies that the highway is a straight line.
                        5
                        Details of how to shorten the highway to a segment will be given in Section 5.
                     
                     
                        5
                     
                     
                        Lemma 1
                        
                           There exists an optimal solution of the FFL-problem in which the facility point is located on the highway.
                        

Let 
                              
                                 (
                                 f
                                 ,
                                 h
                                 )
                              
                            denote an optimal solution of the FFL-problem and suppose that f does not belong to h. Let 
                              
                                 
                                    
                                       S
                                    
                                    
                                       h
                                    
                                 
                              
                            denote the set of demand points using h. For every demand point 
                              
                                 p
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       h
                                    
                                 
                              
                           , let 
                              
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 
                                 ≔
                                 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 p
                                 )
                              
                            and 
                              
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 
                                 ≔
                                 
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 p
                                 )
                              
                            the enter and exit point on h, respectively, of the shortest path connecting p and f. The shortest path connecting p and f decomposes into three parts: an 
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                            path connecting p and 
                              
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                              
                           , a segment of h connecting 
                              
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                              
                           , and an 
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                            path connecting 
                              
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                              
                            to f. By definition, we have 
                              
                                 
                                    
                                       d
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 p
                                 ,
                                 f
                                 )
                                 =
                                 |
                                 |
                                 p
                                 -
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 |
                                 |
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 /
                                 v
                                 +
                                 |
                                 |
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 f
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       1
                                    
                                 
                              
                           .

Let 
                              
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                              
                            be the line containing f that is parallel to h. Let 
                              
                                 
                                    
                                       q
                                    
                                    
                                       3
                                    
                                 
                                 
                                 ≔
                                 
                                 
                                    
                                       q
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 p
                                 )
                              
                            be the point 
                              
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 (
                                 f
                                 -
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 f
                                 +
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           . Observe that, by construction, point 
                              
                                 
                                    
                                       q
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 p
                                 )
                              
                            is in 
                              
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                              
                            (since f is in 
                              
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                              
                           , and we are moving using a director vector of h). We claim that walking from p to 
                              
                                 
                                    
                                       q
                                    
                                    
                                       3
                                    
                                 
                              
                           , and then using 
                              
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                              
                            from 
                              
                                 
                                    
                                       q
                                    
                                    
                                       3
                                    
                                 
                              
                            to f gives a path whose travel time is equal to the one that uses h, see Fig. 1
                           . First notice that the segment of endpoints 
                              
                                 
                                    
                                       q
                                    
                                    
                                       3
                                    
                                 
                              
                            and f is included in 
                              
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                              
                           , thus the new path is indeed feasible with the alternate highway location. Moreover, by definition of 
                              
                                 
                                    
                                       q
                                    
                                    
                                       3
                                    
                                 
                              
                           , we have 
                              
                                 |
                                 |
                                 p
                                 -
                                 
                                    
                                       q
                                    
                                    
                                       3
                                    
                                 
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 |
                                 |
                                 p
                                 -
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 |
                                 |
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 f
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       1
                                    
                                 
                              
                           , and 
                              
                                 |
                                 |
                                 f
                                 -
                                 
                                    
                                       q
                                    
                                    
                                       3
                                    
                                 
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 |
                                 |
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       2
                                    
                                 
                              
                           . Thus, we conclude that 
                              
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                              
                            is an alternative highway location in which travel times of any point 
                              
                                 p
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       h
                                    
                                 
                              
                            do not increase. Clearly, the travel time of points in 
                              
                                 S
                                 ⧹
                                 
                                    
                                       S
                                    
                                    
                                       h
                                    
                                 
                              
                            cannot increase either, thus 
                              
                                 (
                                 f
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                            must also be an optimal solution of the FFL-problem. □

We also note that results similar to Lemma 1 for several variations of this problem, stating that the facility point belongs to the corresponding highway, have been found by Espejo and Rodríguez-Chía (2011) and Díaz-Báñez et al. (2012a). In particular, the above proof assumes that h is an infinitely long highway, but the same statement holds even if the highway’s length is fixed to any constant; the only difference is that there might not exist a translation of h in the y-coordinates so that highway contains f. In this case, we would try a translation in the x-coordinates instead. If either translation reaches the highway, the reasoning is analogous to the line case. Otherwise, we can show that placing the highway with the same slope so that f is at one of the two endpoints will not increase the length of the shortest paths either. We omit the details since for the purposes of our study, we can assume that the highway is sufficiently long. Observe that if a solution 
                        
                           (
                           f
                           ,
                           h
                           )
                        
                      of the problem is such that h is a straight line, then 
                        
                           (
                           f
                           ,
                           
                              
                                 h
                              
                              
                                 ″
                              
                           
                           )
                        
                      is also an optimal solution, where 
                        
                           
                              
                                 h
                              
                              
                                 ″
                              
                           
                           ⊂
                           h
                        
                      is the segment of minimum length such that every demand point both enters and exits h on a point of 
                        
                           
                              
                                 h
                              
                              
                                 ″
                              
                           
                        
                     .

Let 
                        
                           α
                        
                      always denote the non-negative angle of the highway with respect to the positive direction of the x-axis. First we solve the problem under the constraint that 
                        
                           0
                           ⩽
                           α
                           ⩽
                           
                              
                                 π
                              
                              
                                 4
                              
                           
                        
                     . By executing the same algorithm on the symmetric copy (with respect to the line 
                        
                           y
                           =
                           0
                        
                     ) we obtain the optimal solution under the constraint that 
                        
                           -
                           
                              
                                 π
                              
                              
                                 4
                              
                           
                           ⩽
                           α
                           ⩽
                           0
                        
                     . Likewise, by making symmetry through the line 
                        
                           y
                           =
                           x
                        
                      we can obtain the solution for the remaining 
                        
                           α
                           ∈
                           [
                           
                              
                                 π
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 π
                              
                              
                                 2
                              
                           
                           ]
                        
                     , and 
                        
                           α
                           ∈
                           [
                           -
                           
                              
                                 π
                              
                              
                                 2
                              
                           
                           ,
                           -
                           
                              
                                 π
                              
                              
                                 4
                              
                           
                           ]
                        
                      cases. The optimal solution will be the one (among the four obtained solutions) whose associated cost is minimized. Thus, from this point forward we assume 
                        
                           0
                           ⩽
                           α
                           ⩽
                           
                              
                                 π
                              
                              
                                 4
                              
                           
                        
                     .

Given the highway h and a demand point p, let 
                        
                           
                              
                                 p
                              
                              
                                 ′
                              
                           
                        
                      be the intersection point between h and the vertical line passing through p. If h is not horizontal, let 
                        
                           
                              
                                 p
                              
                              
                                 ″
                              
                           
                        
                      be the intersection point between h and the horizontal line passing through p. Let 
                        
                           
                              
                                 h
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      denote the open half-line contained in h that emanates from 
                        
                           
                              
                                 p
                              
                              
                                 ′
                              
                           
                        
                      and does not contain 
                        
                           
                              
                                 p
                              
                              
                                 ″
                              
                           
                        
                     , and 
                        
                           
                              
                                 h
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       ″
                                    
                                 
                              
                           
                        
                      denote the subset of points of h lying below the horizontal line through p. Observe that if h is not horizontal then 
                        
                           
                              
                                 h
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       ″
                                    
                                 
                              
                           
                        
                      is the open half-line that emanates from 
                        
                           
                              
                                 p
                              
                              
                                 ″
                              
                           
                        
                      and does not contain 
                        
                           
                              
                                 p
                              
                              
                                 ′
                              
                           
                        
                     . Otherwise, if h is horizontal, 
                        
                           
                              
                                 h
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       ″
                                    
                                 
                              
                           
                        
                      is the empty set. Let 
                        
                           
                              
                                 h
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       ″
                                    
                                 
                              
                           
                           
                           ≔
                           
                           h
                           ⧹
                           (
                           
                              
                                 h
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           ∪
                           
                              
                                 h
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       ″
                                    
                                 
                              
                           
                           )
                        
                     . Notice from the assumption 
                        
                           0
                           ⩽
                           α
                           ⩽
                           
                              
                                 π
                              
                              
                                 4
                              
                           
                        
                      that given h and a demand point 
                        
                           p
                           ,
                           
                              
                                 p
                              
                              
                                 ′
                              
                           
                        
                      is the nearest point to p on h under the 
                        
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                        
                      metric. The next lemmas characterize the way in which demand points move optimally to the facility.
                        Lemma 2
                        
                           Given the highway h and the facility point 
                           
                              
                                 f
                                 ∈
                                 h
                              
                           
                           , we can assume that all demand points p using h move first to a point of 
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             ″
                                          
                                       
                                    
                                 
                              
                            
                           and after that move to f along h.
                        

Let 
                              
                                 u
                                 ∈
                                 h
                                 ⧹
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             ″
                                          
                                       
                                    
                                 
                              
                            be any point. Let point q denote point 
                              
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                              
                            (if 
                              
                                 u
                                 ∈
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           ) or 
                              
                                 
                                    
                                       p
                                    
                                    
                                       ″
                                    
                                 
                              
                            (otherwise). We have:
                              
                                 
                                    ‖
                                    p
                                    -
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          u
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    ‖
                                    p
                                    -
                                    q
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ‖
                                    q
                                    -
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          u
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    ⩾
                                    ‖
                                    p
                                    -
                                    q
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ‖
                                    q
                                    -
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          u
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    ⩾
                                    ‖
                                    p
                                    -
                                    q
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          q
                                          -
                                          u
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          u
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    ⩾
                                    ‖
                                    p
                                    -
                                    q
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          q
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                 
                              
                           The result thus follows. □


                           Given the highway h and the facility point f located on h, the following holds for all demand points p:
                        


                           If 
                           
                              
                                 cos
                                 α
                                 -
                                 sin
                                 α
                                 ⩾
                                 
                                    
                                       1
                                    
                                    
                                       v
                                    
                                 
                              
                            
                           then p moves first to 
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                              
                            
                           and after that moves to f using h.
                        


                           Otherwise, if 
                           
                              
                                 cos
                                 α
                                 -
                                 sin
                                 α
                                 <
                                 
                                    
                                       1
                                    
                                    
                                       v
                                    
                                 
                              
                           
                           , the next statements are true:
                           
                              
                                 (a)
                                 
                                    If 
                                    
                                       
                                          f
                                          ∈
                                          
                                             
                                                h
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                     
                                    then p moves first to 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ′
                                             
                                          
                                       
                                     
                                    and after that moves to f using h.
                                 


                                    If 
                                    
                                       
                                          f
                                          ∈
                                          
                                             
                                                h
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ″
                                                   
                                                
                                             
                                          
                                       
                                     
                                    then p moves first to 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ″
                                             
                                          
                                       
                                     
                                    and after that moves to f using h.
                                 


                                    If 
                                    
                                       
                                          f
                                          ∈
                                          
                                             
                                                h
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ″
                                                   
                                                
                                             
                                          
                                       
                                     
                                    then p moves directly to f without using h.
                                 

We note that similar characterizations of the shortest path exist in the literature (Díaz-Báñez et al., 2012b; Díaz-Báñez et al., 2013; Espejo & Rodríguez-Chía, 2011). However, to the best of our knowledge, the particular case which we study has not appeared anywhere else. Let p be a demand point and assume w.l.o.g.that p is below h. According to Lemma 2, let 
                              
                                 u
                                 ∈
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             ″
                                          
                                       
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       u
                                    
                                    
                                       ′
                                    
                                 
                                 
                                 ≔
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       u
                                    
                                 
                                 )
                              
                           , and 
                              
                                 
                                    
                                       u
                                    
                                    
                                       ″
                                    
                                 
                                 
                                 ≔
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       p
                                    
                                 
                                 )
                              
                           . Suppose 
                              
                                 cos
                                 α
                                 -
                                 sin
                                 α
                                 ⩾
                                 
                                    
                                       1
                                    
                                    
                                       v
                                    
                                 
                              
                            (refer to Fig. 2
                           (a)), then:
                              
                                 
                                    ‖
                                    p
                                    -
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          u
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    ‖
                                    p
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          u
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    ⩾
                                    ‖
                                    p
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          
                                             
                                                p
                                             
                                             
                                                ′
                                             
                                          
                                          -
                                          u
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          u
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    ⩾
                                    ‖
                                    p
                                    -
                                    
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          
                                             
                                                p
                                             
                                             
                                                ′
                                             
                                          
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                 
                              
                           Suppose now that 
                              
                                 cos
                                 α
                                 -
                                 sin
                                 α
                                 <
                                 
                                    
                                       1
                                    
                                    
                                       v
                                    
                                 
                              
                           . If 
                              
                                 f
                                 ∈
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                            (Fig. 2(b)) then the following holds since 
                              
                                 ‖
                                 
                                    
                                       u
                                    
                                    
                                       ′
                                    
                                 
                                 -
                                 u
                                 
                                    
                                       ‖
                                    
                                    
                                       1
                                    
                                 
                                 ⩾
                                 ‖
                                 
                                    
                                       u
                                    
                                    
                                       ′
                                    
                                 
                                 -
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       1
                                    
                                 
                              
                            because 
                              
                                 α
                                 ∈
                                 [
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       4
                                    
                                 
                                 ]
                              
                           :
                              
                                 
                                    ‖
                                    p
                                    -
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          u
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    ‖
                                    p
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          u
                                          -
                                          
                                             
                                                p
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          
                                             
                                                p
                                             
                                             
                                                ′
                                             
                                          
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    ⩾
                                    ‖
                                    p
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          
                                             
                                                p
                                             
                                             
                                                ′
                                             
                                          
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    ‖
                                    p
                                    -
                                    
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          
                                             
                                                p
                                             
                                             
                                                ′
                                             
                                          
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                 
                              
                           Otherwise, if 
                              
                                 f
                                 ∈
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ″
                                          
                                       
                                    
                                 
                              
                            (Fig. 2(c)), then 
                              
                                 ‖
                                 
                                    
                                       u
                                    
                                    
                                       ″
                                    
                                 
                                 -
                                 u
                                 
                                    
                                       ‖
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       ‖
                                       u
                                       -
                                       
                                          
                                             p
                                          
                                          
                                             ″
                                          
                                       
                                       
                                          
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       v
                                    
                                 
                                 >
                                 ‖
                                 
                                    
                                       u
                                    
                                    
                                       ″
                                    
                                 
                                 -
                                 
                                    
                                       p
                                    
                                    
                                       ″
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       1
                                    
                                 
                              
                            and:
                              
                                 
                                    ‖
                                    p
                                    -
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          u
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    ‖
                                    p
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          ″
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          ″
                                       
                                    
                                    -
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          u
                                          -
                                          
                                             
                                                p
                                             
                                             
                                                ″
                                             
                                          
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          
                                             
                                                p
                                             
                                             
                                                ″
                                             
                                          
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    >
                                    ‖
                                    p
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          ″
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          ″
                                       
                                    
                                    -
                                    
                                       
                                          p
                                       
                                       
                                          ″
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          
                                             
                                                p
                                             
                                             
                                                ″
                                             
                                          
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    ‖
                                    p
                                    -
                                    
                                       
                                          p
                                       
                                       
                                          ″
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          
                                             
                                                p
                                             
                                             
                                                ″
                                             
                                          
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                 
                              
                           Otherwise, if 
                              
                                 f
                                 ∈
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             ″
                                          
                                       
                                    
                                 
                              
                            and u belongs to the open segment connecting f and 
                              
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                              
                            (Fig. 2(d)), let 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 
                                 ≔
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       f
                                    
                                 
                                 )
                              
                            and then:
                              
                                 
                                    ‖
                                    p
                                    -
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          u
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    >
                                    ‖
                                    p
                                    -
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ‖
                                    
                                       
                                          f
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    f
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    -
                                    ‖
                                    
                                       
                                          f
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    ‖
                                    p
                                    -
                                    
                                       
                                          f
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ‖
                                    
                                       
                                          f
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    f
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    ‖
                                    p
                                    -
                                    f
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           Otherwise, if 
                              
                                 f
                                 ∈
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             ″
                                          
                                       
                                    
                                 
                              
                            and u belongs to the open segment connecting f and 
                              
                                 
                                    
                                       p
                                    
                                    
                                       ″
                                    
                                 
                              
                            (Fig. 2(e)), let 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 
                                 ≔
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       f
                                    
                                 
                                 )
                              
                            and then:
                              
                                 
                                    ‖
                                    p
                                    -
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ‖
                                          u
                                          -
                                          f
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    >
                                    ‖
                                    p
                                    -
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    ‖
                                    p
                                    -
                                    f
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    -
                                    ‖
                                    
                                       
                                          f
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ‖
                                    
                                       
                                          f
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    f
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    ⩾
                                    ‖
                                    p
                                    -
                                    f
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           The result thus follows. □

Let 
                        
                           
                              
                                 φ
                              
                              
                                 v
                              
                           
                           
                           ≔
                           
                           
                              
                                 π
                              
                              
                                 4
                              
                           
                           -
                           arcsin
                           (
                           
                              
                                 2
                              
                           
                           /
                           2
                           v
                           )
                        
                     . Observe that 
                        
                           cos
                           
                              
                                 φ
                              
                              
                                 v
                              
                           
                           -
                           sin
                           
                              
                                 φ
                              
                              
                                 v
                              
                           
                           =
                           
                              
                                 1
                              
                              
                                 v
                              
                           
                        
                     . Furthermore, 
                        
                           cos
                           α
                           -
                           sin
                           α
                           ⩾
                           
                              
                                 1
                              
                              
                                 v
                              
                           
                        
                      for all 
                        
                           α
                           ∈
                           [
                           0
                           ,
                           
                              
                                 φ
                              
                              
                                 v
                              
                           
                           ]
                        
                     , and 
                        
                           cos
                           α
                           -
                           sin
                           α
                           <
                           
                              
                                 1
                              
                              
                                 v
                              
                           
                        
                      for all 
                        
                           α
                           ∈
                           (
                           
                              
                                 φ
                              
                              
                                 v
                              
                           
                           ,
                           
                              
                                 π
                              
                              
                                 4
                              
                           
                           ]
                        
                     . That is, if 
                        
                           α
                           ⩽
                           
                              
                                 ϕ
                              
                              
                                 v
                              
                           
                        
                     , points of S will travel vertically to the highway, whereas this fact will not hold for 
                        
                           
                              
                                 ϕ
                              
                              
                                 v
                              
                           
                           ⩾
                           α
                        
                      (the case 
                        
                           α
                           =
                           
                              
                                 ϕ
                              
                              
                                 v
                              
                           
                        
                      is the borderline where both paths have the same length). More examples will be given in Section 7.

Using Lemma 3, we can simplify the travel time between a demand point p and facility f to the following expression.
                        
                           
                              
                                 
                                    d
                                 
                                 
                                    h
                                 
                              
                              (
                              p
                              ,
                              f
                              )
                              
                              ≔
                              
                              
                                 min
                              
                              
                                 
                                    
                                       ‖
                                       p
                                       -
                                       f
                                       
                                          
                                             ‖
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       ‖
                                       p
                                       -
                                       
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             ‖
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             ‖
                                             
                                                
                                                   p
                                                
                                                
                                                   ′
                                                
                                             
                                             -
                                             f
                                             
                                                
                                                   ‖
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             v
                                          
                                       
                                       ,
                                       ‖
                                       p
                                       -
                                       
                                          
                                             p
                                          
                                          
                                             ″
                                          
                                       
                                       
                                          
                                             ‖
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             ‖
                                             
                                                
                                                   p
                                                
                                                
                                                   ″
                                                
                                             
                                             -
                                             f
                                             
                                                
                                                   ‖
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             v
                                          
                                       
                                    
                                 
                              
                           
                        
                     Given a solution 
                        
                           (
                           f
                           ,
                           h
                           )
                        
                      of the FFL-problem, we can always partition the set S of demand points into the sets 
                        
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           
                           ≔
                           
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           (
                           f
                           ,
                           h
                           )
                           ,
                           
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           
                           ≔
                           
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           (
                           f
                           ,
                           h
                           )
                        
                     , and 
                        
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                           
                           ≔
                           
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                           (
                           f
                           ,
                           h
                           )
                        
                      as follows (refer to Fig. 3
                     (a)). Set 
                        
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                        
                      contains the points 
                        
                           p
                           ∈
                           S
                        
                      such that 
                        
                           
                              
                                 x
                              
                              
                                 p
                              
                           
                           ⩽
                           
                              
                                 x
                              
                              
                                 f
                              
                           
                        
                      and 
                        
                           
                              
                                 y
                              
                              
                                 p
                              
                           
                           ⩾
                           
                              
                                 y
                              
                              
                                 f
                              
                           
                        
                      and the points 
                        
                           q
                           ∈
                           S
                        
                      such that 
                        
                           
                              
                                 x
                              
                              
                                 q
                              
                           
                           ⩾
                           
                              
                                 x
                              
                              
                                 f
                              
                           
                        
                      and 
                        
                           
                              
                                 y
                              
                              
                                 q
                              
                           
                           ⩽
                           
                              
                                 y
                              
                              
                                 f
                              
                           
                        
                     . Set 
                        
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                        
                      contains the points 
                        
                           p
                           ∈
                           S
                        
                      such that 
                        
                           
                              
                                 x
                              
                              
                                 p
                              
                           
                           <
                           
                              
                                 x
                              
                              
                                 f
                              
                           
                        
                      and p is either on or below h, and the points 
                        
                           q
                           ∈
                           S
                        
                      such that 
                        
                           
                              
                                 x
                              
                              
                                 q
                              
                           
                           >
                           
                              
                                 x
                              
                              
                                 f
                              
                           
                        
                      and q is either on or above h. Set 
                        
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                        
                      is equal to 
                        
                           S
                           ⧹
                           (
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           ∪
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           )
                        
                     .

Thus, we have two possible cases for the slope of the highway:

If 
                        
                           0
                           ⩽
                           α
                           ⩽
                           
                              
                                 φ
                              
                              
                                 v
                              
                           
                        
                      (Fig. 3(b)), the travel time simplifies to the following expression.
                        
                           (3)
                           
                              
                                 
                                    d
                                 
                                 
                                    h
                                 
                              
                              (
                              p
                              ,
                              f
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      f
                                                   
                                                
                                                |
                                                +
                                                |
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      f
                                                   
                                                
                                                |
                                                tan
                                                α
                                                +
                                                
                                                   
                                                      |
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            f
                                                         
                                                      
                                                      |
                                                   
                                                   
                                                      cos
                                                      α
                                                      ·
                                                      v
                                                   
                                                
                                             
                                             
                                                if
                                                
                                                p
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                |
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      f
                                                   
                                                
                                                |
                                                -
                                                |
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      f
                                                   
                                                
                                                |
                                                tan
                                                α
                                                +
                                                
                                                   
                                                      |
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            f
                                                         
                                                      
                                                      |
                                                   
                                                   
                                                      cos
                                                      α
                                                      ·
                                                      v
                                                   
                                                
                                             
                                             
                                                if
                                                
                                                p
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                -
                                                |
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      f
                                                   
                                                
                                                |
                                                +
                                                |
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      f
                                                   
                                                
                                                |
                                                tan
                                                α
                                                +
                                                
                                                   
                                                      |
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            f
                                                         
                                                      
                                                      |
                                                   
                                                   
                                                      cos
                                                      α
                                                      ·
                                                      v
                                                   
                                                
                                             
                                             
                                                if
                                                
                                                p
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     When we apply this to the objective function 
                        
                           Φ
                           (
                           f
                           ,
                           h
                           )
                        
                     , we obtain:
                        
                           (4)
                           
                              Φ
                              (
                              f
                              ,
                              h
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              |
                              
                                 
                                    y
                                 
                                 
                                    p
                                 
                              
                              -
                              
                                 
                                    y
                                 
                                 
                                    f
                                 
                              
                              |
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              |
                              
                                 
                                    y
                                 
                                 
                                    p
                                 
                              
                              -
                              
                                 
                                    y
                                 
                                 
                                    f
                                 
                              
                              |
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              |
                              
                                 
                                    y
                                 
                                 
                                    p
                                 
                              
                              -
                              
                                 
                                    y
                                 
                                 
                                    f
                                 
                              
                              |
                              +
                              tan
                              α
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                p
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             p
                                          
                                       
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             p
                                          
                                       
                                       -
                                       
                                          
                                             x
                                          
                                          
                                             f
                                          
                                       
                                       |
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                p
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             p
                                          
                                       
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             p
                                          
                                       
                                       -
                                       
                                          
                                             x
                                          
                                          
                                             f
                                          
                                       
                                       |
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                p
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             p
                                          
                                       
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             p
                                          
                                       
                                       -
                                       
                                          
                                             x
                                          
                                          
                                             f
                                          
                                       
                                       |
                                    
                                 
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    cos
                                    α
                                    ·
                                    v
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                p
                                                ∈
                                                S
                                             
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             p
                                          
                                       
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             p
                                          
                                       
                                       -
                                       
                                          
                                             x
                                          
                                          
                                             f
                                          
                                       
                                       |
                                    
                                 
                              
                           
                        
                     Otherwise, we have 
                        
                           
                              
                                 φ
                              
                              
                                 v
                              
                           
                           <
                           α
                           ⩽
                           
                              
                                 π
                              
                              
                                 4
                              
                           
                        
                      (Fig. 3(c)). In this case, we have:
                        
                           (5)
                           
                              
                                 
                                    d
                                 
                                 
                                    h
                                 
                              
                              (
                              p
                              ,
                              f
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      f
                                                   
                                                
                                                |
                                                +
                                                |
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      f
                                                   
                                                
                                                |
                                             
                                             
                                                if
                                                
                                                p
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                |
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      f
                                                   
                                                
                                                |
                                                -
                                                |
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      f
                                                   
                                                
                                                |
                                                tan
                                                α
                                                +
                                                
                                                   
                                                      |
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            f
                                                         
                                                      
                                                      |
                                                   
                                                   
                                                      cos
                                                      α
                                                      ·
                                                      v
                                                   
                                                
                                             
                                             
                                                if
                                                
                                                p
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                |
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      f
                                                   
                                                
                                                |
                                                -
                                                |
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      f
                                                   
                                                
                                                |
                                                cot
                                                α
                                                +
                                                
                                                   
                                                      |
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            f
                                                         
                                                      
                                                      |
                                                   
                                                   
                                                      sin
                                                      α
                                                      ·
                                                      v
                                                   
                                                
                                             
                                             
                                                if
                                                
                                                p
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     Again, we look at our objective function 
                        
                           Φ
                           (
                           f
                           ,
                           h
                           )
                        
                     , and obtain the following expression.
                        
                           (6)
                           
                              Φ
                              (
                              f
                              ,
                              h
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             p
                                          
                                       
                                       -
                                       
                                          
                                             x
                                          
                                          
                                             f
                                          
                                       
                                       |
                                       +
                                       |
                                       
                                          
                                             y
                                          
                                          
                                             p
                                          
                                       
                                       -
                                       
                                          
                                             y
                                          
                                          
                                             f
                                          
                                       
                                       |
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              |
                              
                                 
                                    y
                                 
                                 
                                    p
                                 
                              
                              -
                              
                                 
                                    y
                                 
                                 
                                    f
                                 
                              
                              |
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              |
                              
                                 
                                    x
                                 
                                 
                                    p
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    f
                                 
                              
                              |
                              +
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             cos
                                             α
                                             ·
                                             v
                                          
                                       
                                       -
                                       tan
                                       α
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              |
                              
                                 
                                    x
                                 
                                 
                                    p
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    f
                                 
                              
                              |
                              +
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             sin
                                             α
                                             ·
                                             v
                                          
                                       
                                       -
                                       cot
                                       α
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              |
                              
                                 
                                    y
                                 
                                 
                                    p
                                 
                              
                              -
                              
                                 
                                    y
                                 
                                 
                                    f
                                 
                              
                              |
                           
                        
                     
                  

Let G be the grid defined by the set of all axis-parallel lines passing through the elements of S.
                        Lemma 4
                        
                           There always exists an optimal solution 
                           
                              
                                 (
                                 f
                                 ,
                                 h
                                 )
                              
                            
                           of the FFL-problem satisfying at least one of the two following conditions: 
                           
                              
                                 (
                                 a
                                 )
                              
                            
                           h contains a point of S and f is on a line of grid G, or 
                           
                              
                                 (
                                 b
                                 )
                              
                            
                           f is a vertex of grid G.
                        

The two possible cases for an optimal solution are depicted in Fig. 4
                           . Let 
                              
                                 (
                                 f
                                 ,
                                 h
                                 )
                              
                            be an optimal solution of the FFL-problem satisfying neither condition (a) nor condition (b). Using local linear perturbations, we will transform 
                              
                                 (
                                 f
                                 ,
                                 h
                                 )
                              
                            into another optimal solution that satisfies at least one of these conditions.

Assume first the case where 
                              
                                 
                                    
                                       φ
                                    
                                    
                                       v
                                    
                                 
                                 <
                                 α
                                 ⩽
                                 
                                    
                                       π
                                    
                                    
                                       4
                                    
                                 
                              
                           . Let 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 ⩾
                                 0
                              
                            (resp. 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 ⩾
                                 0
                              
                           ) be the smallest value such that if we translate both f and h with vector 
                              
                                 (
                                 -
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 0
                                 )
                              
                            (resp. 
                              
                                 (
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 0
                                 )
                              
                           ) then f belongs to a vertical line of G or h contains a point of S. Given 
                              
                                 ε
                                 ∈
                                 [
                                 -
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                           , let 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ε
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       h
                                    
                                    
                                       ε
                                    
                                 
                              
                            be f and h translated with vector 
                              
                                 (
                                 ε
                                 ,
                                 0
                                 )
                              
                           , respectively. Using Lemma 3, we partition S into four sets 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       3
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       4
                                    
                                 
                              
                            as follows. Set 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       1
                                    
                                 
                              
                            (resp. 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       2
                                    
                                 
                              
                           ) contains the demand points doing a rightwards (resp. leftwards) movement to reach h. Set 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       3
                                    
                                 
                              
                            (resp. 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       4
                                    
                                 
                              
                           ) contains the demand points doing only a downwards (resp. upwards) movement to reach h. Observe that:
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                    (
                                    p
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          ε
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          d
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    p
                                    ,
                                    f
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      if
                                                      
                                                      p
                                                      ∈
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      -
                                                      ε
                                                   
                                                   
                                                      if
                                                      
                                                      p
                                                      ∈
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      ε
                                                      ·
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            α
                                                         
                                                      
                                                   
                                                   
                                                      if
                                                      
                                                      p
                                                      ∈
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      -
                                                      ε
                                                      ·
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            α
                                                         
                                                      
                                                   
                                                   
                                                      if
                                                      
                                                      p
                                                      ∈
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       c
                                    
                                    
                                       α
                                    
                                 
                                 =
                                 tan
                                 α
                                 -
                                 
                                    
                                       1
                                    
                                    
                                       cos
                                       α
                                       ·
                                       v
                                    
                                 
                              
                           . Let 
                              
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                                 
                                 ≔
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       ∈
                                       
                                          
                                             Z
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 (
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 )
                              
                           . Thus, for any 
                              
                                 ε
                                 ∈
                                 [
                                 -
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                           , the variation of the objective function value when we translate both f and h with vector 
                              
                                 (
                                 ε
                                 ,
                                 0
                                 )
                              
                            is the following:
                              
                                 
                                    Φ
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          ε
                                       
                                    
                                    ,
                                    
                                       
                                          h
                                       
                                       
                                          ε
                                       
                                    
                                    )
                                    -
                                    Φ
                                    (
                                    f
                                    ,
                                    h
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             S
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          p
                                       
                                    
                                    ·
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ε
                                                      
                                                   
                                                
                                             
                                             (
                                             p
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   ε
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   d
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             p
                                             ,
                                             f
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             
                                                
                                                   Z
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          p
                                       
                                    
                                    ε
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             
                                                
                                                   Z
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          p
                                       
                                    
                                    (
                                    -
                                    ε
                                    )
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             
                                                
                                                   Z
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          p
                                       
                                    
                                    (
                                    ε
                                    
                                       
                                          c
                                       
                                       
                                          α
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             
                                                
                                                   Z
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          
                                             -
                                             ε
                                             
                                                
                                                   c
                                                
                                                
                                                   α
                                                
                                             
                                          
                                       
                                    
                                    =
                                    ε
                                    
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   W
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   α
                                                
                                             
                                             (
                                             
                                                
                                                   W
                                                
                                                
                                                   3
                                                
                                             
                                             -
                                             
                                                
                                                   W
                                                
                                                
                                                   4
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           Since 
                              
                                 (
                                 f
                                 ,
                                 h
                                 )
                              
                            is optimal we must have 
                              
                                 Φ
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       ε
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       ε
                                    
                                 
                                 )
                                 -
                                 Φ
                                 (
                                 f
                                 ,
                                 h
                                 )
                                 ⩾
                                 0
                              
                            for all 
                              
                                 ε
                                 ∈
                                 [
                                 -
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                           . This implies 
                              
                                 
                                    
                                       W
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       W
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       α
                                    
                                 
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       3
                                    
                                 
                                 -
                                 
                                    
                                       W
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 =
                                 0
                              
                            and 
                              
                                 Φ
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       ε
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       ε
                                    
                                 
                                 )
                                 =
                                 Φ
                                 (
                                 f
                                 ,
                                 h
                                 )
                              
                            for all 
                              
                                 ε
                                 ∈
                                 [
                                 -
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                           . Therefore, by translating both f and h with vector either 
                              
                                 (
                                 -
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 0
                                 )
                              
                            or 
                              
                                 (
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 0
                                 )
                              
                           , we ensure that f is on a vertical line of G or h passes through a point of S, or both conditions hold.

Note that after h has been translated, we could continue translating h in the same direction. However, the partition of S into the four sets could change (and thus, further translating h might not be possible). In any case, being able to reach a vertical line is enough for our purposes.

We now repeat the same operation in the vertical direction in order to ensure that f is on a horizontal line of G or h passes through a point of S, and condition (a) or condition (b) holds. Otherwise, if it holds only that h passes through a point of S, then it is straightforward to prove, by using similar arguments, that f can be translated along h in order to ensure f belongs to a line of G, either vertical or horizontal, and condition (a) holds. In fact, for some demand point p of 
                              
                                 S
                                 ,
                                 f
                              
                            will coincide with the point in which p enters h, that is, 
                              
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                              
                            or 
                              
                                 
                                    
                                       p
                                    
                                    
                                       ″
                                    
                                 
                              
                           .

In the case where 
                              
                                 0
                                 ⩽
                                 α
                                 ⩽
                                 
                                    
                                       φ
                                    
                                    
                                       v
                                    
                                 
                              
                            every demand point p moves vertically to h (Lemma 3), and we can proceed as follows by using arguments similar to the above ones. We first translate both f and h with the same vertical vector in order to ensure that h contains a point of S. After that, f is translated along h if necessary until f belongs to a vertical line of G and condition (a) holds. The lemma thus follows. Note that it is easy to make a problem instance in which there exists a solution that satisfies both conditions (i.e., when all points of S are on a line). □


                           If 
                           
                              
                                 α
                                 ⩽
                                 
                                    
                                       φ
                                    
                                    
                                       v
                                    
                                 
                              
                            
                           then there always exists an optimal solution satisfying 
                           
                              Lemma 4 
                           
                              
                                 (
                                 a
                                 )
                              
                           
                           .
                        


                     
                        Theorem 6
                        
                           The FFL-problem can be solved in 
                           
                              
                                 O
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                            
                           time.
                        

We find an optimal solution by solving two cases separately. The first case is when the solution satisfies Lemma 4(a), and the second case is when solution satisfies Lemma 4(b).

In order to solve the first case we find, for each demand point p and each line 
                              
                                 ℓ
                              
                            of G, an optimal angle 
                              
                                 α
                              
                            such that 
                              
                                 Φ
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       α
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       α
                                    
                                 
                                 )
                              
                            is minimized, where 
                              
                                 
                                    
                                       h
                                    
                                    
                                       α
                                    
                                 
                              
                            is the line passing through p whose angle with respect to the positive direction of the x-axis is equal to 
                              
                                 α
                              
                           , and 
                              
                                 
                                    
                                       f
                                    
                                    
                                       α
                                    
                                 
                              
                            is the intersection point between 
                              
                                 ℓ
                              
                            and 
                              
                                 
                                    
                                       h
                                    
                                    
                                       α
                                    
                                 
                              
                           . Assume w.l.o.g. that 
                              
                                 ℓ
                              
                            is vertical and p is located to the left of 
                              
                                 ℓ
                              
                           . Observe from Eqs. (4) and (6), that for any 
                              
                                 α
                                 ∈
                                 [
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       4
                                    
                                 
                                 ]
                              
                            the expression of 
                              
                                 Φ
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       α
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       α
                                    
                                 
                                 )
                              
                            is locally has the form 
                              
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 tan
                                 α
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                                 cot
                                 α
                                 +
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             4
                                          
                                       
                                    
                                    
                                       cos
                                       α
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             5
                                          
                                       
                                    
                                    
                                       sin
                                       α
                                    
                                 
                              
                           , where each 
                              
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                              
                            depends on 
                              
                                 
                                    
                                       x
                                    
                                    
                                       f
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       y
                                    
                                    
                                       f
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       w
                                    
                                    
                                       q
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       x
                                    
                                    
                                       q
                                    
                                 
                              
                           , and the weights of coordinates of points of set 
                              
                                 
                                    
                                       S
                                    
                                    
                                       j
                                    
                                 
                              
                            (for some 
                              
                                 j
                                 =
                                 j
                                 (
                                 i
                                 )
                              
                           ).

Furthermore, if we progressively increase the value of 
                              
                                 α
                              
                            from 0 to 
                              
                                 
                                    
                                       π
                                    
                                    
                                       4
                                    
                                 
                              
                           , that expression can only change whenever the sets 
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       S
                                    
                                    
                                       3
                                    
                                 
                              
                            change, that is, when 
                              
                                 
                                    
                                       h
                                    
                                    
                                       α
                                    
                                 
                              
                            crosses a demand point, 
                              
                                 
                                    
                                       f
                                    
                                    
                                       α
                                    
                                 
                              
                            crosses a horizontal line of G, or 
                              
                                 α
                                 =
                                 
                                    
                                       φ
                                    
                                    
                                       v
                                    
                                 
                              
                           . Then consider the sequence 
                              
                                 0
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       0
                                    
                                 
                                 <
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 ⋯
                                 <
                                 
                                    
                                       α
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       π
                                    
                                    
                                       4
                                    
                                 
                              
                            of 
                              
                                 m
                                 +
                                 1
                                 =
                                 O
                                 (
                                 n
                                 )
                              
                            angles, where each angle 
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                              
                            
                           
                              
                                 (
                                 1
                                 ⩽
                                 i
                                 <
                                 m
                                 )
                              
                            is such that either 
                              
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                            contains a demand point, 
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                            belongs to a horizontal line of grid G, or 
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       φ
                                    
                                    
                                       v
                                    
                                 
                              
                           .

Note that, if we restrict the problem within an interval preprocess the demand points S by constructing their dual arrangement (O’Rourke, 1998), the sequence of angular events can be obtained in 
                              
                                 O
                                 (
                                 n
                                 )
                              
                            time by using both the Zone Theorem (O’Rourke, 1998) and the order of the demand points with respect to the y-coordinate (this preprocessing needs 
                              
                                 O
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            time and space). Thus, it remains to show how to find possible solutions within a fixed interval 
                              
                                 [
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ]
                              
                           .

Within any such interval, the partition of S into sets 
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       S
                                    
                                    
                                       3
                                    
                                 
                              
                            does not change. Thus, the points of S that are involved in the expression of 
                              
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       5
                                    
                                 
                              
                            cannot change either. Thus, the expression of a single 
                              
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                              
                            only depends on 
                              
                                 
                                    
                                       x
                                    
                                    
                                       f
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       y
                                    
                                    
                                       f
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       x
                                    
                                    
                                       q
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       y
                                    
                                    
                                       q
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       w
                                    
                                    
                                       q
                                    
                                 
                              
                            (for 
                              
                                 q
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       j
                                    
                                 
                              
                            and 
                              
                                 j
                                 =
                                 j
                                 (
                                 i
                                 )
                              
                           ). The values 
                              
                                 
                                    
                                       x
                                    
                                    
                                       q
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       y
                                    
                                    
                                       q
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       w
                                    
                                    
                                       q
                                    
                                 
                              
                            are part of the input, hence constant. Likewise, 
                              
                                 
                                    
                                       x
                                    
                                    
                                       f
                                    
                                 
                              
                            is a constant (since we assumed that 
                              
                                 ℓ
                              
                            is vertical). Finally, the term 
                              
                                 
                                    
                                       y
                                    
                                    
                                       f
                                    
                                 
                              
                            can be expressed as the product of a constant and 
                              
                                 tan
                                 α
                              
                           : consider the triangle of vertices 
                              
                                 p
                                 ,
                                 f
                              
                           , and 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       f
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       p
                                    
                                 
                                 )
                              
                           . Independently of the value of 
                              
                                 α
                              
                           , the length of one leg is 
                              
                                 
                                    
                                       x
                                    
                                    
                                       f
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       p
                                    
                                 
                              
                            (a constant for fixed p and 
                              
                                 ℓ
                              
                           ). Hence, by trigonometric equalities the length of the other leg must be 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       f
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       p
                                    
                                 
                                 )
                                 tan
                                 α
                              
                           .

That is, the terms 
                              
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       5
                                    
                                 
                              
                            within an interval 
                              
                                 α
                                 ∈
                                 [
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ]
                              
                            
                           
                              
                                 (
                                 0
                                 ⩽
                                 i
                                 <
                                 m
                                 )
                              
                            can be expressed as a linear function of 
                              
                                 tan
                                 α
                              
                           , and thus 
                              
                                 Φ
                              
                            is a trigonometric expression that only depends on 
                              
                                 α
                              
                           . Assume that, for a value of i, the expression of 
                              
                                 Φ
                              
                            is explicitly known. Then, its minimum (within the interval) will either be one of the endpoints, or a value that makes the derivate of 
                              
                                 Φ
                              
                            equal to zero. The derivate is a trigonometric equation that does not depend on n (the size of our problem). Moreover, since we assumed 
                              
                                 0
                                 ⩽
                                 α
                                 ⩽
                                 
                                    
                                       π
                                    
                                    
                                       4
                                    
                                 
                              
                           , and the period of these functions is 
                              
                                 2
                                 π
                              
                           , there can only be a constant number of values in which this happens. Since the expression does not depend on the size of the problem, we can be explicitly obtain the solution in constant time.
                              6
                              We are implicitly using the fact that we can find the roots of a trigonometric equation of a constant number of terms in constant time. Otherwise, we can always approximate it within any reasonable precision using any numerical methods approach for finding the roots of a general function. The important part is the fact that the time needed to do so will not depend on n.
                           
                           
                              6
                           
                        

We study each interval 
                              
                                 [
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ]
                              
                            for increasing values of i, thus the need to obtain the expression for a given interval 
                              
                                 [
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       +
                                       2
                                    
                                 
                                 ]
                              
                            assuming that the expression 
                              
                                 [
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ]
                              
                            for the previous one is already known. The way of updating the expression will depend on the reason why 
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                              
                            was an event in the first place, but it is straightforward to verify that the number of changes in each case are constant (for example, a point may change from set 
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                            to 
                              
                                 
                                    
                                       S
                                    
                                    
                                       3
                                    
                                 
                              
                           , and this will affect the coefficients of the corresponding 
                              
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                              
                            terms).

Thus, we conclude that 
                              
                                 Φ
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       α
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       α
                                    
                                 
                                 )
                                 ,
                                 0
                                 ⩽
                                 α
                                 ⩽
                                 
                                    
                                       π
                                    
                                    
                                       4
                                    
                                 
                              
                           , can be minimized in 
                              
                                 O
                                 (
                                 n
                                 )
                              
                            time by considering the subproblems 
                              
                                 Φ
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       α
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       α
                                    
                                 
                                 )
                              
                            in 
                              
                                 [
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ]
                              
                            for 
                              
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 -
                                 1
                              
                            independently. Since there are n candidates for p and 
                              
                                 2
                                 n
                              
                            candidates for 
                              
                                 ℓ
                              
                           , then an overall 
                              
                                 O
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                           -time algorithm is obtained.

We can proceed similarly in order to solve the second case. We find an optimal solution 
                              
                                 (
                                 u
                                 ,
                                 h
                                 )
                              
                            for each vertex u of the grid G as follows. Let u be a vertex of G. Given an angle 
                              
                                 α
                              
                           , let 
                              
                                 
                                    
                                       h
                                    
                                    
                                       α
                                    
                                 
                              
                            be the line passing through u, whose angle with respect to the positive direction of the x-axis is equal to 
                              
                                 α
                              
                           . Then, by Corollary 5, we look for an angle 
                              
                                 α
                                 ∈
                                 (
                                 
                                    
                                       φ
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       4
                                    
                                 
                                 ]
                              
                            such that the objective function 
                              
                                 Φ
                                 (
                                 u
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       α
                                    
                                 
                                 )
                              
                            is minimized. It follows from Eq. (6) that the expression of 
                              
                                 Φ
                                 (
                                 u
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       α
                                    
                                 
                                 )
                              
                            has the form 
                              
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 tan
                                 α
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                                 cot
                                 α
                                 +
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             4
                                          
                                       
                                    
                                    
                                       cos
                                       α
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             5
                                          
                                       
                                    
                                    
                                       sin
                                       α
                                    
                                 
                              
                            for any 
                              
                                 α
                                 ∈
                                 (
                                 
                                    
                                       φ
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       4
                                    
                                 
                                 ]
                              
                           , where 
                              
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       5
                                    
                                 
                              
                            are constants. If we progressively increase 
                              
                                 α
                              
                            from 
                              
                                 
                                    
                                       φ
                                    
                                    
                                       v
                                    
                                 
                              
                            to 
                              
                                 
                                    
                                       π
                                    
                                    
                                       4
                                    
                                 
                              
                            the values of 
                              
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       5
                                    
                                 
                              
                            keep unchanged as long as 
                              
                                 
                                    
                                       h
                                    
                                    
                                       α
                                    
                                 
                              
                            does not cross a demand point. The sorted sequence of values of 
                              
                                 α
                              
                            in which it happens can be obtained in linear time by using again the dual arrangement of S (O’Rourke, 1998). That sequence of values induces a partition of the interval 
                              
                                 (
                                 
                                    
                                       φ
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       4
                                    
                                 
                                 ]
                              
                            into intervals where in each of them the expression of 
                              
                                 Φ
                                 (
                                 u
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       α
                                    
                                 
                                 )
                              
                            is constant. We can now continue as was done above to solve the first case. Since G has 
                              
                                 O
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            vertices then an overall 
                              
                                 O
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                           -time algorithm is thus obtained. The result follows. □

Note that, since our algorithm makes an exhaustive search of local minima, it can be modified so that all optimal solutions are reported instead of just giving one. Further note that, for simplicity in the exposition, our algorithm locates an infinitely long highway. However, we can make it finite as follows: let R be the smallest axis-aligned rectangle containing all points of S. It is straightforward to see that no shortest path from a point of S to f will ever leave R. Thus, portions of h that are outside R can be discarded and the cost associated with that solution will not change. Thus, the highway’s length will never exceed 
                              
                                 
                                    
                                       2
                                    
                                 
                                 D
                              
                           , where D is the largest 
                              
                                 
                                    
                                       L
                                    
                                    
                                       ∞
                                    
                                 
                              
                            distance between any two points of S.

We have presented two different methods for searching the best solution that satisfies conditions (a) and (b) of Lemma 4, respectively. Both methods run in 
                        
                           O
                           (
                           
                              
                                 n
                              
                              
                                 3
                              
                           
                           )
                        
                      time. Naturally, the optimal solution will be the one whose associated cost is smaller. In the following we show that for “reasonable” values of speed v we can simplify the algorithm given in the proof of Theorem 6 by finding only optimal solutions that satisfy Lemma 4(a). We will use the next technical lemma.
                        Lemma 7
                        
                           Let 
                           
                              
                                 a
                                 ,
                                 
                                 b
                                 ,
                                 
                                 c
                              
                           
                           , and 
                           
                              
                                 v
                                 >
                                 
                                    
                                       3
                                       
                                          
                                             2
                                          
                                       
                                    
                                    
                                       4
                                    
                                 
                              
                            
                           be non-negative constants. Consider the function 
                           
                              
                                 F
                                 :
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 →
                                 R
                              
                            
                           defined by
                           
                              
                                 
                                    F
                                    (
                                    x
                                    )
                                    =
                                    a
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   -
                                                   v
                                                   sin
                                                   x
                                                
                                                
                                                   cos
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    +
                                    b
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   -
                                                   v
                                                   cos
                                                   x
                                                
                                                
                                                   sin
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    +
                                    c
                                 
                              
                           
                           for all 
                           
                              
                                 x
                                 ∈
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                           . Then next statements are true:
                           
                              
                                 (a)
                                 
                                    If 
                                    
                                       
                                          a
                                          =
                                          0
                                       
                                     
                                    and 
                                    
                                       
                                          b
                                          =
                                          0
                                       
                                     
                                    then F is constant.
                                 


                                    If 
                                    
                                       
                                          a
                                          >
                                          0
                                       
                                     
                                    and 
                                    
                                       
                                          b
                                          =
                                          0
                                       
                                     
                                    then F is monotone decreasing.
                                 


                                    If 
                                    
                                       
                                          a
                                          =
                                          0
                                       
                                     
                                    and 
                                    
                                       
                                          b
                                          >
                                          0
                                       
                                     
                                    then F is monotone increasing.
                                 


                                    If 
                                    
                                       
                                          a
                                          >
                                          0
                                       
                                     
                                    and 
                                    
                                       
                                          b
                                          >
                                          0
                                       
                                     
                                    then F has no minima.
                                 

Statement (a) is immediate. Let 
                              
                                 
                                    
                                       F
                                    
                                    
                                       ′
                                    
                                 
                              
                            be the first derivative of F and observe that:
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    a
                                    
                                       
                                          
                                             
                                                
                                                   sin
                                                   x
                                                   -
                                                   v
                                                
                                                
                                                   
                                                      
                                                         cos
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    +
                                    b
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                   -
                                                   cos
                                                   x
                                                
                                                
                                                   
                                                      
                                                         sin
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   x
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           If 
                              
                                 a
                                 >
                                 0
                              
                            and 
                              
                                 b
                                 =
                                 0
                              
                            then 
                              
                                 
                                    
                                       lim
                                    
                                    
                                       x
                                       ↓
                                       0
                                    
                                 
                                 F
                                 (
                                 x
                                 )
                                 =
                                 a
                              
                           , 
                              
                                 
                                    
                                       lim
                                    
                                    
                                       x
                                       ↑
                                       
                                          
                                             π
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 F
                                 (
                                 x
                                 )
                                 =
                                 -
                                 ∞
                              
                           , and 
                              
                                 
                                    
                                       F
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 <
                                 0
                              
                            in 
                              
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            since 
                              
                                 v
                                 >
                                 1
                              
                           . Therefore, 
                              
                                 F
                                 (
                                 x
                                 )
                              
                            is a monotone decreasing function and statement (b) thus holds.

If 
                              
                                 a
                                 =
                                 0
                              
                            and 
                              
                                 b
                                 >
                                 0
                              
                            then 
                              
                                 
                                    
                                       lim
                                    
                                    
                                       x
                                       ↓
                                       0
                                    
                                 
                                 F
                                 (
                                 x
                                 )
                                 =
                                 -
                                 ∞
                              
                           , 
                              
                                 
                                    
                                       lim
                                    
                                    
                                       x
                                       ↑
                                       
                                          
                                             π
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 F
                                 (
                                 x
                                 )
                                 =
                                 b
                              
                           , and 
                              
                                 
                                    
                                       F
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 >
                                 0
                              
                            in 
                              
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            since 
                              
                                 v
                                 >
                                 1
                              
                           . Therefore, 
                              
                                 F
                                 (
                                 x
                                 )
                              
                            is a monotone increasing function and statement (c) thus holds.

Consider 
                              
                                 a
                                 >
                                 0
                              
                            and 
                              
                                 b
                                 >
                                 0
                              
                           . Since 
                              
                                 
                                    
                                       lim
                                    
                                    
                                       x
                                       ↓
                                       0
                                    
                                 
                                 F
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       lim
                                    
                                    
                                       x
                                       ↑
                                       
                                          
                                             π
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 F
                                 (
                                 x
                                 )
                                 =
                                 -
                                 ∞
                              
                            it suffices to prove that equation 
                              
                                 
                                    
                                       F
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 0
                              
                            has only one solution which must be a global maximum of F. Equation 
                              
                                 
                                    
                                       F
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 0
                              
                            is equivalent to equation
                              
                                 
                                    G
                                    (
                                    x
                                    )
                                    
                                    ≔
                                    
                                    
                                       
                                          
                                             
                                                sin
                                             
                                             
                                                2
                                             
                                          
                                          x
                                          (
                                          v
                                          -
                                          sin
                                          x
                                          )
                                       
                                       
                                          
                                             
                                                cos
                                             
                                             
                                                2
                                             
                                          
                                          x
                                          (
                                          v
                                          -
                                          cos
                                          x
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          a
                                       
                                    
                                 
                              
                           We will prove that equation 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 0
                              
                            has no solution in 
                              
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           , which implies that equation 
                              
                                 G
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       a
                                    
                                 
                              
                            has a unique solution in 
                              
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            because 
                              
                                 
                                    
                                       lim
                                    
                                    
                                       x
                                       ↓
                                       0
                                    
                                 
                                 G
                                 (
                                 x
                                 )
                                 =
                                 0
                                 <
                                 
                                    
                                       b
                                    
                                    
                                       a
                                    
                                 
                                 <
                                 +
                                 ∞
                                 =
                                 
                                    
                                       lim
                                    
                                    
                                       x
                                       ↑
                                       
                                          
                                             π
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 G
                                 (
                                 x
                                 )
                              
                           . This will complete the proof.

It is straightforward to see that equation 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 0
                              
                            is equivalent to equation
                              
                                 
                                    H
                                    (
                                    x
                                    )
                                    
                                    ≔
                                    
                                    2
                                    (
                                    v
                                    -
                                    sin
                                    x
                                    )
                                    (
                                    v
                                    -
                                    cos
                                    x
                                    )
                                    +
                                    sin
                                    x
                                    cos
                                    x
                                    (
                                    1
                                    -
                                    v
                                    (
                                    sin
                                    x
                                    +
                                    cos
                                    x
                                    )
                                    )
                                    =
                                    0
                                 
                              
                           Consider the function 
                              
                                 I
                                 :
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 →
                                 R
                              
                            so that
                              
                                 
                                    I
                                    (
                                    x
                                    )
                                    =
                                    2
                                    (
                                    v
                                    -
                                    sin
                                    x
                                    )
                                    (
                                    v
                                    -
                                    cos
                                    x
                                    )
                                    +
                                    sin
                                    x
                                    cos
                                    x
                                    (
                                    1
                                    -
                                    
                                       
                                          2
                                       
                                    
                                    v
                                    )
                                 
                              
                           for all 
                              
                                 x
                                 ∈
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           . Since 
                              
                                 sin
                                 x
                                 +
                                 cos
                                 x
                                 ⩽
                                 
                                    
                                       2
                                    
                                 
                              
                            and 
                              
                                 sin
                                 x
                                 cos
                                 x
                                 >
                                 0
                              
                            for all 
                              
                                 x
                                 ∈
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           , we have 
                              
                                 H
                                 (
                                 x
                                 )
                                 ⩾
                                 I
                                 (
                                 x
                                 )
                              
                            for all 
                              
                                 x
                                 ∈
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           . We now show that the minimum of 
                              
                                 I
                                 (
                                 x
                                 )
                              
                            in 
                              
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            is greater than zero, implying equation 
                              
                                 H
                                 (
                                 x
                                 )
                                 =
                                 0
                              
                            has no solution.
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    2
                                    (
                                    -
                                    cos
                                    x
                                    (
                                    v
                                    -
                                    cos
                                    x
                                    )
                                    +
                                    sin
                                    x
                                    (
                                    v
                                    -
                                    sin
                                    x
                                    )
                                    )
                                    +
                                    (
                                    1
                                    -
                                    
                                       
                                          2
                                       
                                    
                                    v
                                    )
                                    (
                                    
                                       
                                          cos
                                       
                                       
                                          2
                                       
                                    
                                    x
                                    -
                                    
                                       
                                          sin
                                       
                                       
                                          2
                                       
                                    
                                    x
                                    )
                                    =
                                    2
                                    (
                                    cos
                                    x
                                    -
                                    sin
                                    x
                                    )
                                    (
                                    cos
                                    x
                                    +
                                    sin
                                    x
                                    -
                                    v
                                    )
                                    +
                                    (
                                    1
                                    -
                                    
                                       
                                          2
                                       
                                    
                                    v
                                    )
                                    (
                                    cos
                                    x
                                    -
                                    sin
                                    x
                                    )
                                    (
                                    cos
                                    x
                                    +
                                    sin
                                    x
                                    )
                                    =
                                    (
                                    cos
                                    x
                                    -
                                    sin
                                    x
                                    )
                                    
                                       
                                          
                                             (
                                             3
                                             -
                                             
                                                
                                                   2
                                                
                                             
                                             v
                                             )
                                             (
                                             sin
                                             x
                                             +
                                             cos
                                             x
                                             )
                                             -
                                             2
                                             v
                                          
                                       
                                    
                                 
                              
                           If 
                              
                                 3
                                 -
                                 
                                    
                                       2
                                    
                                 
                                 v
                                 <
                                 0
                              
                            then there is no 
                              
                                 x
                                 ∈
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            such that 
                              
                                 (
                                 3
                                 -
                                 
                                    
                                       2
                                    
                                 
                                 v
                                 )
                                 (
                                 sin
                                 x
                                 +
                                 cos
                                 x
                                 )
                                 -
                                 2
                                 v
                                 =
                                 0
                              
                            because 
                              
                                 sin
                                 x
                                 +
                                 cos
                                 x
                                 >
                                 0
                              
                            for all 
                              
                                 x
                                 ∈
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           . Suppose 
                              
                                 3
                                 -
                                 
                                    
                                       2
                                    
                                 
                                 v
                                 ⩾
                                 0
                              
                           . Then we have:
                              
                                 
                                    (
                                    3
                                    -
                                    
                                       
                                          2
                                       
                                    
                                    v
                                    )
                                    (
                                    sin
                                    x
                                    +
                                    cos
                                    x
                                    )
                                    -
                                    2
                                    v
                                    ⩽
                                    (
                                    3
                                    -
                                    
                                       
                                          2
                                       
                                    
                                    v
                                    )
                                    
                                       
                                          2
                                       
                                    
                                    -
                                    2
                                    v
                                    =
                                    3
                                    
                                       
                                          2
                                       
                                    
                                    -
                                    4
                                    v
                                    <
                                    0
                                 
                              
                           and thus there is no 
                              
                                 x
                                 ∈
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            such that 
                              
                                 (
                                 3
                                 -
                                 
                                    
                                       2
                                    
                                 
                                 v
                                 )
                                 (
                                 sin
                                 x
                                 +
                                 cos
                                 x
                                 )
                                 -
                                 2
                                 v
                                 =
                                 0
                              
                           . Therefore, 
                              
                                 
                                    
                                       I
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 0
                              
                            if and only if 
                              
                                 cos
                                 x
                                 -
                                 sin
                                 x
                                 =
                                 0
                              
                           , that is, 
                              
                                 x
                                 =
                                 
                                    
                                       π
                                    
                                    
                                       4
                                    
                                 
                              
                           . Let us prove that
                              
                                 
                                    I
                                    
                                       
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                    
                                    =
                                    2
                                    
                                       
                                          
                                             
                                                v
                                                -
                                                
                                                   
                                                      
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   2
                                                
                                             
                                             v
                                          
                                       
                                    
                                    =
                                    2
                                    
                                       
                                          v
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    
                                       
                                          5
                                          
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    v
                                    +
                                    
                                       
                                          3
                                       
                                       
                                          2
                                       
                                    
                                    >
                                    0
                                    .
                                 
                              
                           The roots of polynomial 
                              
                                 P
                                 (
                                 x
                                 )
                                 
                                 ≔
                                 
                                 2
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 
                                    
                                       5
                                       
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 x
                                 +
                                 
                                    
                                       3
                                    
                                    
                                       2
                                    
                                 
                              
                            are equal to 
                              
                                 
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                5
                                                
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                5
                                                
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       3
                                       
                                          
                                             2
                                          
                                       
                                    
                                    
                                       4
                                    
                                 
                              
                           , respectively. Then we conclude that 
                              
                                 P
                                 (
                                 v
                                 )
                                 =
                                 I
                                 
                                    
                                       
                                          
                                             
                                                π
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                 
                                 >
                                 0
                              
                            because the main coefficient of 
                              
                                 P
                                 (
                                 x
                                 )
                              
                            is positive, 
                              
                                 
                                    
                                       3
                                       
                                          
                                             2
                                          
                                       
                                    
                                    
                                       4
                                    
                                 
                              
                            is the greatest root of 
                              
                                 P
                                 (
                                 x
                                 )
                              
                           , and 
                              
                                 v
                                 >
                                 
                                    
                                       3
                                       
                                          
                                             2
                                          
                                       
                                    
                                    
                                       4
                                    
                                 
                              
                           . Since 
                              
                                 
                                    
                                       lim
                                    
                                    
                                       x
                                       ↓
                                       0
                                    
                                 
                                 I
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       lim
                                    
                                    
                                       x
                                       ↑
                                       
                                          
                                             π
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 I
                                 (
                                 x
                                 )
                                 =
                                 2
                                 v
                                 (
                                 v
                                 -
                                 1
                                 )
                                 >
                                 0
                              
                            and 
                              
                                 I
                                 (
                                 x
                                 )
                                 >
                                 0
                              
                            at the unique extreme point 
                              
                                 x
                                 =
                                 
                                    
                                       π
                                    
                                    
                                       4
                                    
                                 
                              
                           , then 
                              
                                 I
                                 (
                                 x
                                 )
                                 >
                                 0
                              
                            for all 
                              
                                 x
                                 ∈
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           . Therefore, 
                              
                                 H
                                 (
                                 x
                                 )
                                 >
                                 0
                              
                            for all 
                              
                                 x
                                 ∈
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           , equation 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                              
                            has no solution in 
                              
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           , and then 
                              
                                 F
                                 (
                                 x
                                 )
                              
                            has only one extreme point in 
                              
                                 (
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            which is a global maximum. The lemma follows.□


                           If speed v is greater than 
                           
                              
                                 
                                    
                                       3
                                       
                                          
                                             2
                                          
                                       
                                    
                                    
                                       4
                                    
                                 
                                 ≈
                                 1.06
                              
                           
                           , then there always exists an optimal solution 
                           
                              
                                 (
                                 f
                                 ,
                                 h
                                 )
                              
                            
                           of the FFL-problem satisfying 
                           
                              Lemma 4
                           (a), that is, h contains a point of S and f is on a line of grid G.
                        

It suffices to show that for every solution 
                              
                                 (
                                 f
                                 ,
                                 h
                                 )
                              
                           , there exists another solution 
                              
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                            satisfying Lemma 4(a) and 
                              
                                 Φ
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⩽
                                 Φ
                                 (
                                 f
                                 ,
                                 h
                                 )
                              
                           . The proof is as follows.

Let 
                              
                                 (
                                 f
                                 ,
                                 h
                                 )
                              
                            be a solution of the FFL-problem so that h contains no demand point. Assume here that angle 
                              
                                 α
                              
                            satisfies 
                              
                                 0
                                 ⩽
                                 α
                                 <
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                              
                           . If 
                              
                                 α
                              
                            is such that 
                              
                                 0
                                 ⩽
                                 α
                                 ⩽
                                 
                                    
                                       φ
                                    
                                    
                                       v
                                    
                                 
                              
                           , then the result follows from Corollary 5. Therefore, assume 
                              
                                 
                                    
                                       φ
                                    
                                    
                                       v
                                    
                                 
                                 <
                                 α
                                 ⩽
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                              
                           . We proceed to prove that there exists another solution 
                              
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                            such that 
                              
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                              
                            contains a demand point and 
                              
                                 Φ
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⩽
                                 Φ
                                 (
                                 f
                                 ,
                                 h
                                 )
                              
                           . Consider the sets 
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 f
                                 ,
                                 h
                                 )
                              
                            and 
                              
                                 
                                    
                                       S
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 f
                                 ,
                                 h
                                 )
                              
                            as defined before.

Given an angle 
                              
                                 β
                                 ∈
                                 [
                                 
                                    
                                       φ
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           , let 
                              
                                 
                                    
                                       h
                                    
                                    
                                       β
                                    
                                 
                              
                            be the line passing through f so that the angle between 
                              
                                 
                                    
                                       h
                                    
                                    
                                       β
                                    
                                 
                              
                            and the positive direction of the x-axis is equal to 
                              
                                 β
                              
                           . Observe then by Eq. (6) that:
                              
                                 
                                    Φ
                                    (
                                    f
                                    ,
                                    h
                                    )
                                    =
                                    Φ
                                    (
                                    f
                                    ,
                                    
                                       
                                          h
                                       
                                       
                                          α
                                       
                                    
                                    )
                                    =
                                    a
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   -
                                                   v
                                                   sin
                                                   α
                                                
                                                
                                                   cos
                                                   α
                                                
                                             
                                          
                                       
                                    
                                    +
                                    b
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   -
                                                   v
                                                   cos
                                                   α
                                                
                                                
                                                   sin
                                                   α
                                                
                                             
                                          
                                       
                                    
                                    +
                                    c
                                 
                              
                           where 
                              
                                 a
                                 ,
                                 b
                              
                           , and c are non-negative constants that depend on the coordinates of the demand points and the speed v. Then we can argue what follows by both noting that 
                              
                                 a
                                 >
                                 0
                              
                            (resp. 
                              
                                 b
                                 >
                                 0
                              
                           ) if and only if 
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                            (resp. 
                              
                                 
                                    
                                       S
                                    
                                    
                                       3
                                    
                                 
                              
                           ) is not empty and using Lemma 7.

We can rotate h with center f by either increasing or decreasing 
                              
                                 α
                              
                            to the value 
                              
                                 
                                    
                                       α
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 [
                                 
                                    
                                       φ
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            in such a way that a solution 
                              
                                 (
                                 f
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                              
                            is obtained, where either 
                              
                                 
                                    
                                       α
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       φ
                                    
                                    
                                       v
                                    
                                 
                              
                            or 
                              
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                            contains a demand point of 
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 ∪
                                 
                                    
                                       S
                                    
                                    
                                       3
                                    
                                 
                              
                           , and 
                              
                                 Φ
                                 (
                                 f
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                                 ⩽
                                 Φ
                                 (
                                 f
                                 ,
                                 h
                                 )
                              
                           . If 
                              
                                 
                                    
                                       α
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       φ
                                    
                                    
                                       v
                                    
                                 
                              
                            then the result follows from Corollary 5. Otherwise, if 
                              
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                            contains a demand point of 
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 ∪
                                 
                                    
                                       S
                                    
                                    
                                       3
                                    
                                 
                              
                           , then 
                              
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 (
                                 f
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                              
                            is the desired solution, and to finalize the proof, we translate 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                              
                            along 
                              
                                 
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                              
                           , if necessary, as was done in the proof of Lemma 4, in order to ensure 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                              
                            belongs to a line of grid G. The result thus follows.□

In this section, we explore examples of the FFL-problem, and show that all of our characterizations can happen. The instances consist of the nine demand points 
                        
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 p
                              
                              
                                 9
                              
                           
                        
                     ; each demand point is represented by a solid dot and labeled with three numbers (the first two are the coordinates, and the third component is its weight). Facility point f is represented by a cross, and the highway is depicted with a solid blue line. The solution to each problem instance has been found with a small implementation of our problem.

First, we consider the case in which the highway’s speed is small (i.e., 
                        
                           v
                           <
                           
                              
                                 3
                                 
                                    
                                       2
                                    
                                 
                              
                              
                                 4
                              
                           
                        
                     ). We construct two examples whose solutions satisfy Lemma 4(a) and Lemma 4(b), respectively. An example of the former can be seen in Fig. 5
                     , where the highway’s speed is 
                        
                           v
                           =
                           1.02
                        
                     . The solution to this problem instance places the facility at position 
                        
                           f
                           =
                           (
                           -
                           1
                           ,
                           -
                           0.978
                           )
                        
                     . Note that h also passes through point 
                        
                           
                              
                                 p
                              
                              
                                 3
                              
                           
                        
                     , and f is vertically aligned with 
                        
                           
                              
                                 p
                              
                              
                                 5
                              
                           
                        
                     . The cost associated with this solution is 
                        
                           Φ
                           (
                           f
                           ,
                           h
                           )
                           =
                           512.78
                        
                     .

In Fig. 6
                      we present a different example consisting of nine demand points for which optimal solutions satisfy only Lemma 4(b). In the example, the highway’s speed v is equal to 
                        
                           1.04
                           <
                           
                              
                                 3
                                 
                                    
                                       2
                                    
                                 
                              
                              
                                 4
                              
                           
                        
                     . The location of the highway in the optimal solution contains no demand point. Note that the facility 
                        
                           f
                           =
                           (
                           0
                           ,
                           0
                           )
                        
                      is on a vertex of grid G instead. Specifically, it is located on the horizontal line through 
                        
                           
                              
                                 p
                              
                              
                                 7
                              
                           
                        
                      and the vertical line through 
                        
                           
                              
                                 p
                              
                              
                                 6
                              
                           
                        
                     . The value of 
                        
                           Φ
                           (
                           f
                           ,
                           h
                           )
                        
                      is equal to 
                        
                           336.2
                        
                     .

We now give two examples where the highway’s speed is large (i.e., 
                        
                           v
                           >
                           
                              
                                 3
                                 
                                    
                                       2
                                    
                                 
                              
                              
                                 4
                              
                           
                        
                     ). As expected, all solutions satisfy Lemma 4(a). The first example is shown in Fig. 7
                     , where the highway’s speed is 
                        
                           v
                           =
                           1.2
                        
                     . The solution to this instance places the facility at 
                        
                           f
                           =
                           (
                           -
                           1
                           ,
                           -
                           0.14335
                           )
                        
                      and forces the highway to pass through 
                        
                           
                              
                                 p
                              
                              
                                 3
                              
                           
                        
                     . The cost of the objective function 
                        
                           Φ
                           (
                           f
                           ,
                           h
                           )
                        
                      associated with this instance is 
                        
                           525.83
                        
                     . Fig. 8
                      has the same set of clients, but the highway’s speed v has been increased to 
                        
                           1.5
                        
                     . As a result, the optimal solution changes as follows: the facility is placed at 
                        
                           f
                           =
                           (
                           -
                           1
                           ,
                           -
                           0.7758
                           )
                        
                     , and the highway now contains point 
                        
                           
                              
                                 p
                              
                              
                                 2
                              
                           
                        
                     . In both cases, the facility f is vertically aligned with 
                        
                           
                              
                                 p
                              
                              
                                 5
                              
                           
                        
                     . Notice that in this second case, all demand points move vertically to reach the highway according to the claims of Lemma 3. Since the speed has been increased, the value of the objective function 
                        
                           Φ
                           (
                           f
                           ,
                           h
                           )
                        
                      reduces to 
                        
                           471.55
                        
                     .

We have solved in 
                        
                           O
                           (
                           
                              
                                 n
                              
                              
                                 3
                              
                           
                           )
                        
                      time the problem of locating at the same time a facility point and a freeway of variable length, among a set of demand points, in order to minimize the total weighted travel time from the demand points to the facility. Some examples are presented to show that there exist optimal solutions corresponding to each type of solutions that our algorithm considers. The main open problem is to improve the time complexities, mainly to reduce that of the case in which the highway contains a client point. Examples can be constructed to show that if we restrict the highway to contain a given demand point, and continuously rotate it with center at that point from angle 
                        
                           α
                           =
                           
                              
                                 φ
                              
                              
                                 v
                              
                           
                        
                      to angle 
                        
                           α
                           =
                           
                              
                                 π
                              
                              
                                 4
                              
                           
                        
                     , then the optimal position of the facility can move 
                        
                           Ω
                           (
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           )
                        
                      times from one line of G to another.

A natural restriction to be considered in further research of this problem is that the highway has fixed length. In this case, there also exist optimal solutions in which the facility point belongs to the highway. Observe that Lemma 1 still holds since the length of the highway was not altered in its proof. It is not hard to see that when the highway’s length is fixed, the shortest paths from the demand points to the facility point can be discretized as follows. If 
                        
                           0
                           ⩽
                           α
                           ⩽
                           
                              
                                 φ
                              
                              
                                 v
                              
                           
                        
                     , then we distinguish three regions 
                        
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           ,
                           
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        
                     , and 
                        
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        
                      as depicted in Fig. 9
                     (a). The points belonging to 
                        
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           ∪
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        
                      move to the nearest endpoint of h, and the points of 
                        
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        
                      move vertically to h. Otherwise, if 
                        
                           
                              
                                 φ
                              
                              
                                 v
                              
                           
                           <
                           α
                           ⩽
                           
                              
                                 π
                              
                              
                                 4
                              
                           
                        
                     , then eight regions 
                        
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 R
                              
                              
                                 8
                              
                           
                        
                      can be identified as shown in Fig. 9(b). The points of 
                        
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           ∪
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        
                      move to the nearest endpoint of h, the points of 
                        
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           ∪
                           
                              
                                 R
                              
                              
                                 4
                              
                           
                        
                      move directly to f, the points of 
                        
                           
                              
                                 R
                              
                              
                                 5
                              
                           
                           ∪
                           
                              
                                 R
                              
                              
                                 6
                              
                           
                        
                      move horizontally to h, and the points of 
                        
                           
                              
                                 R
                              
                              
                                 7
                              
                           
                           ∪
                           
                              
                                 R
                              
                              
                                 8
                              
                           
                        
                      move vertically to h.

We believe that with the above discretization, the search space of optimal solutions can be simplified by using a similar (and more detailed) statement as Lemma 4. This will permit to obtain an algorithm similar to the one presented in Theorem 6.

Another variant to be considered in further research is the problem of locating at the same time the facility point and a turnpike of variable length. This will extend the results of this paper and the results of Díaz-Báñez et al. (2013) and Espejo and Rodríguez-Chía (2011).

@&#REFERENCES@&#

