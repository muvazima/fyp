@&#MAIN-TITLE@&#Spectral clustering applied for dynamic contrast-enhanced MR analysis of time–intensity curves

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Original method to analysis dynamic contrast enhanced MR time–intensity signals.


                        
                        
                           
                           Spectral space transformation and non-supervised clustering.


                        
                        
                           
                           Validation on simulated and clinical data.


                        
                        
                           
                           Comparison with state of art techniques.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Curves analysis

Dynamic contrast-enhanced (DCE)–magnetic resonance imaging (MRI)

Non-parametric analysis

Spectral clustering

@&#ABSTRACT@&#


               
               
                  Dynamic contrast-enhanced (DCE)–magnetic resonance imaging (MRI) represents an emerging method for the prediction of biomarker responses in cancer. However, DCE images remain difficult to analyze and interpret. Although pharmacokinetic approaches, which involve multi-step processes, can provide a general framework for the interpretation of these data, they are still too complex for robust and accurate implementation. Therefore, statistical data analysis techniques were recently suggested as another valid interpretation strategy for DCE–MRI.
                  In this context, we propose a spectral clustering approach for the analysis of DCE–MRI time–intensity signals. This graph theory-based method allows for the grouping of signals after spatial transformation. Subsequently, these data clusters can be labeled following comparison to arterial signals. Here, we have performed experiments with simulated (i.e., generated via pharmacokinetic modeling) and clinical (i.e., obtained from patients scanned during prostate cancer diagnosis) data sets in order to demonstrate the feasibility and applicability of this kind of unsupervised and non-parametric approach.
               
            

@&#INTRODUCTION@&#

Magnetic resonance imaging (MRI) has become a reference technique for the diagnosis and staging of several types of cancer, including prostate, breast, and liver tumors. The typical multiparametric MRI protocol involves morphologic acquisition of T1-weighted (T1W) and/or T2-weighted (T2W) images as well as functional imaging using diffusion, spectroscopy, and perfusion sequences. Indeed, perfusion or dynamic contrast enhanced (DCE) imaging, which is acquired following injection of a contrast agent, is commonly employed to enhance the characterization of early cancers prior to therapy and to monitor their progression during and after anti-angiogenic or mini invasive treatments [1]. Angiogenesis appears to play a central role in the growth and spread of tumors [2,3]. When a tumor grows, the capillary network proliferates due to the release of pro-angiogenic factors, and the permeability of capillary walls increases [4]. Also, it is known that DCE–MRI can allow the visualization of these aberrant microcirculation modifications, which represent a valid biomarker for cancer development [5,6].

DCE–MRI involves rapid and repeated acquisition of T1W images before, during, and after the injection of a low molecular weight paramagnetic contrast agent. There are three ways to analyze these time-dependent signal-intensity curves: qualitative, semi-quantitative, and quantitative.

Qualitative evaluation uses simple visual assessment, such as Kuhl's technique [7], whereas semi-quantitative analysis provides a set of parameters based on contrast agent dynamics (i.e., wash in [uptake], peak, and wash out [loss over time]) [8]. Although, the semi-quantitative method is reproducible, it can be heavily influenced by the selected protocol [9]. Moreover, it is not useful for precisely determining changes in contrast agent concentration, and therefore does not directly yield data on tissue physiology.

In contrast to the two previous approaches, quantitative analysis is based on a pharmacokinetic model. The model conceptualizes the exchange of a low-molecular weight contrast medium between the intravascular and the extravascular extracellular spaces (EES) in the tissue. The application of this model to DCE–MRI data makes it possible to establish physiologic parameters, such as vessel permeability, perfusion, blood volume, K
                     trans (transfer constant between blood plasma and EES), K
                     ep (exchange constant rate between EES and blood plasma), and V
                     e (extravascular extracellular volume) [10]. It should be noted that clinical implementation of this technique in routine imaging protocols has remained limited. This is due to the fact until 2012, there was no standardized and generally accepted protocols for DCE–MRI. In 2012, the Quantitative Imaging Biomarkers Alliance (QIBA) DCE–MRI Technical Committee from the Radiological Society of North America (RSNA) published recommendations to define basic standards for DCE–MRI measurements and quality control with the goal of promoting consistent and reliable results across platforms, clinical sites, and time [11]. According to these recommendations, QIBA DCE–MRI committee suggested the use of Toft's model as pharmacokinetic model.

However, quantitative signal analysis is a complex, multi-step process. In fact, several studies focusing on this technique have demonstrated the difficulty of reproducing and repeating these physiological parameter measurements [9,12]. Quantitative analysis involves T1 mapping, transformation of signal intensity time curves S(t) into contrast agent concentration time curves C(t), and arterial input function measurement (AIF). Moreover, several techniques and approaches can be applied to achieve each of these steps. To further complicate matters, there remains a lack of consensus regarding standardized cutoff values for K
                     trans, K
                     ep, and V
                     e for clinical applications.

To overcome the limitations of the methods in the literature, data analysis techniques were investigated for interpreting quantitative information [15] (Cluster analysis of the signal curves in perfusion DCE–MRI datasets). In fact, promising results were obtained without any prior knowledge of the underlying tissue vasculature and arterial input function. Indeed, no assumptions about the data distribution, pharmacokinetic model, or AIF model could be established. In these approaches, the aim was to group the voxels into homogeneous patterns that share the same properties. Each voxel is represented by a time–intensity curve, which is obtained by converting each frame of sequential images into a one-dimensional row signal vector. Each curve can then be characterized based on three states: wash in, peak, and wash out. Although these curves display similar shapes, their evolutions and magnitudes are tissue dependent. Fig. 1
                      depicts typical signatures for characterizing tissue health status (e.g., tumor, healthy, and suspicious tissues).

In addition, independent components analysis (ICA) has been used in recent studies [13,14]. In fact, Wu and Liu [13] applied ICA to the assessment of cerebral blood perfusion, analyzing the data as a summation of brain hemodynamic behaviors and external perturbations (head movements, physiological pulsations, and machine noise). Therefore, by assuming the spatial independence of the hemodynamic patterns and artificial processes, the ICA could be used to separate mixed signals and reveal brain hemodynamic abnormalities. On the other hand, Mehrabian et al. [14] developed an adaptive, complex ICA technique to distinguish extravascular and extracellular signals. This method was employed to calculate intravascular time–intensity curves, allowing separation of these signals during DCE–MRI of tumors.

Furthermore, Chen et al. [15] introduced a probabilistic based approach where compartmental analysis was combined with convex analysis in order to determine pixel-wise partial volume effects, which can result in mixing of more than one compartment. Notably, this method is parametric and assumes Gaussian distribution of signal curves. More recently, Agner et al. [16] introduced a spectral embedded active contour technique. They employed this spectral-based approach to perform non-linear dimensionality reduction to drive an active contour, which could be used to segment breast lesions on DCE–MRI. Notably, this study reported the first results concerning the applicability of spectral techniques for reducing image space in DCE.

In the present study, we investigated the use of a graph-based approach (i.e., spectral clustering) to analyze DCE–MRI time–intensity signals. In contrast to parametric methods, graph-based methods are non-parametric and do not require a priori assumptions about the size, shape, or distribution of clusters [17]. Our global approach was comprised of two steps: clustering and interpretation. The clustering step involved space embedding of the curves to make them linearly separable, and results were grouped based on homogenous patterns. On the other hand, the interpretation step was used to classify patterns according to their distance from the artery, with results presented as distance maps. This interpretation strategy is justified based on the assumption that tumor angiogenesis represents a principal factor that determines tumor growth and spread as well as increased capillary permeability. We propose that the map resulting from our approach could be combined with data obtained from other quantitative or qualitative methods in order to enhance DCE–MRI interpretation.

In the following sections, we provide a background on graph-based clustering as well as a description of theoretical aspects associated with spectral clustering. In addition, we describe the application of this technique to the analysis of DCE–MRI (Section 3), which was illustrated using experimental systems based on synthetic and clinical data (Section 4). Finally, we discuss the spectral clustering method along with our results and provide conclusions for our study (Section 5).

@&#BACKGROUND@&#

Graph-based clustering involves constructing a weighted graph in which the data points within each vertex are associated with a point, and the similarity between two points is determined by a weighted edge connecting the two vertices [18–20].

Let us consider a set of data points where X
                        ={x
                        1,…, x
                        
                           i
                        ,…, x
                        
                           n
                        }, with each x
                        
                           i
                        
                        =(x
                        
                           i1,…, x
                        
                           it
                        ,… x
                        
                           im
                        )T. We define an affinity graph G
                        =(V, E, W) as an undirected graph where the ith vertex in V corresponds to the point x
                        
                           i
                        , and each edge (i, j)∈
                        E is associated with a weight w
                        
                           ij
                        , which denotes the similarity (or affinity) of the points x
                        
                           i
                         and x
                        
                           j
                        . Moreover, the similarity matrix W
                        ∈
                        R
                        
                           n×n
                         is represented by the term w
                        
                           ij
                        , which can be of cosine, fuzzy, or Gaussian type. However, a Gaussian function (Eq. (1)) is often used in spectral clustering approaches:
                           
                              (1)
                              
                                 
                                    
                                       w
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    exp
                                    
                                       
                                          −
                                          
                                             1
                                             
                                                2
                                                
                                                   σ
                                                   2
                                                
                                             
                                          
                                          
                                             d
                                             2
                                          
                                          (
                                          
                                             x
                                             i
                                          
                                          ,
                                          
                                             x
                                             j
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        Here, the scaling parameter σ of the Gaussian function (1) is used in the similarity matrix to control how rapidly the similarity w
                        
                           ij
                         falls off in relation to the Euclidean distance, d(x
                        
                           i
                        , x
                        
                           j
                        ), between points x
                        
                           i
                         and x
                        
                           j
                        . Thus, the use of a Gaussian kernel instead of a linear model aims to accentuate the local influence.

There are various ways to construct a graph that represents the relationships between dataset x.
                           
                              •
                              Fully connected graphs: all vertices that have non-null similarities are connected with each other.


                                 ɛ-neighborhood graphs: each vertex is connected to vertices that fall inside a hyper-sphere of radius ɛ, where ɛ is a real value that must be tuned in order to contain the local data structure.


                                 k-nearest neighbor graphs: each vertex is connected to its k-nearest neighbors where k is an integer number that controls the local relationships between data.

Notably, k-nearest neighbor and ɛ-neighborhood graphs are the most suited for clustering problems [20].

The overall goal of spectral clustering is to partition the data into K clusters (groups), such that each x
                        
                           i
                         belongs to only one cluster. Thus, {V
                        1, …, V
                        
                           k
                        } denotes a partition of V, and for two subsets of V (V
                        1 and V
                        2), the similarity is defined by the objective cut function:
                           
                              (2)
                              
                                 
                                    C
                                    (
                                    
                                       V
                                       1
                                    
                                    ,
                                    
                                       V
                                       2
                                    
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          
                                             V
                                             1
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             j
                                             ∈
                                             
                                                V
                                                2
                                             
                                          
                                       
                                       
                                          
                                             w
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                           
                        This equation represents the sum of weight connections between V
                        1 and V
                        2.

Spectral clustering is typically used in its normalized form [19] by optimizing the following objective function:
                           
                              (3)
                              
                                 
                                    
                                       J
                                       
                                          n
                                          cut
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       k
                                    
                                    
                                       
                                          
                                             C
                                             (
                                             
                                                V
                                                i
                                             
                                             ,
                                             V
                                             )
                                             −
                                             C
                                             (
                                             
                                                V
                                                i
                                             
                                             ,
                                             
                                                V
                                                i
                                             
                                             )
                                          
                                          
                                             C
                                             (
                                             
                                                V
                                                i
                                             
                                             ,
                                             V
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        The numerator in the ith term is equal to the sum of the similarities leaving of the subset V
                        
                           i
                         and the denominator is equal to the total degree of the subset V
                        
                           i
                        . Minimizing the sum of these terms results in partitioning so that edges with large similarities tend to stay within the individual subsets V
                        
                           i
                         and that the volumes of V
                        
                           i
                         are balanced.

In its discrete form, the optimization problem is intractable when rewriting Eq. (3) in its normalized quadratic form, which involves indicator vectors. Also, spectral clustering applies a standard relaxation procedure, in which indicator vectors are replaced with real-valued vectors. This produces a generalized eigen-problem, which can be summarized conveniently in terms of the normalized graph Laplacian of W defined as follows:
                           
                              (4)
                              
                                 
                                    L
                                    =
                                    
                                       D
                                       
                                          −
                                          1
                                          /
                                          2
                                       
                                    
                                    (
                                    D
                                    −
                                    W
                                    )
                                    
                                       D
                                       
                                          −
                                          1
                                          /
                                          2
                                       
                                    
                                    =
                                    I
                                    −
                                    
                                       D
                                       
                                          −
                                          1
                                          /
                                          2
                                       
                                    
                                    W
                                    
                                       D
                                       
                                          −
                                          1
                                          /
                                          2
                                       
                                    
                                 
                              
                           
                        In this equation, D
                        =diag(d
                        1, …, d
                        
                           n
                        ) is the degree matrix, with 
                           
                              
                                 d
                                 i
                              
                              =
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 n
                              
                              
                                 
                                    w
                                    
                                       i
                                       j
                                    
                                 
                              
                           
                        , i
                        =1, …, n representing the degree of the ith vertex.

Spectral clustering algorithms typically consist of the following three basic steps [21]:
                           
                              1.
                              Pre-processingConstruct the graph and the similarity matrix to represent the dataset.

Spectral embedding

Form the associated Laplacian matrix.

Compute eigenvalues and eigenvectors of the Laplacian matrix.

Map each point to a lower-dimensional representation based on one or more eigenvectors.

ClusteringAssign points to two or more classes, based on the new representation.

The Gaussian kernel is the most common similarity function in the clustering domain, and its free parameter is the kernel radius σ. Notably, this parameter is often examined in standard spectral algorithms, and different σ values can result in vastly different clustering results.

Instead of selecting a single scaling parameter σ, a local scaling parameter σ
                        
                           i
                         for each data point x
                        
                           i
                         is calculated as previously described [22], where σ
                        
                           i
                        
                        =
                        d(x
                        
                           i
                        , x
                        
                           r(i)) is the distance between x
                        
                           i
                         and its rth neighbored x
                        
                           r(i). The selection of the rank r is scale independent and is usually between 7 and 10. Therefore, for each pair of points (x
                        
                           i
                        , x
                        
                           j
                        ), the connection weight w
                        
                           ij
                         is given by:
                           
                              (5)
                              
                                 
                                    
                                       w
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    exp
                                    
                                       
                                          −
                                          
                                             1
                                             
                                                2
                                                
                                                   σ
                                                   i
                                                
                                                
                                                   σ
                                                   j
                                                
                                             
                                          
                                          
                                             d
                                             2
                                          
                                          (
                                          
                                             x
                                             i
                                          
                                          ,
                                          
                                             x
                                             j
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        Indeed, using a specific scaling parameter for each data point allows for self-tuning of the point-to-point distances according to the local statistics of their neighborhoods.

After defining a scheme in order to set the scale parameter automatically, we are left with only one free parameter: the number of clusters.

The principal difficulty in spectral clustering algorithms is the estimation of the number of clusters. The eigengap technique, which is commonly used to estimate this number, is performed by searching for a drop in the magnitude of eigenvalues that are arranged in an increasing order. The goal of this method is to choose the number k of clusters, such that all eigenvalues λ
                        1, …, λ
                        
                           k
                         are very small, but the λ
                        
                           k+1 is relatively large. The gap between successive eigenvalues is defined as a difference:
                           
                              (6)
                              
                                 
                                    
                                       Δ
                                       k
                                    
                                    =
                                    
                                       
                                          
                                             λ
                                             k
                                          
                                          −
                                          
                                             λ
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Thus, the optimal number of clusters is given by:
                           
                              (7)
                              
                                 
                                    
                                       k
                                       ˆ
                                    
                                    =
                                    arg
                                     
                                    max
                                    (
                                    
                                       Δ
                                       k
                                    
                                    )
                                 
                              
                           
                        However, if the eigengap maximum is relatively small, it becomes hard to precisely estimate the number of clusters. In this regard, White and Smith proposed another approach [23], which employed a previously described graphing concept for identifying communities [24].

Their modularity function J
                        mod can be defined as:
                           
                              (8)
                              
                                 
                                    
                                       J
                                       
                                          mod
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       k
                                    
                                    
                                       
                                          1
                                          
                                             
                                                
                                                   
                                                      V
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                   (
                                                   
                                                      V
                                                      i
                                                   
                                                   ,
                                                   
                                                      V
                                                      i
                                                   
                                                   )
                                                
                                                
                                                   C
                                                   (
                                                   V
                                                   ,
                                                   V
                                                   )
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               C
                                                               (
                                                               
                                                                  V
                                                                  i
                                                               
                                                               ,
                                                               V
                                                               )
                                                            
                                                            
                                                               C
                                                               (
                                                               V
                                                               ,
                                                               V
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        In this equation, |V
                        
                           i
                        | is the cardinal of V
                        
                           i
                        , C(V
                        
                           i
                        , V
                        
                           i
                        ) for measuring the within-cluster sum of weights, whereas C(V
                        
                           i
                        , V) measures the sum of weights over all edges attached to vertices in cluster i, and C(V, V) measures the sum of all edges in the graph. Modularity function is computed versus the number of clusters, with the maximum value yielding the estimated number of clusters.

More recently, Yu and Ding [25], showed that Eq. (8) was related to ratio-cut, and they proposed to solve modularity clustering via normalized cut using the following objective function:
                           
                              (9)
                              
                                 
                                    
                                       J
                                       
                                          n
                                          mod
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       k
                                    
                                    
                                       
                                          1
                                          
                                             C
                                             (
                                             
                                                V
                                                i
                                             
                                             ,
                                             V
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                   (
                                                   
                                                      V
                                                      i
                                                   
                                                   ,
                                                   
                                                      V
                                                      i
                                                   
                                                   )
                                                
                                                
                                                   C
                                                   (
                                                   V
                                                   ,
                                                   V
                                                   )
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               C
                                                               (
                                                               
                                                                  V
                                                                  i
                                                               
                                                               ,
                                                               V
                                                               )
                                                            
                                                            
                                                               C
                                                               (
                                                               V
                                                               ,
                                                               V
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        In the present work, we propose to compute J
                        
                           nmod based on the number of clusters k, with the estimated number of clusters corresponding to the maximum normalized modularity defined in Eq. (9).

A global description of our approach is presented in Fig. 2
                     . It was comprised of two steps: the first step involved clustering in order to classify the voxels into homogeneous classes and the second step introduced additional knowledge for cluster interpretation through comparison to reference signals extracted from the artery.

Time–intensity curves {x
                     1,…, x
                     
                        i
                     ,…, x
                     
                        n
                     } were obtained by converting each voxel of each frame (from the sequential images) into a 1D row, denoted by x
                     
                        i
                     
                     =(x
                     i1, …, x
                     
                        it
                     , …, x
                     
                        im
                     )
                        T
                     , where n is the total number of voxels and m represents the number of temporal scans (i.e., number of acquisitions). Notably, the curve signals were used as inputs for the clustering algorithm. In this context, a graph was constructed, in which each curve was associated with a vertex, and the edge weights between vertices were a function of the distance between their related curves. The data signal structure could then be defined by this graph and its associated Laplacian matrix.

A region of interest (ROI), surrounding the tissue to be analyzed, was selected by experts with knowledge of anatomy. In clinical practice, the quantitative analysis of these images was most often performed following a preliminary visual analysis in order to detect regions with contrast agent uptake.

Three processing steps were applied to the ROI.

The signal presented three characteristics that could interfere with the classification process: delayed bolus arrival, intensity, and noise. In order to properly record bolus arrival in the body, MRI acquisition was started prior to contrast agent injection. Notably, images acquired before injection could not provide information on tissue perfusion. Also, it was necessary to detect the peak time of contrast agent arrival to the study area because images needed to be acquired before this peak was achieved. Peak time could automatically be determined following artery detection. This step is detailed is Section 3.2.1.

The second pre-processing step aimed to reduce any amplitude effect. For this, normalization was applied as:
                              
                                 (10)
                                 
                                    
                                       
                                          x
                                          
                                             i
                                             t
                                          
                                       
                                       =
                                       
                                          
                                             
                                                x
                                                
                                                   i
                                                   t
                                                
                                             
                                             −
                                             min
                                             (
                                             
                                                x
                                                i
                                             
                                             )
                                          
                                          
                                             max
                                             (
                                             
                                                x
                                                i
                                             
                                             )
                                             −
                                             min
                                             (
                                             
                                                x
                                                i
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           The final pre-processing step involved filtering, where a sliding window of size 3 was applied to the wash out part of the curve. The goal of this step was to reduce noise without distorting peak position and magnitude.

The similarity matrix (W) was constructed based on the concept that each element wij represented the similarity between each pair of curves x
                           
                              i
                            and x
                           
                              j
                           . Thus, Eq. (1) of the previous section becomes:
                              
                                 (11)
                                 
                                    
                                       
                                          w
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       exp
                                       
                                          
                                             −
                                             
                                                1
                                                
                                                   2
                                                   
                                                      σ
                                                      i
                                                   
                                                   
                                                      σ
                                                      j
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         x
                                                         
                                                            i
                                                            t
                                                         
                                                      
                                                      −
                                                      
                                                         x
                                                         
                                                            j
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           In this equation, m is the number of temporal scans.

The choice of the techniques is justified by the fact that the analysis technique deals with the curves shapes rather than the absolute signals and its important to take into consideration the underlying physiological phenomenon. Moreover, this kind of techniques proved to be very efficient to deal with temporal signals ([15,26]). In a comparative study by Kruggel et al. [27] different smoothing techniques were tested and evaluated on temporal signals from functional MRI. One of the conclusions is that moving average filter exhibits competitive results.

The spectral representation was obtained by associating the eigenvectors of the Laplacian graph with the similarity matrix. Only the k top eigenvalues were kept, with k being the number of classes estimated in the next section (Fig. 3
                           ).

Estimation of the number of clusters was achieved using the normalized modularity criterion, J
                           nmod (Eq. (9)). The algorithm was iterated by varying the class numbers starting from two. For each iteration, the modularity criterion was computed, with its maximum defining the number of classes. Fig. 4
                            shows an example where the optimal number of classes is three.

As a result of spectral transformation (Fig. 3), the projected data could be easily separated using a simple algorithm like k-means. However, in order to overcome any initialization weakness of k-means, we randomly generated the initialization 100 times, selecting the best solution according to the mean square error criterion between the centers of the calculated classes and the elements contained in those classes. At the end of this procedure, the clusters could be used to label the signal curves (Fig. 2), and therefore their corresponding voxels.

In order to provide a label or interpretation for each cluster, a distance criterion was defined based on quantification of signal behaviors in the cluster using reference behaviors, which were extracted from the artery. This interpretation strategy was justified by the assumption that angiogenesis is one of the factors contributing to the growth and spread of tumors, inducing increased permeability of capillary walls. For this purpose, the artery needs to be detected.

Utilizing an approach proposed by Chen et al. [28], we have developed an arterial detection strategy. The temporal signal of an artery can be characterized by high amplitude at time to peak (t
                           
                              p
                           ), a steep slope, and a spatially cylindrical shape (Fig. 5
                           ). Therefore, our method involved four filters to adjust certain parameters, including threshold, contrast detection, and spatial aspects.

Indeed, arteries display a large amount of contrast agent flowing through them, which can cause the image voxels of arteries to brighten more than most other voxels. For this reason, the peak height of an artery is typically higher than most others. Thus, we first implemented a thresholding filter following Eq. (12). It allowed for the removal of voxels with small peak curves.
                              
                                 (12)
                                 
                                    
                                       x
                                       (
                                       
                                          t
                                          p
                                       
                                       )
                                       <
                                       μ
                                    
                                 
                              
                           Here, x(t) signifies the time-intensity values, t
                           
                              p
                            is the time to peak, and μ represents the mean peak values of all voxels in the image corresponding to the t
                           
                              p
                            position.

The second filter was employed to detect fast contrast during wash in of contrast agent in artery voxels. For this, the signal enhancement ratio at each time point was computed using Eq. (13):
                              
                                 (13)
                                 
                                    
                                       R
                                       (
                                       t
                                       )
                                       =
                                       
                                          
                                             x
                                             (
                                             t
                                             )
                                          
                                          
                                             
                                                x
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                           R(t) represents the ratio of signal enhancement from baseline to time t and x
                           0 is the baseline signal, which was computed as the average signal of the time points during the wash in. The slope was defined by Eq. (14):
                              
                                 (14)
                                 
                                    
                                       slope
                                       =
                                       
                                          
                                             R
                                             (
                                             
                                                t
                                                p
                                             
                                             )
                                             −
                                             1
                                          
                                          
                                             
                                                t
                                                p
                                             
                                          
                                       
                                    
                                 
                              
                           Only the top 20% greatest slopes were retained as arterial candidates.

The two previous filters dealt with temporal aspects of the artery, whereas the two remaining filters pertain to spatial qualities. A region labeling process was applied in order to form distinguishable 2D connected components based on the candidate voxels from each axial slice. Also, a size filter was utilized to retain only those patterns with sufficient voxels to be part of an artery. For each voxel's pattern, the average peak time was calculated, and only those patterns with the lowest 20% of time to peak were kept.

The following step was used to calculate the circularity C
                           
                              z
                            of each remaining region following Eq. (15):
                              
                                 (15)
                                 
                                    
                                       
                                          C
                                          z
                                       
                                       =
                                       
                                          A
                                          
                                             
                                                P
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           Here, P represents the perimeter. It is computed by calculating the distance between each adjoining pair of voxels around the border of the region. A, the area, is the actual number of voxel in the region.

The 2D patterns were propagated in a transverse direction to form 3D patterns. For this process, 2D patterns that overlapped in the axial slices (above or below) were considered to belong to the same 3D object. The cylindricality of each 3D pattern was then calculated by summing (across the axial slices) the circularity of each 2D pattern forming the same 3D object as in Eq. (16):
                              
                                 (16)
                                 
                                    
                                       
                                          C
                                          y
                                       
                                       =
                                       
                                          ∑
                                          z
                                       
                                       
                                          
                                             C
                                             z
                                          
                                       
                                    
                                 
                              
                           
                           C
                           
                              y
                            is the cylindricality of the object. The most cylindrical object was considered to be the artery.

Once the artery was detected, the last step involved estimating its median signal. To this end, for each 2D cluster, a median value was computed from the pixels. The 2D median values were stored together to form the reference signal curve denoted as x
                           
                              a
                           .

To establish the labeling of clusters, a comparison was made by computing the distance d
                           
                              ja
                            between the signal of the artery x
                           
                              a
                            and the median signal 
                              
                                 
                                    
                                       X
                                       ˆ
                                    
                                    j
                                 
                              
                            used as prototype of cluster (j):
                              
                                 (17)
                                 
                                    
                                       
                                          d
                                          
                                             j
                                             a
                                          
                                          2
                                       
                                       =
                                       
                                          ∑
                                          
                                             t
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   x
                                                   
                                                      a
                                                      t
                                                   
                                                
                                                −
                                                
                                                   
                                                      x
                                                      ˆ
                                                   
                                                   
                                                      j
                                                      t
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           The aim of this comparison was to order the clusters according to their distances from the detected artery. This is important because it can relate valuable information about the nature of the tissue.

Ideally, this clustering procedure could be used to assign ROI voxels into clusters that are indicative of the tissue vascularization according to their behaviors. However, MRI is noisy and can lead to an overestimation of the number of clusters. Thus, to reduce this overestimation, our clusters were ordered according to the distance between their prototypes and reference artery signals. They were grouped together when the distance between them was less than a defined threshold. Experimentally, we found that the optimal merging threshold was 10% of the highest distance value between prototypes. Notably, this merging decision made interpretation easier.

@&#EXPERIMENTS AND RESULTS@&#

Here, we report the results obtained after applying our method to either synthetic data (based on pharmacokinetic models with known ground truths of tumor distributions) or clinical images (correlated with histopathology findings).

Validated pharmacokinetic models were used to generate simulations. A large set of synthetic DCE–MRI time series were constructed without assumptions regarding data distribution. However, the generated data contained some aspects of real situations, including the following: (i) the bolus did not appear immediately, (ii) different curve behaviors occurred, and (iii) various organ scenarios were possible.

Curves were based on the work of Chen et al. [15], with additional behavioral possibilities. All curves were displayed as concentration of contrast agent over time. These 1D simulations were then combined with a 3D model of the prostate: Prostate Atlas [29] to obtain 4D data set. The data were immersed in an environment containing the iliac and the obturator artery.

For each voxel, the evolution of the concentration was modeled using Eq. (18):
                              
                                 (18)
                                 
                                    
                                       
                                          C
                                          j
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          k
                                          
                                             j
                                             ,
                                             trans
                                          
                                       
                                       
                                          C
                                          p
                                       
                                       (
                                       t
                                       )
                                       ×
                                       exp
                                       (
                                       −
                                       
                                          k
                                          
                                             e
                                             p
                                             ,
                                             j
                                          
                                       
                                       t
                                       )
                                    
                                 
                              
                           In this equation, ⊗ denotes the mathematical convolution operation.

In addition, the plasmatic concentration, C
                           
                              p
                           (t), was generated using the Weinman model:
                              
                                 (19)
                                 
                                    
                                       
                                          C
                                          p
                                       
                                       (
                                       t
                                       )
                                       =
                                       D
                                       (
                                       
                                          a
                                          1
                                       
                                       
                                          e
                                          
                                             −
                                             
                                                m
                                                1
                                             
                                             t
                                          
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       
                                          e
                                          
                                             −
                                             
                                                m
                                                2
                                             
                                             t
                                          
                                       
                                       )
                                    
                                 
                              
                           
                           D is the contrast agent dose (0.1mM/Kg). Two arterial input function parameters (a
                           1, a
                           2, m
                           1, and m
                           2) were considered: those proposed by Weinmann et al. [30] (a
                           1
                           =3.99, a
                           2
                           =4.78, m
                           1
                           =0.144 et m
                           2
                           =0.011 and those used by Chen et al. [15] (a1
                           =3.99, a2
                           =0.78, m
                           1
                           =1 et m
                           2
                           =0.011).

In order to achieve different behavioral schemes, depending on the tissue nature, distinct pharmacokinetic parameters were chosen (K
                           trans and K
                           ep). For prostate imaging, the following values were reported in the literature [31,32]: K
                           trans
                           =0.05min−1 or 0.2min−1 and K
                           ep
                           =0.1min−1 or 0.4min−1 for healthy prostate tissue, whereas K
                           trans
                           =0.4min−1 or 1min−1 and K
                           ep
                           =1.4min−1 or 2min−1 for prostate lesions.

The generated signals were subsequently perturbed by adding Gaussian noise (σ
                           2
                           =0.2) in order to obtain more realistic situations. The obtained curves represented the time concentration evolution for each voxel, while in real DCE–MRI data, signals denote time intensity variations. Therefore, the following conversion was realized:
                              
                                 (20)
                                 
                                    
                                       
                                          x
                                          j
                                       
                                       (
                                       t
                                       )
                                       =
                                       m
                                       (
                                       t
                                       )
                                       sin
                                       (
                                       α
                                       )
                                       
                                          
                                             1
                                             −
                                             
                                                e
                                                
                                                   −
                                                   (
                                                   (
                                                   T
                                                   R
                                                   /
                                                   
                                                      T
                                                      
                                                         10
                                                      
                                                   
                                                   )
                                                   +
                                                   
                                                      c
                                                      
                                                         p
                                                         j
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   T
                                                   R
                                                   )
                                                
                                             
                                          
                                          
                                             1
                                             −
                                             cos
                                             (
                                             α
                                             )
                                             
                                                e
                                                
                                                   −
                                                   (
                                                   (
                                                   T
                                                   R
                                                   /
                                                   
                                                      T
                                                      
                                                         10
                                                      
                                                   
                                                   )
                                                   +
                                                   
                                                      R
                                                      1
                                                   
                                                   
                                                      C
                                                      
                                                         p
                                                         j
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   T
                                                   R
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           with
                              
                                 (21)
                                 
                                    
                                       m
                                       (
                                       t
                                       )
                                       =
                                       m
                                       (
                                       0
                                       )
                                       
                                          e
                                          
                                             −
                                             
                                                R
                                                2
                                             
                                             
                                                C
                                                
                                                   p
                                                   j
                                                
                                             
                                             (
                                             t
                                             )
                                             T
                                             R
                                          
                                       
                                    
                                 
                              
                           In this equation, m(0) equals 6000, α represents the flip angle (17°), TR is the repetition time (8.9ms), and TE stands for the echo time (4.2ms). R
                           1 (4.5s−1
                           mM−1) and R2 (5.5s−1
                           mM−1) are the longitudinal and transverse tissue contrast agent relaxivities. T
                           10 (1000ms) and 
                              
                                 
                                    T
                                    
                                       20
                                    
                                    *
                                 
                              
                            are the longitudinal and transverse relaxation times, respectively.

Overall, six cases were generated by varying the number of lesions and their positions on the images (Table 1
                           ). A seventh case, representing healthy tissue, was also considered.

@&#RESULTS@&#

Both qualitative and quantitative criteria were used. Qualitative criteria allowed for global appreciation of the method behavior, whereas quantitative criteria were used to quantify detection. The following quantitative criteria were used:
                              
                                 (22)
                                 
                                    
                                       sensitivity
                                       =
                                       
                                          
                                             True
                                              
                                             Positive
                                          
                                          
                                             True
                                              
                                             Positive
                                             +
                                             False
                                              
                                             Positive
                                          
                                       
                                       =
                                       recall
                                    
                                 
                              
                           
                           
                              
                                 (23)
                                 
                                    
                                       specificity
                                       =
                                       
                                          
                                             True
                                              
                                             Negative
                                          
                                          
                                             True
                                              
                                             Negative
                                             +
                                             False
                                              
                                             Negative
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (24)
                                 
                                    
                                       precision
                                       =
                                       
                                          
                                             True
                                              
                                             Positive
                                          
                                          
                                             True
                                              
                                             Positive
                                             +
                                             False
                                              
                                             Positive
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (25)
                                 
                                    
                                       F
                                       -measure
                                       =
                                       2
                                       ×
                                       
                                          
                                             precision
                                             ×
                                             sensitivity
                                          
                                          
                                             precision
                                             +
                                             sensitivity
                                          
                                       
                                    
                                 
                              
                           
                           Table 1 gives a global description of the synthetic data generated and summarizes our results using the defined criteria.

It clearly appears that the proposed method is efficient: sensitivity (0.96–1.00), specificity (0.86–1.00) and F-measure (0.76–1). These results were mainly due to the non-linear space projection obtained by spectral clustering approach. This fact is highlighted on Fig. 6
                           , which shows these same data clustered by K-means in the input space resulting in lower sensitivity (0.56–0.98), specificity (0.56–1.00) and F-measure (0.00–0.99). Moreover, a comparative study is done with the ICA approach. This later performs better than K-means with sensitivity in (0.91–0.98), specificity in (0.20–1.00) and F-measure in (0.56–1.00). The spectral approach outperforms ICA in all cases except for cases 2 and 4, the ICA sensitivity is slightly better. Globally, sensitivities of both approaches are close while the specificity of our approach is clearly higher.


                           Fig. 7
                            depicts the results from four cases, including three tumors with different volumes (case 1), two tumors with distinct volumes (case 2), three tumors that are small but close (case 4), and healthy tissue (case 7).


                           Fig. 8
                            highlights the fact that spatial transformation can allow the data to be easily separable using a classification algorithm, such as the K-means.

We retrospectively analyzed clinical data from seven patients. These individuals were scanned with a multiparametric MRI protocol for prostate cancer diagnosis. Acquisitions were made on a 1.5T Philips MRI device using an external abdominal coil.

The multispectral MRI data consisted of T2W images with a voxel size of 0.48mm×0.48mm×2.5mm (50 images by volume), T1 DCE with a voxel size of 0.61mm×0.61mm×4.0mm (15 images by volume), 20 acquisitions with a temporal resolution of 15s, and an apparent diffusion coefficient (ADC) map achieved through diffusion weighting imaging (DWI) (1.12mm×1.12mm×4.00mm voxel size; 15 images by volume).

Ultimately, all patients underwent radical prostatectomy. Thus, histologic findings can be correlated with the MRI, providing a ground truth for validation of our method. For this purpose, prostate specimens were inked, fixed, and sectioned according to the Stanford protocol [33]. A reconstructed histological map of each prostate was then created. Contours of the histological zones and outlines of each cancer were drawn on the slides while under the microscope. The results from these analyses were reported on MRI via manual correspondence with histology images. Experienced urologists performed this analysis [34]. The prostate was divided into eight regions using the octant technique, with the top and bottom divided into four quadrants: transition zone (TZ), peripheral zone (PZ), left, and right. Within each octant, TZ, PZ, and anterior boundaries of the fibromuscular stroma were traced, and the tumor was located according to these histological points of reference.

Six of the ROI samples were analyzed (from six distinct patients). Five of the specimens were pathological, while the sixth was extracted from healthy tissue. For each of these clinical samples, starting from the histopathology cards (Fig. 9
                        , column 4), an experienced radiologist defined ROIs containing tumor via DCE–MRI (Fig. 9, columns 1 and 2). For the last patient, the ROI was defined on healthy tissue.

In the five cases involving tumor, the algorithm was able to classify the voxels into three groups (identifying homogeneous classes), which were then sorted according to distance from the artery, indicating regions with differential vascularization (Fig. 9 column 3). The closest corresponded to the tumor. However, the spatial delimitation of this focus was restricted due to fact that hyper-vascularization was present around the tumor area (including the healthy tissue).

For the last case, initially the algorithm classified the voxels into the two closest classes with signal behavior far from the reference artery signal; however, they were later merged into one homogeneous class. This finding may reflect the fact that the tissue in this zone presented a different response to the contrast agent than the artery and was thus considered as healthy.

A more precise analysis of our findings allowed for the following interpretations: in cases 1, 2, 4, and 5 the algorithm was able to effectively detect the tumors due to good tissue vascularization; however, results for the third case were not convincing. To understand the reasons for this behavior, we estimated the pharmacokinetic parameters using the Toft's model. The K
                        trans map (Fig. 10
                        ) confirmed the fact that the tissue examined for case 3 was poorly vascularized, likely representing a necrotic tumor.

@&#DISCUSSION AND CONCLUSION@&#

Assuming that time-intensity curves are an indicator of tissue behavior, we proposed an original analysis method for DCE–MRI signals based on the grouping of voxels with similar behaviors. These behaviors can then be compared to a reference extracted from an artery. For this method, which is based on spectral clustering, the data are represented in graphical form with each vertex associated with a data sample and the weighted edges encoding the relationship between the underlying data. In contrast to commonly used techniques, such as K-means and mixture models, it is known that spectral clustering can deal with complex and unknown cluster shapes. In particular, the top eigenvectors of the graph Laplacian can unfold the data structure to form meaningful clusters.

In comparison to methods that measure pharmacokinetic parameters or other data analysis techniques, our approach is non-parametric and fully automatic. Without making any assumptions regarding the models, our strategy exhibited results similar to those obtained by pharmacokinetic approaches. However, it is important to stress that our proposed method is not intended to replace pharmacokinetic techniques, but instead is meant to act a complementary analysis framework, which can ultimately help define cutoffs.

Another clustering-based method, which was described by Chen et al. [15], also represents a statistical data analysis method; however, it is parametric and assumes a Gaussian distribution of signal curves. We have validated our method using both synthetic and clinical data. For the initial experiments on simulated cases, time concentrations and time-intensity curves with ground truths were constructed based on a previous method [15]. In order to make the simulations more realistic, they were combined with a 3D frame to obtain 4D images [29]. Indeed, the results of our experiments were very good, and the algorithm was able to detect lesions in all cases (Table 1). The data for the healthy case, in which no lesions were simulated, were also interesting. In fact, our algorithm highlighted the fact that the tissue was homogeneous following the analysis of cluster fusion and distance comparisons with the artery (Fig. 7).

For the second experiments, clinical data from routine prostate cancer imaging protocols were examined. Notably, histopathological data provided ground truths for the analysis, and our algorithm proved to be efficient for assessing clinical cases (Figs. 9 and 10). However, these results must be related to DCE–MRI in order to establish the efficiency of localization. Indeed, it has been reported that for tumors with significant volumes (>0.5mL) and Gleason grades (≥6), DCE–MRI shows sensitivity and specificity ranges of 46–96% and 74–96%, respectively [35].

Certainly, pharmacokinetic methods, such as Toft's model, cannot not be substituted by statistical techniques during DCE–MRI analysis. However, these methods can provide valuable information, which has been demonstrated in the present work as well as by others. Currently, we are investigating the optimal combination of these approaches within the same methodological framework, and our ultimate goal is to establish a standardized analysis and interpretation pathway that will yield excellent sensitivity and specificity.

@&#REFERENCES@&#

