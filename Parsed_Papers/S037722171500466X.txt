@&#MAIN-TITLE@&#Fast local search for single row facility layout

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We consider the single row facility layout problem (SRFLP).


                        
                        
                           
                           Neighborhood exploration procedures with time complexity O(n
                              2) are proposed.


                        
                        
                           
                           Insertion-based local search (LS) algorithm is embedded into the VNS framework.


                        
                        
                           
                           Numerical results are reported for SRFLP instances of size up to 300 facilities.


                        
                        
                           
                           Results show that the speedup provided by our LS algorithms is rather spectacular.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Combinatorial optimization

Single row facility layout

Local search

Variable neighborhood search

@&#ABSTRACT@&#


               
               
                  Given n facilities of prescribed lengths and a flow matrix, the single row facility layout problem (SRFLP) is to arrange the facilities along a straight line so as to minimize the total arrangement cost, which is the sum of the products of the flows and center-to-center distances between facilities. We propose interchange and insertion neighborhood exploration (NE) procedures with time complexity O(n
                     2), which is an improvement over O(n
                     3)-time NE procedures from the literature. Numerical results show that, for large SRFLP instances, our insertion-based local search (LS) algorithm is two orders of magnitude faster than the best existing LS techniques. As a case study, we embed this LS algorithm into the variable neighborhood search (VNS) framework. We report computational results for SRFLP instances of size up to 300 facilities. They indicate that our VNS implementation offers markedly better performance than the variant of VNS that uses a recently proposed O(n
                     3)-time insertion-based NE procedure.
               
            

@&#INTRODUCTION@&#

An active line of research in the area of combinatorial optimization is concerned with developing various algorithms for a wide set of problems whose solutions are permutations. An important member of this set is the single row facility layout problem (SRFLP for short). Given a number of facilities and the flows between them, the SRFLP is to arrange the facilities along a straight line so as to minimize the total arrangement cost, which is the sum of the products of the flows and center-to-center distances between facilities. Suppose that there are n facilities having lengths 
                        
                           
                              L
                              1
                           
                           ,
                           …
                           ,
                           
                              L
                              n
                           
                           ,
                        
                      respectively. Let 
                        
                           W
                           =
                           (
                           
                              w
                              
                                 i
                                 j
                              
                           
                           )
                        
                      be a symmetric n × n matrix whose entry wij
                      represents the flow of material between facilities i and j. Our intention in this paper is to deal with a version of the SRFLP where clearances between facilities, denoted as γij
                     , 
                        
                           i
                           ,
                           j
                           ∈
                           {
                           1
                           ,
                           …
                           ,
                           n
                           }
                           ,
                        
                      
                     i ≠ j, are not all equal to a (nonnegative) constant value. We emphasize that our approach to the SRFLP is applicable even when the matrix of clearances, 
                        
                           Γ
                           =
                           (
                           
                              γ
                              
                                 i
                                 j
                              
                           
                           )
                           ,
                        
                      is not assumed to be necessarily symmetric. Because of this, and also to avoid losing the generality of the SRFLP formulation, we do not require symmetry in the matrix Γ. Certainly, the main diagonal of Γ is zero, and all other entries are nonnegative. With these notations, the SRFLP can be expressed as

                        
                           (1)
                           
                              
                                 
                                    min
                                    
                                       p
                                       ∈
                                       Π
                                    
                                 
                                 F
                                 
                                    (
                                    p
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    ∑
                                    
                                       l
                                       =
                                       k
                                       +
                                       1
                                    
                                    n
                                 
                                 
                                    w
                                    
                                       p
                                       (
                                       k
                                       )
                                       p
                                       (
                                       l
                                       )
                                    
                                 
                                 
                                    d
                                    
                                       p
                                       (
                                       k
                                       )
                                       p
                                       (
                                       l
                                       )
                                    
                                 
                                 ,
                              
                           
                        
                     where Π is the set of all permutations of 
                        
                           {
                           1
                           ,
                           …
                           ,
                           n
                           }
                           ,
                        
                      
                     p(k) is the facility in the k-th position of permutation p, and d
                     
                        p(k)p(l) is the distance between the centroids of facilities p(k) and p(l). Let us assume that k < l. Then the distance is calculated according to the following equation:

                        
                           (2)
                           
                              
                                 
                                    d
                                    
                                       p
                                       (
                                       k
                                       )
                                       p
                                       (
                                       l
                                       )
                                    
                                 
                                 =
                                 
                                    L
                                    
                                       p
                                       (
                                       k
                                       )
                                    
                                 
                                 /
                                 2
                                 +
                                 
                                    ∑
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                   =
                                                   k
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      if
                                                   
                                                   
                                                   l
                                                   >
                                                   k
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       l
                                       −
                                       1
                                    
                                 
                                 
                                    L
                                    
                                       p
                                       (
                                       m
                                       )
                                    
                                 
                                 +
                                 
                                    L
                                    
                                       p
                                       (
                                       l
                                       )
                                    
                                 
                                 /
                                 2
                                 +
                                 
                                    ∑
                                    
                                       m
                                       =
                                       k
                                    
                                    
                                       l
                                       −
                                       1
                                    
                                 
                                 
                                    γ
                                    
                                       p
                                       (
                                       m
                                       )
                                       p
                                       (
                                       m
                                       +
                                       1
                                       )
                                    
                                 
                                 .
                              
                           
                        
                     We note that the formulation (1)–(2) was used by Datta, Amaral, and Figueira (2011) in their paper on a genetic algorithm approach to single row facility layout.

The SRFLP is a challenging research problem which has several real-life applications. In the area of flexible manufacturing systems, it models the linear layout of machines within manufacturing cells. In this type of layout, the machines are placed along a straight path travelled by an automated guided vehicle (Heragu & Kusiak, 1988). Other applications of the SRFLP include arranging a number of rooms on one side of a corridor in supermarkets, hospitals and office buildings (Simmons, 1969), arranging books on a shelf in a library (Picard & Queyranne, 1981), and design of warehouse layouts (Picard & Queyranne, 1981).

Because of the practical importance of the SRFLP, considerable attention has been given to the development of algorithms for its solution. Existing exact methods for the SRFLP include branch-and-bound (Simmons, 1969), dynamic programming (Picard & Queyranne, 1981), mixed-integer linear programming (Amaral, 2006, 2008; Heragu & Kusiak, 1991), cutting plane (Amaral, 2009), branch-and-cut (Amaral & Letchford, 2013), and semidefinite programming approaches (Anjos & Vannelli, 2008; Hungerländer & Rendl, 2013). Branch-and-bound (Palubeckis, 2012) and semidefinite programming (Hungerländer, 2014) algorithms were also applied for solving a special case of the problem in which all facilities have the same length. A computational comparison of the state-of-the-art exact methods for the SRFLP is given in the paper by Hungerländer and Rendl (2013). They report that the largest SRFLP instance solved to prove optimality involves 42 facilities. For the purpose of finding good but not necessarily optimal solutions for larger instances of the problem, a number of heuristic algorithms have been developed.

The fastest methods to generate feasible solutions for large-scale SRFLP instances are construction heuristics. Among them, a greedy-like algorithm of Heragu and Kusiak (1988) and an iterative construction procedure of Djellab and Gourgand (2001) can be mentioned. However, it is widely acknowledged that construction heuristics are not able to produce solutions of high quality. They can be applied in situations where computation time is a critical factor.

Another group of heuristic algorithms construct a permutation of facilities from the results obtained by solving either a mixed-integer or a semidefinite program (SDP). In particular, an algorithm relying on a mixed-integer programming model was presented by Heragu and Kusiak (1991). Recently, Amaral and Letchford (2013) have proposed an approach which allows obtaining a suboptimal solution as a byproduct of the branch-and-cut method. The crux of their approach is the use of a multi-dimensional scaling technique. Anjos, Kennings, and Vannelli (2005) were the first who proposed an SDP-based heuristic to produce a single row facility layout. The same strategy to obtain solutions to the SRFLP was followed by Anjos and Yen (2009) and Hungerländer and Rendl (2013).

The other way to approach the problem is to use metaheuristic search methods. The application of metaheuristics for the SRFLP dates back at least to Romero and Sánchez-Flores (1990) and Heragu and Alfa (1992), who developed simulated annealing algorithms for the problem. de Alvarenga, Negreiros-Gomes, and Mestria (2000) proposed another simulated annealing implementation for the SRFLP. The same authors also presented a tabu search algorithm and tested both metaheuristics on a small set of instances of size n ≤ 30. More recent variants of tabu search strategy were proposed by Samarghandi and Eshghi (2010) and Kothari and Ghosh (2013a). Solimanpur, Vrat, and Shankar (2005) developed an ant algorithm for the SRFLP. Teo and Ponnambalam (2008) investigated a hybrid approach, combining ant colony optimization and particle swarm optimization (PSO) techniques. A pure PSO algorithm for the problem was proposed by Samarghandi, Taabayan, and Jahantigh (2010). Recently, Kothari and Ghosh (2013b) presented an insertion-based Lin–Kernighan heuristic for producing good quality layouts. The heuristic was shown to be competitive with other high-performance algorithms. There are also several layout methods available which follow the genetic paradigm. These include genetic algorithms of Ficko, Brezocnik, and Balic (2004) and Datta et al. (2011) as well as hybrid genetic algorithms of Ozcelik (2012) and Kothari and Ghosh (2014a). A similar evolutionary technique called the imperialist competitive algorithm was presented by Lian, Zhang, Gao, and Shao (2011). Single row layout algorithms based on the scatter search metaheuristic were proposed by Kumar, Asokan, Kumanan, and Varma (2008) and Kothari and Ghosh (2014b). The second of them was reported to yield very good solutions for popular benchmark SRFLP instances. For recent surveys on the single row facility layout problem, the reader is referred to Anjos and Liers (2012), Hungerländer and Rendl (2013), Keller and Buscher (2015), and Kothari and Ghosh (2012).

From the literature, it can be seen that many algorithms for the SRFLP incorporate a local search procedure (Amaral & Letchford, 2013; Heragu & Alfa, 1992; Heragu & Kusiak, 1991; Kothari & Ghosh, 2013a, 2014a, 2014b; Kumar et al., 2008; Ozcelik, 2012; Samarghandi & Eshghi, 2010; Samarghandi et al., 2010; Solimanpur et al., 2005; Teo & Ponnambalam, 2008). Two main types of local searches have been used for this problem (Kothari & Ghosh, 2013b). The first of them is based on pairwise interchanges of facilities (Amaral & Letchford, 2013; Heragu & Alfa, 1992; Heragu & Kusiak, 1991; Kothari & Ghosh, 2013a; Samarghandi & Eshghi, 2010; Samarghandi et al., 2010; Solimanpur et al., 2005; Teo & Ponnambalam, 2008), whereas the second one proceeds by executing insertion moves, where a facility is moved from one position to another in the permutation (Kothari & Ghosh, 2013a, 2014a, 2014b; Kumar et al., 2008; Ozcelik, 2012). The performance of local search (LS) algorithms greatly depends on the neighborhood exploration (NE) procedures (Kothari & Ghosh, 2013a). A straightforward implementation of such a procedure for each type of LS has time complexity O(n
                     4) (Kothari & Ghosh, 2013a). Indeed, for example, in the case of interchange-based LS, there are 
                        
                           n
                           (
                           n
                           −
                           1
                           )
                           /
                           2
                        
                      pairs of facilities, and computation of the objective function value for a permutation obtained by interchanging two facilities takes O(n
                     2) operations. Recently, Kothari and Ghosh (2013a) developed NE procedures (for both interchange and insertion neighborhood structures) whose time complexity is O(n
                     3). The algorithms of Kothari and Ghosh (2013a, 2013b, 2014a, 2014b) use these procedures and show good performance compared to other methods in the literature.

Many studies on the SRFLP (Amaral and Letchford, 2013; Anjos et al., 2005; Kothari and Ghosh, 2013a, among others) assumed that the clearance between each pair of facilities is equal to a constant value. In such a situation, by adequately adjusting the length of the facilities, zero clearances can be achieved. In this paper, however, our intention is to consider a more general model in which clearances between adjacent facilities are not necessarily all equal. There are two main reasons for such a choice. First, as emphasized by Solimanpur et al. (2005), allowing different clearances is important in real life manufacturing. Solimanpur et al. (2005) listed several factors that affect the clearance spaces required between facilities. They mentioned that an analytic approach, e.g. queuing models or simulation study, can be used to obtain the required data. Second, the assumption of different clearances between facilities adds no principal difficulties to our approach to constructing fast local search algorithms for the SRFLP.

The primary motivation of this paper is to develop more efficient neighborhood exploration algorithms than those presented by Kothari and Ghosh (2013a). We propose three NE procedures, one for searching pairwise interchange neighborhoods and the other two for searching insertion neighborhoods. The time complexity of each procedure is O(n
                     2). We present empirical results comparing the performance of our NE procedures against those of Kothari and Ghosh (2013a). We embed these procedures in the variable neighborhood search algorithm for solving the SRFLP. We report on computational experiments on SRFLP instances of size up to 300 facilities.

The outline of the rest of the paper is as follows. In Section 2, we rephrase the objective function of the problem and introduce some preliminary notations. In Sections 3 and 4, we propose interchange-based and, respectively, insertion-based local search algorithms for the SRFLP. Their experimental evaluation is presented in Section 5. In Section 6, we provide a case study focused on the application of the variable neighborhood search metaheuristic for the considered problem. Concluding remarks are given in Section 7. Proofs of some results appear in Appendix A.

The SRFLP (1)–(2) can be restated using an alternative form of the objective function. To present this form, we fix a permutation p ∈ Π and consider a family of cuts induced by subsets of facilities 
                        
                           
                              V
                              m
                           
                           =
                           
                              {
                              p
                              
                                 (
                                 k
                                 )
                              
                              ∣
                              k
                              =
                              1
                              ,
                              …
                              ,
                              m
                              }
                           
                           ,
                        
                     
                     
                        
                           m
                           ∈
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                           −
                           1
                           }
                        
                     . Let 
                        
                           m
                           ∈
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                           −
                           1
                           }
                        
                     . We call the sum 
                        
                           
                              c
                              m
                           
                           =
                           
                              ∑
                              
                                 k
                                 =
                                 1
                              
                              m
                           
                           
                              ∑
                              
                                 l
                                 =
                                 m
                                 +
                                 1
                              
                              n
                           
                           
                              w
                              
                                 p
                                 (
                                 k
                                 )
                                 p
                                 (
                                 l
                                 )
                              
                           
                        
                      the cut value and the vector 
                        
                           C
                           =
                           (
                           
                              c
                              1
                           
                           ,
                           …
                           ,
                           
                              c
                              
                                 n
                                 −
                                 1
                              
                           
                           )
                        
                      indexed by cuts the cut vector. We define 
                        
                           
                              λ
                              r
                           
                           =
                           
                              L
                              r
                           
                           /
                           2
                        
                      to be the half-length of the facility r, 
                        
                           r
                           ∈
                           {
                           1
                           ,
                           …
                           ,
                           n
                           }
                        
                     . With these definitions, the objective function in (1) can be rewritten as follows.

                        Proposition 1
                        
                           For p ∈ Π,

                              
                                 (3)
                                 
                                    
                                       F
                                       
                                          (
                                          p
                                          )
                                       
                                       =
                                       
                                          ∑
                                          
                                             m
                                             =
                                             1
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          c
                                          m
                                       
                                       
                                          (
                                          
                                             λ
                                             
                                                p
                                                (
                                                m
                                                )
                                             
                                          
                                          +
                                          
                                             λ
                                             
                                                p
                                                (
                                                m
                                                +
                                                1
                                                )
                                             
                                          
                                          +
                                          
                                             γ
                                             
                                                p
                                                (
                                                m
                                                )
                                                p
                                                (
                                                m
                                                +
                                                1
                                                )
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           
                        

For 
                              
                                 m
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 }
                                 ,
                              
                            let us denote by 
                              
                                 λ
                                 
                                    p
                                    (
                                    m
                                    )
                                 
                                 
                                    left
                                 
                              
                            (respectively 
                              
                                 λ
                                 
                                    p
                                    (
                                    m
                                    )
                                 
                                 
                                    right
                                 
                              
                           ) the left half length (respectively, right half length) of the facility placed in the m-th position in the permutation p. Then F(p), given by (1) and (2), can be rewritten as (for notational simplicity, we assume here and in what follows that a sum is zero if the lower limit of the summation index is greater than the upper limit)

                              
                                 (4)
                                 
                                    
                                       
                                          
                                             
                                                F
                                                (
                                                p
                                                )
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      k
                                                      +
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   w
                                                   
                                                      p
                                                      (
                                                      k
                                                      )
                                                      p
                                                      (
                                                      l
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                ×
                                                
                                                   (
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         k
                                                         )
                                                      
                                                      
                                                         right
                                                      
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         j
                                                         =
                                                         k
                                                         +
                                                         1
                                                      
                                                      
                                                         l
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         λ
                                                         
                                                            p
                                                            (
                                                            j
                                                            )
                                                         
                                                         
                                                            left
                                                         
                                                      
                                                      +
                                                      
                                                         λ
                                                         
                                                            p
                                                            (
                                                            j
                                                            )
                                                         
                                                         
                                                            right
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         l
                                                         )
                                                      
                                                      
                                                         left
                                                      
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         j
                                                         =
                                                         k
                                                      
                                                      
                                                         l
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         j
                                                         )
                                                         p
                                                         (
                                                         j
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      k
                                                      +
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   w
                                                   
                                                      p
                                                      (
                                                      k
                                                      )
                                                      p
                                                      (
                                                      l
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                ×
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         j
                                                         =
                                                         k
                                                         +
                                                         1
                                                      
                                                      l
                                                   
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         j
                                                         )
                                                      
                                                      
                                                         left
                                                      
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         j
                                                         =
                                                         k
                                                      
                                                      
                                                         l
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         j
                                                         )
                                                      
                                                      
                                                         right
                                                      
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         j
                                                         =
                                                         k
                                                      
                                                      
                                                         l
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         j
                                                         )
                                                         p
                                                         (
                                                         j
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           We combine all the terms in (4) containing 
                              
                                 
                                    λ
                                    
                                       p
                                       (
                                       m
                                       )
                                    
                                    
                                       left
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 m
                                 ∈
                                 {
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 }
                              
                           . It can be checked that the resulting expression is

                              
                                 (5)
                                 
                                    
                                       
                                          λ
                                          
                                             p
                                             (
                                             m
                                             )
                                          
                                          
                                             left
                                          
                                       
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       
                                          ∑
                                          
                                             l
                                             =
                                             m
                                          
                                          n
                                       
                                       
                                          w
                                          
                                             p
                                             (
                                             k
                                             )
                                             p
                                             (
                                             l
                                             )
                                          
                                       
                                       ,
                                       
                                       
                                       m
                                       ∈
                                       
                                          {
                                          2
                                          ,
                                          …
                                          ,
                                          n
                                          }
                                       
                                       .
                                    
                                 
                              
                           Similarly, all the terms with 
                              
                                 λ
                                 
                                    p
                                    (
                                    m
                                    )
                                 
                                 
                                    right
                                 
                              
                            can be combined into a single term:

                              
                                 (6)
                                 
                                    
                                       
                                          λ
                                          
                                             p
                                             (
                                             m
                                             )
                                          
                                          
                                             right
                                          
                                       
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                          ∑
                                          
                                             l
                                             =
                                             m
                                             +
                                             1
                                          
                                          n
                                       
                                       
                                          w
                                          
                                             p
                                             (
                                             k
                                             )
                                             p
                                             (
                                             l
                                             )
                                          
                                       
                                       ,
                                       
                                       
                                       m
                                       ∈
                                       
                                          {
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          −
                                          1
                                          }
                                       
                                       .
                                    
                                 
                              
                           Finally, the terms with 
                              
                                 γ
                                 
                                    p
                                    (
                                    m
                                    )
                                    p
                                    (
                                    m
                                    +
                                    1
                                    )
                                 
                              
                            contribute

                              
                                 (7)
                                 
                                    
                                       
                                          γ
                                          
                                             p
                                             (
                                             m
                                             )
                                             p
                                             (
                                             m
                                             +
                                             1
                                             )
                                          
                                       
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                          ∑
                                          
                                             l
                                             =
                                             m
                                             +
                                             1
                                          
                                          n
                                       
                                       
                                          w
                                          
                                             p
                                             (
                                             k
                                             )
                                             p
                                             (
                                             l
                                             )
                                          
                                       
                                       ,
                                       
                                       
                                       m
                                       ∈
                                       
                                          {
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          −
                                          1
                                          }
                                       
                                       .
                                    
                                 
                              
                           The double summation in (6) (as well as (7)) is equal to the cut value cm
                            and that in (5) is equal to the cut value 
                              
                                 c
                                 
                                    m
                                    −
                                    1
                                 
                              
                           . Thus we can write

                              
                                 (8)
                                 
                                    
                                       F
                                       
                                          (
                                          p
                                          )
                                       
                                       =
                                       
                                          ∑
                                          
                                             m
                                             =
                                             2
                                          
                                          n
                                       
                                       
                                          λ
                                          
                                             p
                                             (
                                             m
                                             )
                                          
                                          
                                             left
                                          
                                       
                                       
                                          c
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       +
                                       
                                          ∑
                                          
                                             m
                                             =
                                             1
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             λ
                                             
                                                p
                                                (
                                                m
                                                )
                                             
                                             
                                                right
                                             
                                          
                                          
                                             c
                                             m
                                          
                                          +
                                          
                                             γ
                                             
                                                p
                                                (
                                                m
                                                )
                                                p
                                                (
                                                m
                                                +
                                                1
                                                )
                                             
                                          
                                          
                                             c
                                             m
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           The first summand in (8) is equal to 
                              
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    λ
                                    
                                       p
                                       (
                                       m
                                       +
                                       1
                                       )
                                    
                                    
                                       left
                                    
                                 
                                 
                                    c
                                    m
                                 
                              
                           . Hence

                              
                                 (9)
                                 
                                    
                                       F
                                       
                                          (
                                          p
                                          )
                                       
                                       =
                                       
                                          ∑
                                          
                                             m
                                             =
                                             1
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          c
                                          m
                                       
                                       
                                          (
                                          
                                             λ
                                             
                                                p
                                                (
                                                m
                                                )
                                             
                                             
                                                right
                                             
                                          
                                          +
                                          
                                             λ
                                             
                                                p
                                                (
                                                m
                                                +
                                                1
                                                )
                                             
                                             
                                                left
                                             
                                          
                                          +
                                          
                                             γ
                                             
                                                p
                                                (
                                                m
                                                )
                                                p
                                                (
                                                m
                                                +
                                                1
                                                )
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           After getting rid of the “right” and ”left” superscripts in (9), we arrive at (3).□

For a permutation p ∈ Π, the components of the cut vector C can be computed using the following recurrence:

                        
                           (10)
                           
                              
                                 
                                    c
                                    m
                                 
                                 =
                                 
                                    c
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 −
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 
                                    w
                                    
                                       p
                                       (
                                       m
                                       )
                                       p
                                       (
                                       k
                                       )
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       l
                                       =
                                       m
                                       +
                                       1
                                    
                                    n
                                 
                                 
                                    w
                                    
                                       p
                                       (
                                       m
                                       )
                                       p
                                       (
                                       l
                                       )
                                    
                                 
                                 ,
                                 
                                 m
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 −
                                 1
                                 ,
                              
                           
                        
                     with the initial condition 
                        
                           
                              c
                              0
                           
                           =
                           0
                        
                     . To show (10), we assume that m > 1. From the definition of cm
                     , we have

                        
                           (11)
                           
                              
                                 
                                    c
                                    m
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 
                                    ∑
                                    
                                       l
                                       =
                                       m
                                       +
                                       1
                                    
                                    n
                                 
                                 
                                    w
                                    
                                       p
                                       (
                                       k
                                       )
                                       p
                                       (
                                       l
                                       )
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       l
                                       =
                                       m
                                       +
                                       1
                                    
                                    n
                                 
                                 
                                    w
                                    
                                       p
                                       (
                                       m
                                       )
                                       p
                                       (
                                       l
                                       )
                                    
                                 
                                 .
                              
                           
                        
                     Adding to and subtracting from the right-hand side of (11) the sum 
                        
                           
                              ∑
                              
                                 k
                                 =
                                 1
                              
                              
                                 m
                                 −
                                 1
                              
                           
                           
                              w
                              
                                 p
                                 (
                                 k
                                 )
                                 p
                                 (
                                 m
                                 )
                              
                           
                        
                      gives

                        
                           (12)
                           
                              
                                 
                                    c
                                    m
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 
                                    ∑
                                    
                                       l
                                       =
                                       m
                                    
                                    n
                                 
                                 
                                    w
                                    
                                       p
                                       (
                                       k
                                       )
                                       p
                                       (
                                       l
                                       )
                                    
                                 
                                 −
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 
                                    w
                                    
                                       p
                                       (
                                       k
                                       )
                                       p
                                       (
                                       m
                                       )
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       l
                                       =
                                       m
                                       +
                                       1
                                    
                                    n
                                 
                                 
                                    w
                                    
                                       p
                                       (
                                       m
                                       )
                                       p
                                       (
                                       l
                                       )
                                    
                                 
                                 .
                              
                           
                        
                     By replacing the double summation in (12) with 
                        
                           c
                           
                              m
                              −
                              1
                           
                        
                      we obtain (10).

Given a cut vector 
                        
                           C
                           =
                           (
                           
                              c
                              1
                           
                           ,
                           …
                           ,
                           
                              c
                              
                                 n
                                 −
                                 1
                              
                           
                           )
                           ,
                        
                      we denote by 
                        
                           
                              C
                              −
                           
                           =
                           
                              (
                              
                                 c
                                 1
                                 −
                              
                              ,
                              …
                              ,
                              
                                 c
                                 n
                                 −
                              
                              )
                           
                        
                      the n-vector with components 
                        
                           
                              c
                              1
                              −
                           
                           =
                           
                              c
                              1
                           
                           ,
                        
                     
                     
                        
                           
                              c
                              m
                              −
                           
                           =
                           
                              c
                              m
                           
                           −
                           
                              c
                              
                                 m
                                 −
                                 1
                              
                           
                        
                      for 
                        
                           m
                           =
                           2
                           ,
                           …
                           ,
                           n
                           −
                           1
                           ,
                        
                      and 
                        
                           
                              c
                              n
                              −
                           
                           =
                           −
                           
                              c
                              
                                 n
                                 −
                                 1
                              
                           
                        
                     . We similarly define a vector 
                        
                           C
                           +
                        
                     : 
                        
                           
                              c
                              1
                              +
                           
                           =
                           
                              c
                              1
                           
                           ,
                        
                     
                     
                        
                           
                              c
                              m
                              +
                           
                           =
                           
                              c
                              m
                           
                           +
                           
                              c
                              
                                 m
                                 −
                                 1
                              
                           
                        
                      for 
                        
                           m
                           =
                           2
                           ,
                           …
                           ,
                           n
                           −
                           1
                           ,
                        
                      and 
                        
                           
                              c
                              n
                              +
                           
                           =
                           
                              c
                              
                                 n
                                 −
                                 1
                              
                           
                        
                     . We will also use two n × n matrices computed from the lengths of facilities: 
                        
                           (
                           
                              λ
                              
                                 r
                                 s
                              
                              −
                           
                           )
                        
                      with entries 
                        
                           
                              λ
                              
                                 r
                                 s
                              
                              −
                           
                           =
                           
                              λ
                              r
                           
                           −
                           
                              λ
                              s
                           
                           =
                           
                              (
                              
                                 L
                                 r
                              
                              −
                              
                                 L
                                 s
                              
                              )
                           
                           /
                           2
                        
                      and 
                        
                           (
                           
                              λ
                              
                                 r
                                 s
                              
                              +
                           
                           )
                        
                      with entries 
                        
                           
                              λ
                              
                                 r
                                 s
                              
                              +
                           
                           =
                           
                              λ
                              r
                           
                           +
                           
                              λ
                              s
                           
                        
                     . We will write 
                        
                           D
                           =
                           (
                           
                              d
                              
                                 r
                                 s
                              
                           
                           )
                        
                      to denote the distance matrix, where drs
                      for 
                        
                           r
                           =
                           p
                           (
                           k
                           )
                        
                      and 
                        
                           s
                           =
                           p
                           (
                           l
                           )
                        
                      is given by (2). The components of the vectors 
                        
                           
                              C
                              −
                           
                           ,
                        
                     
                     
                        
                           C
                           +
                        
                      and entries of the matrices 
                        
                           (
                           
                              λ
                              
                                 r
                                 s
                              
                              −
                           
                           )
                           ,
                        
                     
                     
                        
                           (
                           
                              λ
                              
                                 r
                                 s
                              
                              +
                           
                           )
                        
                      are used in formulas to calculate the change in the objective function value resulting from applying a pairwise interchange or insertion move (see (15) and (24)–(27) in the next two sections). In fact, the purpose of the introduction of 
                        
                           
                              C
                              −
                           
                           ,
                        
                     
                     
                        
                           
                              C
                              +
                           
                           ,
                        
                     
                     
                        
                           (
                           
                              λ
                              
                                 r
                                 s
                              
                              −
                           
                           )
                        
                      and 
                        
                           (
                           
                              λ
                              
                                 r
                                 s
                              
                              +
                           
                           )
                        
                      is twofold. First, the above-mentioned formulas become slightly shorter. Second, and more importantly, the usage of the auxiliary arrays and matrices allows us to reduce the execution time of the algorithms based on our approach. For example, at each iteration of interchange-based local search, the vectors 
                        
                           C
                           −
                        
                      and 
                        
                           C
                           +
                        
                      are computed only once and then used O(n
                     2) times while examining pairs of n facilities. When vectors 
                        
                           C
                           −
                        
                      and 
                        
                           C
                           +
                        
                      are not maintained, then extra addition/subtraction operations are needed. We also note that the matrices 
                        
                           (
                           
                              λ
                              
                                 r
                                 s
                              
                              −
                           
                           )
                        
                      and 
                        
                           (
                           
                              λ
                              
                                 r
                                 s
                              
                              +
                           
                           )
                        
                      can be precomputed in advance.

In the next sections, we derive some formulas related to the LS algorithms. In order to keep them compact, we make the following conventions: 
                        
                           p
                           (
                           0
                           )
                           =
                           0
                           ,
                        
                     
                     
                        
                           p
                           (
                           n
                           +
                           1
                           )
                           =
                           0
                           ,
                        
                     
                     
                        
                           
                              c
                              0
                           
                           =
                           0
                           ,
                        
                     
                     
                        
                           
                              c
                              n
                           
                           =
                           0
                           ,
                        
                      and 
                        
                           
                              γ
                              
                                 0
                                 r
                              
                           
                           =
                           
                              γ
                              
                                 r
                                 0
                              
                           
                           =
                           0
                        
                      for each 
                        
                           r
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                     .

In this section, we describe an implementation of the local search algorithm based on a fast procedure for exploring the pairwise interchange neighborhood of a SRFLP solution in the search space. Our aim is to provide an efficient way to compare the quality of two solutions differing in the positions of precisely two facilities. For this purpose, a couple of auxiliary matrices along with some other data are used.

For p ∈ Π, let Δ(p, k, l) denote the change in the objective function value that will result from swapping positions of the facilities p(k) and p(l) in the permutation p. Formally, let p′ be the permutation obtained by performing this swapping operation. Then 
                        
                           Δ
                           
                              (
                              p
                              ,
                              k
                              ,
                              l
                              )
                           
                           =
                           F
                           
                              (
                              
                                 p
                                 ′
                              
                              )
                           
                           −
                           F
                           
                              (
                              p
                              )
                           
                        
                     . In order to present a fast method for computing Δ(p, k, l) we introduce two n × n matrices denoted by 
                        
                           A
                           =
                           (
                           
                              a
                              
                                 u
                                 j
                              
                           
                           )
                        
                      and 
                        
                           B
                           =
                           (
                           
                              b
                              
                                 u
                                 j
                              
                           
                           )
                        
                     . Both matrices are associated with a permutation of facilities, say p ∈ Π. The rows of the matrices correspond to facilities and the columns correspond to permutation positions. To define the matrices A and B, we suppose that the facility u is assigned to the m-th position of the permutation p, that is, 
                        
                           u
                           =
                           p
                           (
                           m
                           )
                        
                     . The entry auj
                      of the matrix A represents the total flow of material between facility u and facilities in the segment of p from position m exclusively to position j inclusively. Formally, for 
                        
                           u
                           ,
                           j
                           ∈
                           {
                           1
                           ,
                           …
                           ,
                           n
                           }
                        
                     
                     
                        
                           (13)
                           
                              
                                 
                                    a
                                    
                                       u
                                       j
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      j
                                                   
                                                   
                                                      m
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   w
                                                   
                                                      u
                                                      p
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   if
                                                
                                                
                                                
                                                j
                                                <
                                                m
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      m
                                                      +
                                                      1
                                                   
                                                   j
                                                
                                                
                                                   w
                                                   
                                                      u
                                                      p
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   if
                                                
                                                
                                                
                                                j
                                                >
                                                m
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   if
                                                
                                                
                                                
                                                j
                                                =
                                                m
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     The entries of the matrix B are computed by summing over the same permutation positions as in the case of the matrix A. The summand for i ≠ j is a product of aui
                      and the distance between the centroids of facilities p(i) and either 
                        
                           p
                           (
                           i
                           −
                           1
                           )
                        
                      or 
                        
                           p
                           (
                           i
                           +
                           1
                           )
                        
                      depending on whether p(i) is to the left or the right of the facility u. If 
                        
                           i
                           =
                           j
                           ,
                        
                      then calculations are performed assuming that u substitutes for 
                        
                           p
                           (
                           i
                           −
                           1
                           )
                        
                      (or 
                        
                           p
                           (
                           i
                           +
                           1
                           )
                        
                     ). Thus, the entry buj
                     , 
                        
                           u
                           ,
                           j
                           ∈
                           {
                           1
                           ,
                           …
                           ,
                           n
                           }
                           ,
                        
                      of the matrix B is defined as follows:

                        
                           (14)
                           
                              
                                 
                                    b
                                    
                                       u
                                       j
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                   
                                                      u
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      u
                                                   
                                                   +
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         j
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         u
                                                         p
                                                         (
                                                         j
                                                         )
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      j
                                                      +
                                                      1
                                                   
                                                   
                                                      m
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   a
                                                   
                                                      u
                                                      i
                                                   
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         i
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         i
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         i
                                                         −
                                                         1
                                                         )
                                                         p
                                                         (
                                                         i
                                                         )
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   if
                                                
                                                
                                                
                                                j
                                                <
                                                m
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   a
                                                   
                                                      u
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         j
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      λ
                                                      u
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         j
                                                         )
                                                         u
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      m
                                                      +
                                                      1
                                                   
                                                   
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   a
                                                   
                                                      u
                                                      i
                                                   
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         i
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         i
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         i
                                                         )
                                                         p
                                                         (
                                                         i
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   if
                                                
                                                
                                                
                                                j
                                                >
                                                m
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   if
                                                
                                                
                                                
                                                j
                                                =
                                                m
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     The matrices A and B arise when manipulating the expression for Δ(p, k, l). They also play an important role in constructing fast insertion-based local search algorithms for the problem (see Section 4).

Next we provide a formula to calculate the value of Δ(p, k, l).

                        Proposition 2
                        
                           For p ∈ Π, 
                              
                                 k
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 −
                                 1
                                 }
                                 ,
                              
                           
                           
                              
                                 l
                                 ∈
                                 {
                                 k
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 }
                                 ,
                              
                           
                           
                              
                                 r
                                 =
                                 p
                                 (
                                 k
                                 )
                                 ,
                              
                            
                           and
                           
                              
                                 s
                                 =
                                 p
                                 (
                                 l
                                 )
                                 ,
                              
                           
                           
                              
                                 (15)
                                 
                                    
                                       
                                          
                                             
                                                Δ
                                                (
                                                p
                                                ,
                                                k
                                                ,
                                                l
                                                )
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      c
                                                      l
                                                      −
                                                   
                                                   −
                                                   
                                                      c
                                                      k
                                                      −
                                                   
                                                   +
                                                   2
                                                   
                                                      w
                                                      
                                                         r
                                                         s
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      d
                                                      
                                                         r
                                                         s
                                                      
                                                   
                                                   +
                                                   
                                                      γ
                                                      1
                                                   
                                                   +
                                                   
                                                      γ
                                                      2
                                                   
                                                   )
                                                
                                                +
                                                2
                                                
                                                   (
                                                   
                                                      b
                                                      
                                                         r
                                                         ,
                                                         l
                                                         −
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      b
                                                      
                                                         s
                                                         ,
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   λ
                                                   
                                                      r
                                                      s
                                                   
                                                   −
                                                
                                                
                                                   (
                                                   
                                                      c
                                                      l
                                                      +
                                                   
                                                   −
                                                   
                                                      c
                                                      k
                                                      +
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   
                                                      k
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         k
                                                         −
                                                         1
                                                         )
                                                         s
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         k
                                                         −
                                                         1
                                                         )
                                                         r
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   c
                                                   k
                                                
                                                
                                                   γ
                                                   1
                                                
                                                +
                                                
                                                   c
                                                   
                                                      l
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   γ
                                                   2
                                                
                                                +
                                                
                                                   c
                                                   l
                                                
                                                
                                                   (
                                                   
                                                      γ
                                                      
                                                         r
                                                         p
                                                         (
                                                         l
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         s
                                                         p
                                                         (
                                                         l
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           where 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                γ
                                                1
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               γ
                                                               
                                                                  s
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               if
                                                            
                                                            
                                                            
                                                            l
                                                            >
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               γ
                                                               
                                                                  s
                                                                  r
                                                               
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  r
                                                                  s
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               if
                                                            
                                                            
                                                            
                                                            l
                                                            =
                                                            k
                                                            +
                                                            1
                                                            ,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                γ
                                                2
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                                  r
                                                               
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                                  s
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               if
                                                            
                                                            
                                                            
                                                            l
                                                            >
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               if
                                                            
                                                            
                                                            
                                                            l
                                                            =
                                                            k
                                                            +
                                                            1
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The proof of this result can be found in Appendix A. Notice that in the case of zero clearances between neighboring facilities the right-hand side of (15) becomes much simpler. Indeed, in this case, the last four terms as well as γ
                     1 and γ
                     2 in its first term vanish.

Armed with the formula for Δ(p, k, l), we are now ready to present our first local search algorithm for the SRFLP. We start with a description of its main ingredient, a neighborhood exploration procedure, called NE1 (we add the digit 1 at the end of NE to distinguish between this and two other procedures which are provided in the next section).

NE1(
                        
                           p
                           ,
                           C
                           ,
                           
                              C
                              −
                           
                           ,
                           
                              C
                              +
                           
                           ,
                           A
                           ,
                           B
                           ,
                           D
                        
                     )

                        
                           1.
                           Set h
                              * ≔ 0.

For each pair (k, l), 
                                 
                                    k
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    −
                                    1
                                    ,
                                 
                              
                              
                                 
                                    l
                                    =
                                    k
                                    +
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    ,
                                 
                               do the following:
                                 
                                    2.1.
                                    Compute 
                                          
                                             h
                                             =
                                             Δ
                                             (
                                             p
                                             ,
                                             k
                                             ,
                                             l
                                             )
                                          
                                        by Eq. (15).

Check whether h < h
                                       *. If so, then set h
                                       * ≔ h, k′ ≔ k and l′ ≔ l.

If 
                                 
                                    
                                       h
                                       *
                                    
                                    =
                                    0
                                    ,
                                 
                               then return with ρ set to 1. Otherwise, perform pairwise interchange of facilities p(k′) and p(l′) in the permutation p, update matrices A, B, D and vectors C, 
                                 
                                    
                                       C
                                       −
                                    
                                    ,
                                 
                              
                              
                                 
                                    C
                                    +
                                 
                               used in Δ calculations, and return with 
                                 
                                    ρ
                                    =
                                    0
                                 
                              .

LS1(p)

                        
                           1.
                           Initialize matrices A, B, D and vectors C, 
                                 
                                    C
                                    −
                                 
                               and 
                                 
                                    C
                                    +
                                 
                              .

Apply NE1(
                                 
                                    p
                                    ,
                                    C
                                    ,
                                    
                                       C
                                       −
                                    
                                    ,
                                    
                                       C
                                       +
                                    
                                    ,
                                    A
                                    ,
                                    B
                                    ,
                                    D
                                 
                              ). Let ρ denote the local optimality flag returned by NE1.

Check whether 
                                 
                                    ρ
                                    =
                                    1
                                 
                              . If so, then stop with the solution p. Otherwise, go to 2.

An important question that remains to be addressed is how efficiently the entries of the matrices A, B and D can be updated (Step 3 of NE1) after the replacement of p by a permutation p′ chosen from the neighborhood N
                     2(p). Suppose that p′ is obtained from p by interchanging the facilities r and s. Let 
                        
                           r
                           =
                           p
                           (
                           k
                           )
                           ,
                        
                     
                     
                        
                           s
                           =
                           p
                           (
                           l
                           )
                           ,
                        
                      
                     k < l, and 
                        
                           u
                           =
                           
                              p
                              ′
                           
                           
                              (
                              m
                              )
                           
                           ,
                        
                     
                     
                        
                           m
                           ∈
                           {
                           1
                           ,
                           …
                           ,
                           n
                           }
                        
                     . Then, we can write the following formulas that are involved in updating the matrices A, B and D:

                        
                           (16)
                           
                              
                                 
                                    a
                                    
                                       u
                                       j
                                    
                                 
                                 =
                                 
                                    a
                                    
                                       u
                                       ,
                                       j
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    w
                                    
                                       u
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          j
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                 j
                                 >
                                 m
                                 ,
                              
                           
                        
                     
                     
                        
                           (17)
                           
                              
                                 
                                    a
                                    
                                       u
                                       j
                                    
                                 
                                 =
                                 
                                    a
                                    
                                       u
                                       ,
                                       j
                                       +
                                       1
                                    
                                 
                                 +
                                 
                                    w
                                    
                                       u
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          j
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                 j
                                 <
                                 m
                                 ,
                              
                           
                        
                     
                     
                        
                           (18)
                           
                              
                                 
                                    
                                       
                                          b
                                          
                                             u
                                             j
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             b
                                             
                                                u
                                                ,
                                                j
                                                −
                                                1
                                             
                                          
                                          +
                                          
                                             a
                                             
                                                u
                                                ,
                                                j
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                   u
                                                
                                                −
                                             
                                             +
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             −
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      −
                                                      1
                                                      )
                                                   
                                                   u
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             a
                                             
                                                u
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                   u
                                                
                                                +
                                             
                                             +
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                   u
                                                
                                             
                                             )
                                          
                                          ,
                                          
                                          j
                                          >
                                          m
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (19)
                           
                              
                                 
                                    
                                       
                                          b
                                          
                                             u
                                             j
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             b
                                             
                                                u
                                                ,
                                                j
                                                +
                                                1
                                             
                                          
                                          +
                                          
                                             a
                                             
                                                u
                                                ,
                                                j
                                                +
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                   u
                                                
                                                −
                                             
                                             +
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             −
                                             
                                                γ
                                                
                                                   u
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             a
                                             
                                                u
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                   u
                                                
                                                +
                                             
                                             +
                                             
                                                γ
                                                
                                                   u
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                          ,
                                          
                                          j
                                          <
                                          m
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (20)
                           
                              
                                 
                                    d
                                    
                                       u
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          j
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    d
                                    
                                       u
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          j
                                          −
                                          1
                                          )
                                       
                                    
                                 
                                 +
                                 
                                    λ
                                    
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          j
                                          −
                                          1
                                          )
                                       
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          j
                                          )
                                       
                                    
                                    +
                                 
                                 +
                                 
                                    γ
                                    
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          j
                                          −
                                          1
                                          )
                                       
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          j
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                 j
                                 >
                                 m
                                 .
                              
                           
                        
                     
                  

To show (16), we decompose the right-hand side of (13):

                        
                           
                              
                                 
                                    a
                                    
                                       u
                                       j
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       m
                                       +
                                       1
                                    
                                    j
                                 
                                 
                                    w
                                    
                                       u
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       m
                                       +
                                       1
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                 
                                 
                                    w
                                    
                                       u
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                 
                                 +
                                 
                                    w
                                    
                                       u
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          j
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    a
                                    
                                       u
                                       ,
                                       j
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    w
                                    
                                       u
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          j
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                     Eq. (17) is derived similarly (the first case of the right-hand side of (13) is used). To obtain (18), we apply the same trick with respect to (14):

                        
                           (21)
                           
                              
                                 
                                    
                                       
                                          b
                                          
                                             u
                                             j
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             a
                                             
                                                u
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                λ
                                                u
                                             
                                             +
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                   u
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                m
                                                +
                                                1
                                             
                                             
                                                j
                                                −
                                                2
                                             
                                          
                                          
                                             a
                                             
                                                u
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             a
                                             
                                                u
                                                ,
                                                j
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Adding to and subtracting from (21) the term 
                        
                           
                              a
                              
                                 u
                                 ,
                                 j
                                 −
                                 1
                              
                           
                           
                              (
                              
                                 λ
                                 u
                              
                              +
                              
                                 γ
                                 
                                    
                                       p
                                       ′
                                    
                                    
                                       (
                                       j
                                       −
                                       1
                                       )
                                    
                                    u
                                 
                              
                              )
                           
                        
                      gives

                        
                           
                              
                                 
                                    
                                       
                                          b
                                          
                                             u
                                             j
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             a
                                             
                                                u
                                                ,
                                                j
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                λ
                                                u
                                             
                                             +
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      −
                                                      1
                                                      )
                                                   
                                                   u
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                m
                                                +
                                                1
                                             
                                             
                                                j
                                                −
                                                2
                                             
                                          
                                          
                                             a
                                             
                                                u
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             a
                                             
                                                u
                                                ,
                                                j
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             −
                                             
                                                λ
                                                u
                                             
                                             −
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      −
                                                      1
                                                      )
                                                   
                                                   u
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             a
                                             
                                                u
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                λ
                                                u
                                             
                                             +
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                   u
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             b
                                             
                                                u
                                                ,
                                                j
                                                −
                                                1
                                             
                                          
                                          +
                                          
                                             a
                                             
                                                u
                                                ,
                                                j
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                   u
                                                
                                                −
                                             
                                             +
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             −
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      −
                                                      1
                                                      )
                                                   
                                                   u
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             a
                                             
                                                u
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                   u
                                                
                                                +
                                             
                                             +
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                   u
                                                
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     To show (19) we proceed analogously and obtain

                        
                           
                              
                                 
                                    
                                       
                                          b
                                          
                                             u
                                             j
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             a
                                             
                                                u
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                u
                                             
                                             +
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                γ
                                                
                                                   u
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                j
                                                +
                                                2
                                             
                                             
                                                m
                                                −
                                                1
                                             
                                          
                                          
                                             a
                                             
                                                u
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             a
                                             
                                                u
                                                ,
                                                j
                                                +
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Continuing as in the previous case, we find that

                        
                           
                              
                                 
                                    
                                       
                                          b
                                          
                                             u
                                             j
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             a
                                             
                                                u
                                                ,
                                                j
                                                +
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                u
                                             
                                             +
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                γ
                                                
                                                   u
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                j
                                                +
                                                2
                                             
                                             
                                                m
                                                −
                                                1
                                             
                                          
                                          
                                             a
                                             
                                                u
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             a
                                             
                                                u
                                                ,
                                                j
                                                +
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             −
                                             
                                                λ
                                                u
                                             
                                             −
                                             
                                                γ
                                                
                                                   u
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             a
                                             
                                                u
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                u
                                             
                                             +
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                γ
                                                
                                                   u
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             b
                                             
                                                u
                                                ,
                                                j
                                                +
                                                1
                                             
                                          
                                          +
                                          
                                             a
                                             
                                                u
                                                ,
                                                j
                                                +
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                   u
                                                
                                                −
                                             
                                             +
                                             
                                                γ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             −
                                             
                                                γ
                                                
                                                   u
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             a
                                             
                                                u
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                   u
                                                
                                                +
                                             
                                             +
                                             
                                                γ
                                                
                                                   u
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Finally, we prove (20). Using (2), we can compute the distance between facilities u and p′(j)

                        
                           
                              
                                 
                                    d
                                    
                                       u
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          j
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    λ
                                    u
                                 
                                 +
                                 
                                    ∑
                                    
                                       i
                                       =
                                       m
                                       +
                                       1
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                 
                                 
                                    L
                                    
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                 
                                 +
                                 
                                    λ
                                    
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          j
                                          )
                                       
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       i
                                       =
                                       m
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                 
                                 
                                    γ
                                    
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          i
                                          +
                                          1
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        
                     Equivalently, we can write

                        
                           (22)
                           
                              
                                 
                                    
                                       
                                          d
                                          
                                             u
                                             
                                                p
                                                ′
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             λ
                                             u
                                          
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                m
                                                +
                                                1
                                             
                                             
                                                j
                                                −
                                                2
                                             
                                          
                                          
                                             L
                                             
                                                
                                                   p
                                                   ′
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                             
                                          
                                          +
                                          2
                                          
                                             λ
                                             
                                                
                                                   p
                                                   ′
                                                
                                                
                                                   (
                                                   j
                                                   −
                                                   1
                                                   )
                                                
                                             
                                          
                                          +
                                          
                                             λ
                                             
                                                
                                                   p
                                                   ′
                                                
                                                
                                                   (
                                                   j
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                m
                                             
                                             
                                                j
                                                −
                                                2
                                             
                                          
                                          
                                             γ
                                             
                                                
                                                   p
                                                   ′
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                
                                                   p
                                                   ′
                                                
                                                
                                                   (
                                                   i
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                          +
                                          
                                             γ
                                             
                                                
                                                   p
                                                   ′
                                                
                                                
                                                   (
                                                   j
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   p
                                                   ′
                                                
                                                
                                                   (
                                                   j
                                                   )
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Replacing 
                        
                           
                              λ
                              u
                           
                           +
                           
                              ∑
                              
                                 i
                                 =
                                 m
                                 +
                                 1
                              
                              
                                 j
                                 −
                                 2
                              
                           
                           
                              L
                              
                                 
                                    p
                                    ′
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                           +
                           
                              λ
                              
                                 
                                    p
                                    ′
                                 
                                 
                                    (
                                    j
                                    −
                                    1
                                    )
                                 
                              
                           
                           +
                           
                              ∑
                              
                                 i
                                 =
                                 m
                              
                              
                                 j
                                 −
                                 2
                              
                           
                           
                              γ
                              
                                 
                                    p
                                    ′
                                 
                                 
                                    (
                                    i
                                    )
                                 
                                 
                                    p
                                    ′
                                 
                                 
                                    (
                                    i
                                    +
                                    1
                                    )
                                 
                              
                           
                        
                      in (22) by 
                        
                           
                              d
                              
                                 u
                                 
                                    p
                                    ′
                                 
                                 
                                    (
                                    j
                                    −
                                    1
                                    )
                                 
                              
                           
                           ,
                        
                      we arrive at (20).

The procedure for updating entries of A, B and D related to facility 
                        
                           u
                           =
                           
                              p
                              ′
                           
                           
                              (
                              m
                              )
                           
                        
                      is summarized below:

                        
                           1.
                           If m < k, then compute auj
                              , 
                                 
                                    j
                                    =
                                    k
                                    ,
                                    …
                                    ,
                                    l
                                    −
                                    1
                                    ,
                                 
                               by (16), buj
                              , 
                                 
                                    j
                                    =
                                    k
                                    ,
                                    …
                                    ,
                                    n
                                    −
                                    1
                                    ,
                                 
                               by (18), and 
                                 
                                    
                                       d
                                       
                                          u
                                          
                                             p
                                             ′
                                          
                                          
                                             (
                                             j
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       d
                                       
                                          
                                             p
                                             ′
                                          
                                          
                                             (
                                             j
                                             )
                                          
                                          u
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    j
                                    =
                                    k
                                    ,
                                    …
                                    ,
                                    n
                                    ,
                                 
                               by (20). Go to 4.

If m > l, then compute auj
                              , 
                                 
                                    j
                                    =
                                    l
                                    ,
                                    l
                                    −
                                    1
                                    ,
                                    …
                                    ,
                                    k
                                    +
                                    1
                                    ,
                                 
                               by (17) and buj
                              , 
                                 
                                    j
                                    =
                                    l
                                    ,
                                    l
                                    −
                                    1
                                    ,
                                    …
                                    ,
                                    2
                                    ,
                                 
                               by (19). Go to 4.

If k < m < l, then set j
                              1 ≔ k and j
                              2 ≔ l. Otherwise, set 
                                 
                                    
                                       j
                                       1
                                    
                                    :
                                    =
                                    m
                                    −
                                    1
                                    ,
                                 
                              
                              
                                 
                                    
                                       j
                                       2
                                    
                                    :
                                    =
                                    m
                                    +
                                    1
                                    ,
                                 
                               
                              aum
                               ≔ 0 and bum
                               ≔ 0. Compute auj
                              , 
                                 
                                    j
                                    =
                                    
                                       j
                                       1
                                    
                                    ,
                                    
                                       j
                                       1
                                    
                                    −
                                    1
                                    ,
                                    …
                                    ,
                                    1
                                    ,
                                 
                               by (17) and buj
                              , 
                                 
                                    j
                                    =
                                    
                                       j
                                       1
                                    
                                    ,
                                    
                                       j
                                       1
                                    
                                    −
                                    1
                                    ,
                                    …
                                    ,
                                    2
                                    ,
                                 
                               by (19). Also, compute auj
                              , 
                                 
                                    j
                                    =
                                    
                                       j
                                       2
                                    
                                    ,
                                    …
                                    ,
                                    n
                                    ,
                                 
                               by (16), buj
                              , 
                                 
                                    j
                                    =
                                    
                                       j
                                       2
                                    
                                    ,
                                    …
                                    ,
                                    n
                                    −
                                    1
                                    ,
                                 
                               by (18), and 
                                 
                                    
                                       d
                                       
                                          u
                                          
                                             p
                                             ′
                                          
                                          
                                             (
                                             j
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       d
                                       
                                          
                                             p
                                             ′
                                          
                                          
                                             (
                                             j
                                             )
                                          
                                          u
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    j
                                    =
                                    
                                       j
                                       2
                                    
                                    ,
                                    …
                                    ,
                                    n
                                    ,
                                 
                               by (20).

Stop.

Additionally, in Step 3 of NE1, the cut vector C is updated. The computation is based on the following variation of (10):

                        
                           (23)
                           
                              
                                 
                                    c
                                    m
                                 
                                 =
                                 
                                    c
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    a
                                    
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                       n
                                    
                                 
                                 −
                                 
                                    a
                                    
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                     where 
                        
                           m
                           =
                           k
                           ,
                           …
                           ,
                           l
                           −
                           1
                        
                     .

Another remark is that the formulas (16)–(19) and (23) (with p′ replaced by p) can also be used to initialize the matrices A, B and vector C in Step 1 of LS1. Notice that, before applying (16)–(19), the entries a
                     
                        p(j)j
                      and b
                     
                        p(j)j
                      for each 
                        
                           j
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                      must be set to zero. It is easy to see that the initialization step of the local search algorithm takes O(n
                     2) time.

                        Example 1
                        Let us consider the 5-facility SRFLP instance taken from Simmons (1969). The flows of material between facilities are given by the following matrix:

                              
                                 
                                    
                                       W
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   2
                                                
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   2
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   6
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   2
                                                
                                                
                                                   6
                                                
                                                
                                                   0
                                                
                                                
                                                   4
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                                
                                                   3
                                                
                                                
                                                   4
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           
                        

The vector of lengths of facilities is (1, 3, 4, 6, 7). In order to avoid fractional numbers, we multiply its components by 2. Thus, 
                              
                                 
                                    L
                                    1
                                 
                                 =
                                 2
                                 ,
                              
                           
                           
                              
                                 
                                    L
                                    2
                                 
                                 =
                                 6
                                 ,
                              
                           
                           
                              
                                 
                                    L
                                    3
                                 
                                 =
                                 8
                                 ,
                              
                           
                           
                              
                                 
                                    L
                                    4
                                 
                                 =
                                 12
                                 ,
                              
                            and 
                              
                                 
                                    L
                                    5
                                 
                                 =
                                 14
                              
                           . There are no clearances between facilities specified in this instance, so the formula (15) for calculating Δ values becomes simpler.

Suppose that LS1 is applied to the permutation 
                              
                                 p
                                 =
                                 (
                                 3
                                 ,
                                 5
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 4
                                 )
                              
                            (the corresponding layout is depicted in the left part of Fig. 1). Taking into account the fact that we doubled the length of each facility, the objective function value of the solution p is 386. Step 1 of LS1 initializes the data needed for the procedure NE1. Starting with 
                              
                                 
                                    a
                                    
                                       p
                                       (
                                       j
                                       )
                                       j
                                    
                                 
                                 =
                                 0
                              
                            for all j and using (16) and (17), the matrix A for p is constructed:

                              
                                 
                                    
                                       A
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   4
                                                
                                                
                                                   4
                                                
                                                
                                                   2
                                                
                                                
                                                   0
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   3
                                                
                                                
                                                   4
                                                
                                                
                                                   4
                                                
                                                
                                                   10
                                                
                                             
                                             
                                                
                                                   12
                                                
                                                
                                                   6
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   3
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                                
                                                   3
                                                
                                                
                                                   7
                                                
                                             
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           Then, using (18) and (19), the entries of the matrix B can be computed:

                              
                                 
                                    
                                       B
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   21
                                                
                                                
                                                   8
                                                
                                                
                                                   0
                                                
                                                
                                                   8
                                                
                                                
                                                   32
                                                
                                             
                                             
                                                
                                                   88
                                                
                                                
                                                   56
                                                
                                                
                                                   8
                                                
                                                
                                                   0
                                                
                                                
                                                   18
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   33
                                                
                                                
                                                   44
                                                
                                                
                                                   68
                                                
                                                
                                                   176
                                                
                                             
                                             
                                                
                                                   210
                                                
                                                
                                                   102
                                                
                                                
                                                   22
                                                
                                                
                                                   18
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   33
                                                
                                                
                                                   0
                                                
                                                
                                                   8
                                                
                                                
                                                   34
                                                
                                                
                                                   122
                                                
                                             
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           The distance matrix corresponding to p is as follows:

                              
                                 
                                    
                                       D
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   4
                                                
                                                
                                                   19
                                                
                                                
                                                   13
                                                
                                                
                                                   8
                                                
                                             
                                             
                                                
                                                   4
                                                
                                                
                                                   0
                                                
                                                
                                                   23
                                                
                                                
                                                   9
                                                
                                                
                                                   12
                                                
                                             
                                             
                                                
                                                   19
                                                
                                                
                                                   23
                                                
                                                
                                                   0
                                                
                                                
                                                   32
                                                
                                                
                                                   11
                                                
                                             
                                             
                                                
                                                   13
                                                
                                                
                                                   9
                                                
                                                
                                                   32
                                                
                                                
                                                   0
                                                
                                                
                                                   21
                                                
                                             
                                             
                                                
                                                   8
                                                
                                                
                                                   12
                                                
                                                
                                                   11
                                                
                                                
                                                   21
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           The cut vector is 
                              
                                 C
                                 =
                                 (
                                 10
                                 ,
                                 14
                                 ,
                                 14
                                 ,
                                 12
                                 )
                              
                           . From it, we obtain the vectors 
                              
                                 
                                    C
                                    −
                                 
                                 =
                                 
                                    (
                                    10
                                    ,
                                    4
                                    ,
                                    0
                                    ,
                                    −
                                    2
                                    ,
                                    −
                                    12
                                    )
                                 
                              
                            and 
                              
                                 
                                    C
                                    +
                                 
                                 =
                                 
                                    (
                                    10
                                    ,
                                    24
                                    ,
                                    28
                                    ,
                                    26
                                    ,
                                    12
                                    )
                                 
                              
                           . Now, using (15), the value of Δ for each pair of facilities can easily be calculated. For example, consider the second and fifth facilities in the permutation p. In this case, 
                              
                                 k
                                 =
                                 2
                                 ,
                              
                           
                           
                              
                                 l
                                 =
                                 5
                                 ,
                              
                           
                           
                              
                                 r
                                 =
                                 5
                                 ,
                              
                           
                           
                              
                                 s
                                 =
                                 4
                                 ,
                              
                            and 
                              
                                 
                                    λ
                                    
                                       5
                                       ,
                                       4
                                    
                                    −
                                 
                                 =
                                 7
                                 −
                                 6
                                 =
                                 1
                              
                           . From (15), we obtain 
                              
                                 Δ
                                 (
                                 p
                                 ,
                                 2
                                 ,
                                 5
                                 )
                                 =
                                 (
                                 −
                                 12
                                 −
                                 4
                                 +
                                 2
                                 ·
                                 4
                                 )
                                 21
                                 +
                                 2
                                 (
                                 34
                                 +
                                 22
                                 )
                                 +
                                 1
                                 ·
                                 (
                                 12
                                 −
                                 24
                                 )
                                 =
                                 −
                                 68
                              
                           . Other Δ values are calculated similarly: 
                              
                                 Δ
                                 (
                                 p
                                 ,
                                 1
                                 ,
                                 2
                                 )
                                 =
                                 −
                                 42
                                 ,
                              
                           
                           
                              
                                 Δ
                                 (
                                 p
                                 ,
                                 1
                                 ,
                                 3
                                 )
                                 =
                                 −
                                 16
                                 ,
                              
                           
                           
                              
                                 Δ
                                 (
                                 p
                                 ,
                                 1
                                 ,
                                 4
                                 )
                                 =
                                 −
                                 60
                                 ,
                              
                           
                           
                              
                                 Δ
                                 (
                                 p
                                 ,
                                 1
                                 ,
                                 5
                                 )
                                 =
                                 16
                                 ,
                              
                           
                           
                              
                                 Δ
                                 (
                                 p
                                 ,
                                 2
                                 ,
                                 3
                                 )
                                 =
                                 8
                                 ,
                              
                           
                           
                              
                                 Δ
                                 (
                                 p
                                 ,
                                 2
                                 ,
                                 4
                                 )
                                 =
                                 16
                                 ,
                              
                           
                           
                              
                                 Δ
                                 (
                                 p
                                 ,
                                 3
                                 ,
                                 4
                                 )
                                 =
                                 12
                                 ,
                              
                           
                           
                              
                                 Δ
                                 (
                                 p
                                 ,
                                 3
                                 ,
                                 5
                                 )
                                 =
                                 −
                                 24
                                 ,
                              
                           
                           
                              
                                 Δ
                                 (
                                 p
                                 ,
                                 4
                                 ,
                                 5
                                 )
                                 =
                                 −
                                 12
                              
                           . The maximum decrease in objective function value is achieved by interchanging the second and fifth facilities in p (the obtained layout is shown in the right part of Fig. 1). In Step 3 of NE1, the matrices and vectors are updated to correspond to the new permutation 
                              
                                 p
                                 =
                                 (
                                 3
                                 ,
                                 4
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 5
                                 )
                              
                           . This is done using the above given four-step procedure based on formulas (16)–(20). The matrix A takes the following form:

                              
                                 
                                    
                                       A
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   2
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   4
                                                
                                                
                                                   4
                                                
                                                
                                                   2
                                                
                                                
                                                   0
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   6
                                                
                                                
                                                   7
                                                
                                                
                                                   7
                                                
                                                
                                                   10
                                                
                                             
                                             
                                                
                                                   6
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   2
                                                
                                                
                                                   6
                                                
                                             
                                             
                                                
                                                   10
                                                
                                                
                                                   7
                                                
                                                
                                                   3
                                                
                                                
                                                   2
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           A relevant part of the matrix B is given below (the entries of B in the first and last columns, except b
                           
                              p(1)1 and 
                              
                                 
                                    b
                                    
                                       p
                                       (
                                       n
                                       )
                                       n
                                    
                                 
                                 =
                                 
                                    b
                                    
                                       p
                                       (
                                       5
                                       )
                                       5
                                    
                                 
                                 ,
                              
                            are not used in (15) and are not recalculated by the algorithm; therefore, we replace them by asterisks):

                              
                                 
                                    
                                       B
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   *
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   8
                                                
                                                
                                                   *
                                                
                                             
                                             
                                                
                                                   *
                                                
                                                
                                                   50
                                                
                                                
                                                   8
                                                
                                                
                                                   0
                                                
                                                
                                                   *
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   60
                                                
                                                
                                                   77
                                                
                                                
                                                   119
                                                
                                                
                                                   *
                                                
                                             
                                             
                                                
                                                   *
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   18
                                                
                                                
                                                   *
                                                
                                             
                                             
                                                
                                                   *
                                                
                                                
                                                   120
                                                
                                                
                                                   32
                                                
                                                
                                                   20
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           The new cut vector is 
                              
                                 C
                                 =
                                 (
                                 10
                                 ,
                                 10
                                 ,
                                 12
                                 ,
                                 10
                                 )
                              
                           . In the next iteration, NE1 explores the interchange neighborhood of the updated permutation p. This is done in the same way as we have described above.

We end the section with the following statement concerning the effectiveness of our approach.

                        Proposition 3
                        
                           The computational complexity of the procedure NE1 is O(n
                           2).
                        

First, notice that the vectors C, 
                              
                                 
                                    C
                                    −
                                 
                                 ,
                              
                           
                           
                              
                                 C
                                 +
                              
                            and matrices B and D remain unchanged during execution of Step 2 of NE1. These vectors and matrices are passed as parameters to the procedure. Thus, using (15), Δ(p, k, l) can be computed in Step 2 in constant time. Hence, the complexity of Step 2 of NE1 is O(n
                           2). If h
                           * < 0, then NE1 updates the data used in Δ calculations. These data will be returned to NE1 at the next call to this procedure in Step 2 of LS1. In order to update the matrices A, B and D, Step 3 of NE1 applies the above-described four-step method based on equations (16)–(20). It is clear that, for each facility, this method runs in O(n) time. Therefore, in total, it performs O(n
                           2) operations. Since the vectors C, 
                              
                                 C
                                 −
                              
                            and 
                              
                                 C
                                 +
                              
                            can be updated in linear time using (23), the overall complexity of Step 3, and hence of the entire procedure, is O(n
                           2).□

Another strategy in the development of local search techniques for the SRFLP is to use the insertion neighborhood structure. We will describe two practical procedures for exploring this neighborhood. The first one takes advantage of the matrices A and B introduced in the previous section. The second procedure is somewhat simpler because it does not use these two auxiliary matrices. However, this procedure suffers from the restriction imposed on the order in which solutions are explored.

For p ∈ Π, 
                           
                              k
                              ,
                              l
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              n
                              }
                              ,
                           
                         
                        k ≠ l, let p′ be the permutation obtained from p by removing the facility p(k) from position k and inserting it at position l. Let us denote the resulting change in the objective function value by 
                           
                              δ
                              
                                 (
                                 p
                                 ,
                                 k
                                 ,
                                 l
                                 )
                              
                              =
                              F
                              
                                 (
                                 
                                    p
                                    ′
                                 
                                 )
                              
                              −
                              F
                              
                                 (
                                 p
                                 )
                              
                           
                        . An efficient way to compute δ(p, k, l) is provided by the proposition stated below and proved in Appendix A.

                           Proposition 4
                           
                              Let p ∈ Π, 
                                 
                                    k
                                    ,
                                    l
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    }
                                    ,
                                 
                               
                              k ≠ l, and
                              
                                 
                                    r
                                    =
                                    p
                                    (
                                    k
                                    )
                                 
                              
                              . Then, for l > k,

                                 
                                    (24)
                                    
                                       
                                          
                                             
                                                
                                                   δ
                                                   (
                                                   p
                                                   ,
                                                   k
                                                   ,
                                                   l
                                                   )
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   2
                                                   
                                                      b
                                                      
                                                         r
                                                         l
                                                      
                                                   
                                                   −
                                                   
                                                      c
                                                      k
                                                      −
                                                   
                                                   
                                                      (
                                                      
                                                         d
                                                         
                                                            p
                                                            (
                                                            k
                                                            +
                                                            1
                                                            )
                                                            p
                                                            (
                                                            l
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         λ
                                                         
                                                            p
                                                            (
                                                            k
                                                            +
                                                            1
                                                            )
                                                            p
                                                            (
                                                            l
                                                            )
                                                         
                                                         +
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      L
                                                      r
                                                   
                                                   
                                                      (
                                                      
                                                         c
                                                         l
                                                      
                                                      −
                                                      
                                                         c
                                                         k
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   +
                                                   
                                                   
                                                      c
                                                      
                                                         k
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            k
                                                            −
                                                            1
                                                            )
                                                            p
                                                            (
                                                            k
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            l
                                                            )
                                                            r
                                                         
                                                      
                                                      −
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            k
                                                            −
                                                            1
                                                            )
                                                            r
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   −
                                                   
                                                   
                                                      c
                                                      k
                                                   
                                                   
                                                      (
                                                      
                                                         γ
                                                         
                                                            r
                                                            p
                                                            (
                                                            k
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            l
                                                            )
                                                            r
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   +
                                                   
                                                   
                                                      c
                                                      l
                                                   
                                                   
                                                      (
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            l
                                                            )
                                                            r
                                                         
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            r
                                                            p
                                                            (
                                                            l
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      −
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            l
                                                            )
                                                            p
                                                            (
                                                            l
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              and, for l < k,

                                 
                                    (25)
                                    
                                       
                                          
                                             
                                                
                                                   δ
                                                   (
                                                   p
                                                   ,
                                                   k
                                                   ,
                                                   l
                                                   )
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   2
                                                   
                                                      b
                                                      
                                                         r
                                                         l
                                                      
                                                   
                                                   +
                                                   
                                                      c
                                                      k
                                                      −
                                                   
                                                   
                                                      (
                                                      
                                                         d
                                                         
                                                            p
                                                            (
                                                            l
                                                            )
                                                            p
                                                            (
                                                            k
                                                            −
                                                            1
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         λ
                                                         
                                                            p
                                                            (
                                                            l
                                                            )
                                                            p
                                                            (
                                                            k
                                                            −
                                                            1
                                                            )
                                                         
                                                         +
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      L
                                                      r
                                                   
                                                   
                                                      (
                                                      
                                                         c
                                                         
                                                            l
                                                            −
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         c
                                                         
                                                            k
                                                            −
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   +
                                                   
                                                   
                                                      c
                                                      
                                                         l
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            l
                                                            −
                                                            1
                                                            )
                                                            r
                                                         
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            r
                                                            p
                                                            (
                                                            l
                                                            )
                                                         
                                                      
                                                      −
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            l
                                                            −
                                                            1
                                                            )
                                                            p
                                                            (
                                                            l
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   −
                                                   
                                                   
                                                      c
                                                      
                                                         k
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         γ
                                                         
                                                            r
                                                            p
                                                            (
                                                            l
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            k
                                                            −
                                                            1
                                                            )
                                                            r
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   +
                                                   
                                                   
                                                      c
                                                      k
                                                   
                                                   
                                                      (
                                                      
                                                         γ
                                                         
                                                            r
                                                            p
                                                            (
                                                            l
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            k
                                                            −
                                                            1
                                                            )
                                                            p
                                                            (
                                                            k
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      −
                                                      
                                                         γ
                                                         
                                                            r
                                                            p
                                                            (
                                                            k
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

We will refer to the neighborhood exploration and local search algorithms based on (24) and (25) as NE2 and LS2, respectively. The former is similar to NE1 with a few differences. First, Step 2 is executed for all pairs (k, l) such that 
                           
                              k
                              ,
                              l
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              n
                              }
                           
                         and k ≠ l. Second, of course, Δ is replaced by δ calculated using either Eq. (24) or (25) depending on whether l > k or l < k. Third, in Step 3, the permutation p is updated by relocating the facility p(k′) from position k′ to position l′. Fourth, the vector 
                           
                              C
                              +
                           
                         is eliminated. The LS2 algorithm is almost identical to LS1. The only differences are that the procedure NE2 instead of NE1 is invoked and the vector 
                           
                              C
                              +
                           
                         is not used.

The routine for updating the matrices A, B and D is slightly more complicated than in the case of pairwise interchanges. For their entries corresponding to facility 
                           
                              u
                              =
                              
                                 p
                                 ′
                              
                              
                                 (
                                 m
                                 )
                              
                              ,
                           
                         it goes as follows.

                           
                              1.
                              Let 
                                    
                                       
                                          j
                                          1
                                       
                                       =
                                       min
                                       
                                          (
                                          k
                                          ,
                                          l
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          j
                                          2
                                       
                                       =
                                       max
                                       
                                          (
                                          k
                                          ,
                                          l
                                          )
                                       
                                    
                                 .

If m < j
                                 1, then compute auj
                                 , 
                                    
                                       j
                                       =
                                       
                                          j
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          j
                                          2
                                       
                                       −
                                       1
                                       ,
                                    
                                  by (16), buj
                                 , 
                                    
                                       j
                                       =
                                       
                                          j
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       n
                                       ,
                                    
                                  by (18), and 
                                    
                                       
                                          d
                                          
                                             u
                                             
                                                p
                                                ′
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                          
                                       
                                       =
                                       
                                          d
                                          
                                             
                                                p
                                                ′
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                             u
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       j
                                       =
                                       
                                          j
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       n
                                       ,
                                    
                                  by (20). Go to 6.

If m > j
                                 2, then compute auj
                                 , 
                                    
                                       j
                                       =
                                       
                                          j
                                          2
                                       
                                       ,
                                       
                                          j
                                          2
                                       
                                       −
                                       1
                                       ,
                                       …
                                       ,
                                       
                                          j
                                          1
                                       
                                       +
                                       1
                                       ,
                                    
                                  by (17) and buj
                                 , 
                                    
                                       j
                                       =
                                       
                                          j
                                          2
                                       
                                       ,
                                       
                                          j
                                          2
                                       
                                       −
                                       1
                                       ,
                                       …
                                       ,
                                       1
                                       ,
                                    
                                  by (19). Go to 6.

If 
                                    
                                       m
                                       =
                                       l
                                    
                                  (that is, 
                                    
                                       u
                                       =
                                       
                                          p
                                          ′
                                       
                                       
                                          (
                                          l
                                          )
                                       
                                       =
                                       p
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 ), then perform the following operations. Set aum
                                  ≔ 0 and bum
                                  ≔ 0. For 
                                    
                                       j
                                       =
                                       l
                                       −
                                       1
                                       ,
                                       l
                                       −
                                       2
                                       ,
                                       …
                                       ,
                                       1
                                       ,
                                    
                                  compute auj
                                  by (17) and buj
                                  by (19). Also, for 
                                    
                                       j
                                       =
                                       l
                                       +
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       ,
                                    
                                  compute auj
                                  by (16), buj
                                  by (18) and 
                                    
                                       
                                          d
                                          
                                             u
                                             
                                                p
                                                ′
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                          
                                       
                                       =
                                       
                                          d
                                          
                                             
                                                p
                                                ′
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                             u
                                          
                                       
                                    
                                  by (20). Go to 6.

If k < l, then set 
                                    
                                       
                                          j
                                          1
                                       
                                       :
                                       =
                                       k
                                       −
                                       1
                                       ,
                                    
                                  
                                 j
                                 2 ≔ l and 
                                    
                                       
                                          a
                                          
                                             u
                                             j
                                          
                                       
                                       :
                                       =
                                       
                                          a
                                          
                                             u
                                             ,
                                             j
                                             +
                                             1
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          b
                                          
                                             u
                                             j
                                          
                                       
                                       :
                                       =
                                       
                                          b
                                          
                                             u
                                             ,
                                             j
                                             +
                                             1
                                          
                                       
                                    
                                  for 
                                    
                                       j
                                       =
                                       k
                                       ,
                                       …
                                       ,
                                       l
                                       −
                                       1
                                    
                                 . Otherwise, set j
                                 1 ≔ l, 
                                    
                                       
                                          j
                                          2
                                       
                                       :
                                       =
                                       k
                                       +
                                       1
                                    
                                  and 
                                    
                                       
                                          a
                                          
                                             u
                                             j
                                          
                                       
                                       :
                                       =
                                       
                                          a
                                          
                                             u
                                             ,
                                             j
                                             −
                                             1
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          b
                                          
                                             u
                                             j
                                          
                                       
                                       :
                                       =
                                       
                                          b
                                          
                                             u
                                             ,
                                             j
                                             −
                                             1
                                          
                                       
                                    
                                  for 
                                    
                                       j
                                       =
                                       k
                                       ,
                                       k
                                       −
                                       1
                                       ,
                                       …
                                       ,
                                       l
                                       +
                                       1
                                    
                                 . In both cases, for 
                                    
                                       j
                                       =
                                       
                                          j
                                          1
                                       
                                       ,
                                       
                                          j
                                          1
                                       
                                       −
                                       1
                                       ,
                                       …
                                       ,
                                       1
                                       ,
                                    
                                  compute auj
                                  by (17) and buj
                                  by (19). Also, for 
                                    
                                       j
                                       =
                                       
                                          j
                                          2
                                       
                                       ,
                                       …
                                       ,
                                       n
                                       ,
                                    
                                  compute auj
                                  by (16), buj
                                  by (18), and 
                                    
                                       
                                          d
                                          
                                             u
                                             
                                                p
                                                ′
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                          
                                       
                                       =
                                       
                                          d
                                          
                                             
                                                p
                                                ′
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                             u
                                          
                                       
                                    
                                  by (20).

Stop.

We note that the cut vector C can be updated in the same way as it is done in the procedure NE1. However, unlike NE1, the procedure NE2 does not maintain the vector 
                           
                              C
                              +
                           
                        . Owing to the similarity between NE1 and NE2, the following result should be clear.

                           Proposition 5
                           
                              The computational complexity of the procedure NE2 is O(n
                              2).
                           

Consider the same SRFLP instance as in Example 1. Suppose that LS2 and NE2 are applied to the same permutation as before, that is, 
                                 
                                    p
                                    =
                                    (
                                    3
                                    ,
                                    5
                                    ,
                                    1
                                    ,
                                    2
                                    ,
                                    4
                                    )
                                 
                              . To illustrate Proposition 5, we compute the value of δ for the case when the last facility in p is moved to the first position (the layouts corresponding to p as well as to the new permutation are shown in Fig. 2
                              ). In this case, 
                                 
                                    k
                                    =
                                    5
                                    ,
                                 
                              
                              
                                 
                                    l
                                    =
                                    1
                                    ,
                                 
                              
                              
                                 
                                    r
                                    =
                                    4
                                    ,
                                 
                               and 
                                 
                                    
                                       λ
                                       
                                          p
                                          (
                                          l
                                          )
                                          p
                                          (
                                          k
                                          −
                                          1
                                          )
                                       
                                       +
                                    
                                    =
                                    
                                       λ
                                       
                                          3
                                          ,
                                          2
                                       
                                       +
                                    
                                    =
                                    7
                                 
                              . The initial matrices A, B, D and vectors C and 
                                 
                                    C
                                    −
                                 
                               are the same as in Example 1. Therefore, using (25), we have 
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    5
                                    ,
                                    1
                                    )
                                    =
                                    2
                                    ·
                                    210
                                    +
                                    (
                                    −
                                    12
                                    )
                                    (
                                    23
                                    +
                                    7
                                    )
                                    +
                                    12
                                    (
                                    0
                                    −
                                    12
                                    )
                                    =
                                    −
                                    84
                                 
                              . Other δ values are as follows: 
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    1
                                    ,
                                    2
                                    )
                                    =
                                    −
                                    42
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    1
                                    ,
                                    3
                                    )
                                    =
                                    −
                                    40
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    1
                                    ,
                                    4
                                    )
                                    =
                                    −
                                    68
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    1
                                    ,
                                    5
                                    )
                                    =
                                    −
                                    68
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    2
                                    ,
                                    1
                                    )
                                    =
                                    −
                                    42
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    2
                                    ,
                                    3
                                    )
                                    =
                                    8
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    2
                                    ,
                                    4
                                    )
                                    =
                                    8
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    2
                                    ,
                                    5
                                    )
                                    =
                                    −
                                    32
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    3
                                    ,
                                    1
                                    )
                                    =
                                    14
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    3
                                    ,
                                    2
                                    )
                                    =
                                    8
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    3
                                    ,
                                    4
                                    )
                                    =
                                    12
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    3
                                    ,
                                    5
                                    )
                                    =
                                    36
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    4
                                    ,
                                    1
                                    )
                                    =
                                    44
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    4
                                    ,
                                    2
                                    )
                                    =
                                    56
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    4
                                    ,
                                    3
                                    )
                                    =
                                    12
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    4
                                    ,
                                    5
                                    )
                                    =
                                    −
                                    12
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    5
                                    ,
                                    2
                                    )
                                    =
                                    −
                                    84
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    5
                                    ,
                                    3
                                    )
                                    =
                                    −
                                    28
                                    ,
                                 
                              
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    5
                                    ,
                                    4
                                    )
                                    =
                                    −
                                    12
                                 
                              . Since δ(p, 5, 1) ≤ δ(p, k, l) for all 
                                 
                                    k
                                    ,
                                    l
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    5
                                    ,
                                 
                               
                              k ≠ l, facility 4 is moved to position 1. Then, using the above given six-step procedure based on (16)–(20), the matrices A and B are updated:

                                 
                                    
                                       
                                          A
                                          =
                                          
                                             [
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      6
                                                   
                                                   
                                                      4
                                                   
                                                   
                                                      4
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      6
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      4
                                                   
                                                   
                                                      4
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      6
                                                   
                                                   
                                                      10
                                                   
                                                   
                                                      10
                                                   
                                                   
                                                      12
                                                   
                                                
                                                
                                                   
                                                      7
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             ]
                                          
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          B
                                          =
                                          
                                             [
                                             
                                                
                                                   
                                                      45
                                                   
                                                   
                                                      21
                                                   
                                                   
                                                      8
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      8
                                                   
                                                
                                                
                                                   
                                                      154
                                                   
                                                   
                                                      88
                                                   
                                                   
                                                      56
                                                   
                                                   
                                                      8
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      60
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      33
                                                   
                                                   
                                                      44
                                                   
                                                   
                                                      68
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      60
                                                   
                                                   
                                                      196
                                                   
                                                   
                                                      216
                                                   
                                                   
                                                      294
                                                   
                                                
                                                
                                                   
                                                      121
                                                   
                                                   
                                                      33
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      8
                                                   
                                                   
                                                      34
                                                   
                                                
                                             
                                             ]
                                          
                                          .
                                       
                                    
                                 
                              
                           

The new cut vector is 
                                 
                                    C
                                    =
                                    (
                                    12
                                    ,
                                    10
                                    ,
                                    6
                                    ,
                                    6
                                    )
                                 
                              . The resulting layout is shown in the right part of Fig. 2. The corresponding objective function value with respect to original (not doubled) facility lengths is 151. We notice that the obtained layout is optimal (see Amaral (2006)).

Another efficient method for exploring the insertion neighborhood rests on the idea to include the value of δ, calculated in the previous step, in an expression for δ(p, k, l). In the following, we present our realization of this idea.

                           Proposition 6
                           
                              Let p ∈ Π, 
                                 
                                    k
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    }
                                    ,
                                 
                               
                              and
                              
                                 
                                    r
                                    =
                                    p
                                    (
                                    k
                                    )
                                 
                              
                              . Then, for
                              
                                 
                                    l
                                    =
                                    k
                                    +
                                    1
                                    ,
                                    k
                                    +
                                    2
                                    ,
                                    …
                                    ,
                                    n
                                    ,
                                 
                              
                              
                                 
                                    (26)
                                    
                                       
                                          
                                             
                                                
                                                   δ
                                                   (
                                                   p
                                                   ,
                                                   k
                                                   ,
                                                   l
                                                   )
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   δ
                                                   
                                                      (
                                                      p
                                                      ,
                                                      k
                                                      ,
                                                      l
                                                      −
                                                      1
                                                      )
                                                   
                                                   +
                                                   
                                                      L
                                                      r
                                                   
                                                   
                                                      (
                                                      
                                                         w
                                                         
                                                            r
                                                            p
                                                            (
                                                            l
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         c
                                                         l
                                                         −
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      L
                                                      
                                                         p
                                                         (
                                                         l
                                                         )
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         e
                                                         
                                                            l
                                                            −
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         e
                                                         l
                                                      
                                                      −
                                                      
                                                         c
                                                         k
                                                         −
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   +
                                                   
                                                   2
                                                   
                                                      w
                                                      
                                                         p
                                                         (
                                                         l
                                                         )
                                                         r
                                                      
                                                   
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         l
                                                         )
                                                         r
                                                      
                                                   
                                                   +
                                                   
                                                      (
                                                      2
                                                      
                                                         e
                                                         
                                                            l
                                                            −
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         c
                                                         k
                                                         −
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         γ
                                                         
                                                            u
                                                            p
                                                            (
                                                            l
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            l
                                                            )
                                                            r
                                                         
                                                      
                                                      −
                                                      
                                                         γ
                                                         
                                                            u
                                                            r
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   −
                                                   
                                                   
                                                      c
                                                      
                                                         l
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         γ
                                                         
                                                            u
                                                            r
                                                         
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            r
                                                            p
                                                            (
                                                            l
                                                            )
                                                         
                                                      
                                                      −
                                                      
                                                         γ
                                                         
                                                            u
                                                            p
                                                            (
                                                            l
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   +
                                                   
                                                   
                                                      c
                                                      l
                                                   
                                                   
                                                      (
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            l
                                                            )
                                                            r
                                                         
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            r
                                                            p
                                                            (
                                                            l
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      −
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            l
                                                            )
                                                            p
                                                            (
                                                            l
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              where
                              
                                 
                                    
                                       e
                                       l
                                    
                                    =
                                    
                                       e
                                       
                                          l
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       w
                                       
                                          r
                                          p
                                          (
                                          l
                                          )
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    u
                                    =
                                    p
                                    (
                                    k
                                    −
                                    1
                                    )
                                 
                               
                              if
                              
                                 
                                    l
                                    =
                                    k
                                    +
                                    1
                                    ,
                                 
                              
                              
                                 
                                    u
                                    =
                                    p
                                    (
                                    l
                                    −
                                    1
                                    )
                                 
                               
                              if
                              
                                 
                                    l
                                    ≠
                                    k
                                    +
                                    1
                                    ,
                                 
                               
                              and initially
                              
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    k
                                    ,
                                    k
                                    )
                                    =
                                    0
                                 
                               
                              and
                              
                                 
                                    
                                       e
                                       k
                                    
                                    =
                                    0
                                 
                              
                              .
                           


                              For
                              
                                 
                                    l
                                    =
                                    k
                                    −
                                    1
                                    ,
                                    k
                                    −
                                    2
                                    ,
                                    …
                                    ,
                                    1
                                    ,
                                 
                              
                              
                                 
                                    (27)
                                    
                                       
                                          
                                             
                                                
                                                   δ
                                                   (
                                                   p
                                                   ,
                                                   k
                                                   ,
                                                   l
                                                   )
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   δ
                                                   
                                                      (
                                                      p
                                                      ,
                                                      k
                                                      ,
                                                      l
                                                      +
                                                      1
                                                      )
                                                   
                                                   +
                                                   
                                                      L
                                                      r
                                                   
                                                   
                                                      (
                                                      
                                                         w
                                                         
                                                            r
                                                            p
                                                            (
                                                            l
                                                            )
                                                         
                                                      
                                                      −
                                                      
                                                         c
                                                         l
                                                         −
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      L
                                                      
                                                         p
                                                         (
                                                         l
                                                         )
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         e
                                                         l
                                                      
                                                      +
                                                      
                                                         e
                                                         
                                                            l
                                                            +
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         c
                                                         k
                                                         −
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   +
                                                   
                                                   2
                                                   
                                                      w
                                                      
                                                         r
                                                         p
                                                         (
                                                         l
                                                         )
                                                      
                                                   
                                                   
                                                      γ
                                                      
                                                         r
                                                         p
                                                         (
                                                         l
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      (
                                                      2
                                                      
                                                         e
                                                         
                                                            l
                                                            +
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         c
                                                         k
                                                         −
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         γ
                                                         
                                                            r
                                                            p
                                                            (
                                                            l
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            l
                                                            )
                                                            u
                                                         
                                                      
                                                      −
                                                      
                                                         γ
                                                         
                                                            r
                                                            u
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   +
                                                   
                                                   
                                                      c
                                                      
                                                         l
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            l
                                                            −
                                                            1
                                                            )
                                                            r
                                                         
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            r
                                                            p
                                                            (
                                                            l
                                                            )
                                                         
                                                      
                                                      −
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            l
                                                            −
                                                            1
                                                            )
                                                            p
                                                            (
                                                            l
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   −
                                                   
                                                   
                                                      c
                                                      l
                                                   
                                                   
                                                      (
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            l
                                                            )
                                                            r
                                                         
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            r
                                                            u
                                                         
                                                      
                                                      −
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            l
                                                            )
                                                            u
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              where
                              
                                 
                                    
                                       e
                                       l
                                    
                                    =
                                    
                                       e
                                       
                                          l
                                          +
                                          1
                                       
                                    
                                    +
                                    
                                       w
                                       
                                          r
                                          p
                                          (
                                          l
                                          )
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    u
                                    =
                                    p
                                    (
                                    k
                                    +
                                    1
                                    )
                                 
                               
                              if
                              
                                 
                                    l
                                    =
                                    k
                                    −
                                    1
                                    ,
                                 
                              
                              
                                 
                                    u
                                    =
                                    p
                                    (
                                    l
                                    +
                                    1
                                    )
                                 
                               
                              if
                              
                                 
                                    l
                                    ≠
                                    k
                                    −
                                    1
                                    ,
                                 
                               
                              and initial conditions are as in (
                              
                                 26
                              
                              ).
                           

The proof of Proposition 6 is given in Appendix A. When the clearance matrix Γ is zero, Eqs. (26) and (27) take simplified forms. In this case, the right-hand side of each of them, besides the previous value of δ, has only two terms.

Let Aq
                        , 
                           
                              q
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              n
                              }
                              ,
                           
                         denote the q-th column vector of the matrix A. Our third neighborhood exploration procedure for the SRFLP can be described as follows.

NE3(
                           
                              p
                              ,
                              
                                 A
                                 1
                              
                              ,
                              
                                 A
                                 n
                              
                              ,
                              C
                              ,
                              
                                 C
                                 −
                              
                           
                        )

                           
                              1.
                              Set h
                                 * ≔ 0.

For 
                                    
                                       k
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                    
                                  do the following:
                                    
                                       2.1.
                                       Set δ(p, k, k) ≔ 0 and ek
                                           ≔ 0.

For 
                                             
                                                l
                                                =
                                                k
                                                −
                                                1
                                                ,
                                                k
                                                −
                                                2
                                                ,
                                                …
                                                ,
                                                1
                                                ,
                                             
                                           perform the following operations. Set 
                                             
                                                
                                                   e
                                                   l
                                                
                                                :
                                                =
                                                
                                                   e
                                                   
                                                      l
                                                      +
                                                      1
                                                   
                                                
                                                +
                                                
                                                   w
                                                   
                                                      p
                                                      (
                                                      k
                                                      )
                                                      p
                                                      (
                                                      l
                                                      )
                                                   
                                                
                                             
                                          . Compute 
                                             
                                                h
                                                =
                                                δ
                                                (
                                                p
                                                ,
                                                k
                                                ,
                                                l
                                                )
                                             
                                           by Eq. (27). If h < h
                                          *, then set h
                                          * ≔ h, k′ ≔ k and l′ ≔ l.

For 
                                             
                                                l
                                                =
                                                k
                                                +
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                ,
                                             
                                           perform the following operations. Set 
                                             
                                                
                                                   e
                                                   l
                                                
                                                :
                                                =
                                                
                                                   e
                                                   
                                                      l
                                                      −
                                                      1
                                                   
                                                
                                                +
                                                
                                                   w
                                                   
                                                      p
                                                      (
                                                      k
                                                      )
                                                      p
                                                      (
                                                      l
                                                      )
                                                   
                                                
                                             
                                          . Compute 
                                             
                                                h
                                                =
                                                δ
                                                (
                                                p
                                                ,
                                                k
                                                ,
                                                l
                                                )
                                             
                                           by Eq. (26). If h < h
                                          *, then set h
                                          * ≔ h, k′ ≔ k and l′ ≔ l.

If 
                                    
                                       
                                          h
                                          *
                                       
                                       =
                                       0
                                       ,
                                    
                                  then return with ρ set to 1. Otherwise, first remove the facility p(k′) from position k′ and insert it at position l′. Then update the vectors A
                                 1 and An
                                  as well as the vectors C and 
                                    
                                       C
                                       −
                                    
                                  used in δ calculations, and return with 
                                    
                                       ρ
                                       =
                                       0
                                    
                                 .

We apply NE3 to the same SRFLP instance as in the previous examples. Again, the initial layout is defined by the permutation 
                                 
                                    p
                                    =
                                    (
                                    3
                                    ,
                                    5
                                    ,
                                    1
                                    ,
                                    2
                                    ,
                                    4
                                    )
                                 
                              . From Example 1, we know that 
                                 
                                    
                                       C
                                       −
                                    
                                    =
                                    
                                       (
                                       10
                                       ,
                                       4
                                       ,
                                       0
                                       ,
                                       −
                                       2
                                       ,
                                       −
                                       12
                                       )
                                    
                                 
                              . The execution of Step 2 of NE3 is illustrated in Table 1
                              , in which e
                              previous stands for 
                                 
                                    e
                                    
                                       l
                                       −
                                       1
                                    
                                 
                               if l > k, and for 
                                 
                                    e
                                    
                                       l
                                       +
                                       1
                                    
                                 
                               if l < k. Furthermore, δ
                              added is used to denote the sum of the second and third terms on the right-hand side of (26) (or (27)), which is added to 
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    k
                                    ,
                                    l
                                    −
                                    1
                                    )
                                 
                               (or 
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    k
                                    ,
                                    l
                                    +
                                    1
                                    )
                                 
                              ) to obtain δ(p, k, l). Let us consider the variants of relocating the facility 
                                 
                                    r
                                    =
                                    4
                                 
                               in more detail. The loop in Step 2.2 of NE3 starts with 
                                 
                                    k
                                    =
                                    5
                                 
                               and 
                                 
                                    l
                                    =
                                    4
                                 
                              . Using (27), we get 
                                 
                                    
                                       δ
                                       
                                          added
                                       
                                    
                                    =
                                    δ
                                    
                                       (
                                       p
                                       ,
                                       5
                                       ,
                                       4
                                       )
                                    
                                    =
                                    12
                                    
                                       (
                                       2
                                       −
                                       
                                          (
                                          −
                                          2
                                          )
                                       
                                       )
                                    
                                    +
                                    6
                                    
                                       (
                                       2
                                       +
                                       0
                                       +
                                       
                                          (
                                          −
                                          12
                                          )
                                       
                                       )
                                    
                                    =
                                    −
                                    12
                                 
                              . When 
                                 
                                    k
                                    =
                                    5
                                 
                               and 
                                 
                                    l
                                    =
                                    3
                                    ,
                                 
                               we have 
                                 
                                    
                                       δ
                                       
                                          added
                                       
                                    
                                    =
                                    12
                                    
                                       (
                                       0
                                       −
                                       0
                                       )
                                    
                                    +
                                    2
                                    
                                       (
                                       2
                                       +
                                       2
                                       +
                                       
                                          (
                                          −
                                          12
                                          )
                                       
                                       )
                                    
                                    =
                                    −
                                    16
                                 
                               and 
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    5
                                    ,
                                    3
                                    )
                                    =
                                    −
                                    12
                                    −
                                    16
                                    =
                                    −
                                    28
                                 
                              . Similarly, for 
                                 
                                    l
                                    =
                                    2
                                    ,
                                 
                              
                              
                                 
                                    
                                       δ
                                       
                                          added
                                       
                                    
                                    =
                                    12
                                    
                                       (
                                       4
                                       −
                                       4
                                       )
                                    
                                    +
                                    14
                                    
                                       (
                                       6
                                       +
                                       2
                                       +
                                       
                                          (
                                          −
                                          12
                                          )
                                       
                                       )
                                    
                                    =
                                    −
                                    56
                                 
                               and 
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    5
                                    ,
                                    2
                                    )
                                    =
                                    −
                                    28
                                    −
                                    56
                                    =
                                    −
                                    84
                                 
                              . Finally, for 
                                 
                                    l
                                    =
                                    1
                                    ,
                                 
                              
                              
                                 
                                    
                                       δ
                                       
                                          added
                                       
                                    
                                    =
                                    12
                                    
                                       (
                                       6
                                       −
                                       10
                                       )
                                    
                                    +
                                    8
                                    
                                       (
                                       12
                                       +
                                       6
                                       +
                                       
                                          (
                                          −
                                          12
                                          )
                                       
                                       )
                                    
                                    =
                                    0
                                 
                               and 
                                 
                                    δ
                                    (
                                    p
                                    ,
                                    5
                                    ,
                                    1
                                    )
                                    =
                                    −
                                    84
                                 
                              . The results of these calculations are summarized in the last four rows of Table 1. By moving facility 4 to either position 1 or 2 we obtain an optimal solution.

It is important to note that NE3 requires significantly less data to calculate δ in comparison with NE2. Indeed, no permutation-dependent matrix is involved in δ calculations (see (26) and (27)). Instead, only four vectors, C, 
                           
                              
                                 C
                                 −
                              
                              ,
                           
                         
                        A
                        1 and An
                        , need to be maintained. Let us assume that h
                        * < 0 in Step 3 of the procedure NE3, and let the permutation obtained by shifting the facility 
                           
                              r
                              =
                              p
                              (
                              
                                 k
                                 ′
                              
                              )
                           
                         to position l′ be denoted by p′. Having p′, the procedure first updates a
                        
                           u1 and aun
                         for each facility 
                           
                              u
                              =
                              p
                              (
                              m
                              )
                           
                         such that its position m in p′ belongs to the interval [min (k′, l′), max (k′, l′)]. Suppose that k′ < l′ (the case of k′ > l′ can be processed similarly). If m ≠ l′, then a
                        
                           u1 is decreased by wur
                         and aun
                         is increased by the same value. Clearly, NE3 spends constant time per facility in this case. If however 
                           
                              m
                              =
                              
                                 l
                                 ′
                              
                              ,
                           
                         then 
                           
                              u
                              =
                              r
                              ,
                           
                         and a
                        
                           u1 is increased (and aun
                         decreased) by the sum 
                           
                              
                                 ∑
                                 
                                    j
                                    =
                                    
                                       k
                                       ′
                                    
                                 
                                 
                                    
                                       l
                                       ′
                                    
                                    −
                                    1
                                 
                              
                              
                                 w
                                 
                                    u
                                    
                                       p
                                       ′
                                    
                                    
                                       (
                                       j
                                       )
                                    
                                 
                              
                           
                        . Since summation is performed only once, the computational complexity of updating vectors A
                        1 and An
                         is O(n). Once A
                        1 and An
                         are ready, the procedure can use (23) to update the cut vector C (or more precisely, its components with indices in the range min (k′, l′) through 
                           
                              max
                              (
                              
                                 k
                                 ′
                              
                              ,
                              
                                 l
                                 ′
                              
                              )
                              −
                              1
                           
                        ). Finally, the vector 
                           
                              C
                              −
                           
                         is computed. Updating C and 
                           
                              C
                              −
                           
                         has linear-time complexity in the worst case. Summarizing, we can state that Step 3 of NE3 takes only O(n) time. The efficiency of the entire procedure is determined by that of Step 2, where a double loop is performed. Thus, we have the following result.

                           Proposition 7
                           
                              The computational complexity of the procedure NE3 is O(n
                              2).
                           

In what follows, we let LS3 denote the local search algorithm relying on the procedure NE3. Its structure is the same as that of LS1 and LS2.

The main difference between two approaches described in this section is the order in which the algorithms examine candidate positions for facilities. In the case of NE3, for each facility, there are generally two ordered sequences of positions, and the algorithm is forced to follow them. Meanwhile, in NE2, the pairs of type (facility, its new position) are allowed to be considered in an arbitrary order. However, such flexibility in the search process is achieved at the expense of an increase in the amount of computation due to the necessity of maintaining the matrices A, B and D.

The goal of this section is to provide empirical evidence of the effectiveness of our local search algorithms for the SRFLP. For comparison purposes, we also implemented two local search methods of Kothari and Ghosh (2013a). One of them minimizes the objective function of the SRFLP by performing pairwise interchanges of facilities, while another does the same using the insertion neighborhood structure. By adopting the same naming style as in Kothari and Ghosh (2013a), we refer to these two algorithms as LS-2OPT and LS-INSERT, respectively. The method of experimentation is quite straightforward: we run each of the algorithms in a multi-start mode. An initial permutation of facilities for each restart is generated randomly. The main metric used for comparison is the cumulative CPU time of all restarts.

All the algorithms have been coded in C++ using a uniform programming style. The source code of LS1, LS2 and LS3 is publicly available in Palubeckis (2013). The tests have been carried out on a PC with an Intel Core 2 Duo CPU running at 3.0 GHz. As a testbed for the algorithms, two sets of SRFLP instances from the literature as well as additional instances of our own were considered. The first set of benchmark instances was introduced by Anjos et al. (2005). It consists of four subsets, each of cardinality 5. The size of the instances in the first to fourth subsets is 60, 70, 75 and 80, respectively. The second dataset is composed of 20 QAP (quadratic assignment problem)-based sko instances (Skorin-Kapov, 1990) tailored for the SRFLP in Anjos and Yen (2009). Their size ranges from 64 to 100 facilities. Both datasets have been used in several recent studies, including Anjos and Yen (2009), Hungerländer and Rendl (2013), Kothari and Ghosh (2013a, 2013b, 2014a, 2014b) and Ozcelik (2012).

In order to test the algorithms more thoroughly, we generated a set of 20 SRFLP instances of larger size (with 
                           
                              n
                              ∈
                              [
                              110
                              ,
                              120
                              ,
                              …
                              ,
                              300
                              ]
                           
                        ). In these instances, the lengths of facilities and the nondiagonal entries of the flow matrix are integer numbers drawn uniformly at random from the intervals [1, 10] and [0, 10], respectively. Of course, the flow matrix is symmetric. The clearances between facilities are assumed to be zero. This choice is conditioned by our intention to compare our algorithms with those of Kothari and Ghosh (2013a, 2013b). These latter algorithms, together with the underlying formulas, are presented for the SRFLP formulation where the clearances between facilities are not taken into account. The third set of SRFLP instances can be found in Palubeckis (2013).

As already mentioned before, the experiments were conducted by running the algorithms in a multi-start mode. For each algorithm, the number of restarts was limited to 500, 1000 and 100 for problem instances in the first, second and third set, respectively. The choice of a smaller number of restarts for the first set, as compared to the second one, is justified by the fact that 500 restarts of insertion-based LS algorithms are sufficient to achieve the best known objective function values for all instances in this set (see Supplementary Appendix B). In order to obtain robust results, we run the algorithms 10 times on each instance in the datasets. Thus, for example, for a benchmark instance of Anjos et al. (2005), we performed 500 restarts of each tested algorithm 10 times, and averaged the results over these 10 runs.


                        Table 2 shows the performance comparison of the tested algorithms on the dataset of Anjos et al. (2005). Its first column contains the instance names. The first integer in the name gives the problem dimension, that is, the number of facilities. The second column presents the average time taken by multi-start LS-2OPT. The average is computed over 10 runs of this heuristic. Each run consisted of 500 restarts of LS-2OPT. The standard deviation of the running time for LS-2OPT is displayed in the third column. The remaining columns report the same type of information for other local search algorithms. The overall results, averaged over 20 instances, are presented in the bottom row. The main message of Table 2 concerns the amount of time required to arrive at a locally optimal solution. The table shows that our algorithms run much faster than both LS-2OPT and LS-INSERT. We find that LS3 achieves the best performance in terms of computational time. This algorithm took less than 40 seconds for the whole dataset. On average, this is less than the time required by each of LS-2OPT and LS-INSERT (55 seconds and 72.3 seconds, respectively) for only one problem instance in the table. We can also see from the table that the standard deviation of the running time is very small. The values of this measure for LS1, LS2 and LS3 are constantly less than 0.05.

The results of solving SRFLP instances in the second dataset are summarized in Table 3. The information in this table is organized in the same manner as in Table 2. The first column contains the instance names in which the integer following sko indicates the number of facilities. From Table 3, we notice that again LS3 is faster than other algorithms involved in the comparison. We also see that LS-2OPT and LS-INSERT are many times slower than the local search techniques described in this paper.

In Table 4, we report the results of experiments on larger scale SRFLP instances. The number of facilities is encoded in the instance name. As Table 4 indicates, our local search algorithms are appropriate when dealing with higher-dimensional problem instances as well. They are much more efficient than previous approaches. In particular, the best of our procedures, LS3, is two orders of magnitude faster than the existing insertion-based algorithm LS-INSERT. Supplementary Appendix B contains the comparison of the local search algorithms in terms of solution quality. The results show that such a simple technique as multi-start local search is not suitable if one aims at achieving satisfactory results for problem instances with more than 100 facilities. In such a case, more sophisticated approaches are required. An example of such an approach is given in the next section.

The proposed local search procedures can be incorporated into various heuristic algorithms for solving the SRFLP. In order to illustrate the benefits of using our procedures, we have developed a variable neighborhood search (VNS) algorithm for this problem. Different LS techniques can be embedded into the VNS framework. Our purpose is to compare the best of the techniques presented in Sections 3 and 4 with the LS-INSERT method of Kothari and Ghosh (2013a). We prefer LS-INSERT because, as Kothari and Ghosh discovered, this method performs better than LS-2OPT.

The variable neighborhood search metaheuristic is a general-purpose optimization method which combines a neighborhood change rule and solution perturbation component with a local search technique. In recent years, algorithms based on the VNS metaheuristic have been successfully applied to a variety of combinatorial optimization problems. The general schemes of VNS and their applications are reviewed by Hansen and Mladenović (2001) and by Hansen, Mladenović, and Moreno Pérez (2008, 2010).

Before presenting our VNS algorithm for the SRFLP, we need to first define the neighborhood structures with respect to the solution space. Let p ∈ Π be fixed. We say that the permutation p′ belongs to the neighborhood Ni
                        (p) of p if p and p′ differ on exactly i entries. Our algorithm makes use of the neighborhoods 
                           
                              
                                 N
                                 2
                              
                              ,
                              
                                 N
                                 4
                              
                              ,
                              
                                 N
                                 6
                              
                              ,
                              …
                           
                        . It generates a permutation p′ ∈ N
                        2k
                        (p) by performing k pairwise interchanges of facilities under the restriction that no facility may be relocated more than once. By changing the value of k, the algorithm can select neighborhoods of different sizes. An important feature of the algorithm is that, at each iteration, it uses a neighborhood of the best solution found so far. Our implementation of the variable neighborhood search method for the SRFLP can be described as follows.

VNS

                           
                              1.
                              Randomly generate an initial solution p to the given instance of the SRFLP. Apply a local search procedure to p. Let p′ denote the solution returned by it. Initialize p
                                 * with p′ and F
                                 * with F(p′).

Set k ≔ k
                                 min.

While k ≤ k
                                 max do the following:

                                    
                                       3.1.
                                       Set p ≔ p
                                          * and 
                                             
                                                R
                                                :
                                                =
                                                {
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                }
                                             
                                          .

Generate a permutation in N
                                          2k
                                          (p
                                          *) by repeating k times the following steps:

                                             
                                                3.2.1.
                                                Randomly select facilities i, j ∈ R and interchange their positions in p.

Remove both i and j from R.

Calculate the distance matrix D corresponding to the permutation p.

Apply a local search procedure to p and let p′ denote the resulting solution.

Check whether F(p′) < F
                                          *. If so, then set p
                                          * ≔ p′, F
                                          * ≔ F(p′) and k ≔ k
                                          min. Otherwise, increase k by k
                                          step.

Check if the termination condition is satisfied. If so, then stop with the solution p
                                          * of value F
                                          *.

Go to 2.

It is clear that the quality of solutions produced by VNS greatly depends on the local search procedure employed in the optimization phase of the algorithm. Within the VNS framework, we have tested the procedures proposed in the current paper as well as the LS-INSERT procedure from Kothari and Ghosh (2013a). In what follows, we will refer to the obtained configurations of VNS as VNS-LS1, VNS-LS2, VNS-LS3 and, respectively, VNS-LS-INSERT.

We conducted computational experiments with VNS on three datasets: the QAP-based sko instances (Anjos & Yen, 2009), three instances of size 110 taken from Amaral and Letchford (2011), and the set of larger scale instances introduced in Section 5.1. The results summarized in the current section were obtained by running variations of VNS 10 times on each problem instance in these datasets. Maximum CPU time limits for a run were as follows: 10 seconds for sko instances, 100 seconds for 
                           
                              n
                              ∈
                              {
                              110
                              ,
                              120
                              ,
                              …
                              ,
                              200
                              }
                              ,
                           
                         and 600 seconds for 
                           
                              n
                              ∈
                              {
                              210
                              ,
                              220
                              ,
                              …
                              ,
                              300
                              }
                           
                        . After some preliminary testing, the parameter 
                           
                              k
                              
                                 max
                              
                              ′
                           
                         of VNS was fixed at 0.4. Two other parameters, k
                        min and k
                        step, were set to 1.

In the experiments on the sko instances (Anjos & Yen, 2009) and the dataset of Amaral and Letchford (2011), we compare the results of the VNS algorithm with the best known values reported in the literature. For the third dataset, the situation is slightly different. For each test case, we need a reference point as a basis of comparison. In this regard, we decided to perform one long run of VNS-LS3 for each instance in the set {p110, p120,… , p300}. We preferred VNS-LS3 to VNS-LS1 and VNS-LS2 because this variation of VNS produced the best results in our preliminary experiments. The cutoff time for each long run was 5 hours.

In Table 5
                        , we compare the performance of our LS algorithms when used as search intensification components within the VNS framework. For each VNS variation, we provide two statistics: the average value of the objective function and the success rate, which is defined to be the number of runs (out of 10) in which the algorithm obtained the best solution (the best values are displayed in the second column of Tables 6
                         and 8). Table 5 discloses that the VNS-LS3 algorithm performs slightly better than both VNS-LS1 and VNS-LS2. We content ourselves by presenting results on a small sample of instances. As a matter of fact, the same conclusion on the superiority of VNS-LS3 could have been reached by considering the full set of results. We, thus, choose VNS-LS3 as a representative of a group of VNS algorithms that are based on our local search procedures.

We note that the main goal of experiments with VNS algorithms was to test their performance in terms of solution quality. A secondary objective was to compare the average time taken by each of the tested algorithms to first find a solution that is best in the run (these statistics are presented in Supplementary Appendix B). The main results of solving SRFLP instances in the sko dataset (Anjos & Yen, 2009) are reported in Table 6. The best known solution values are given in its second column. They are taken from various recent studies. The third column shows the gap, G
                        best, of the value of the best solution out of 10 runs (in parentheses, the gap, G
                        aver, of the average value of 10 solutions) found by VNS-LS3 to the best known value displayed in the second column. The fourth column provides the standard deviation of solution values for VNS-LS3. The last two columns stand for VNS-LS-INSERT. The bottom row of the table gives the averages of solution gaps and standard deviation over the whole dataset. As we can see from Table 6, the combination of VNS with our local search procedure competes very favorably with VNS-LS-INSERT. Specifically, VNS-LS3 obtained best known results in 197 runs out of 200. It did not reach the best solution three times for the last instance in the set. The performance of VNS-LS-INSERT is less impressive. All 10 runs of this algorithm were successful in two test cases only. For two instances of size 100, VNS-LS-INSERT failed to match the best value in all runs.


                        Table 7
                         shows the results of the VNS algorithms on the instances from Amaral and Letchford (2011). The size of each instance is 110. The second column displays the best known values reported in the paper by Ozcelik (2012). The obtained results indicate that VNS-LS3 again significantly outperforms VNS-LS-INSERT.

We have made an attempt to improve the best known solution for each problem instance in the sko dataset by Anjos and Yen (2009) as well as for each instance introduced by Amaral and Letchford (2011). To accomplish this task, the VNS-LS3 algorithm has been used. We have limited the computational time for each run to one day. However, for each instance, VNS-LS3 produced a solution with precisely the same objective function value as that shown in Table 6 or 7. One can reasonably conjecture that the best known solutions reported in these tables are optimal.

The results achieved in Table 6 suggest that SRFLP instances in the sko dataset do not pose a perceptible challenge to the VNS-LS3 algorithm. The benchmark instances of Amaral and Letchford are relatively easy for this algorithm as well. Therefore, we have carried out a computational study on larger problem instances, which have already been used in the investigation of LS strategies in Section 5. The results of the tested algorithms on these instances are summarized in Table 8
                        . We remind that the second column of this table contains solution values obtained by letting VNS-LS3 run for 5 hours. The best solutions for instances in Table 8 as well as for other SRFLP instances used in our computational experiments can be found in Supplementary Appendix B. By contrasting columns 3–4 of Table 8 with the last two columns we ascertain that VNS-LS3 is unequivocally superior to VNS-LS-INSERT. The former algorithm was successful in finding the best solutions for all instances in the dataset. We note, however, that in three cases (p250, p280, p290) the best value was obtained only once. From the table, we also see that the VNS-LS-INSERT algorithm had low performance relative to VNS-LS3. It was able to produce the best quality solutions for the first four problem instances only. As a more general conclusion from the numerical experiments, we can state that the VNS metaheuristic is a viable alternative that can provide a basis for the development of effective algorithms for solving the SRFLP.

@&#CONCLUSIONS@&#

The main contribution of this work is fast and easy to implement neighborhood exploration (NE) procedures for the single row facility layout problem. Their time complexity is O(n
                     2). Because the objective function of the problem involves the summation of 
                        
                           n
                           (
                           n
                           −
                           1
                           )
                           /
                           2
                        
                      terms, it is not reasonable to expect any NE procedure to be (asymptotically) faster than those presented in this paper. The local search (LS) algorithms based on the developed NE procedures appear to provide markedly better performance than existing state-of-the-art LS approaches for the SRFLP. We tested our LS algorithms on a range of previously studied SRFLP benchmark instances, and have found that they are capable of obtaining good solutions in a short period of time, even when they operate in the stand-alone mode.

We have shown that the usefulness of the proposed LS algorithms significantly increases when they are embedded into a VNS metaheuristic scheme. We carried out computational experiments on three sets of SRFLP instances of size up to 300 facilities. The results indicate that the speedup provided by using the fastest of our LS algorithms is rather spectacular. The VNS based on this algorithm offers much better performance than the variant of VNS that uses an O(n
                     3)-time NE technique from the literature. This finding underscores the importance of utilizing an effective LS heuristic within a VNS framework.

The approach we have presented affords opportunities to develop high-performance algorithms for the SRFLP. Besides VNS, there are other metaheuristics and their hybrids which contain a local search component. An attractive way to implement such a component is to use neighborhood exploration procedures proposed in this paper.

Throughout the proofs, we will, mostly tacitly, use the following equation obtained from (23)
                     
                        
                           (28)
                           
                              
                                 
                                    c
                                    m
                                    −
                                 
                                 =
                                 
                                    a
                                    
                                       p
                                       (
                                       m
                                       )
                                       n
                                    
                                 
                                 −
                                 
                                    a
                                    
                                       p
                                       (
                                       m
                                       )
                                       1
                                    
                                 
                                 .
                              
                           
                        
                     
                     
                        Proof of Proposition 2
                        To get an initial expression for Δ(p, k, l), we rewrite (3) as 
                              
                                 F
                                 
                                    (
                                    p
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    f
                                    m
                                 
                                 
                                    (
                                    p
                                    )
                                 
                              
                            where fm
                           (p) stands for the m-th term in the right-hand side of (3). Let p′ denote the permutation obtained from p by interchanging the facilities 
                              
                                 r
                                 =
                                 p
                                 (
                                 k
                                 )
                              
                            and 
                              
                                 s
                                 =
                                 p
                                 (
                                 l
                                 )
                              
                            in positions k and, respectively, l > k. Denoting the difference 
                              
                                 
                                    f
                                    m
                                 
                                 
                                    (
                                    
                                       p
                                       ′
                                    
                                    )
                                 
                                 −
                                 
                                    f
                                    m
                                 
                                 
                                    (
                                    p
                                    )
                                 
                              
                            by Δm
                            and taking into account the fact that 
                              
                                 
                                    f
                                    m
                                 
                                 
                                    (
                                    
                                       p
                                       ′
                                    
                                    )
                                 
                                 =
                                 
                                    f
                                    m
                                 
                                 
                                    (
                                    p
                                    )
                                 
                              
                            for 
                              
                                 m
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 k
                                 −
                                 2
                              
                            and 
                              
                                 m
                                 =
                                 l
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 −
                                 1
                              
                            we can write

                              
                                 (29)
                                 
                                    
                                       Δ
                                       
                                          (
                                          p
                                          ,
                                          k
                                          ,
                                          l
                                          )
                                       
                                       =
                                       F
                                       
                                          (
                                          
                                             p
                                             ′
                                          
                                          )
                                       
                                       −
                                       F
                                       
                                          (
                                          p
                                          )
                                       
                                       =
                                       
                                          ∑
                                          
                                             m
                                             =
                                             k
                                             −
                                             1
                                          
                                          l
                                       
                                       
                                          Δ
                                          m
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    Δ
                                    0
                                 
                                 =
                                 0
                              
                            if 
                              
                                 k
                                 =
                                 1
                              
                            and 
                              
                                 
                                    Δ
                                    n
                                 
                                 =
                                 0
                              
                            if 
                              
                                 l
                                 =
                                 n
                              
                           .

Now let 
                              
                                 
                                    c
                                    1
                                    ′
                                 
                                 ,
                                 …
                                 ,
                                 
                                    c
                                    
                                       n
                                       −
                                       1
                                    
                                    ′
                                 
                              
                            be the cut values for the solution p′. To continue, there are five cases which need to be handled.

                              
                                 (i)
                                 
                                    
                                       
                                          m
                                          =
                                          k
                                          −
                                          1
                                          ,
                                       
                                     
                                    k > 1. It is easy to see that 
                                       
                                          
                                             f
                                             
                                                k
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                p
                                                ′
                                             
                                             )
                                          
                                          =
                                          
                                             c
                                             
                                                k
                                                −
                                                1
                                             
                                             ′
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   p
                                                   (
                                                   k
                                                   −
                                                   1
                                                   )
                                                
                                             
                                             +
                                             
                                                λ
                                                s
                                             
                                             +
                                             
                                                γ
                                                
                                                   p
                                                   (
                                                   k
                                                   −
                                                   1
                                                   )
                                                   s
                                                
                                             
                                             )
                                          
                                       
                                     and 
                                       
                                          
                                             f
                                             
                                                k
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             p
                                             )
                                          
                                          =
                                          
                                             c
                                             
                                                k
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                λ
                                                
                                                   p
                                                   (
                                                   k
                                                   −
                                                   1
                                                   )
                                                
                                             
                                             +
                                             
                                                λ
                                                r
                                             
                                             +
                                             
                                                γ
                                                
                                                   p
                                                   (
                                                   k
                                                   −
                                                   1
                                                   )
                                                   r
                                                
                                             
                                             )
                                          
                                       
                                    . Since 
                                       
                                          
                                             c
                                             
                                                k
                                                −
                                                1
                                             
                                             ′
                                          
                                          =
                                          
                                             c
                                             
                                                k
                                                −
                                                1
                                             
                                          
                                       
                                     it follows that

                                       
                                          (30)
                                          
                                             
                                                
                                                   
                                                      
                                                         Δ
                                                         
                                                            k
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            f
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               p
                                                               ′
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            f
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            p
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               s
                                                            
                                                            −
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  −
                                                                  1
                                                                  )
                                                                  s
                                                               
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  −
                                                                  1
                                                                  )
                                                                  r
                                                               
                                                            
                                                            )
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 


                                    
                                       
                                          m
                                          =
                                          l
                                          ,
                                       
                                     
                                    l < n. Similarly as in case (i) we have

                                       
                                          (31)
                                          
                                             
                                                
                                                   Δ
                                                   l
                                                
                                                =
                                                
                                                   c
                                                   l
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      r
                                                   
                                                   −
                                                   
                                                      λ
                                                      s
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         r
                                                         p
                                                         (
                                                         l
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         s
                                                         p
                                                         (
                                                         l
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 


                                    
                                       
                                          m
                                          =
                                          k
                                       
                                    . In this case

                                       
                                          (32)
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                         k
                                                         ′
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            k
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               r
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                         −
                                                         
                                                            (
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                               n
                                                            
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               w
                                                               
                                                                  r
                                                                  s
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               l
                                                               +
                                                               1
                                                            
                                                            n
                                                         
                                                         
                                                            w
                                                            
                                                               s
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         −
                                                         
                                                         
                                                            (
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  l
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               w
                                                               
                                                                  s
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                               
                                                                  l
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               w
                                                               
                                                                  s
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               w
                                                               
                                                                  r
                                                                  s
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               k
                                                               +
                                                               1
                                                            
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               s
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    By using the definition of the matrix A and Eq. (28) with respect to 
                                       
                                          r
                                          =
                                          p
                                          (
                                          k
                                          )
                                       
                                     and 
                                       
                                          s
                                          =
                                          p
                                          (
                                          l
                                          )
                                          ,
                                       
                                     
                                    (32) can be rewritten as

                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                         k
                                                         ′
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            k
                                                         
                                                         +
                                                         
                                                            a
                                                            
                                                               r
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            a
                                                            
                                                               r
                                                               n
                                                            
                                                         
                                                         +
                                                         
                                                            a
                                                            
                                                               s
                                                               n
                                                            
                                                         
                                                         −
                                                         
                                                            a
                                                            
                                                               s
                                                               1
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            a
                                                            
                                                               s
                                                               ,
                                                               k
                                                               +
                                                               1
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            w
                                                            
                                                               r
                                                               s
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            k
                                                         
                                                         +
                                                         
                                                            c
                                                            l
                                                            −
                                                         
                                                         −
                                                         
                                                            c
                                                            k
                                                            −
                                                         
                                                         +
                                                         2
                                                         
                                                            a
                                                            
                                                               s
                                                               ,
                                                               k
                                                               +
                                                               1
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            w
                                                            
                                                               r
                                                               s
                                                            
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    Now suppose that 
                                       
                                          l
                                          >
                                          k
                                          +
                                          1
                                       
                                    . Then we have

                                       
                                          (33)
                                          
                                             
                                                
                                                   
                                                      
                                                         Δ
                                                         k
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            f
                                                            k
                                                         
                                                         
                                                            (
                                                            
                                                               p
                                                               ′
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            f
                                                            k
                                                         
                                                         
                                                            (
                                                            p
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            c
                                                            k
                                                         
                                                         +
                                                         
                                                            c
                                                            l
                                                            −
                                                         
                                                         −
                                                         
                                                            c
                                                            k
                                                            −
                                                         
                                                         +
                                                         2
                                                         
                                                            a
                                                            
                                                               s
                                                               ,
                                                               k
                                                               +
                                                               1
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            w
                                                            
                                                               r
                                                               s
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         ×
                                                         
                                                         (
                                                         
                                                            λ
                                                            s
                                                         
                                                         +
                                                         
                                                            λ
                                                            
                                                               p
                                                               (
                                                               k
                                                               +
                                                               1
                                                               )
                                                            
                                                         
                                                         +
                                                         
                                                            γ
                                                            
                                                               s
                                                               p
                                                               (
                                                               k
                                                               +
                                                               1
                                                               )
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         −
                                                         
                                                         
                                                            c
                                                            k
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               c
                                                               l
                                                               −
                                                            
                                                            −
                                                            
                                                               c
                                                               k
                                                               −
                                                            
                                                            +
                                                            2
                                                            
                                                               a
                                                               
                                                                  s
                                                                  ,
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                            
                                                            +
                                                            2
                                                            
                                                               w
                                                               
                                                                  r
                                                                  s
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               s
                                                            
                                                            +
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  s
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         +
                                                         
                                                         
                                                            c
                                                            k
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               s
                                                            
                                                            −
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  s
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    If 
                                       
                                          l
                                          =
                                          k
                                          +
                                          1
                                          ,
                                       
                                     then 
                                       
                                          
                                             a
                                             
                                                s
                                                ,
                                                k
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             a
                                             
                                                s
                                                l
                                             
                                          
                                          =
                                          0
                                          ,
                                       
                                     and the expression for Δk
                                     is slightly different:

                                       
                                          (34)
                                          
                                             
                                                
                                                   
                                                      
                                                         Δ
                                                         k
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               c
                                                               k
                                                            
                                                            +
                                                            
                                                               c
                                                               l
                                                               −
                                                            
                                                            −
                                                            
                                                               c
                                                               k
                                                               −
                                                            
                                                            +
                                                            2
                                                            
                                                               w
                                                               
                                                                  r
                                                                  s
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               s
                                                            
                                                            +
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  s
                                                                  r
                                                               
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            c
                                                            k
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               λ
                                                               s
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  r
                                                                  s
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               c
                                                               l
                                                               −
                                                            
                                                            −
                                                            
                                                               c
                                                               k
                                                               −
                                                            
                                                            +
                                                            2
                                                            
                                                               w
                                                               
                                                                  r
                                                                  s
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               s
                                                            
                                                            +
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  s
                                                                  r
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         
                                                            c
                                                            k
                                                         
                                                         
                                                            (
                                                            
                                                               γ
                                                               
                                                                  s
                                                                  r
                                                               
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  r
                                                                  s
                                                               
                                                            
                                                            )
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 


                                    
                                       
                                          m
                                          =
                                          l
                                          −
                                          1
                                       
                                    . By the same derivation as in case (iii), we have

                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                         
                                                            l
                                                            −
                                                            1
                                                         
                                                         ′
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               r
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                         −
                                                         
                                                            (
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                               n
                                                            
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                               
                                                                  l
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               w
                                                               
                                                                  r
                                                                  s
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               k
                                                               +
                                                               1
                                                            
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               r
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               l
                                                               +
                                                               1
                                                            
                                                            n
                                                         
                                                         
                                                            w
                                                            
                                                               s
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                         −
                                                         
                                                            (
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  l
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               w
                                                               
                                                                  s
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               w
                                                               
                                                                  r
                                                                  s
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         +
                                                         
                                                            a
                                                            
                                                               r
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            a
                                                            
                                                               r
                                                               n
                                                            
                                                         
                                                         +
                                                         
                                                            a
                                                            
                                                               s
                                                               n
                                                            
                                                         
                                                         −
                                                         
                                                            a
                                                            
                                                               s
                                                               1
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            a
                                                            
                                                               r
                                                               ,
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            w
                                                            
                                                               r
                                                               s
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         +
                                                         
                                                            c
                                                            l
                                                            −
                                                         
                                                         −
                                                         
                                                            c
                                                            k
                                                            −
                                                         
                                                         +
                                                         2
                                                         
                                                            a
                                                            
                                                               r
                                                               ,
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            w
                                                            
                                                               r
                                                               s
                                                            
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    Notice that 
                                       
                                          l
                                          >
                                          k
                                          +
                                          1
                                       
                                     since otherwise we get case (iii). Therefore

                                       
                                          (35)
                                          
                                             
                                                
                                                   
                                                      
                                                         Δ
                                                         
                                                            l
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            c
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         +
                                                         
                                                            c
                                                            l
                                                            −
                                                         
                                                         −
                                                         
                                                            c
                                                            k
                                                            −
                                                         
                                                         +
                                                         2
                                                         
                                                            a
                                                            
                                                               r
                                                               ,
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            w
                                                            
                                                               r
                                                               s
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         ×
                                                         
                                                         (
                                                         
                                                            λ
                                                            
                                                               p
                                                               (
                                                               l
                                                               −
                                                               1
                                                               )
                                                            
                                                         
                                                         +
                                                         
                                                            λ
                                                            r
                                                         
                                                         +
                                                         
                                                            γ
                                                            
                                                               p
                                                               (
                                                               l
                                                               −
                                                               1
                                                               )
                                                               r
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         −
                                                         
                                                         
                                                            c
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               λ
                                                               s
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                                  s
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               c
                                                               l
                                                               −
                                                            
                                                            −
                                                            
                                                               c
                                                               k
                                                               −
                                                            
                                                            +
                                                            2
                                                            
                                                               a
                                                               
                                                                  r
                                                                  ,
                                                                  l
                                                                  −
                                                                  1
                                                               
                                                            
                                                            +
                                                            2
                                                            
                                                               w
                                                               
                                                                  r
                                                                  s
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                                  r
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         +
                                                         
                                                         
                                                            c
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               r
                                                            
                                                            −
                                                            
                                                               λ
                                                               s
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                                  r
                                                               
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                                  s
                                                               
                                                            
                                                            )
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 


                                    
                                       
                                          m
                                          ∈
                                          [
                                          k
                                          +
                                          1
                                          ,
                                          …
                                          ,
                                          l
                                          −
                                          2
                                          ]
                                       
                                    . Now

                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                         m
                                                         ′
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            m
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               r
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                         −
                                                         
                                                            (
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                               n
                                                            
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                               m
                                                            
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               w
                                                               
                                                                  r
                                                                  s
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               k
                                                               +
                                                               1
                                                            
                                                            m
                                                         
                                                         
                                                            w
                                                            
                                                               r
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               l
                                                               +
                                                               1
                                                            
                                                            n
                                                         
                                                         
                                                            w
                                                            
                                                               s
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         −
                                                         
                                                            (
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  l
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               w
                                                               
                                                                  s
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  m
                                                                  +
                                                                  1
                                                               
                                                               
                                                                  l
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               w
                                                               
                                                                  s
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               w
                                                               
                                                                  r
                                                                  s
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               m
                                                               +
                                                               1
                                                            
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               s
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            m
                                                         
                                                         +
                                                         
                                                            a
                                                            
                                                               r
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            a
                                                            
                                                               r
                                                               n
                                                            
                                                         
                                                         +
                                                         
                                                            a
                                                            
                                                               s
                                                               n
                                                            
                                                         
                                                         −
                                                         
                                                            a
                                                            
                                                               s
                                                               1
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            a
                                                            
                                                               r
                                                               m
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            a
                                                            
                                                               s
                                                               ,
                                                               m
                                                               +
                                                               1
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            w
                                                            
                                                               r
                                                               s
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    and hence

                                       
                                          (36)
                                          
                                             
                                                
                                                   
                                                      
                                                         Δ
                                                         m
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            c
                                                            l
                                                            −
                                                         
                                                         −
                                                         
                                                            c
                                                            k
                                                            −
                                                         
                                                         +
                                                         2
                                                         
                                                            a
                                                            
                                                               r
                                                               m
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            a
                                                            
                                                               s
                                                               ,
                                                               m
                                                               +
                                                               1
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            w
                                                            
                                                               r
                                                               s
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         ×
                                                         
                                                         (
                                                         
                                                            λ
                                                            
                                                               p
                                                               (
                                                               m
                                                               )
                                                            
                                                         
                                                         +
                                                         
                                                            λ
                                                            
                                                               p
                                                               (
                                                               m
                                                               +
                                                               1
                                                               )
                                                            
                                                         
                                                         +
                                                         
                                                            γ
                                                            
                                                               p
                                                               (
                                                               m
                                                               )
                                                               p
                                                               (
                                                               m
                                                               +
                                                               1
                                                               )
                                                            
                                                         
                                                         )
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 

The obtained expressions for Δm
                           , 
                              
                                 m
                                 =
                                 k
                                 −
                                 1
                                 ,
                                 …
                                 ,
                                 l
                                 ,
                              
                            can be combined to calculate the value of Δ(p, k, l). First assume that 
                              
                                 l
                                 >
                                 k
                                 +
                                 1
                              
                           . Substituting (30), (31), (33), (35) and (36) into (29) and making some minor rearrangements, we have

                              
                                 
                                    
                                       Δ
                                       
                                          (
                                          p
                                          ,
                                          k
                                          ,
                                          l
                                          )
                                       
                                       =
                                       
                                          T
                                          1
                                       
                                       +
                                       
                                          T
                                          2
                                       
                                       +
                                       
                                          T
                                          3
                                       
                                       +
                                       
                                          T
                                          4
                                       
                                       +
                                       
                                          T
                                          5
                                       
                                       ,
                                    
                                 
                              
                           where

                              
                                 (37)
                                 
                                    
                                       
                                          
                                             
                                                T
                                                1
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      c
                                                      l
                                                      −
                                                   
                                                   −
                                                   
                                                      c
                                                      k
                                                      −
                                                   
                                                   +
                                                   2
                                                   
                                                      w
                                                      
                                                         r
                                                         s
                                                      
                                                   
                                                   )
                                                
                                                
                                                   [
                                                   
                                                      ∑
                                                      
                                                         m
                                                         =
                                                         k
                                                         +
                                                         1
                                                      
                                                      
                                                         l
                                                         −
                                                         2
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         λ
                                                         
                                                            p
                                                            (
                                                            m
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         λ
                                                         
                                                            p
                                                            (
                                                            m
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            m
                                                            )
                                                            p
                                                            (
                                                            m
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                   
                                                      λ
                                                      s
                                                   
                                                   +
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         k
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         s
                                                         p
                                                         (
                                                         k
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         l
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      λ
                                                      r
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         l
                                                         −
                                                         1
                                                         )
                                                         r
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               m
                                                               =
                                                               k
                                                               +
                                                               1
                                                            
                                                            
                                                               l
                                                               −
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                T
                                                2
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                2
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               m
                                                               =
                                                               k
                                                               +
                                                               1
                                                            
                                                            
                                                               l
                                                               −
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      a
                                                      
                                                         r
                                                         ,
                                                         l
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         λ
                                                         
                                                            p
                                                            (
                                                            l
                                                            −
                                                            1
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         λ
                                                         r
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            l
                                                            −
                                                            1
                                                            )
                                                            r
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                   
                                                      ∑
                                                      
                                                         m
                                                         =
                                                         k
                                                         +
                                                         1
                                                      
                                                      
                                                         l
                                                         −
                                                         2
                                                      
                                                   
                                                   
                                                      a
                                                      
                                                         r
                                                         m
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         λ
                                                         
                                                            p
                                                            (
                                                            m
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         λ
                                                         
                                                            p
                                                            (
                                                            m
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            m
                                                            )
                                                            p
                                                            (
                                                            m
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                T
                                                3
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                2
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               m
                                                               =
                                                               k
                                                               +
                                                               1
                                                            
                                                            
                                                               l
                                                               −
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      a
                                                      
                                                         s
                                                         ,
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         λ
                                                         s
                                                      
                                                      +
                                                      
                                                         λ
                                                         
                                                            p
                                                            (
                                                            k
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            s
                                                            p
                                                            (
                                                            k
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                   
                                                      ∑
                                                      
                                                         m
                                                         =
                                                         k
                                                         +
                                                         1
                                                      
                                                      
                                                         l
                                                         −
                                                         2
                                                      
                                                   
                                                   
                                                      a
                                                      
                                                         s
                                                         ,
                                                         m
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         λ
                                                         
                                                            p
                                                            (
                                                            m
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         λ
                                                         
                                                            p
                                                            (
                                                            m
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            m
                                                            )
                                                            p
                                                            (
                                                            m
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (38)
                                 
                                    
                                       
                                          
                                             
                                                T
                                                4
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      λ
                                                      r
                                                   
                                                   −
                                                   
                                                      λ
                                                      s
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      c
                                                      l
                                                   
                                                   +
                                                   
                                                      c
                                                      
                                                         l
                                                         −
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      c
                                                      k
                                                   
                                                   −
                                                   
                                                      c
                                                      
                                                         k
                                                         −
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                T
                                                5
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   c
                                                   
                                                      k
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         k
                                                         −
                                                         1
                                                         )
                                                         s
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         k
                                                         −
                                                         1
                                                         )
                                                         r
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   c
                                                   k
                                                
                                                
                                                   γ
                                                   1
                                                
                                                +
                                                
                                                   c
                                                   
                                                      l
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   γ
                                                   2
                                                
                                                +
                                                
                                                   c
                                                   l
                                                
                                                
                                                   (
                                                   
                                                      γ
                                                      
                                                         r
                                                         p
                                                         (
                                                         l
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         s
                                                         p
                                                         (
                                                         l
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           To simplify the term T
                           1, we notice that

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   λ
                                                   r
                                                
                                                +
                                                
                                                   λ
                                                   
                                                      p
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                                +
                                                
                                                   γ
                                                   
                                                      r
                                                      p
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      m
                                                      =
                                                      k
                                                      +
                                                      1
                                                   
                                                   
                                                      l
                                                      −
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         m
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         m
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         m
                                                         )
                                                         p
                                                         (
                                                         m
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   λ
                                                   
                                                      p
                                                      (
                                                      l
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                                +
                                                
                                                   λ
                                                   s
                                                
                                                +
                                                
                                                   γ
                                                   
                                                      p
                                                      (
                                                      l
                                                      −
                                                      1
                                                      )
                                                      s
                                                   
                                                
                                                =
                                                
                                                   d
                                                   
                                                      r
                                                      s
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Thus 
                              
                                 
                                    T
                                    1
                                 
                                 =
                                 
                                    (
                                    
                                       c
                                       l
                                       −
                                    
                                    −
                                    
                                       c
                                       k
                                       −
                                    
                                    +
                                    2
                                    
                                       w
                                       
                                          r
                                          s
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       d
                                       
                                          r
                                          s
                                       
                                    
                                    +
                                    
                                       γ
                                       1
                                    
                                    +
                                    
                                       γ
                                       2
                                    
                                    )
                                 
                              
                           . Next, from the definition of the matrix B, the case of j > k, it can be immediately seen that 
                              
                                 
                                    T
                                    2
                                 
                                 =
                                 2
                                 
                                    b
                                    
                                       r
                                       ,
                                       l
                                       −
                                       1
                                    
                                 
                              
                           . A similar conclusion can be reached for the term T
                           3. Indeed, by replacing 
                              
                                 m
                                 +
                                 1
                              
                            by i, the sum in (37) can be written as 
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       k
                                       +
                                       2
                                    
                                    
                                       l
                                       −
                                       1
                                    
                                 
                                 
                                    a
                                    
                                       s
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       λ
                                       
                                          p
                                          (
                                          i
                                          −
                                          1
                                          )
                                       
                                    
                                    +
                                    
                                       λ
                                       
                                          p
                                          (
                                          i
                                          )
                                       
                                    
                                    +
                                    
                                       γ
                                       
                                          p
                                          (
                                          i
                                          −
                                          1
                                          )
                                          p
                                          (
                                          i
                                          )
                                       
                                    
                                    )
                                 
                              
                           . Now, remembering that 
                              
                                 s
                                 =
                                 p
                                 (
                                 l
                                 )
                                 ,
                              
                            it should be clear that 
                              
                                 
                                    T
                                    3
                                 
                                 =
                                 2
                                 
                                    b
                                    
                                       s
                                       ,
                                       k
                                       +
                                       1
                                    
                                 
                              
                           . Finally, the term T
                           4 is equal to 
                              
                                 
                                    λ
                                    
                                       r
                                       s
                                    
                                    −
                                 
                                 
                                    (
                                    
                                       c
                                       l
                                       +
                                    
                                    −
                                    
                                       c
                                       k
                                       +
                                    
                                    )
                                 
                              
                           . Putting T
                           1, T
                           2, T
                           3, T
                           4 and T
                           5 together yields (15).

If 
                              
                                 l
                                 =
                                 k
                                 +
                                 1
                                 ,
                              
                            then Δ(p, k, l) is obtained by summing up (30), (31) and (34). Keeping the same notations as in the general case, we find that 
                              
                                 
                                    T
                                    1
                                 
                                 =
                                 
                                    (
                                    
                                       c
                                       l
                                       −
                                    
                                    −
                                    
                                       c
                                       k
                                       −
                                    
                                    +
                                    2
                                    
                                       w
                                       
                                          r
                                          s
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       λ
                                       r
                                    
                                    +
                                    
                                       λ
                                       s
                                    
                                    +
                                    
                                       γ
                                       
                                          s
                                          r
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    T
                                    2
                                 
                                 =
                                 
                                    T
                                    3
                                 
                                 =
                                 0
                                 ,
                              
                           
                           
                              
                                 
                                    T
                                    4
                                 
                                 =
                                 
                                    (
                                    
                                       λ
                                       r
                                    
                                    −
                                    
                                       λ
                                       s
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       c
                                       l
                                    
                                    −
                                    
                                       c
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 ,
                              
                            and T
                           5 is given by (38). Since 
                              
                                 
                                    λ
                                    r
                                 
                                 +
                                 
                                    λ
                                    s
                                 
                                 +
                                 
                                    γ
                                    
                                       s
                                       r
                                    
                                 
                                 =
                                 
                                    d
                                    
                                       r
                                       s
                                    
                                 
                                 +
                                 
                                    γ
                                    
                                       s
                                       r
                                    
                                 
                                 −
                                 
                                    γ
                                    
                                       r
                                       s
                                    
                                 
                              
                            and 
                              
                                 
                                    c
                                    l
                                 
                                 −
                                 
                                    c
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    c
                                    l
                                    +
                                 
                                 −
                                 
                                    c
                                    k
                                    +
                                 
                              
                            for 
                              
                                 l
                                 =
                                 k
                                 +
                                 1
                              
                            it follows that the sum of T
                           1, T
                           4 and T
                           5 is equal to the right-hand side of (15). Notice that, in the case of 
                              
                                 l
                                 =
                                 k
                                 +
                                 1
                                 ,
                              
                           
                           
                              
                                 
                                    b
                                    
                                       r
                                       ,
                                       l
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    b
                                    
                                       r
                                       k
                                    
                                 
                                 =
                                 0
                              
                            and 
                              
                                 
                                    b
                                    
                                       s
                                       ,
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    b
                                    
                                       s
                                       l
                                    
                                 
                                 =
                                 0
                              
                           .□

Let p′ denote the permutation obtained from p by relocating the facility 
                              
                                 r
                                 =
                                 p
                                 (
                                 k
                                 )
                              
                            from position k to position 
                              
                                 l
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 }
                                 ∖
                                 {
                                 k
                                 }
                              
                            and let 
                              
                                 
                                    c
                                    1
                                    ′
                                 
                                 ,
                                 …
                                 ,
                                 
                                    c
                                    
                                       n
                                       −
                                       1
                                    
                                    ′
                                 
                              
                            be the cut values for p′. First consider the case where l > k. Like in the proof of Proposition 2, we can write

                              
                                 
                                    
                                       δ
                                       
                                          (
                                          p
                                          ,
                                          k
                                          ,
                                          l
                                          )
                                       
                                       =
                                       F
                                       
                                          (
                                          
                                             p
                                             ′
                                          
                                          )
                                       
                                       −
                                       F
                                       
                                          (
                                          p
                                          )
                                       
                                       =
                                       
                                          ∑
                                          
                                             m
                                             =
                                             k
                                             −
                                             1
                                          
                                          l
                                       
                                       
                                          Δ
                                          m
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    Δ
                                    0
                                 
                                 =
                                 
                                    Δ
                                    n
                                 
                                 =
                                 0
                              
                            as before.

We proceed by deriving expressions for Δm
                           , 
                              
                                 m
                                 =
                                 k
                                 −
                                 1
                                 ,
                                 …
                                 ,
                                 l
                              
                           . To this end, we distinguish between the following five cases.

                              
                                 (i)
                                 
                                    
                                       
                                          m
                                          =
                                          k
                                          −
                                          1
                                          ,
                                       
                                     
                                    k > 1. Obviously, 
                                       
                                          
                                             c
                                             
                                                k
                                                −
                                                1
                                             
                                             ′
                                          
                                          =
                                          
                                             c
                                             
                                                k
                                                −
                                                1
                                             
                                          
                                       
                                    . Hence

                                       
                                          (39)
                                          
                                             
                                                
                                                   
                                                      
                                                         Δ
                                                         
                                                            k
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  −
                                                                  1
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  −
                                                                  1
                                                                  )
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         −
                                                         
                                                         
                                                            c
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  −
                                                                  1
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  −
                                                                  1
                                                                  )
                                                                  r
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  −
                                                                  1
                                                                  )
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  −
                                                                  1
                                                                  )
                                                                  r
                                                               
                                                            
                                                            )
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 


                                    
                                       
                                          m
                                          =
                                          l
                                          ,
                                       
                                     
                                    l < n. In this case, we have

                                       
                                          (40)
                                          
                                             
                                                
                                                   Δ
                                                   l
                                                
                                                =
                                                
                                                   c
                                                   l
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      r
                                                   
                                                   −
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         l
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         r
                                                         p
                                                         (
                                                         l
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         l
                                                         )
                                                         p
                                                         (
                                                         l
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 


                                    
                                       
                                          m
                                          =
                                          k
                                       
                                    . The k-th cut value for p′ is

                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                         k
                                                         ′
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            k
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               r
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                         −
                                                         
                                                            (
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                               n
                                                            
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               k
                                                               +
                                                               2
                                                            
                                                            n
                                                         
                                                         
                                                            w
                                                            
                                                               p
                                                               (
                                                               k
                                                               +
                                                               1
                                                               )
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                         −
                                                         
                                                            (
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               k
                                                            
                                                            
                                                               w
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            k
                                                         
                                                         +
                                                         
                                                            a
                                                            
                                                               r
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            a
                                                            
                                                               r
                                                               n
                                                            
                                                         
                                                         +
                                                         
                                                            a
                                                            
                                                               p
                                                               (
                                                               k
                                                               +
                                                               1
                                                               )
                                                               n
                                                            
                                                         
                                                         −
                                                         
                                                            a
                                                            
                                                               p
                                                               (
                                                               k
                                                               +
                                                               1
                                                               )
                                                               1
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            w
                                                            
                                                               r
                                                               p
                                                               (
                                                               k
                                                               +
                                                               1
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            k
                                                         
                                                         +
                                                         
                                                            c
                                                            
                                                               k
                                                               +
                                                               1
                                                            
                                                            −
                                                         
                                                         −
                                                         
                                                            c
                                                            k
                                                            −
                                                         
                                                         +
                                                         2
                                                         
                                                            w
                                                            
                                                               r
                                                               p
                                                               (
                                                               k
                                                               +
                                                               1
                                                               )
                                                            
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    We remark that if 
                                       
                                          l
                                          =
                                          k
                                          +
                                          1
                                          ,
                                       
                                     then case (iv) is considered. So we can assume that 
                                       
                                          l
                                          >
                                          k
                                          +
                                          1
                                       
                                    . Then

                                       
                                          (41)
                                          
                                             
                                                
                                                   
                                                      
                                                         Δ
                                                         k
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            c
                                                            k
                                                         
                                                         +
                                                         
                                                            c
                                                            
                                                               k
                                                               +
                                                               1
                                                            
                                                            −
                                                         
                                                         −
                                                         
                                                            c
                                                            k
                                                            −
                                                         
                                                         +
                                                         2
                                                         
                                                            w
                                                            
                                                               r
                                                               p
                                                               (
                                                               k
                                                               +
                                                               1
                                                               )
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         ×
                                                         
                                                         (
                                                         
                                                            λ
                                                            
                                                               p
                                                               (
                                                               k
                                                               +
                                                               1
                                                               )
                                                            
                                                         
                                                         +
                                                         
                                                            λ
                                                            
                                                               p
                                                               (
                                                               k
                                                               +
                                                               2
                                                               )
                                                            
                                                         
                                                         +
                                                         
                                                            γ
                                                            
                                                               p
                                                               (
                                                               k
                                                               +
                                                               1
                                                               )
                                                               p
                                                               (
                                                               k
                                                               +
                                                               2
                                                               )
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         −
                                                         
                                                         
                                                            c
                                                            k
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               c
                                                               
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                               −
                                                            
                                                            −
                                                            
                                                               c
                                                               k
                                                               −
                                                            
                                                            +
                                                            2
                                                            
                                                               a
                                                               
                                                                  r
                                                                  ,
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  2
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  2
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                         
                                                         
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         +
                                                         
                                                         
                                                            c
                                                            k
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  2
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  2
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  k
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 


                                    
                                       
                                          m
                                          =
                                          l
                                          −
                                          1
                                       
                                    . In this case

                                       
                                          (42)
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                         
                                                            l
                                                            −
                                                            1
                                                         
                                                         ′
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               r
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                         −
                                                         
                                                            (
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                               n
                                                            
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                               
                                                                  l
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            
                                                            )
                                                         
                                                         
                                                         
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               k
                                                               +
                                                               1
                                                            
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               r
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               l
                                                               +
                                                               1
                                                            
                                                            n
                                                         
                                                         
                                                            w
                                                            
                                                               p
                                                               (
                                                               l
                                                               )
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                         −
                                                         
                                                            (
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  l
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               w
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            
                                                            )
                                                         
                                                         
                                                         
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         +
                                                         
                                                            a
                                                            
                                                               r
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            a
                                                            
                                                               r
                                                               n
                                                            
                                                         
                                                         +
                                                         
                                                            a
                                                            
                                                               p
                                                               (
                                                               l
                                                               )
                                                               n
                                                            
                                                         
                                                         −
                                                         
                                                            a
                                                            
                                                               p
                                                               (
                                                               l
                                                               )
                                                               1
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            (
                                                            
                                                               a
                                                               
                                                                  r
                                                                  ,
                                                                  l
                                                                  −
                                                                  1
                                                               
                                                            
                                                            +
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         +
                                                         
                                                            c
                                                            l
                                                            −
                                                         
                                                         −
                                                         
                                                            c
                                                            k
                                                            −
                                                         
                                                         +
                                                         2
                                                         
                                                            a
                                                            
                                                               r
                                                               l
                                                            
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    Using (42) we get

                                       
                                          (43)
                                          
                                             
                                                
                                                   
                                                      
                                                         Δ
                                                         
                                                            l
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               c
                                                               
                                                                  l
                                                                  −
                                                                  1
                                                               
                                                            
                                                            +
                                                            
                                                               c
                                                               l
                                                               −
                                                            
                                                            −
                                                            
                                                               c
                                                               k
                                                               −
                                                            
                                                            +
                                                            2
                                                            
                                                               a
                                                               
                                                                  r
                                                                  l
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                                  r
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         −
                                                         
                                                         
                                                            c
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               c
                                                               l
                                                               −
                                                            
                                                            −
                                                            
                                                               c
                                                               k
                                                               −
                                                            
                                                            +
                                                            2
                                                            
                                                               a
                                                               
                                                                  r
                                                                  l
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                                  r
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         +
                                                         
                                                         
                                                            c
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               r
                                                            
                                                            −
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                                  r
                                                               
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 


                                    
                                       
                                          m
                                          ∈
                                          [
                                          k
                                          +
                                          1
                                          ,
                                          …
                                          ,
                                          l
                                          −
                                          2
                                          ]
                                       
                                    . As before, we first identify the cut value:

                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                         m
                                                         ′
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            m
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               r
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                         −
                                                         
                                                         
                                                            (
                                                            
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                               n
                                                            
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                               m
                                                            
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  m
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               k
                                                               +
                                                               1
                                                            
                                                            m
                                                         
                                                         
                                                            w
                                                            
                                                               r
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               m
                                                               +
                                                               2
                                                            
                                                            n
                                                         
                                                         
                                                            w
                                                            
                                                               p
                                                               (
                                                               m
                                                               +
                                                               1
                                                               )
                                                               p
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         −
                                                         
                                                            (
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               m
                                                            
                                                            
                                                               w
                                                               
                                                                  p
                                                                  (
                                                                  m
                                                                  +
                                                                  1
                                                                  )
                                                                  p
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  m
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            m
                                                         
                                                         +
                                                         
                                                            a
                                                            
                                                               r
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            a
                                                            
                                                               r
                                                               n
                                                            
                                                         
                                                         +
                                                         
                                                            a
                                                            
                                                               p
                                                               (
                                                               m
                                                               +
                                                               1
                                                               )
                                                               n
                                                            
                                                         
                                                         −
                                                         
                                                            a
                                                            
                                                               p
                                                               (
                                                               m
                                                               +
                                                               1
                                                               )
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         +
                                                         
                                                         2
                                                         
                                                            (
                                                            
                                                               a
                                                               
                                                                  r
                                                                  m
                                                               
                                                            
                                                            +
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  m
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                         =
                                                         
                                                            c
                                                            m
                                                         
                                                         +
                                                         
                                                            c
                                                            
                                                               m
                                                               +
                                                               1
                                                            
                                                            −
                                                         
                                                         −
                                                         
                                                            c
                                                            k
                                                            −
                                                         
                                                         +
                                                         2
                                                         
                                                            a
                                                            
                                                               r
                                                               ,
                                                               m
                                                               +
                                                               1
                                                            
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    Then we can write

                                       
                                          (44)
                                          
                                             
                                                
                                                   
                                                      
                                                         Δ
                                                         m
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            c
                                                            m
                                                         
                                                         +
                                                         
                                                            c
                                                            
                                                               m
                                                               +
                                                               1
                                                            
                                                            −
                                                         
                                                         −
                                                         
                                                            c
                                                            k
                                                            −
                                                         
                                                         +
                                                         2
                                                         
                                                            a
                                                            
                                                               r
                                                               ,
                                                               m
                                                               +
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         ×
                                                         
                                                         (
                                                         
                                                            λ
                                                            
                                                               p
                                                               (
                                                               m
                                                               +
                                                               1
                                                               )
                                                            
                                                         
                                                         +
                                                         
                                                            λ
                                                            
                                                               p
                                                               (
                                                               m
                                                               +
                                                               2
                                                               )
                                                            
                                                         
                                                         +
                                                         
                                                            γ
                                                            
                                                               p
                                                               (
                                                               m
                                                               +
                                                               1
                                                               )
                                                               p
                                                               (
                                                               m
                                                               +
                                                               2
                                                               )
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         −
                                                         
                                                         
                                                            c
                                                            m
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  m
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  m
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  m
                                                                  )
                                                                  p
                                                                  (
                                                                  m
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            c
                                                            
                                                               m
                                                               +
                                                               1
                                                            
                                                            −
                                                         
                                                         −
                                                         
                                                            c
                                                            k
                                                            −
                                                         
                                                         +
                                                         2
                                                         
                                                            a
                                                            
                                                               r
                                                               ,
                                                               m
                                                               +
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         ×
                                                         
                                                         (
                                                         
                                                            λ
                                                            
                                                               p
                                                               (
                                                               m
                                                               +
                                                               1
                                                               )
                                                            
                                                         
                                                         +
                                                         
                                                            λ
                                                            
                                                               p
                                                               (
                                                               m
                                                               +
                                                               2
                                                               )
                                                            
                                                         
                                                         +
                                                         
                                                            γ
                                                            
                                                               p
                                                               (
                                                               m
                                                               +
                                                               1
                                                               )
                                                               p
                                                               (
                                                               m
                                                               +
                                                               2
                                                               )
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         +
                                                         
                                                         
                                                            c
                                                            m
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  m
                                                                  +
                                                                  2
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  m
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  m
                                                                  +
                                                                  1
                                                                  )
                                                                  p
                                                                  (
                                                                  m
                                                                  +
                                                                  2
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  m
                                                                  )
                                                                  p
                                                                  (
                                                                  m
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 

Following the same strategy as in the proof of Proposition 2, we combine (39)–(41), (43) and (44) in a way that is suitable for performing further manipulations:

                              
                                 (45)
                                 
                                    
                                       δ
                                       
                                          (
                                          p
                                          ,
                                          k
                                          ,
                                          l
                                          )
                                       
                                       =
                                       
                                          T
                                          1
                                       
                                       −
                                       
                                          T
                                          2
                                       
                                       +
                                       
                                          T
                                          3
                                       
                                       +
                                       
                                          T
                                          4
                                       
                                       +
                                       
                                          T
                                          5
                                       
                                       +
                                       
                                          T
                                          6
                                       
                                    
                                 
                              
                           where in the case of 
                              
                                 l
                                 >
                                 k
                                 +
                                 1
                              
                           
                           
                              
                                 (46)
                                 
                                    
                                       
                                          
                                             
                                                T
                                                1
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                2
                                                
                                                   ∑
                                                   
                                                      m
                                                      =
                                                      k
                                                   
                                                   
                                                      l
                                                      −
                                                      2
                                                   
                                                
                                                
                                                   a
                                                   
                                                      r
                                                      ,
                                                      m
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         m
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         m
                                                         +
                                                         2
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         m
                                                         +
                                                         1
                                                         )
                                                         p
                                                         (
                                                         m
                                                         +
                                                         2
                                                         )
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                2
                                                
                                                   a
                                                   
                                                      r
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         l
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      λ
                                                      r
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         l
                                                         )
                                                         r
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                T
                                                2
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   c
                                                   k
                                                   −
                                                
                                                
                                                   [
                                                   
                                                      ∑
                                                      
                                                         m
                                                         =
                                                         k
                                                      
                                                      
                                                         l
                                                         −
                                                         2
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         λ
                                                         
                                                            p
                                                            (
                                                            m
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         λ
                                                         
                                                            p
                                                            (
                                                            m
                                                            +
                                                            2
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         γ
                                                         
                                                            p
                                                            (
                                                            m
                                                            +
                                                            1
                                                            )
                                                            p
                                                            (
                                                            m
                                                            +
                                                            2
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         l
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      λ
                                                      r
                                                   
                                                   ]
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (47)
                                 
                                    
                                       
                                          T
                                          3
                                       
                                       =
                                       
                                          ∑
                                          
                                             m
                                             =
                                             k
                                          
                                          
                                             l
                                             −
                                             2
                                          
                                       
                                       
                                          c
                                          
                                             m
                                             +
                                             1
                                          
                                          −
                                       
                                       
                                          (
                                          
                                             λ
                                             
                                                p
                                                (
                                                m
                                                +
                                                1
                                                )
                                             
                                          
                                          +
                                          
                                             λ
                                             
                                                p
                                                (
                                                m
                                                +
                                                2
                                                )
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          c
                                          l
                                          −
                                       
                                       
                                          (
                                          
                                             λ
                                             
                                                p
                                                (
                                                l
                                                )
                                             
                                          
                                          +
                                          
                                             λ
                                             r
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 (48)
                                 
                                    
                                       
                                          
                                             
                                                T
                                                4
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   c
                                                   
                                                      k
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         k
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   −
                                                   
                                                      λ
                                                      r
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   l
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      r
                                                   
                                                   −
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         l
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   k
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         k
                                                         +
                                                         2
                                                         )
                                                      
                                                   
                                                   −
                                                   
                                                      λ
                                                      r
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   c
                                                   
                                                      l
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      r
                                                   
                                                   −
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         l
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      m
                                                      =
                                                      k
                                                      +
                                                      1
                                                   
                                                   
                                                      l
                                                      −
                                                      2
                                                   
                                                
                                                
                                                   c
                                                   m
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         m
                                                         +
                                                         2
                                                         )
                                                      
                                                   
                                                   −
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         m
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (49)
                                 
                                    
                                       
                                          
                                             
                                                T
                                                5
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      m
                                                      =
                                                      k
                                                   
                                                   
                                                      l
                                                      −
                                                      2
                                                   
                                                
                                                
                                                   c
                                                   
                                                      m
                                                      +
                                                      1
                                                   
                                                   −
                                                
                                                
                                                   γ
                                                   
                                                      p
                                                      (
                                                      m
                                                      +
                                                      1
                                                      )
                                                      p
                                                      (
                                                      m
                                                      +
                                                      2
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                   ∑
                                                   
                                                      m
                                                      =
                                                      k
                                                      +
                                                      1
                                                   
                                                   
                                                      l
                                                      −
                                                      2
                                                   
                                                
                                                
                                                   c
                                                   m
                                                
                                                
                                                   (
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         m
                                                         +
                                                         1
                                                         )
                                                         p
                                                         (
                                                         m
                                                         +
                                                         2
                                                         )
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         m
                                                         )
                                                         p
                                                         (
                                                         m
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (50)
                                 
                                    
                                       
                                          
                                             
                                                T
                                                6
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      c
                                                      l
                                                      −
                                                   
                                                   −
                                                   
                                                      c
                                                      k
                                                      −
                                                   
                                                   )
                                                
                                                
                                                   γ
                                                   
                                                      p
                                                      (
                                                      l
                                                      )
                                                      r
                                                   
                                                
                                                +
                                                
                                                   c
                                                   
                                                      k
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         k
                                                         −
                                                         1
                                                         )
                                                         p
                                                         (
                                                         k
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         k
                                                         −
                                                         1
                                                         )
                                                         r
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   c
                                                   l
                                                
                                                
                                                   (
                                                   
                                                      γ
                                                      
                                                         r
                                                         p
                                                         (
                                                         l
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         l
                                                         )
                                                         p
                                                         (
                                                         l
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   k
                                                
                                                
                                                   (
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         k
                                                         +
                                                         1
                                                         )
                                                         p
                                                         (
                                                         k
                                                         +
                                                         2
                                                         )
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         r
                                                         p
                                                         (
                                                         k
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   c
                                                   
                                                      l
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         l
                                                         )
                                                         r
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         l
                                                         −
                                                         1
                                                         )
                                                         p
                                                         (
                                                         l
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           If 
                              
                                 l
                                 =
                                 k
                                 +
                                 1
                                 ,
                              
                            then (48) and (50) must be adjusted by removing the third and, respectively, the fourth term.

We now simplify the above expressions. First of all, observe that 
                              
                                 
                                    T
                                    1
                                 
                                 =
                                 2
                                 
                                    b
                                    
                                       r
                                       l
                                    
                                 
                              
                           . Next, it is easy to see that the sum over m in (46) is equal to 
                              
                                 d
                                 
                                    p
                                    (
                                    k
                                    +
                                    1
                                    )
                                    p
                                    (
                                    l
                                    )
                                 
                              
                           . Therefore, 
                              
                                 
                                    T
                                    2
                                 
                                 =
                                 
                                    c
                                    k
                                    −
                                 
                                 
                                    (
                                    
                                       d
                                       
                                          p
                                          (
                                          k
                                          +
                                          1
                                          )
                                          p
                                          (
                                          l
                                          )
                                       
                                    
                                    +
                                    
                                       λ
                                       
                                          p
                                          (
                                          l
                                          )
                                       
                                    
                                    +
                                    
                                       λ
                                       r
                                    
                                    )
                                 
                              
                           . Further, it is not hard to check that, using equations 
                              
                                 
                                    c
                                    
                                       m
                                       +
                                       1
                                    
                                    −
                                 
                                 =
                                 
                                    c
                                    
                                       m
                                       +
                                       1
                                    
                                 
                                 −
                                 
                                    c
                                    m
                                 
                                 ,
                              
                           
                           
                              
                                 m
                                 =
                                 k
                                 ,
                                 …
                                 ,
                                 l
                                 −
                                 1
                                 ,
                              
                            
                           (47) can be rewritten as

                              
                                 (51)
                                 
                                    
                                       
                                          T
                                          3
                                       
                                       =
                                       
                                          c
                                          
                                             k
                                             +
                                             1
                                          
                                          −
                                       
                                       
                                          λ
                                          
                                             p
                                             (
                                             k
                                             +
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          c
                                          l
                                          −
                                       
                                       
                                          λ
                                          r
                                       
                                       +
                                       
                                          ∑
                                          
                                             m
                                             =
                                             k
                                             +
                                             2
                                          
                                          l
                                       
                                       
                                          (
                                          
                                             c
                                             m
                                          
                                          −
                                          
                                             c
                                             
                                                m
                                                −
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          λ
                                          
                                             p
                                             (
                                             m
                                             )
                                          
                                       
                                       .
                                    
                                 
                              
                           Similarly, simplifying (48) we get

                              
                                 (52)
                                 
                                    
                                       
                                          T
                                          4
                                       
                                       =
                                       
                                          (
                                          
                                             c
                                             l
                                             +
                                          
                                          −
                                          
                                             c
                                             k
                                             +
                                          
                                          )
                                       
                                       
                                          λ
                                          r
                                       
                                       −
                                       
                                          ∑
                                          
                                             m
                                             =
                                             k
                                             +
                                             1
                                          
                                          l
                                       
                                       
                                          (
                                          
                                             c
                                             m
                                          
                                          −
                                          
                                             c
                                             
                                                m
                                                −
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          λ
                                          
                                             p
                                             (
                                             m
                                             )
                                          
                                       
                                       .
                                    
                                 
                              
                           Notice that (52) holds also for 
                              
                                 l
                                 =
                                 k
                                 +
                                 1
                                 ,
                              
                            since in this case only the first two terms in (48) can be nonzero and 
                              
                                 
                                    c
                                    
                                       k
                                       +
                                       1
                                    
                                    +
                                 
                                 −
                                 
                                    c
                                    k
                                    +
                                 
                                 =
                                 
                                    c
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 −
                                 
                                    c
                                    
                                       k
                                       −
                                       1
                                    
                                 
                              
                           . Summing (51) and (52) gives 
                              
                                 
                                    T
                                    3
                                 
                                 +
                                 
                                    T
                                    4
                                 
                                 =
                                 
                                    (
                                    2
                                    
                                       c
                                       l
                                    
                                    −
                                    
                                       c
                                       k
                                       +
                                    
                                    )
                                 
                                 
                                    λ
                                    r
                                 
                                 −
                                 
                                    c
                                    k
                                    −
                                 
                                 
                                    λ
                                    
                                       p
                                       (
                                       k
                                       +
                                       1
                                       )
                                    
                                 
                              
                           . Suppose that 
                              
                                 l
                                 >
                                 k
                                 +
                                 1
                              
                           . Then by expanding the sums in (49), we find that 
                              
                                 
                                    T
                                    5
                                 
                                 =
                                 
                                    c
                                    
                                       l
                                       −
                                       1
                                    
                                 
                                 
                                    γ
                                    
                                       p
                                       (
                                       l
                                       −
                                       1
                                       )
                                       p
                                       (
                                       l
                                       )
                                    
                                 
                                 −
                                 
                                    c
                                    k
                                 
                                 
                                    γ
                                    
                                       p
                                       (
                                       k
                                       +
                                       1
                                       )
                                       p
                                       (
                                       k
                                       +
                                       2
                                       )
                                    
                                 
                              
                           . Substituting 
                              
                                 
                                    T
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    T
                                    6
                                 
                              
                            in (45), and performing minor manipulations yields (24). In the case of 
                              
                                 l
                                 =
                                 k
                                 +
                                 1
                                 ,
                              
                           
                           
                              
                                 
                                    T
                                    5
                                 
                                 =
                                 0
                              
                            and the terms of (24) containing γ values are deduced from T
                           6 alone (with the adjustment mentioned right below (50)).

To finish the proof, we address the case where l < k. Our strategy is to take advantage of formula (24) we have just derived. For a permutation p ∈ Π, let 
                              
                                 p
                                 ˜
                              
                            be its reverse defined by 
                              
                                 
                                    p
                                    ˜
                                 
                                 
                                    (
                                    m
                                    )
                                 
                                 =
                                 p
                                 
                                    (
                                    n
                                    −
                                    m
                                    +
                                    1
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 m
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                           . Denote the transpose of the matrix Γ by 
                              
                                 
                                    Γ
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       γ
                                       
                                          i
                                          j
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                                 ,
                              
                            where 
                              
                                 
                                    γ
                                    
                                       i
                                       j
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    γ
                                    
                                       j
                                       i
                                    
                                 
                              
                           . We will write 
                              
                                 δ
                                 ˜
                              
                            for the δ values (and 
                              
                                 b
                                 ˜
                              
                            for the entries of the matrix B) defined with respect to the SRFLP instance given by the triplet (W, L, Γ
                           T), 
                              
                                 L
                                 =
                                 (
                                 
                                    L
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    L
                                    n
                                 
                                 )
                              
                           . We will use 
                              
                                 
                                    
                                       c
                                       ˜
                                    
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       c
                                       ˜
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                              
                            to refer to the cut values for the solution 
                              
                                 p
                                 ˜
                              
                           . By applying (24) to 
                              
                                 
                                    δ
                                    ˜
                                 
                                 ,
                              
                            we have

                              
                                 
                                    
                                       
                                          
                                             
                                                δ
                                                (
                                                p
                                                ,
                                                k
                                                ,
                                                l
                                                )
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   δ
                                                   ˜
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      ˜
                                                   
                                                   ,
                                                   n
                                                   −
                                                   k
                                                   +
                                                   1
                                                   ,
                                                   n
                                                   −
                                                   l
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                2
                                                
                                                   
                                                      b
                                                      ˜
                                                   
                                                   
                                                      r
                                                      ,
                                                      n
                                                      −
                                                      l
                                                      +
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      c
                                                      ˜
                                                   
                                                   
                                                      n
                                                      −
                                                      k
                                                      +
                                                      1
                                                   
                                                   −
                                                
                                                
                                                   (
                                                   
                                                      d
                                                      
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            k
                                                            +
                                                            2
                                                            )
                                                         
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            l
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      λ
                                                      
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            k
                                                            +
                                                            2
                                                            )
                                                         
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            l
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      +
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   L
                                                   r
                                                
                                                
                                                   (
                                                   
                                                      
                                                         c
                                                         ˜
                                                      
                                                      
                                                         n
                                                         −
                                                         l
                                                         +
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         c
                                                         ˜
                                                      
                                                      
                                                         n
                                                         −
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      c
                                                      ˜
                                                   
                                                   
                                                      n
                                                      −
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                ×
                                                
                                                
                                                   (
                                                   
                                                      γ
                                                      
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            k
                                                            )
                                                         
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            k
                                                            +
                                                            2
                                                            )
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            l
                                                            +
                                                            1
                                                            )
                                                         
                                                         r
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            k
                                                            )
                                                         
                                                         r
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                −
                                                
                                                
                                                   
                                                      c
                                                      ˜
                                                   
                                                   
                                                      n
                                                      −
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      γ
                                                      
                                                         r
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            k
                                                            +
                                                            2
                                                            )
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            l
                                                            +
                                                            1
                                                            )
                                                         
                                                         r
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   
                                                      c
                                                      ˜
                                                   
                                                   
                                                      n
                                                      −
                                                      l
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      γ
                                                      
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            l
                                                            +
                                                            1
                                                            )
                                                         
                                                         r
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         r
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            l
                                                            +
                                                            2
                                                            )
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            l
                                                            +
                                                            1
                                                            )
                                                         
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            l
                                                            +
                                                            2
                                                            )
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       c
                                       ˜
                                    
                                    
                                       n
                                       −
                                       k
                                       +
                                       1
                                    
                                    −
                                 
                                 =
                                 
                                    
                                       c
                                       ˜
                                    
                                    
                                       n
                                       −
                                       k
                                       +
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       c
                                       ˜
                                    
                                    
                                       n
                                       −
                                       k
                                    
                                 
                              
                           . Making use of the identities 
                              
                                 
                                    
                                       b
                                       ˜
                                    
                                    
                                       r
                                       ,
                                       n
                                       −
                                       l
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    b
                                    
                                       r
                                       l
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       c
                                       ˜
                                    
                                    
                                       n
                                       −
                                       l
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    c
                                    
                                       l
                                       −
                                       1
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       c
                                       ˜
                                    
                                    
                                       n
                                       −
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    c
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       c
                                       ˜
                                    
                                    
                                       n
                                       −
                                       k
                                    
                                 
                                 =
                                 
                                    c
                                    k
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       c
                                       ˜
                                    
                                    
                                       n
                                       −
                                       k
                                       +
                                       1
                                    
                                    −
                                 
                                 =
                                 −
                                 
                                    c
                                    k
                                    −
                                 
                              
                            and translating back to the permutation p and matrix Γ, we arrive at (25).□

First we show that (26) holds. We start with the following equality:

                              
                                 (53)
                                 
                                    
                                       δ
                                       
                                          (
                                          p
                                          ,
                                          k
                                          ,
                                          l
                                          )
                                       
                                       =
                                       δ
                                       
                                          (
                                          p
                                          ,
                                          k
                                          ,
                                          l
                                          −
                                          1
                                          )
                                       
                                       +
                                       
                                          Δ
                                          
                                             l
                                             −
                                             2
                                          
                                       
                                       +
                                       
                                          Δ
                                          
                                             l
                                             −
                                             1
                                          
                                       
                                       +
                                       
                                          Δ
                                          l
                                       
                                       ,
                                    
                                 
                              
                           where 
                              
                                 
                                    Δ
                                    m
                                 
                                 =
                                 
                                    f
                                    m
                                 
                                 
                                    (
                                    
                                       p
                                       ′
                                    
                                    )
                                 
                                 −
                                 
                                    f
                                    m
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          ′
                                          ′
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 m
                                 =
                                 l
                                 −
                                 2
                                 ,
                                 l
                                 −
                                 1
                                 ,
                                 l
                                 ,
                              
                            and p′ (respectively, p′′) is the permutation obtained from p by relocating the facility 
                              
                                 r
                                 =
                                 p
                                 (
                                 k
                                 )
                              
                            from position k to position l (respectively, to position 
                              
                                 l
                                 −
                                 1
                              
                           ). It is assumed that 
                              
                                 
                                    p
                                    
                                       ′
                                       ′
                                    
                                 
                                 =
                                 p
                              
                            if 
                              
                                 l
                                 =
                                 k
                                 +
                                 1
                              
                           . Letting 
                              
                                 
                                    c
                                    i
                                    ′
                                 
                                 ,
                              
                           
                           
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 −
                                 1
                                 ,
                              
                            denote the cut values for p′, we consider the following three cases.

                              
                                 (i)
                                 
                                    
                                       
                                          m
                                          =
                                          l
                                       
                                    . Since 
                                       
                                          
                                             c
                                             l
                                             ′
                                          
                                          =
                                          
                                             c
                                             l
                                          
                                       
                                     it follows that

                                       
                                          (54)
                                          
                                             
                                                
                                                   Δ
                                                   l
                                                
                                                =
                                                
                                                   c
                                                   l
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      r
                                                   
                                                   −
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         l
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         r
                                                         p
                                                         (
                                                         l
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         l
                                                         )
                                                         p
                                                         (
                                                         l
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 


                                    
                                       
                                          m
                                          =
                                          l
                                          −
                                          1
                                       
                                    . The cut value for p′ is 
                                       
                                          
                                             c
                                             
                                                l
                                                −
                                                1
                                             
                                             ′
                                          
                                          =
                                          
                                             c
                                             
                                                l
                                                −
                                                1
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                l
                                                −
                                                1
                                             
                                          
                                          
                                             w
                                             
                                                r
                                                p
                                                (
                                                i
                                                )
                                             
                                          
                                          −
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   l
                                                
                                                n
                                             
                                             
                                                w
                                                
                                                   r
                                                   p
                                                   (
                                                   i
                                                   )
                                                
                                             
                                             
                                             −
                                             
                                             
                                                w
                                                
                                                   r
                                                   p
                                                   (
                                                   l
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                          +
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                l
                                                +
                                                1
                                             
                                             n
                                          
                                          
                                             w
                                             
                                                p
                                                (
                                                l
                                                )
                                                p
                                                (
                                                i
                                                )
                                             
                                          
                                          
                                          −
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   l
                                                   −
                                                   1
                                                
                                             
                                             
                                                w
                                                
                                                   p
                                                   (
                                                   l
                                                   )
                                                   p
                                                   (
                                                   i
                                                   )
                                                
                                             
                                             −
                                             
                                                w
                                                
                                                   r
                                                   p
                                                   (
                                                   l
                                                   )
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             c
                                             
                                                l
                                                −
                                                1
                                             
                                          
                                          +
                                          
                                             a
                                             
                                                r
                                                1
                                             
                                          
                                          +
                                          
                                             a
                                             
                                                r
                                                ,
                                                l
                                                −
                                                1
                                             
                                          
                                          −
                                          
                                             (
                                             
                                                a
                                                
                                                   r
                                                   n
                                                
                                             
                                             −
                                             
                                                a
                                                
                                                   r
                                                   ,
                                                   l
                                                   −
                                                   1
                                                
                                             
                                             −
                                             
                                                w
                                                
                                                   r
                                                   p
                                                   (
                                                   l
                                                   )
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             a
                                             
                                                p
                                                (
                                                l
                                                )
                                                n
                                             
                                          
                                          
                                          −
                                          
                                             (
                                             
                                                a
                                                
                                                   p
                                                   (
                                                   l
                                                   )
                                                   1
                                                
                                             
                                             −
                                             
                                                w
                                                
                                                   r
                                                   p
                                                   (
                                                   l
                                                   )
                                                
                                             
                                             )
                                          
                                       
                                    . Simplifying, we get:

                                       
                                          (55)
                                          
                                             
                                                
                                                   c
                                                   
                                                      l
                                                      −
                                                      1
                                                   
                                                   ′
                                                
                                                =
                                                
                                                   c
                                                   
                                                      l
                                                      −
                                                      1
                                                   
                                                
                                                −
                                                
                                                   c
                                                   k
                                                   −
                                                
                                                +
                                                
                                                   c
                                                   l
                                                   −
                                                
                                                +
                                                2
                                                
                                                   a
                                                   
                                                      r
                                                      l
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    Making use of (55) gives

                                       
                                          (56)
                                          
                                             
                                                
                                                   
                                                      
                                                         Δ
                                                         
                                                            l
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               c
                                                               
                                                                  l
                                                                  −
                                                                  1
                                                               
                                                            
                                                            −
                                                            
                                                               c
                                                               k
                                                               −
                                                            
                                                            +
                                                            
                                                               c
                                                               l
                                                               −
                                                            
                                                            +
                                                            2
                                                            
                                                               a
                                                               
                                                                  r
                                                                  l
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                                  r
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         −
                                                         
                                                         
                                                            c
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               c
                                                               l
                                                               −
                                                            
                                                            −
                                                            
                                                               c
                                                               k
                                                               −
                                                            
                                                            +
                                                            2
                                                            
                                                               a
                                                               
                                                                  r
                                                                  l
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                                  r
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         +
                                                         
                                                         
                                                            c
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                                  r
                                                               
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 


                                    
                                       
                                          m
                                          =
                                          l
                                          −
                                          2
                                       
                                    . First suppose that 
                                       
                                          l
                                          >
                                          k
                                          +
                                          1
                                       
                                    . Since swapping the facilities r and p(l) does not affect the cut value 
                                       
                                          
                                             c
                                             
                                                l
                                                −
                                                2
                                             
                                             ′
                                          
                                          ,
                                       
                                     we can write

                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Δ
                                                         
                                                            l
                                                            −
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            
                                                               l
                                                               −
                                                               2
                                                            
                                                            ′
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         −
                                                         
                                                         
                                                            c
                                                            
                                                               l
                                                               −
                                                               2
                                                            
                                                            ′
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                                  r
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                            
                                                               l
                                                               −
                                                               2
                                                            
                                                            ′
                                                         
                                                         
                                                            (
                                                            
                                                               λ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               λ
                                                               r
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  −
                                                                  1
                                                                  )
                                                                  r
                                                               
                                                            
                                                            )
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    Using an analogue of (55) for 
                                       
                                          l
                                          −
                                          2
                                          ,
                                       
                                     we obtain

                                       
                                          (57)
                                          
                                             
                                                
                                                   Δ
                                                   
                                                      l
                                                      −
                                                      2
                                                   
                                                
                                                =
                                                
                                                   (
                                                   
                                                      c
                                                      
                                                         l
                                                         −
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      c
                                                      k
                                                      −
                                                   
                                                   +
                                                   2
                                                   
                                                      a
                                                      
                                                         r
                                                         ,
                                                         l
                                                         −
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         l
                                                         )
                                                      
                                                   
                                                   −
                                                   
                                                      λ
                                                      r
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         l
                                                         −
                                                         1
                                                         )
                                                         p
                                                         (
                                                         l
                                                         )
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         l
                                                         −
                                                         1
                                                         )
                                                         r
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    If 
                                       
                                          l
                                          =
                                          k
                                          +
                                          1
                                          ,
                                       
                                     then 
                                       
                                          Δ
                                          
                                             l
                                             −
                                             2
                                          
                                       
                                     takes a simpler form:

                                       
                                          (58)
                                          
                                             
                                                
                                                   Δ
                                                   
                                                      l
                                                      −
                                                      2
                                                   
                                                
                                                =
                                                
                                                   c
                                                   
                                                      l
                                                      −
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      
                                                         p
                                                         (
                                                         l
                                                         )
                                                      
                                                   
                                                   −
                                                   
                                                      λ
                                                      r
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         k
                                                         −
                                                         1
                                                         )
                                                         p
                                                         (
                                                         l
                                                         )
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         p
                                                         (
                                                         k
                                                         −
                                                         1
                                                         )
                                                         r
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    Substituting (54), (56) and (57) in (53) yields

                                       
                                          (59)
                                          
                                             
                                                
                                                   
                                                      
                                                         δ
                                                         (
                                                         p
                                                         ,
                                                         k
                                                         ,
                                                         l
                                                         )
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         δ
                                                         
                                                            (
                                                            p
                                                            ,
                                                            k
                                                            ,
                                                            l
                                                            −
                                                            1
                                                            )
                                                         
                                                         +
                                                         2
                                                         
                                                            λ
                                                            
                                                               p
                                                               (
                                                               l
                                                               )
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               a
                                                               
                                                                  r
                                                                  ,
                                                                  l
                                                                  −
                                                                  1
                                                               
                                                            
                                                            +
                                                            
                                                               a
                                                               
                                                                  r
                                                                  l
                                                               
                                                            
                                                            −
                                                            
                                                               c
                                                               k
                                                               −
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         +
                                                         
                                                         2
                                                         
                                                            λ
                                                            r
                                                         
                                                         
                                                            (
                                                            
                                                               w
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               c
                                                               l
                                                               −
                                                            
                                                            )
                                                         
                                                         +
                                                         T
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    where

                                       
                                          (60)
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         2
                                                         
                                                            a
                                                            
                                                               r
                                                               l
                                                            
                                                         
                                                         
                                                            γ
                                                            
                                                               p
                                                               (
                                                               l
                                                               )
                                                               r
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            a
                                                            
                                                               r
                                                               ,
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               γ
                                                               
                                                                  u
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  u
                                                                  r
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         −
                                                         
                                                         
                                                            c
                                                            k
                                                            −
                                                         
                                                         
                                                            (
                                                            
                                                               γ
                                                               
                                                                  u
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                                  r
                                                               
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  u
                                                                  r
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         −
                                                         
                                                         
                                                            c
                                                            
                                                               l
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               γ
                                                               
                                                                  u
                                                                  r
                                                               
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  u
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         +
                                                         
                                                         
                                                            c
                                                            l
                                                         
                                                         
                                                            (
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                                  r
                                                               
                                                            
                                                            +
                                                            
                                                               γ
                                                               
                                                                  r
                                                                  p
                                                                  (
                                                                  l
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               γ
                                                               
                                                                  p
                                                                  (
                                                                  l
                                                                  )
                                                                  p
                                                                  (
                                                                  l
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    with u as defined in the formulation of the proposition. We emphasize that (59) and (60) also cover the case of 
                                       
                                          l
                                          =
                                          k
                                          +
                                          1
                                       
                                    . This can be checked by combining (54), (56) and (58) and taking into account the following identities, valid for 
                                       
                                          l
                                          =
                                          k
                                          +
                                          1
                                       
                                    : 
                                       
                                          
                                             a
                                             
                                                r
                                                ,
                                                l
                                                −
                                                1
                                             
                                          
                                          =
                                          0
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             a
                                             
                                                r
                                                l
                                             
                                          
                                          =
                                          
                                             w
                                             
                                                r
                                                p
                                                (
                                                l
                                                )
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             c
                                             k
                                             −
                                          
                                          =
                                          
                                             c
                                             
                                                l
                                                −
                                                1
                                             
                                          
                                          −
                                          
                                             c
                                             
                                                l
                                                −
                                                2
                                             
                                          
                                       
                                    .

Using the equation 
                              
                                 
                                    a
                                    
                                       r
                                       l
                                    
                                 
                                 =
                                 
                                    a
                                    
                                       r
                                       ,
                                       l
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    w
                                    
                                       r
                                       p
                                       (
                                       l
                                       )
                                    
                                 
                                 ,
                              
                            the first three terms in (60) can be rewritten as 
                              
                                 2
                                 
                                    w
                                    
                                       r
                                       p
                                       (
                                       l
                                       )
                                    
                                 
                                 
                                    γ
                                    
                                       p
                                       (
                                       l
                                       )
                                       r
                                    
                                 
                                 +
                                 
                                    (
                                    2
                                    
                                       a
                                       
                                          r
                                          ,
                                          l
                                          −
                                          1
                                       
                                    
                                    −
                                    
                                       c
                                       k
                                       −
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       γ
                                       
                                          u
                                          p
                                          (
                                          l
                                          )
                                       
                                    
                                    +
                                    
                                       γ
                                       
                                          p
                                          (
                                          l
                                          )
                                          r
                                       
                                    
                                    −
                                    
                                       γ
                                       
                                          u
                                          r
                                       
                                    
                                    )
                                 
                              
                           . Now substituting the value of T in (59) and, for ease of exposition, renaming 
                              
                                 a
                                 
                                    r
                                    ,
                                    l
                                    −
                                    1
                                 
                              
                            to 
                              
                                 e
                                 
                                    l
                                    −
                                    1
                                 
                              
                            and, respectively, arl
                            to el
                            we get (26).

For 
                              
                                 l
                                 =
                                 k
                                 −
                                 1
                                 ,
                                 k
                                 −
                                 2
                                 ,
                                 …
                                 ,
                                 1
                                 ,
                              
                            we apply the same trick as in the proof of the case l < k of Proposition 4. In terms of the notations used there, from (26) we have

                              
                                 (61)
                                 
                                    
                                       
                                          
                                             
                                                δ
                                                (
                                                p
                                                ,
                                                k
                                                ,
                                                l
                                                )
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   δ
                                                   ˜
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      ˜
                                                   
                                                   ,
                                                   n
                                                   −
                                                   k
                                                   +
                                                   1
                                                   ,
                                                   n
                                                   −
                                                   l
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   δ
                                                   ˜
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      ˜
                                                   
                                                   ,
                                                   n
                                                   −
                                                   k
                                                   +
                                                   1
                                                   ,
                                                   n
                                                   −
                                                   l
                                                   )
                                                
                                                +
                                                
                                                   L
                                                   r
                                                
                                                
                                                   (
                                                   
                                                      w
                                                      
                                                         r
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            l
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                         ˜
                                                      
                                                      
                                                         n
                                                         −
                                                         l
                                                         +
                                                         1
                                                      
                                                      −
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   L
                                                   
                                                      
                                                         p
                                                         ˜
                                                      
                                                      
                                                         (
                                                         n
                                                         −
                                                         l
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         e
                                                         ˜
                                                      
                                                      
                                                         n
                                                         −
                                                         l
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         e
                                                         ˜
                                                      
                                                      
                                                         n
                                                         −
                                                         l
                                                         +
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         c
                                                         ˜
                                                      
                                                      
                                                         n
                                                         −
                                                         k
                                                         +
                                                         1
                                                      
                                                      −
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                2
                                                
                                                   w
                                                   
                                                      
                                                         p
                                                         ˜
                                                      
                                                      
                                                         (
                                                         n
                                                         −
                                                         l
                                                         +
                                                         1
                                                         )
                                                      
                                                      r
                                                   
                                                
                                                
                                                   γ
                                                   
                                                      
                                                         p
                                                         ˜
                                                      
                                                      
                                                         (
                                                         n
                                                         −
                                                         l
                                                         +
                                                         1
                                                         )
                                                      
                                                      r
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   (
                                                   2
                                                   
                                                      
                                                         e
                                                         ˜
                                                      
                                                      
                                                         n
                                                         −
                                                         l
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         c
                                                         ˜
                                                      
                                                      
                                                         n
                                                         −
                                                         k
                                                         +
                                                         1
                                                      
                                                      −
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      γ
                                                      
                                                         u
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            l
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            l
                                                            +
                                                            1
                                                            )
                                                         
                                                         r
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         u
                                                         r
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                −
                                                
                                                
                                                   
                                                      c
                                                      ˜
                                                   
                                                   
                                                      n
                                                      −
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      γ
                                                      
                                                         u
                                                         r
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         r
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            l
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         u
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            l
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   
                                                      c
                                                      ˜
                                                   
                                                   
                                                      n
                                                      −
                                                      l
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      γ
                                                      
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            l
                                                            +
                                                            1
                                                            )
                                                         
                                                         r
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   +
                                                   
                                                      γ
                                                      
                                                         r
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            l
                                                            +
                                                            2
                                                            )
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            l
                                                            +
                                                            1
                                                            )
                                                         
                                                         
                                                            p
                                                            ˜
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            l
                                                            +
                                                            2
                                                            )
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       e
                                       ˜
                                    
                                    
                                       n
                                       −
                                       l
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       e
                                       ˜
                                    
                                    
                                       n
                                       −
                                       l
                                    
                                 
                                 +
                                 
                                    w
                                    
                                       r
                                       
                                          p
                                          ˜
                                       
                                       
                                          (
                                          n
                                          −
                                          l
                                          +
                                          1
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 u
                                 =
                                 
                                    p
                                    ˜
                                 
                                 
                                    (
                                    n
                                    −
                                    k
                                    )
                                 
                              
                            if 
                              
                                 n
                                 −
                                 l
                                 +
                                 1
                                 =
                                 n
                                 −
                                 k
                                 +
                                 2
                                 ,
                              
                            and 
                              
                                 u
                                 =
                                 
                                    p
                                    ˜
                                 
                                 
                                    (
                                    n
                                    −
                                    l
                                    )
                                 
                              
                            if 
                              
                                 n
                                 −
                                 l
                                 +
                                 1
                                 ≠
                                 n
                                 −
                                 k
                                 +
                                 2
                              
                           . Now (27) follows from (61) by applying the identities 
                              
                                 
                                    p
                                    ˜
                                 
                                 
                                    (
                                    m
                                    )
                                 
                                 =
                                 p
                                 
                                    (
                                    n
                                    −
                                    m
                                    +
                                    1
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       c
                                       ˜
                                    
                                    m
                                 
                                 =
                                 
                                    c
                                    
                                       n
                                       −
                                       m
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       c
                                       ˜
                                    
                                    m
                                    −
                                 
                                 =
                                 −
                                 
                                    c
                                    
                                       n
                                       −
                                       m
                                       +
                                       1
                                    
                                    −
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       e
                                       ˜
                                    
                                    m
                                 
                                 =
                                 
                                    e
                                    
                                       n
                                       −
                                       m
                                       +
                                       1
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 m
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                              
                            and 
                              
                                 
                                    γ
                                    
                                       i
                                       j
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    γ
                                    
                                       j
                                       i
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 i
                                 ,
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                           .□

Supplementary material associated with this article can be found, in the online version, at 10.1016/j.ejor.2015.05.055
                  


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

