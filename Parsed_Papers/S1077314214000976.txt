@&#MAIN-TITLE@&#Fast and globally convex multiphase active contours for brain MRI segmentation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A multiphase active contour model for image segmentation is proposed for brain MRI images.


                        
                        
                           
                           Following a relaxed convex formulation, a fast algorithm using dual minimization is implemented.


                        
                        
                           
                           Compared with other multiphase active contours, the proposed model performs well.


                        
                        
                           
                           Extensive experimental and comparison results indicate the usefulness of the model for brain MRI image segmentation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image segmentation

Active contours

Multiphase

Globally convex

Dual formulation

Brain MRI

@&#ABSTRACT@&#


               
               
                  Multiphase active contour based models are useful in identifying multiple regions with spatial consistency but varying characteristics such as the mean intensities of regions. Segmenting brain magnetic resonance images (MRIs) using a multiphase approach is useful to differentiate white and gray matter tissue for anatomical, functional and disease studies. Multiphase active contour methods are superior to other approaches due to their topological flexibility, accurate boundaries, robustness to image variations and adaptive energy functionals. Globally convex methods are furthermore initialization independent. We extend the relaxed globally convex Chan and Vese two-phase piecewise constant energy minimization formulation of Chan et al. (2006) [1] to the multiphase domain and prove the existence of a global minimizer in a specific space which is one of the novel contributions of the paper. An efficient dual minimization implementation of our binary partitioning function model accurately describes disjoint regions using stable segmentations by avoiding local minima solutions. Experimental results indicate that the proposed approach provides consistently better accuracy than other related multiphase active contour algorithms using four different error metrics (Dice, Rand Index, Global Consistency Error and Variation of Information) even under severe noise, intensity inhomogeneities, and partial volume effects in MRI imagery.
               
            

@&#INTRODUCTION@&#

The aim of image segmentation is to obtain meaningful partitions of an input image into a finite number of disjoint homogeneous objects. Active contour models are popular in the regard. Chan and Vese [2] proposed an active contour without edges scheme based on the classical work of Mumford and Shah [3] variational energy minimization model. Since biomedical images typically have multiple regions of interest with different characteristics, deriving a multiphase active contour scheme for efficient segmentation is an important area of research in image processing [4–6].

Measuring brain activity and structure using neuroimaging, combined with behavioral and genetic data to characterize human brain connectivity is one of the major goals of The Human Connectome Project (HCP) [7]. Systematic processing and analysis of the MRI (magnetic resonance image) data collected by the HCP for 1200 subjects will be an extremely challenging task. Automated segmentation of multimodal imagery such as T1-weighted, T2-weighted anatomical scans, diffusion imaging, resting state and task-evoked functional MRI will enable quantitative characterization of similarities and differences in structural connectivity and brain activity differences between individuals. Cognitive processes such as memory, language, emotion, decision-making, and social cognition are all being studied as part of the HCP. One of the basic quantitative image analysis tasks that is expected to be necessary in the neuro-informatics data processing workflow is brain region segmentation. The multi-region brain MRI segmentation algorithm developed in this paper will facilitate the large scale efforts underway in functional connectomics and can be adapted for building an activity map of the brain.

In MR images, segmentation schemes based on active contours have used the traditional level set method [8]. Active contours can also be improved using region information [9,10], salient features [11], mathematical morphology [12], etc. Traditionally these schemes use a gradient descent formulation to implement the non-convex energy minimization which often converges to undesirable local minima resulting in erroneous segmentations. Moreover, traditional level set based implementations are susceptible to slower convergence due to the well-known re-initialization requirement and discretization errors. Among other techniques for MRI segmentation, we mention fuzzy C-means based models [13–16], fuzzy connectedness [17], automatic labeling [18], adaptive expectation–maximization (EM) [19], Bayesian EM [20], hidden Markov model EM [21], kernel clustering [22], optimum-path clustering [23], anisotropic diffusion combined with classical snakes model [24], discriminant analysis [25], and neural networks [26]. We also refer to [27–29] for reviews about segmentation for medical images in general. The area of MRI image segmentation has seen tremendous research activity and a more detailed review in this particular field can be found in [30].

Recently quite a lot of interest is being shown in techniques that can obtain a general convex formulation for active contours schemes based on energy minimization which can alleviate the problem of local minima and at the same time reduce computational complexity [31–37]. In Chan et al. [1] a convex approach to the two phase segmentation is proposed when the piecewise constant values labeling disjoint regions are known. The method relies in replacing the Heaviside functions of level sets (or characteristic functions) by convex and differentiable functions varying in the interval 
                        
                           [
                           0
                           ,
                           1
                           ]
                        
                      which remarkably still yields a solution that is obtained by a simple thresholding procedure. This allows the non-convex Chan–Vese problem [2] to be solved using standard convex optimization methods. There have been efforts to extend the approach of [1] to the more challenging multi-phase problem [5]. Zach et al. [38] and Lellman et al. [39] proposed convex minimization schemes for the multi-phase segmentation without guaranteed global optimum of the original problem. Other approaches due to [40,41] not only use a convex formulation but also a dual formulation of the total variation in order to enforce a convex constraint on the dual variable providing accurate and better numerical solutions, but do not aim at computing a global minimizer of the problem.

In this paper, we consider a globally convex version of the four phase piecewise constant energy functional motivated from the seminal work of Chan et al. [1] and based on Bresson et al. [42] which considered the two phase segmentation model. By deriving an approximate novel convex functional we change the original formulation into a binary segmentation problem and utilize a Chambolle’s dual minimization [43] to solve the relaxed formulation [44]. The proposed global methodology avoids the level set re-initialization constraint and other ad hoc techniques [45] used for fixing level set active contour movements throughout the iterations. The proposed approach is used to obtain white matter and gray matter partitions on brain MRI images as can be seen for example in Fig. 1
                     . Fig. 1a is a coronal slice from a normal brain MRI and the binary segmentations capture gray matter/white matter (Fig. 1b white and black regions respectively), and tissue/background (Fig. 1c white and black regions respectively). Fig. 1d show the final segmentation result as contours superimposed on the input image and the color coded regions in Fig. 1e shows that our scheme captures the intermediate regions as well.

Our scheme does not involve level sets or re-initialization and instead relies on the relaxed globally convex formulation of the Vese and Chan multiphase active contours [5]. Comparison results on different MRI data sets (real and synthetic) with varying noise and inhomogeneities show that we can obtain better results than traditional level set multiphase schemes [5,46,47] and the primal–dual approach of [48]. Moreover, compared to these traditional level set based implementations we achieve faster convergence due to the use of efficient alternating dual minimization [49]. The proposed approach is general in the sense that we can add domain specific knowledge to improve such active contour schemes further for various tasks [50–55]. The main contribution of our work is twofold: (1) a fast four phase active contour model using a relaxed globally convex minimization approximation; (2) an efficient dual minimization based numerical implementation for performing segmentation on MRI images.

The rest of the paper is organized as follows. Section 2 introduces the multiphase variational active contour scheme and provides a globally convex formulation. Section 3 illustrates the segmentation results on various Brain MRI images including comparison of different schemes. Finally, Section 4 concludes the paper with discussion.

We first briefly review the classical level set formulation of Chan and Vese [2] which is based on the Mumford and Shah functional [3] with particular emphasis on the piecewise constant model. The Mumford–Shah segmentation energy minimization is given by
                           
                              (1)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                c
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          ∈
                                          R
                                          ,
                                          Σ
                                          ⊂
                                          Ω
                                       
                                    
                                 
                                 MS
                                 (
                                 Σ
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ≔
                                 Per
                                 (
                                 Σ
                                 )
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       0
                                    
                                 
                                 
                                    ∫
                                    
                                       Σ
                                    
                                 
                                 
                                    
                                       (
                                       I
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 x
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    ∫
                                    
                                       Ω
                                       ⧹
                                       Σ
                                    
                                 
                                 
                                    
                                       (
                                       I
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 x
                              
                           
                        where 
                           
                              I
                              :
                              Ω
                              ⊂
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              →
                              R
                           
                         is the input image, 
                           
                              Per
                              (
                              ·
                              )
                           
                         denotes the perimeter and 
                           
                              ∂
                              Σ
                           
                         separates the regions 
                           
                              Σ
                           
                         and 
                           
                              Ω
                              ⧹
                              Σ
                           
                         where the two values 
                           
                              
                                 
                                    c
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                           
                         are taken. This functional is non-convex even if we fix the constants 
                           
                              
                                 
                                    c
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                           
                         and thus a difficult optimization problem. Chan and Vese proposed to use the level set-based algorithm for solving the functional (1) by representing the boundary 
                           
                              ∂
                              Σ
                           
                         with the zero level set of an implicit function which models the image. Let 
                           
                              ϕ
                              :
                              Ω
                              ⊂
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              →
                              R
                           
                         be the level set which defines two regions which are ‘inside’ 
                           
                              {
                              x
                              ∈
                              Ω
                              :
                              ϕ
                              (
                              x
                              )
                              <
                              0
                              }
                           
                         and ‘outside’ 
                           
                              {
                              x
                              ∈
                              Ω
                              :
                              ϕ
                              (
                              x
                              )
                              >
                              0
                              }
                           
                         based on the zero level set 
                           
                              ϕ
                              =
                              0
                           
                        . Let H is the Heaviside function,
                           
                              (2)
                              
                                 H
                                 (
                                 z
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   if
                                                   
                                                   
                                                   z
                                                   ⩾
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   if
                                                   
                                                   z
                                                   <
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Then the Chan and Vese model is given by the following minimization problem,
                           
                              (3)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          (
                                          c
                                          ,
                                          ϕ
                                          )
                                       
                                    
                                 
                                 E
                                 (
                                 c
                                 ,
                                 ϕ
                                 )
                                 =
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 δ
                                 (
                                 ϕ
                                 )
                                 |
                                 ∇
                                 ϕ
                                 |
                                 d
                                 x
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       0
                                    
                                 
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       (
                                       I
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 H
                                 (
                                 ϕ
                                 )
                                 d
                                 x
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       (
                                       I
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 1
                                 -
                                 H
                                 (
                                 ϕ
                                 )
                                 )
                                 d
                                 x
                                 ,
                              
                           
                        where 
                           
                              δ
                           
                         is the Dirac delta function, 
                           
                              c
                              =
                              (
                              
                                 
                                    c
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         are the mean intensity values inside and outside regions respectively. The Euler–Lagrange equation with gradient descent formulation results in a nonlinear partial differential equation (PDE),
                           
                              (4)
                              
                                 
                                    
                                       ∂
                                       ϕ
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 δ
                                 (
                                 ϕ
                                 )
                                 
                                    
                                       
                                          div
                                          
                                             
                                                
                                                   
                                                      
                                                         ∇
                                                         ϕ
                                                      
                                                      
                                                         |
                                                         ∇
                                                         ϕ
                                                         |
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                λ
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                (
                                                I
                                                -
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                (
                                                I
                                                -
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        along with
                           
                              (5)
                              
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       IH
                                       (
                                       ϕ
                                       )
                                       d
                                       x
                                    
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       H
                                       (
                                       ϕ
                                       )
                                       d
                                       x
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       I
                                       (
                                       1
                                       -
                                       H
                                       (
                                       ϕ
                                       )
                                       )
                                       d
                                       x
                                    
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       (
                                       1
                                       -
                                       H
                                       (
                                       ϕ
                                       )
                                       )
                                       d
                                       x
                                    
                                 
                                 .
                              
                           
                        Chan et al. [1] in their work on finding global minimizers for such segmentation models observed that the following PDE,
                           
                              (6)
                              
                                 
                                    
                                       ∂
                                       ϕ
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          div
                                          
                                             
                                                
                                                   
                                                      
                                                         ∇
                                                         ϕ
                                                      
                                                      
                                                         |
                                                         ∇
                                                         ϕ
                                                         |
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                λ
                                             
                                             
                                                0
                                             
                                          
                                          (
                                          I
                                          -
                                          
                                             
                                                c
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          I
                                          -
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                        and the PDE in Eq. (4) has the same steady states and the later PDE (6) can be derived from the following functional,
                           
                              (7)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          (
                                          c
                                          ,
                                          ϕ
                                          )
                                       
                                    
                                 
                                 E
                                 (
                                 c
                                 ,
                                 ϕ
                                 )
                                 =
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 |
                                 ∇
                                 ϕ
                                 |
                                 d
                                 x
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 [
                                 
                                    
                                       λ
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       (
                                       I
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       (
                                       I
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 ]
                                 ϕ
                                 d
                                 x
                                 .
                              
                           
                        The following theorem which is proven in [1] paves the way for obtaining globally convex version of the two phase Mumford and Shah functional.
                           Theorem 1
                           
                              Theorem 2 in [1]
                           


                           
                              For any 
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    ∈
                                    R
                                 
                              
                              , a global minimizer of 
                              
                                 
                                    MS
                                    (
                                    ·
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                               
                              can be found by carrying out the following minimization:
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                             
                                             
                                                0
                                                ⩽
                                                u
                                                ⩽
                                                1
                                             
                                          
                                       
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       |
                                       ∇
                                       u
                                       |
                                       d
                                       x
                                       +
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      (
                                                      I
                                                      -
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                                -
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      (
                                                      I
                                                      -
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       u
                                       (
                                       x
                                       )
                                       d
                                       x
                                    
                                 
                              
                              and then setting 
                              
                                 
                                    Σ
                                    =
                                    {
                                    x
                                    :
                                    u
                                    (
                                    x
                                    )
                                    ⩾
                                    μ
                                    }
                                 
                               
                              for a.e. 
                              
                                 
                                    μ
                                    ∈
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                              
                              .
                           

Vese and Chan [5] extended the two-phase formulation to multi-phase case based on the observation that n level sets can be used to describe 
                           
                              
                                 
                                    2
                                 
                                 
                                    n
                                 
                              
                           
                         phases or regions. Here we restrict our description to the four phase model which is used in segmenting MR images effectively. Let 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    2
                                 
                              
                              :
                              Ω
                              ⊂
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              →
                              R
                           
                         be the two level sets. 
                           
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                              =
                              H
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              
                                 
                                    H
                                 
                                 
                                    2
                                 
                              
                              =
                              H
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          H
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              =
                              1
                              -
                              H
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              
                                 
                                    
                                       
                                          H
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              1
                              -
                              H
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , representing four regions. Our goal is to solve a minimization problem
                           
                              (8)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          (
                                          c
                                          ,
                                          Φ
                                          )
                                       
                                    
                                 
                                 F
                                 (
                                 c
                                 ,
                                 Φ
                                 )
                              
                           
                        with
                           
                              
                                 F
                                 (
                                 c
                                 ,
                                 Φ
                                 )
                                 =
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 δ
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 |
                                 ∇
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 d
                                 x
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 δ
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 |
                                 ∇
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 |
                                 d
                                 x
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       11
                                    
                                 
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       (
                                       I
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             11
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 x
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       10
                                    
                                 
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       (
                                       I
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             10
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 x
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       01
                                    
                                 
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       (
                                       I
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             01
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 x
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       00
                                    
                                 
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       (
                                       I
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             00
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 x
                              
                           
                        where 
                           
                              Φ
                              =
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , and the constant mean values 
                           
                              c
                              =
                              (
                              
                                 
                                    c
                                 
                                 
                                    11
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    10
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    01
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    00
                                 
                              
                              )
                           
                         can be derived as
                           
                              (9)
                              
                                 
                                    
                                       c
                                    
                                    
                                       11
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       
                                          
                                             IH
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             H
                                          
                                          
                                             2
                                          
                                       
                                       d
                                       x
                                    
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       
                                          
                                             H
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             H
                                          
                                          
                                             2
                                          
                                       
                                       d
                                       x
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       10
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       
                                          
                                             IH
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   ∼
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       d
                                       x
                                    
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       
                                          
                                             H
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   ∼
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       d
                                       x
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       c
                                    
                                    
                                       01
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       I
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   ∼
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             H
                                          
                                          
                                             2
                                          
                                       
                                       d
                                       x
                                    
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   ∼
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             H
                                          
                                          
                                             2
                                          
                                       
                                       d
                                       x
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       00
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       I
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   ∼
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   ∼
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       d
                                       x
                                    
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   ∼
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   ∼
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       d
                                       x
                                    
                                 
                                 .
                              
                           
                        Note the zero level sets 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                              ,
                              i
                              =
                              1
                              ,
                              2
                           
                        , represent object boundaries and the mean values 
                           
                              c
                           
                         represent the expected average pixel values in these objects. Vese and Chan [5] used the corresponding gradient descent equations to implement the active contours [8]. In the numerical implementation of the above PDEs, a non-compactly supported, smooth approximation of the Heaviside function 
                           
                              
                                 
                                    H
                                 
                                 
                                    ∊
                                 
                              
                              (
                              x
                              )
                           
                        , such that 
                           
                              
                                 
                                    H
                                 
                                 
                                    ∊
                                 
                              
                              (
                              x
                              )
                              →
                              H
                              (
                              x
                              )
                           
                         as 
                           
                              ∊
                              →
                              0
                           
                         is utilized. Since the above minimization (8) is non-convex the time discretized gradient descent PDEs usually require large iterations and small time steps to convergence (typically in 100’s of iterations). Moreover, the final segmentation result may not correspond to the global minimum of the energy function as the gradient descent scheme can be stuck at a local minima of the corresponding energy functional given in Eq. (8).

We note the corresponding gradient descent equations (time dependent Euler–Lagrange equations of Eq. (8)) for the level sets functions 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    2
                                 
                              
                           
                        ,
                           
                              (11)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                       t
                                    
                                 
                                 =
                                 δ
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       
                                          div
                                          
                                             
                                                
                                                   
                                                      
                                                         ∇
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         |
                                                         ∇
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         |
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                r
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          c
                                          )
                                       
                                    
                                 
                              
                           
                        and
                           
                              (12)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                       t
                                    
                                 
                                 =
                                 δ
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 
                                    
                                       
                                          div
                                          
                                             
                                                
                                                   
                                                      
                                                         ∇
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         |
                                                         ∇
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         |
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                r
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          c
                                          )
                                       
                                    
                                 
                              
                           
                        respectively. Here, the image fitting terms are given by,
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   1
                                                
                                             
                                             (
                                             c
                                             )
                                             =
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   11
                                                
                                             
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             
                                                
                                                   λ
                                                
                                                
                                                   01
                                                
                                             
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         01
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             
                                                
                                                   H
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             +
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   10
                                                
                                             
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         10
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             
                                                
                                                   λ
                                                
                                                
                                                   00
                                                
                                             
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         00
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             c
                                             )
                                             =
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   11
                                                
                                             
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             
                                                
                                                   λ
                                                
                                                
                                                   10
                                                
                                             
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         10
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             
                                                
                                                   H
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             +
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   01
                                                
                                             
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         01
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             
                                                
                                                   λ
                                                
                                                
                                                   00
                                                
                                             
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         00
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Following, Chan et al. [1], we drop the dirac delta functions (
                           
                              δ
                              (
                              ·
                              )
                           
                         in (11) and (12)) allowing us to obtain the minimization
                           
                              (13)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          (
                                          c
                                          ,
                                          Φ
                                          )
                                       
                                    
                                 
                                 F
                                 (
                                 c
                                 ,
                                 Φ
                                 )
                              
                           
                        with
                           
                              
                                 F
                                 (
                                 c
                                 ,
                                 Φ
                                 )
                                 =
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 |
                                 ∇
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 d
                                 x
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 |
                                 ∇
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 |
                                 d
                                 x
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 c
                                 )
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 d
                                 x
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 c
                                 )
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 x
                                 .
                              
                           
                        Then correspondingly we can derive an energy functional which does not depend on regularized Heaviside functions. Thus, we can solve the following globally convex energy minimization problem,
                           
                              (14)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          u
                                          =
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          ∈
                                          
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 G
                                 (
                                 c
                                 ,
                                 u
                                 )
                              
                           
                        with
                           
                              
                                 G
                                 (
                                 c
                                 ,
                                 u
                                 )
                                 =
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 |
                                 ∇
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 d
                                 x
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 |
                                 ∇
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 |
                                 d
                                 x
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       11
                                    
                                 
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       (
                                       I
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             11
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 x
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       01
                                    
                                 
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       (
                                       I
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             01
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 x
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       10
                                    
                                 
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       (
                                       I
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             10
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 d
                                 x
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       00
                                    
                                 
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       (
                                       I
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             00
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 (
                                 1
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 d
                                 x
                                 ,
                              
                           
                        where Heaviside functions are replaced by 
                           
                              u
                              =
                              (
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              )
                              ∈
                              
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 
                                    2
                                 
                              
                           
                         which are known as binary partitioning functions. The above modified minimization problem (14) can further be relaxed to the set of functions 
                           
                              u
                              =
                              (
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              )
                              ∈
                              
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 
                                    2
                                 
                              
                           
                         in order to solve a convex minimization problem. That is, the binary partitioning functions based energy minimization becomes,
                           
                              (15)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          u
                                          =
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          ∈
                                          
                                             
                                                [
                                                0
                                                ,
                                                1
                                                ]
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 G
                                 (
                                 c
                                 ,
                                 u
                                 )
                                 .
                              
                           
                        The following theorem provides the guarantee of finding a global minimizer for the derived functional (14) in terms of the relaxed version in (15). We follow arguments similar to the work of Chan et al. [1,36] to prove the following result.
                           Theorem 2
                           
                              For any 
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          11
                                       
                                    
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          10
                                       
                                    
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          01
                                       
                                    
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          00
                                       
                                    
                                    ∈
                                    R
                                 
                              
                              , a global minimizer for 
                              
                                 
                                    G
                                    (
                                    c
                                    ,
                                    ·
                                    )
                                 
                               
                              in 
                              
                                 (14)
                               
                              can be found by carrying out the convex minimization problem 
                              
                                 (15)
                              
                              .
                           

See Appendix A.□

The final segmentation is obtained by thresholding the functions 
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                           
                         with any number in the interval 
                           
                              (
                              0
                              ,
                              1
                              )
                           
                         for example at 
                           
                              0.5
                           
                        , as shown in Fig. 1b and c. Note that the above modified minimization model does not involve level sets and thus can be solved efficiently. Further, we can prove that the above relaxed minimization problem can be solved in a binary variable minimization formulation to find a global minimum. The existence of minimizers of the modified energy 
                           
                              G
                           
                         given in Eq. (15) is proved using the theory of functions of bounded variation (BV) [56].
                           Theorem 3
                           
                              For a given input gray scale image 
                              
                                 
                                    I
                                    ∈
                                    
                                       
                                          L
                                       
                                       
                                          ∞
                                       
                                    
                                    (
                                    Ω
                                    )
                                 
                              
                              , there exists a minimizer for the functional 
                              
                                 
                                    G
                                 
                               
                              in 
                              
                                 (15)
                               
                              in 
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          4
                                       
                                    
                                    ×
                                    
                                       
                                          BV
                                       
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    
                                    
                                       
                                          (
                                          Ω
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              .
                           

See Appendix B
                              □

@&#EXPERIMENTAL RESULTS@&#

@&#IMPLEMENTATION DETAILS@&#

The four phase convex minimization problem in (15) is solved in an alternating fashion for the image variables 
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        :
                           
                              (16)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                          ∈
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          =
                                          
                                             ∫
                                             
                                                Ω
                                             
                                          
                                          |
                                          ∇
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                          |
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                Ω
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          c
                                          )
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                          d
                                          x
                                       
                                    
                                 
                                 .
                              
                           
                        where 
                           
                              j
                              =
                              1
                              ,
                              2
                           
                         and the image region fitting terms are given by,
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   1
                                                
                                             
                                             (
                                             c
                                             )
                                             =
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   11
                                                
                                             
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             
                                                
                                                   λ
                                                
                                                
                                                   01
                                                
                                             
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         01
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             +
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   10
                                                
                                             
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         10
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             
                                                
                                                   λ
                                                
                                                
                                                   00
                                                
                                             
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         00
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             (
                                             1
                                             -
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             c
                                             )
                                             =
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   11
                                                
                                             
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             
                                                
                                                   λ
                                                
                                                
                                                   10
                                                
                                             
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         10
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             +
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   01
                                                
                                             
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         01
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             
                                                
                                                   λ
                                                
                                                
                                                   00
                                                
                                             
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         00
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             (
                                             1
                                             -
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Following [1], the constrained problem (16) is changed into an unconstrained minimization problem by solving
                           
                              (17)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                          ∈
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          =
                                          
                                             ∫
                                             
                                                Ω
                                             
                                          
                                          |
                                          ∇
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                          |
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                Ω
                                             
                                          
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          c
                                          )
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                          +
                                          
                                             
                                                α
                                             
                                             
                                                j
                                             
                                          
                                          ν
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          )
                                          d
                                          x
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              ν
                              (
                              ξ
                              )
                              ≔
                              max
                              {
                              0
                              ,
                              2
                              |
                              ξ
                              -
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              |
                              -
                              1
                              }
                           
                         is an exact penalty function provided that 
                           
                              
                                 
                                    α
                                 
                                 
                                    j
                                 
                              
                              >
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              ‖
                              
                                 
                                    r
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          ∞
                                       
                                    
                                    (
                                    Ω
                                    )
                                 
                              
                           
                        . Based on [42] we use a convex regularization of (17) involving the auxiliary variables 
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         and solving the minimization problem
                           
                              (18)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ∫
                                             
                                                Ω
                                             
                                          
                                          |
                                          ∇
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                          |
                                          d
                                          x
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                2
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          ‖
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                          -
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                ‖
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                Ω
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             ∫
                                             
                                                Ω
                                             
                                          
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          c
                                          )
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          +
                                          
                                             
                                                α
                                             
                                             
                                                j
                                             
                                          
                                          ν
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          )
                                          d
                                          x
                                       
                                    
                                 
                                 ,
                              
                           
                        with 
                           
                              
                                 
                                    θ
                                 
                                 
                                    j
                                 
                              
                           
                         chosen to be small [44] allowing us to split (18) into two minimization sub-problems with respect to 
                           
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                           
                         and 
                           
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                           
                         separately. To solve the convex optimization with respect 
                           
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                           
                         we use the Chambolle’s dual formulation [43,42] of the total variation regularization function. In detail:
                           
                              1.
                              Solve for 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                    
                                 :
                                    
                                       (19)
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ∫
                                                      
                                                         Ω
                                                      
                                                   
                                                   |
                                                   ∇
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   |
                                                   d
                                                   x
                                                   +
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                   ‖
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         ‖
                                                      
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         (
                                                         Ω
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 The solution is given by
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                          =
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          -
                                          
                                             
                                                θ
                                             
                                             
                                                j
                                             
                                          
                                          div
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                       
                                    
                                 where the vector 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                  satisfies the equation
                                    
                                       
                                          ∇
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                j
                                             
                                          
                                          div
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                          
                                          -
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          -
                                          |
                                          ∇
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                j
                                             
                                          
                                          div
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                          
                                          -
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          |
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                          
                                          =
                                          0
                                       
                                    
                                 and it is solved by a fixed point method: 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       0
                                    
                                  and
                                    
                                       (20)
                                       
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      n
                                                   
                                                
                                                +
                                                δ
                                                t
                                                ∇
                                                (
                                                div
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                                -
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      j
                                                   
                                                
                                                /
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                             
                                                1
                                                +
                                                δ
                                                t
                                                |
                                                ∇
                                                (
                                                div
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                                -
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      j
                                                   
                                                
                                                /
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                                |
                                             
                                          
                                          .
                                       
                                    
                                 
                              

We utilize the following stopping condition for the fixed point iterations,
                                    
                                       (21)
                                       
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   x
                                                   ∈
                                                   Ω
                                                
                                             
                                          
                                          {
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          (
                                          x
                                          )
                                          -
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                             
                                                n
                                             
                                          
                                          (
                                          x
                                          )
                                          }
                                          >
                                          tol
                                       
                                    
                                 with the tolerance set at 
                                    
                                       tol
                                       =
                                       
                                          
                                             10
                                          
                                          
                                             -
                                             2
                                          
                                       
                                    
                                 . That is, the criterion for stopping the iteration is to check that the maximum variation between the dual variables is less than the given tolerance.

Solve for the auxiliary variable 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                    
                                 :
                                    
                                       (22)
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                   ‖
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         ‖
                                                      
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         (
                                                         Ω
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      ∫
                                                      
                                                         Ω
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   (
                                                   c
                                                   )
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ν
                                                   (
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   )
                                                   d
                                                   x
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 for which the solution is given by:
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          =
                                          
                                             min
                                          
                                          
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            (
                                                            x
                                                            )
                                                            -
                                                            
                                                               
                                                                  θ
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            (
                                                            c
                                                            )
                                                            ,
                                                            0
                                                         
                                                      
                                                   
                                                   ,
                                                   1
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              

We have used some real MR images from the atlas of normal structure and blood flow from the Whole Brain Atlas website.
                           1
                           
                              http://www.med.harvard.edu/aanlib/home.html.
                        
                        
                           1
                         The images presented here are from T1 MRI imaging modality with slice thickness of 1mm. We also utilize the full brain MRI images available at the BrainWeb database
                           2
                           
                              http://brainweb.bic.mni.mcgill.ca/brainweb/.
                        
                        
                           2
                         which allows us to experiment with synthetically generated noise (calculated relative to the brightest tissue, and denoted by “n”) and intensity non-uniformity (denoted by “RF”) to test the robustness of our scheme. BrainWeb is a simulated brain database which contains a set of realistic MRI data volumes produced by a powerful MR simulator. This database is widely used by the neuroimaging community to evaluate the performance of various image analysis methods [57].

The parameters 
                           
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              =
                              0.001
                           
                         were fixed for the segmentation results reported here. We observed that decreasing the 
                           
                              θ
                           
                        ’s increased the speed of convergence. In order to simplify notations we use 
                           
                              λ
                              =
                              
                                 
                                    λ
                                 
                                 
                                    11
                                 
                              
                              =
                              
                                 
                                    λ
                                 
                                 
                                    01
                                 
                              
                              =
                              
                                 
                                    λ
                                 
                                 
                                    10
                                 
                              
                              =
                              
                                 
                                    λ
                                 
                                 
                                    00
                                 
                              
                           
                         and we fix 
                           
                              λ
                              =
                              1
                           
                         in all our experiments reported here. Equal weights (
                           
                              
                                 
                                    λ
                                 
                                 
                                    ij
                                 
                              
                           
                        ’s) are used for the four regions to be segmented as we do not want to introduce bias for certain phases and it worked for the brain MRI datasets we used here. The time step parameter 
                           
                              δ
                              t
                              =
                              1
                              /
                              8
                           
                         for the fixed point iterations (20) (which typically converged in 
                           
                              n
                              =
                              5
                           
                         iterations) with tolerance 
                           
                              
                                 
                                    10
                                 
                                 
                                    -
                                    2
                                 
                              
                           
                         in (21) is used. We note that these optimal parameters were set for both the brain MRI datasets used here which obtained best segmentation results (see Section 3.4) and no further tuning is necessary. Our scheme takes less than 0.2s (for 100 iterations) on MATLAB2012a on a Mac laptop with Intel Core i7 CPU 2.3GHz, 8GB RAM CPU. Meanwhile, the average computation time for related models compared from the literature are in the region of 30s (for 100 iterations as an upper bound) to converge to the final segmentation.


                        Fig. 2
                         shows an example segmentation result of our globally convex four phase scheme on a normal brain MRI transaxial slice from the Whole Brain Atlas, see also Fig. 1 where we show a coronal slice from the same atlas. Fig. 2b and c show the two functions 
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                           
                         computed using our scheme and thresholded at 
                           
                              0.5
                           
                         respectively. As can be seen, the binary function from 
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                           
                        , corresponding to level set 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                           
                        , contains gray matter (Fig. 2b, 
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              >
                              0.5
                           
                        , shown in white color) whereas white matter (
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              <
                              0.5
                           
                        , shown in black color) is combined with the background. Similarly the binary function from 
                           
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                           
                        , corresponding to level set 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    2
                                 
                              
                           
                        , contains muscle (Fig. 2(c), 
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              >
                              0.5
                           
                        , shown in white color) whereas background (
                           
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              <
                              0.5
                           
                        , shown in black color) is combined with Cerebrospinal fluid (CSF). In order to discern the background and CSF, we need to look at the intersection regions of the functions 
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                           
                        . For this purpose we show the result of our four phase model as contours corresponding to the threshold regions 
                           
                              {
                              x
                              ∈
                              Ω
                              :
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              (
                              x
                              )
                              =
                              0.5
                              }
                           
                        , and 
                           
                              {
                              x
                              ∈
                              Ω
                              :
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              (
                              x
                              )
                              =
                              0.5
                              }
                           
                        , see Fig. 2d where two contours (Cyan, Magenta) are overlaid on top of the input image. In Fig. 2e we use four different colors (Blue, Green, Yellow, and Maroon) which highlight different phases for better visualization of phase separation and boundary detection of regions. In Fig. 2f and g, we show cumulative distribution function (CDF) and the histogram of each of the four regions computed by the proposed method. The histograms highlight separation of different phases/regions indicating the superior performance of our splitting based numerical approach.


                        Fig. 3
                         shows segmentation results for an MR image (Slice 67 from the BrainWeb synthetic atlas) to show the robustness of our scheme with respect to various amount of noise and intensity non-uniformity. We change the amount of noise n from 3% to 5% and intensity non-uniformity RF from 0 to 40. As can be seen from the final segmentation results in Fig. 3 (left column), we obtain stable segments under different RF (Fig. 3 top two rows) and when the noise increases the segmentation results remain stable (Fig. 3 bottom three rows). Next, Fig. 4
                         shows the corresponding energy values (15) against iterations with different number updates for the constant 
                           
                              c
                              =
                              (
                              
                                 
                                    c
                                 
                                 
                                    11
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    10
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    01
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    00
                                 
                              
                              )
                           
                         in Eqs. (23) and (24) in our implementation. As can be seen, updating the constant at every iteration decreases the energy rapidly initially and keeps it near zero (but not zero) whereas updating at every 40 iterations decreases in a piecewise manner but with large drop in energy values as the increase the iterations. We chose to update the 
                           
                              c
                           
                         at every 10 iterations in our alternating minimization implementation (15). Thus we see that updating the mean values 
                           
                              c
                           
                         computed using Eqs. (23) and (24) at only few iterations does not necessarily increase the speed of convergence. Further analysis of the implementation presented in Section 3.1 and obtaining convergence rates are open research questions which needs to be explored further.


                        Fig. 5
                         shows representative segmentation results for full brain BrainWeb data-set (transaxial slices are shown) with different noise (“n”) and non-uniformity (“RF”) levels for our scheme. Different n and RF are specified in Fig. 5 for each row. This illustrates that our scheme preserves topological changes as we move through the image stack as well as our scheme can handle noise and intensity non-uniformity together effectively.


                        Fig. 6
                         shows a comparison result with other related multiphase active contour methods which we describe briefly and refer the reader to the corresponding references for more details.
                           
                              •
                              
                                 Ker 
                                 [46]: This method implements a kernel function which maps implicitly the original image data into data of a higher dimension and uses level set algorithm for multiphase segmentation.


                                 Mean 
                                 [5]: Classical Vese–Chan multiphase piecewise constant model implemented using the level set algorithm.


                                 Clust 
                                 [47]: This method uses curve evolution equations along with a partition constraint which uses the rule that if a point leaves a region then it is claimed by a single other region.


                                 Primal–Dual 
                                 [48]: This uses a primal–dual minimization method for the piecewise constant multiphase active contour scheme.

We utilize the same real MR image given in Fig. 2a for comparing other schemes. In Fig. 6b and c we show CDFs and histograms computed for each of the computed phases respectively. Compared with the histograms shown in Fig. 2f and g for our scheme, we see that the proposed model provides better separation of regions. The histograms for the other schemes in Fig. 6c show nontrivial intersections, highlighting the drawback in using level set based implementations. Moreover, the noise remains as speckles in the segmented regions whereas our model handles it efficiently.

Finally, in Fig. 7
                         we show different segmentation results for a particular image (slice number 79) taken across all noise and inhomogeneity levels for different schemes. The results indicate that Ker and Mean methods can lead to poor separation of different regions whereas noise can affect the result of Clust and Primal–Dual schemes. Meanwhile, our approach performs well and handles higher non-uniformity without degrading the final segmentation results. Further data-sets and extensive comparison results of all the schemes for full brain stacks are available online.
                           3
                           
                              http://cell.missouri.edu/pages/BrainMRISegmentation.
                        
                        
                           3
                        
                     

We further use the following quantitative error metrics to compare the schemes with gold standard ground truth segmentations on BrainWeb synthetic atlas with different noise and intensity non-uniformity values. For more details about objective evaluation of image segmentation algorithms and for precise definitions of these metrics we refer to [58].
                           
                              •
                              
                                 DICE:

The Dice coefficient [59] is a popular error metric and it is used to compare ground truth segmentation with those obtained with automatic multiphase segmentation schemes. By definition, for two binary segmentations A and B, the Dice coefficient is computed as:
                                    
                                       (25)
                                       
                                          D
                                          (
                                          A
                                          ,
                                          B
                                          )
                                          =
                                          
                                             
                                                2
                                                
                                                   
                                                      
                                                         A
                                                         ∩
                                                         B
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         B
                                                      
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              

Here the binary segmentation is computed automatically, using the segmentation curves and by thresholding regions obtained by all algorithms. The notation 
                                    
                                       
                                          
                                             
                                                A
                                             
                                          
                                       
                                    
                                  denotes the number of pixels in the set A. Note that, a D value of 1 indicates perfect agreement. In particular, higher numbers indicate that the results of that particular scheme’s result match the gold standard better than results that produce lower Dice coefficients.


                                 RI:


                                 Rand index: A metric based on a classical nonparametric test and is computed by counting pairs of pixels that have compatible label relationships in the two segmentations to be compared. Values closer to 1 indicate better segmentation result.


                                 GCE:


                                 Global consistency error: A metric which computes the degree of overlap of the cluster associated with each pixel in one segmentation and its ÒclosestÓ approximation in the other segmentation. Values closer to 0 indicate better segmentation results.


                                 VI:


                                 Variation of information: A metric related to the conditional entropies between the class label distribution of the segmentations. This computes a measure of information content in each of the segmentations and how much information one segmentation gives about the other. Lower values indicate better segmentation results.

Note that all these metrics are for comparing two segmentations, one of which is assumed to be the available ground truth. Table 1
                         shows the comparison of average Dice values (for a total of 181 images) of different models for different noise and intensity inhomogenieties taken from BrainWeb database. As can be seen, our scheme performs better in terms of the Dice coefficient compared with other related approaches for all noise levels in all the four regions. Similarly in Table 2
                         we see that the average value of metrics RI, GCE and VI for different schemes against our model shows that the proposed globally convex multiphase scheme performs well overall.

We considered a fast globally convex four phase active contour scheme for MRI image segmentation inspired by Chan et al. [1] approach and provide a well-posed convex energy minimization which can be used to determine piecewise constant segmentations without level sets. By using a dual minimization-based implementation our approach provides better phase differentiation than other schemes. Experimental results on brain MRI images indicate the proposed approach provides better results compared with other active contour based multiphase segmentation schemes.

The four phase method we studied is found to provide better phase separation which is relevant in biomedical imagery. Experimental results indicate that our method performs better than other multiphase schemes which are applied MR image segmentation in terms of different error metrics. We obtain better differentiation of gray, white matters and the background in an unsupervised manner. Further, finer differentiation of other tissue classes such as CSF, fat, muscle, blood vessels, connective tissue (region around fat), dura matter and bone marrow will require more features and adaptive choice of parameters used in our implementation. This requires prior anatomical knowledge about the tissues which then can be used to pick our parameters for obtaining finer segmentations. The methodology presented here is general and currently we are developing the method to work for different imaging modalities (for example natural images from the Berkeley segmentation dataset [55], and biomedical images [54]). Our preliminary analysis suggest that we need to incorporate further features (color, texture, motion) before it can be applied for such images.

The main theoretical results we proved assume that the mean values are known a priori. Relaxing this assumption and proving the convergence of dual minimization based alternating iterative scheme are open though the numerical results indicate our approach works well for MR image segmentation. We also remark that the 
                        
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                        
                     -norm can be replaced by 
                        
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                        
                     -norm as a fidelity measures being particularly suitable for handling non-Gaussian additive noise and it will not erode geometric structures of the image during the segmentation allowing to preserve the contrast [60,42,61]. Currently we are developing a completely convex formulation of the original multiphase Vese and Chan model to guarantee the existence of a global solution when the constant values for each phase are not known a prior as well. Further, we plan to extend the multiphase model to perform surface segmentations from 3D MRI images similar to [9] as well as a method to extract intensity non-uniformity patterns coupled with segmentations [17].


                     
                        Proof
                        Proof of Theorem 2
                        


                        We use the standard notation for functions of bounded variation [62]. Since 
                              
                                 u
                                 ∈
                                 
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                    
                                       2
                                    
                                 
                              
                           , it follows from the standard total variation based Coarea Formula (see Theorem 4 below),
                              
                                 
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    |
                                    ∇
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    |
                                    d
                                    x
                                    =
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    Per
                                    
                                       
                                          
                                             {
                                             x
                                             ∈
                                             Ω
                                             :
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             (
                                             x
                                             )
                                             >
                                             
                                                
                                                   ζ
                                                
                                                
                                                   1
                                                
                                             
                                             }
                                          
                                       
                                    
                                    d
                                    
                                       
                                          ζ
                                       
                                       
                                          1
                                       
                                    
                                    d
                                    
                                       
                                          ζ
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                           and
                              
                                 
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    |
                                    ∇
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    |
                                    d
                                    x
                                    =
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    Per
                                    
                                       
                                          
                                             {
                                             x
                                             ∈
                                             Ω
                                             :
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             x
                                             )
                                             >
                                             
                                                
                                                   ζ
                                                
                                                
                                                   2
                                                
                                             
                                             }
                                          
                                       
                                    
                                    d
                                    
                                       
                                          ζ
                                       
                                       
                                          1
                                       
                                    
                                    d
                                    
                                       
                                          ζ
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           For the image fitting term,
                              
                                 
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          (
                                          u
                                          -
                                          
                                             
                                                c
                                             
                                             
                                                11
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    d
                                    x
                                    =
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          (
                                          u
                                          -
                                          
                                             
                                                c
                                             
                                             
                                                11
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             ∏
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∫
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   {
                                                   x
                                                   ∈
                                                   Ω
                                                   :
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   >
                                                   
                                                      
                                                         ζ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   }
                                                
                                             
                                             d
                                             
                                                
                                                   ζ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    d
                                    x
                                    =
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          (
                                          u
                                          -
                                          
                                             
                                                c
                                             
                                             
                                                11
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          {
                                          x
                                          ∈
                                          Ω
                                          :
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          >
                                          
                                             
                                                ζ
                                             
                                             
                                                1
                                             
                                          
                                          }
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          {
                                          x
                                          ∈
                                          Ω
                                          :
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          >
                                          
                                             
                                                ζ
                                             
                                             
                                                2
                                             
                                          
                                          }
                                       
                                    
                                    d
                                    x
                                    d
                                    
                                       
                                          ζ
                                       
                                       
                                          1
                                       
                                    
                                    d
                                    
                                       
                                          ζ
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           Further similar computations yield,
                              
                                 
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          (
                                          u
                                          -
                                          
                                             
                                                c
                                             
                                             
                                                01
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    1
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    d
                                    x
                                    =
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          (
                                          u
                                          -
                                          
                                             
                                                c
                                             
                                             
                                                01
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    1
                                    -
                                    
                                       
                                          1
                                       
                                       
                                          {
                                          x
                                          ∈
                                          Ω
                                          :
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          >
                                          
                                             
                                                ζ
                                             
                                             
                                                1
                                             
                                          
                                          }
                                       
                                    
                                    )
                                    
                                       
                                          1
                                       
                                       
                                          {
                                          x
                                          ∈
                                          Ω
                                          :
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          >
                                          
                                             
                                                ζ
                                             
                                             
                                                2
                                             
                                          
                                          }
                                       
                                    
                                    d
                                    x
                                    d
                                    
                                       
                                          ζ
                                       
                                       
                                          1
                                       
                                    
                                    d
                                    
                                       
                                          ζ
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          (
                                          u
                                          -
                                          
                                             
                                                c
                                             
                                             
                                                10
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    1
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    d
                                    x
                                    =
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          (
                                          u
                                          -
                                          
                                             
                                                c
                                             
                                             
                                                10
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          {
                                          x
                                          ∈
                                          Ω
                                          :
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          >
                                          
                                             
                                                ζ
                                             
                                             
                                                1
                                             
                                          
                                          }
                                       
                                    
                                    (
                                    1
                                    -
                                    
                                       
                                          1
                                       
                                       
                                          {
                                          x
                                          ∈
                                          Ω
                                          :
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          >
                                          
                                             
                                                ζ
                                             
                                             
                                                2
                                             
                                          
                                          }
                                       
                                    
                                    )
                                    d
                                    x
                                    d
                                    
                                       
                                          ζ
                                       
                                       
                                          1
                                       
                                    
                                    d
                                    
                                       
                                          ζ
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          (
                                          u
                                          -
                                          
                                             
                                                c
                                             
                                             
                                                00
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    1
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    (
                                    1
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    d
                                    x
                                    =
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          (
                                          u
                                          -
                                          
                                             
                                                c
                                             
                                             
                                                00
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    1
                                    -
                                    
                                       
                                          1
                                       
                                       
                                          {
                                          x
                                          ∈
                                          Ω
                                          :
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          >
                                          
                                             
                                                ζ
                                             
                                             
                                                1
                                             
                                          
                                          }
                                       
                                    
                                    )
                                    (
                                    1
                                    -
                                    
                                       
                                          1
                                       
                                       
                                          {
                                          x
                                          ∈
                                          Ω
                                          :
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          >
                                          
                                             
                                                ζ
                                             
                                             
                                                2
                                             
                                          
                                          }
                                       
                                    
                                    )
                                    d
                                    x
                                    d
                                    
                                       
                                          ζ
                                       
                                       
                                          1
                                       
                                    
                                    d
                                    
                                       
                                          ζ
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           Defining 
                              
                                 
                                    
                                       1
                                    
                                    
                                       u
                                    
                                 
                                 ≔
                                 (
                                 
                                    
                                       1
                                    
                                    
                                       {
                                       x
                                       ∈
                                       Ω
                                       :
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       >
                                       
                                          
                                             ζ
                                          
                                          
                                             1
                                          
                                       
                                       }
                                    
                                 
                                 ,
                                 
                                    
                                       1
                                    
                                    
                                       {
                                       x
                                       ∈
                                       Ω
                                       :
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       >
                                       
                                          
                                             ζ
                                          
                                          
                                             2
                                          
                                       
                                       }
                                    
                                 
                                 )
                              
                           , it follows that
                              
                                 
                                    G
                                    (
                                    c
                                    ,
                                    u
                                    )
                                    =
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    G
                                    (
                                    c
                                    ,
                                    
                                       
                                          1
                                       
                                       
                                          u
                                       
                                    
                                    )
                                    d
                                    
                                       
                                          ζ
                                       
                                       
                                          1
                                       
                                    
                                    d
                                    
                                       
                                          ζ
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    F
                                    (
                                    c
                                    ,
                                    u
                                    -
                                    ζ
                                    )
                                    d
                                    
                                       
                                          ζ
                                       
                                       
                                          1
                                       
                                    
                                    d
                                    
                                       
                                          ζ
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                           for a.e. 
                           
                              
                                 ζ
                                 =
                                 (
                                 
                                    
                                       ζ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       ζ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ∈
                                 
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                    
                                       2
                                    
                                 
                              
                           . Thus, it follows from the above equations that if 
                              
                                 u
                              
                            is a minimizer of the convex relaxed problem (15), then for a.e. 
                           
                              
                                 ζ
                                 ∈
                                 
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                    
                                       2
                                    
                                 
                              
                           , the function 
                              
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       u
                                    
                                 
                              
                            is a minimizer of the problem (14).□

Note also that 
                              
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 u
                                 -
                                 ζ
                              
                            is a solution of the original Vese and Chan minimization problem (8). This shows that the relaxed convex minimization problem is equivalent to the original Vese and Chan piecewise constant multiphase formulation (8), we refer to Chan et al. [1] for more details.

We note that the Theorem 2 assumes the constants 
                        
                           c
                           =
                           (
                           
                              
                                 c
                              
                              
                                 11
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 10
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 01
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 00
                              
                           
                           )
                        
                      to be known to obtain a global minimizer of the energy minimization problem (15). In the image segmentation problem, we assume that these constants are unknown and they are part of the minimization problem considered in our implementation (see Section 3.1, we update the constants 
                        
                           c
                        
                      in Eqs. (23) and (24) at every few iterations). Currently there are no results which can guarantee that the alternating minimization scheme for both the image functions and constants, that is for 
                        
                           (
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           c
                           )
                        
                     , converges to the global minimum of (15). Nevertheless we observed numerically that the proposed implementation decrease the energy value rapidly, see Fig. 4.

In order to prove the existence of a solution to our problem in (15) we need to recall a definition and some properties of functions of bounded variation [62,63].
                        Definition 1
                        Let 
                              
                                 Ω
                                 ⊂
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                              
                            be an open set and 
                              
                                 u
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 Ω
                                 )
                              
                           . The total variation of u in 
                              
                                 Ω
                              
                            is defined by
                              
                                 
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    |
                                    ∇
                                    u
                                    |
                                    d
                                    x
                                    ≔
                                    
                                       
                                          
                                             sup
                                          
                                          
                                             ϕ
                                             ∈
                                             Φ
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∫
                                                
                                                   Ω
                                                
                                             
                                             udiv
                                             ϕ
                                             d
                                             x
                                          
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 Φ
                                 =
                                 
                                    
                                       
                                          ϕ
                                          ∈
                                          
                                             
                                                C
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          Ω
                                          ,
                                          
                                             
                                                R
                                             
                                             
                                                n
                                             
                                          
                                          )
                                          :
                                          |
                                          ϕ
                                          (
                                          x
                                          )
                                          |
                                          ⩽
                                          1
                                          
                                          in
                                          
                                          Ω
                                       
                                    
                                 
                              
                           .


                           
                              
                                 u
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 Ω
                                 )
                              
                            is a function of bounded variation if 
                              
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 |
                                 ∇
                                 u
                                 |
                                 d
                                 x
                              
                            is finite. 
                              
                                 BV
                                 (
                                 Ω
                                 )
                              
                            is the space of all functions in 
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 Ω
                                 )
                              
                            with bounded variation. The 
                              
                                 BV
                                 (
                                 Ω
                                 )
                              
                            space is endowed with the norm 
                              
                                 ‖
                                 u
                                 
                                    
                                       ‖
                                    
                                    
                                       BV
                                       (
                                       Ω
                                       )
                                    
                                 
                                 =
                                 ‖
                                 u
                                 
                                    
                                       ‖
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Ω
                                       )
                                    
                                 
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 |
                                 ∇
                                 u
                                 |
                                 d
                                 x
                              
                           , which makes it a Banach space. The set of functions 
                              
                                 u
                                 ∈
                                 BV
                                 (
                                 Ω
                                 )
                              
                            taking values in 
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                            is denoted by 
                              
                                 
                                    
                                       BV
                                    
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                 
                                 (
                                 Ω
                                 )
                              
                           .

A Borel subset 
                              
                                 E
                                 ⊆
                                 Ω
                              
                            is called a set of finite perimeter in 
                              
                                 Ω
                              
                           , when the associated characteristic function, 
                              
                                 
                                    
                                       1
                                    
                                    
                                       E
                                    
                                 
                              
                           , belongs to 
                              
                                 BV
                                 (
                                 Ω
                                 )
                              
                           . The perimeter of E in 
                              
                                 Ω
                              
                            is defined as 
                              
                                 Per
                                 (
                                 E
                                 )
                                 ≔
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 |
                                 ∇
                                 
                                    
                                       1
                                    
                                    
                                       E
                                    
                                 
                                 |
                                 d
                                 x
                              
                           .


                           If 
                           
                              
                                 u
                                 ∈
                                 BV
                                 (
                                 Ω
                                 )
                              
                           
                           , then for a.e. 
                           
                              
                                 t
                                 ∈
                                 R
                              
                           
                           , the level set 
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       t
                                    
                                 
                                 ≔
                                 {
                                 x
                                 ∈
                                 Ω
                                 :
                                 
                                 u
                                 (
                                 x
                                 )
                                 >
                                 t
                                 }
                              
                            
                           has finite perimeter, i.e., the characteristic function 
                           
                              
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             E
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 ∈
                                 BV
                                 (
                                 Ω
                                 )
                              
                           
                           . Then, one has
                           
                              
                                 
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    |
                                    ∇
                                    u
                                    |
                                    d
                                    x
                                    =
                                    
                                       ∫
                                       
                                          -
                                          ∞
                                       
                                       
                                          ∞
                                       
                                    
                                    Per
                                    
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    dt
                                    .
                                 
                              
                           
                        


                           Let 
                           
                              
                                 Ω
                              
                            
                           be a 1-regular open bounded subset of 
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                              
                           
                           . Then, for all p such that 
                           
                              
                                 1
                                 ⩽
                                 p
                                 <
                                 
                                    
                                       n
                                    
                                    
                                       n
                                       -
                                       1
                                    
                                 
                              
                           
                           , the embedding 
                           
                              
                                 BV
                                 (
                                 Ω
                                 )
                                 ⊂
                                 
                                    
                                       L
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 Ω
                                 )
                              
                            
                           is compact.
                        


                           Let 
                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       k
                                       ∈
                                       N
                                    
                                 
                              
                            
                           be a sequence in 
                           
                              
                                 BV
                                 (
                                 Ω
                                 )
                              
                            
                           strongly converging to some 
                           
                              
                                 u
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 Ω
                                 )
                              
                            
                           and satisfying 
                           
                              
                                 
                                    
                                       sup
                                    
                                    
                                       k
                                       ∈
                                       N
                                    
                                 
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 |
                                 ∇
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 d
                                 x
                                 <
                                 +
                                 ∞
                              
                           
                           . Then, 
                           
                              
                                 u
                                 ∈
                                 BV
                                 (
                                 Ω
                                 )
                                 ,
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 |
                                 ∇
                                 u
                                 |
                                 d
                                 x
                                 ⩽
                                 lim
                                 
                                    
                                       inf
                                    
                                    
                                       k
                                       →
                                       +
                                       ∞
                                    
                                 
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 |
                                 ∇
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 d
                                 x
                              
                           
                           , and 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                              
                            
                           weakly converges to u in 
                           
                              
                                 BV
                                 (
                                 Ω
                                 )
                              
                           
                           .
                        

We are now ready to prove our main result.
                        Proof of Theorem 3
                        Let 
                              
                                 m
                                 ≔
                                 inf
                                 G
                                 (
                                 c
                                 ,
                                 u
                                 )
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       ∞
                                    
                                 
                                 ⊆
                                 
                                    
                                       R
                                    
                                    
                                       4
                                    
                                 
                                 ×
                                 
                                    
                                       BV
                                    
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                 
                                 
                                    
                                       (
                                       Ω
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                            be a minimizer sequence for the energy 
                              
                                 G
                              
                           , i.e.,
                              
                                 
                                    G
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    
                                       
                                          →
                                       
                                       
                                          k
                                          →
                                          ∞
                                       
                                    
                                    
                                    m
                                    .
                                 
                              
                           Since 
                              
                                 
                                    
                                       {
                                       
                                          
                                             u
                                          
                                          
                                             k
                                          
                                       
                                       }
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       ∞
                                    
                                 
                              
                            is bounded in 
                              
                                 
                                    
                                       BV
                                    
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                 
                                 
                                    
                                       (
                                       Ω
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           , there is a subsequence also denoted by 
                              
                                 
                                    
                                       {
                                       
                                          
                                             u
                                          
                                          
                                             k
                                          
                                       
                                       }
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       ∞
                                    
                                 
                              
                           , strongly convergent to an element 
                              
                                 
                                    
                                       u
                                    
                                    
                                       ∗
                                    
                                 
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       (
                                       Ω
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                            (Theorem 5). Furthermore, 
                              
                                 
                                    
                                       u
                                    
                                    
                                       ∗
                                    
                                 
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       (
                                       Ω
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           . Therefore, it follows that 
                              
                                 
                                    
                                       u
                                    
                                    
                                       ∗
                                    
                                 
                                 ∈
                                 
                                    
                                       BV
                                    
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                 
                                 
                                    
                                       (
                                       Ω
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                            and
                              
                                 (B.1)
                                 
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    |
                                    
                                       
                                          Du
                                       
                                       
                                          i
                                       
                                       
                                          ∗
                                       
                                    
                                    |
                                    d
                                    x
                                    ⩽
                                    
                                       
                                          
                                             lim
                                             inf
                                          
                                          
                                             k
                                             →
                                             ∞
                                          
                                       
                                    
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    |
                                    
                                       
                                          Du
                                       
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    d
                                    x
                                    
                                    (
                                    with
                                    
                                    
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    )
                                 
                              
                           
                        

(Theorem 6). Now, considering 
                              
                                 G
                              
                            as a function of 
                              
                                 c
                              
                           , its minimization brings the following two equations,
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      11
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∫
                                                         
                                                            Ω
                                                         
                                                      
                                                      
                                                         
                                                            Iu
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      d
                                                      x
                                                   
                                                   
                                                      
                                                         ∫
                                                         
                                                            Ω
                                                         
                                                      
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      d
                                                      x
                                                   
                                                
                                                ,
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      10
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∫
                                                         
                                                            Ω
                                                         
                                                      
                                                      
                                                         
                                                            Iu
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                               -
                                                               
                                                                  
                                                                     u
                                                                  
                                                                  
                                                                     2
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      d
                                                      x
                                                   
                                                   
                                                      
                                                         ∫
                                                         
                                                            Ω
                                                         
                                                      
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                               -
                                                               
                                                                  
                                                                     u
                                                                  
                                                                  
                                                                     2
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      d
                                                      x
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      01
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∫
                                                         
                                                            Ω
                                                         
                                                      
                                                      I
                                                      (
                                                      1
                                                      -
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      d
                                                      x
                                                   
                                                   
                                                      
                                                         ∫
                                                         
                                                            Ω
                                                         
                                                      
                                                      (
                                                      1
                                                      -
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      d
                                                      x
                                                   
                                                
                                                ,
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      00
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∫
                                                         
                                                            Ω
                                                         
                                                      
                                                      I
                                                      (
                                                      1
                                                      -
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      (
                                                      1
                                                      -
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      d
                                                      x
                                                   
                                                   
                                                      
                                                         ∫
                                                         
                                                            Ω
                                                         
                                                      
                                                      (
                                                      1
                                                      -
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      (
                                                      1
                                                      -
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      d
                                                      x
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Since 
                              
                                 I
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       ∞
                                    
                                 
                                 (
                                 Ω
                                 )
                              
                           , it follows 
                              
                                 
                                    
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             k
                                          
                                       
                                       }
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       ∞
                                    
                                 
                              
                            is uniformly bounded. Hence, there is a subsequence also denoted by 
                              
                                 
                                    
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             k
                                          
                                       
                                       }
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       ∞
                                    
                                 
                                 ⊂
                                 
                                    
                                       R
                                    
                                    
                                       2
                                       n
                                    
                                 
                              
                            and a constant vector 
                              
                                 
                                    
                                       c
                                    
                                    
                                       ∗
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       2
                                       n
                                    
                                 
                              
                            such that
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          →
                                       
                                       
                                          k
                                          →
                                          ∞
                                       
                                    
                                    
                                    
                                       
                                          c
                                       
                                       
                                          ∗
                                       
                                    
                                    .
                                 
                              
                           Then, from Fatou’s lemma we get for the suitable sequence 
                              
                                 
                                    
                                       {
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       }
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       ∞
                                    
                                 
                              
                           :
                              
                                 
                                    G
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          ∗
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                    ⩽
                                    
                                       
                                          
                                             lim
                                             inf
                                          
                                          
                                             k
                                             →
                                             ∞
                                          
                                       
                                    
                                    G
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    =
                                    m
                                    ,
                                 
                              
                           
                        

i.e., 
                              
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                              
                            is a minimizer of the functional 
                              
                                 G
                              
                           .□

Note that the 
                        
                           c
                           =
                           (
                           
                              
                                 c
                              
                              
                                 11
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 10
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 01
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 00
                              
                           
                           )
                        
                      values given in the above theorem are computed in the numerical scheme based on the dual minimization formulation of Chambolle [43] and extends [42] which is described in detail in Section 3.1.

@&#REFERENCES@&#

