@&#MAIN-TITLE@&#Multiplicity of equilibria in conjectural variations models of natural gas markets

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The gas market is represented by a partial equilibrium model including market power.


                        
                        
                           
                           We demonstrate that some prices and flows are not unique in general.


                        
                        
                           
                           The gas flows to consumers are unique for traders exerting market power.


                        
                        
                           
                           We conclude that the entire solution space has to be considered for interpretation.


                        
                        
                           
                           We discuss the economical meaning of parameter value changes which enforce uniqueness.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in energy

Conjectural variations

Existence and uniqueness of solutions

Natural gas market

Linear complementarity program

@&#ABSTRACT@&#


               
               
                  Spatial partial equilibrium models incorporating conjectural variations are widely used to analyze the development of oligopolistic multi-agent markets, such as international energy and raw material markets. Although this model type can produce multiple equilibria under commonly used assumptions, to the best of our knowledge, the consequences for the interpretation of the model results have not yet been explored in detail. To this end, we derive a linear complementarity model for the gas market and discuss under which assumptions on the model structure a component of the solution is unique. In particular, we find that the gas flow between a trader and a consumer is unique whenever the trader is modeled to exert market power in the consumer’s market. We demonstrate our findings by computing the extreme points of the polyhedral solution space and show that erroneous conclusions could be drawn whenever only one (arbitrary) point in the solution space is picked for interpretation. Furthermore, we discuss whether economically meaningful parameter value changes exist which would enforce uniqueness in all components of the solution.
               
            

@&#INTRODUCTION@&#

Spatial partial equilibrium models including conjectural variations (SPE-CV models) are a popular tool to investigate oligopolistic markets, such as fossil fuel or electricity markets (Díaz, Villar, Campos, & Reneses, 2010; Kamiński, 2011; Neuhoff et al., 2005). These markets are characterized by a high capital intensity as a result of high exploration costs, long lead times, large distances between producing and consuming regions, or expensive infrastructure requirements. This creates high barriers to entry and limits the competition, which allows major traders to exert market power over consumers.

In SPE-CV models, multiple traders are distinguished to represent the impact of market power exertion. As a consequence, one of the model outcomes are the sales of the individual traders to consumers, which is of interest in practice, because it indicates which two parties are likely to trade in a given situation. Unfortunately, this representation may also introduce redundancies to the model, mathematically corresponding to the existence of multiple solutions for a given set of parameters, and economically to the existence of multiple market equilibria in a single situation. This is problematic when it comes to the interpretation of the model results, since one could not determine which, of the possibly many, equilibria proposed by the model become reality.

In the presented study we investigate SPE-CV models for gas markets. Several variants have been proposed in the past, including the special cases of Cournot and Bertrand competition. The most prominent examples are the dynamic GASTALE model by Lise and Hobbs (2008), and the World Gas Model(WGM) by Egging, Gabriel, Holz, and Zhuang (2008): both models assume international gas traders to exert market power over consumers, and compete perfectly for infrastructure services such as transmission or storage capacity. The dynamic GASTALE model (de Joode & Özdemir, 2010; Lise, Hobbs, & van Oostvoorn, 2008) and the WGM (Egging, 2013; Egging, Holz, & Gabriel, 2010; Egging, 2010; Gabriel, Rosendahl, Egging, Avetisyan, & Siddiqui, 2012; Gabriel, Zhuang, & Egging, 2009; Huppmann, 2013; Moryadee, Gabriel, & Avetisyan, 2014; Zhuang & Gabriel, 2008) were expanded successively and used for various case studies.

However, in most articles, the multiplicity of solutions is not discussed. Exceptions include (Gabriel, Kiet, & Zhuang, 2005), who analyzed a predecessor of the WGM and derived uniqueness criteria for the intermediate and wholesale prices, and Egging (2010), who presented an example in which non-unique service prices can arise in the WGM. To the best of our knowledge, the remaining variables, particularly the volume flows, have not yet received any attention. The contribution of this article is to analyze the multiplicity of all variables by exploiting the information hidden in the mathematical structure of the problem. For the non-unique variables, we discuss whether uniqueness is relevant for interpretation in the first place, and investigate how uniqueness could be achieved based on changes in the model’s parameter values.

The remainder of this article is structured as follows. In the next section, we introduce a SPE-CV model for the gas market. In Section 3, we substantially reduce the number of equations by expressing (infrastructure) service prices and volume flows explicitly. Service cost functions are affine or quadratic in the volume flows, allowing the model to be represented as a linear complementarity problem. Subsequently, we carry out the mathematical analysis concerning the multiplicity of solutions. In Section 4, we demonstrate our findings via a numerical example. In Section 5, we discuss our theoretical and numerical results, and in Section 6, we summarize and conclude our work.

The structure of our SPE-CV model comprises nodes and arcs, and distinguishes multiple time periods within a year. The nodes represent countries or regions, in which gas is produced, stored, and sold to consumers. The arcs represent the gas flow capacities from one region to another. The differentiation of time periods allows a distinction of multiple levels of demand. The geographical and temporal granularity and range of the model can be adjusted to fit the requirements of a specific case; in the numerical example presented in Section 4, the world-wide gas trade over a year is represented by 50 nodes, 291 arcs, and 2 time periods (summer and winter half-year).

While SPE-CV models are certainly able to capture the main properties of the gas market such as limited production, restricted transport capabilities, large seasonal demand fluctuations, and market power exerting traders, they do not provide any information on the status of the gas market within a node, implicitly assuming that the gas is distributed well and prices are uniform. If the region mapping to a node is chosen sufficiently small, this weakness can be compensated to some extent. Since publicly available data for some of the parameters, particularly production capacities and wholesale prices, is mostly limited to country-level, a finer granularity is rarely aimed for with SPE-CV models. Other types of models, such as the TIGER model (Dieckhöner, Lochner, & Lindenberger, 2013; Lochner, 2011a, 2011b; Lochner & Dieckhöner, 2012), or the model introduced by Carvalho et al. (2014), circumvent this data constraint by assuming a fixed and therefore price-independent demand; this eliminates the need for accurate wholesale price data and hence allows a higher model resolution.

The mathematical formulation is inspired by other models in the field, particularly the deterministic version of the WGM proposed by Egging (2010), except that we refrain from modeling investments over time. In comparison to the WGM, we aim for a more compact representation of the overall model to facilitate the mathematical analysis, and therefore choose a more general notation for the individual components of the model to emphasize their similarity. The notation is introduced as we formulate the model, and summarized in Tables A.1–A.5. An exemplary model with two interconnected nodes is depicted in Fig. 1.

The nodes 
                           
                              n
                              ,
                              m
                              ∈
                              N
                              ,
                              n
                              ≠
                              m
                           
                         represent countries or regions, and the time periods are denoted 
                           
                              t
                              ∈
                              T
                           
                        . In each node n, a consumer Cn
                        , a gas producing company Pn
                        , a storage operator Sn
                        , a liquefaction plant operator Ln
                        , and a regasification plant operator Rn
                         may be located. The storage operator Sn
                         provides two services: injection of gas (In
                        ), and extraction of gas (Xn
                        ). A transmission system operator Anm
                         manages the flows in the pipelines from n to m, and a shipping company Bnm
                         transports liquefied natural gas(LNG) from n to m. To simplify notation in the remainder of this paper, we introduce Zz
                         as a placeholder for a producer or an infrastructure service Z in a node/arc z, thus Z ∈ {P, I, X, L, R, A, B}, and 
                           
                              z
                              ∈
                              Z
                              ,
                           
                         where 
                           Z
                         is the corresponding subset of nodes/arcs in which a service
                           1
                        
                        
                           1
                           Although producers are not an infrastructure service, we henceforth include them in our notion of services.
                         of type Z is active. Note that each service Zz
                         represents all companies of type Z in a node/arc z, even if in reality multiple firms carry out this activity in the geographical region of z. Similarly, Cn
                         represents the aggregated demand of all consumers located in node n.

In most of the large companies, gas is produced in one division, and then internally transferred to the trading-arm of the company, which deals with the (international) trade and distribution. Each of these companies’ trading-arm is modeled by a trader Fn
                        , which receives gas only from the producer Pn
                         located in its home-node. Each Fn
                         spreads out from his home-node through the network, thereby competes with the other traders for service capacities (except production capacities), and finally sells gas in the consumer markets, where it again competes with the other traders for market shares. While we assume all services to be price-takers, the traders exert market power in the consumer markets, which is modeled based on a conjectural variations approach. Note that since we only introduce traders which are associated with a producer, and gas is not resold among traders, arbitrage is limited and depends on the market power of the traders.

The traders and service providers have perfect and complete information about the market. Therefore, the decision processes of the traders and the service providers can be modeled as (deterministic) optimization problems. In the following, we introduce the optimization problem of the traders (Section 2.2.1), the optimization problem of the service providers (Section 2.2.2), and the market clearing conditions (Section 2.2.3).

The goal of each trader f is to maximize profit 
                              
                                 
                                    Π
                                    f
                                    F
                                 
                                 ,
                              
                            which is equal to total revenue 
                              
                                 TR
                                 f
                                 F
                              
                            from sales to the consumers, minus the total cost 
                              
                                 TC
                                 f
                                 F
                              
                            arising from using services:

                              
                                 (2.1)
                                 
                                    
                                       
                                          Π
                                          f
                                          F
                                       
                                       =
                                       
                                          
                                             TR
                                          
                                          f
                                          F
                                       
                                       −
                                       
                                          
                                             TC
                                          
                                          f
                                          F
                                       
                                       .
                                    
                                 
                              
                           
                           
                              
                                 f
                                 ∈
                                 F
                              
                            represents an arbitrary trader in the set of all traders (whereas Fn
                            is the specific trader whose home base is in node n). The total revenue of trader f reads

                              
                                 (2.2)
                                 
                                    
                                       
                                          
                                             TR
                                          
                                          f
                                          F
                                       
                                       =
                                       
                                          ∑
                                          
                                             t
                                             ∈
                                             T
                                          
                                       
                                       
                                          ∑
                                          
                                             n
                                             ∈
                                             C
                                             (
                                             f
                                             )
                                          
                                       
                                       
                                          [
                                          
                                             (
                                             1
                                             −
                                             
                                                θ
                                                
                                                   f
                                                   n
                                                   t
                                                
                                                C
                                             
                                             )
                                          
                                          
                                             λ
                                             
                                                n
                                                t
                                             
                                             C
                                          
                                          +
                                          
                                             θ
                                             
                                                f
                                                n
                                                t
                                             
                                             C
                                          
                                          
                                             Λ
                                             
                                                n
                                                t
                                             
                                             C
                                          
                                          
                                             (
                                             ·
                                             )
                                          
                                          ]
                                       
                                       
                                          q
                                          
                                             f
                                             n
                                             t
                                          
                                          C
                                       
                                       .
                                    
                                 
                              
                           The decision variables are all the 
                              
                                 q
                                 
                                    f
                                    n
                                    t
                                 
                                 C
                              
                            which represent the total amount of gas sold to the consumers in node n and period t. The quantity is multiplied by the corresponding wholesale price, and the product is summed over all periods 
                              T
                            and over the set of nodes 
                              
                                 C
                                 (
                                 f
                                 )
                              
                            in which the trader f and a consumer are present. The wholesale price comprises the weighted sum of two quantities: the price on the wholesale market 
                              
                                 
                                    λ
                                    
                                       n
                                       t
                                    
                                    C
                                 
                                 ,
                              
                            which is determined by the market clearing conditions and is exogenous to the trader; and the inverse demand function 
                              
                                 
                                    Λ
                                    
                                       n
                                       t
                                    
                                    C
                                 
                                 ,
                              
                            a function of the total demand 
                              
                                 
                                    ∑
                                    
                                       f
                                       ∈
                                       F
                                       (
                                       n
                                       )
                                    
                                 
                                 
                                    q
                                    
                                       f
                                       n
                                       t
                                    
                                    C
                                 
                                 ,
                              
                            on which the trader has influence via its decision variable 
                              
                                 q
                                 
                                    f
                                    n
                                    t
                                 
                                 C
                              
                           . The weight 
                              
                                 
                                    θ
                                    
                                       f
                                       n
                                       t
                                    
                                    C
                                 
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                              
                            is referred to as the behavioral parameter of market power (Tremblay and Tremblay, 2012, Chapter 12) of trader f over consumers located in node n in period t: if 
                              
                                 
                                    θ
                                    
                                       f
                                       n
                                       t
                                    
                                    C
                                 
                                 =
                                 1
                              
                            for all traders f, the market n in period t is characterized by a Cournot equilibrium, whereas 
                              
                                 
                                    θ
                                    
                                       f
                                       n
                                       t
                                    
                                    C
                                 
                                 =
                                 0
                              
                            for all traders f indicates a competitive equilibrium. Conceptually following the setting used by Egging et al. (2010) for the WGM, we also allow values 
                              
                                 0
                                 <
                                 
                                    θ
                                    
                                       f
                                       n
                                       t
                                    
                                    C
                                 
                                 <
                                 1
                                 ,
                              
                            representing intermediate stages of the traders’ conjectures about the other traders’ behaviors.
                              2
                           
                           
                              2
                              There are different propositions how values of 
                                    
                                       θ
                                       
                                          f
                                          n
                                          t
                                       
                                       C
                                    
                                  different from 0 and 1 should be interpreted, see for example (Perloff, Karp, and Golan, 2007, Chapter 3) for a discussion. In this work, we follow the interpretation of Tremblay and Tremblay (2012, Chapter 12) and think of 
                                    
                                       θ
                                       
                                          f
                                          n
                                          t
                                       
                                       C
                                    
                                  as “toughness of competition”, where decreasing 
                                    
                                       θ
                                       
                                          f
                                          n
                                          t
                                       
                                       C
                                    
                                  indicates increasing competition.
                            However, we do not allow 
                              
                                 
                                    θ
                                    
                                       f
                                       n
                                       t
                                    
                                    C
                                 
                                 >
                                 1
                              
                            and hence exclude cartelization of multiple traders.

The inverse demand function in node n and period t is defined as

                              
                                 (2.3)
                                 
                                    
                                       
                                          Λ
                                          
                                             n
                                             t
                                          
                                          C
                                       
                                       
                                          (
                                          ·
                                          )
                                       
                                       :
                                       =
                                       
                                          INT
                                          
                                             n
                                             t
                                          
                                          C
                                       
                                       +
                                       
                                          SLP
                                          
                                             n
                                             t
                                          
                                          C
                                       
                                       
                                          ∑
                                          
                                             f
                                             ∈
                                             F
                                             (
                                             n
                                             )
                                          
                                       
                                       
                                          q
                                          
                                             f
                                             n
                                             t
                                          
                                          C
                                       
                                       .
                                    
                                 
                              
                           
                           
                              
                                 INT
                                 
                                    n
                                    t
                                 
                                 C
                              
                            represents the intercept of the inverse demand function, which corresponds to the maximum willingness to pay of consumers at node n in period t, 
                              
                                 SLP
                                 
                                    n
                                    t
                                 
                                 C
                              
                            is the slope and is assumed strictly negative. These parameters are derived from the reference willingness to pay 
                              
                                 
                                    WTP
                                    
                                       n
                                       t
                                    
                                    C
                                 
                                 ,
                              
                            reference demand 
                              
                                 
                                    DMD
                                    
                                       n
                                       t
                                    
                                    C
                                 
                                 ,
                              
                            and price elasticity ηnt
                           , which in turn is calculated from the price elasticities of the residential and commercial, industrial and power sectors and their reference shares 
                              
                                 SHR
                                 
                                    n
                                    d
                                    ,
                                    ·
                                 
                                 C
                              
                            in consumption.

                              
                                 (2.4)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   INT
                                                   
                                                      n
                                                      t
                                                   
                                                   C
                                                
                                                =
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      1
                                                      
                                                         η
                                                         
                                                            n
                                                            t
                                                         
                                                         C
                                                      
                                                   
                                                   )
                                                
                                                ·
                                                
                                                   WTP
                                                   
                                                      n
                                                      t
                                                   
                                                   C
                                                
                                                ≥
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (2.5)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   SLP
                                                   
                                                      n
                                                      t
                                                   
                                                   C
                                                
                                                =
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      WTP
                                                      
                                                         n
                                                         t
                                                      
                                                      C
                                                   
                                                   
                                                      
                                                         DMD
                                                         
                                                            n
                                                            t
                                                         
                                                         C
                                                      
                                                      ·
                                                      
                                                         η
                                                         
                                                            n
                                                            t
                                                         
                                                         C
                                                      
                                                   
                                                
                                                <
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (2.6)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   η
                                                   
                                                      n
                                                      t
                                                   
                                                   C
                                                
                                                
                                                =
                                                
                                                
                                                   η
                                                   
                                                      n
                                                      t
                                                      ,
                                                      res
                                                   
                                                   C
                                                
                                                
                                                ·
                                                
                                                
                                                   SHR
                                                   
                                                      n
                                                      t
                                                      ,
                                                      res
                                                   
                                                   C
                                                
                                                
                                                +
                                                
                                                
                                                   η
                                                   
                                                      n
                                                      t
                                                      ,
                                                      ind
                                                   
                                                   C
                                                
                                                
                                                ·
                                                
                                                
                                                   SHR
                                                   
                                                      n
                                                      t
                                                      ,
                                                      ind
                                                   
                                                   C
                                                
                                                
                                                +
                                                
                                                
                                                   η
                                                   
                                                      n
                                                      t
                                                      ,
                                                      el
                                                   
                                                   C
                                                
                                                
                                                ·
                                                
                                                
                                                   SHR
                                                   
                                                      n
                                                      t
                                                      ,
                                                      el
                                                   
                                                   C
                                                
                                                
                                                <
                                                
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           All parameters can vary in n and t if the respective data is available. Following previous works of Lise et al. (2008) (dynamic GASTALE model) and Egging et al. (2010) (WGM), the inverse demand function is chosen affine; for a market analysis including more general structures of inverse demand functions we refer to Abolhassani, Bateni, Hajiaghayi, Mahini, and Sawant (2014).

For each trader f, the total cost arising from service utilization can be written as

                              
                                 (2.7)
                                 
                                    
                                       
                                          
                                             TC
                                          
                                          f
                                          F
                                       
                                       =
                                       
                                          ∑
                                          
                                             Z
                                             ∈
                                             {
                                             P
                                             ,
                                             A
                                             ,
                                             R
                                             ,
                                             B
                                             ,
                                             L
                                             ,
                                             I
                                             ,
                                             X
                                             }
                                          
                                       
                                       
                                          ∑
                                          
                                             t
                                             ∈
                                             T
                                          
                                       
                                       
                                          ∑
                                          
                                             z
                                             ∈
                                             Z
                                             (
                                             f
                                             )
                                          
                                       
                                       
                                          λ
                                          
                                             z
                                             t
                                          
                                          Z
                                       
                                       
                                          q
                                          
                                             f
                                             z
                                             t
                                          
                                          Z
                                       
                                       ,
                                    
                                 
                              
                           where the 
                              
                                 q
                                 
                                    f
                                    z
                                    t
                                 
                                 Z
                              
                            are the decision variables of the traders and represent the volume flows between trader f and service provider Zz
                           , 
                              
                                 λ
                                 
                                    z
                                    t
                                 
                                 Z
                              
                            is the market price for using the service Zz
                            (exogenous to the trader), and 
                              
                                 Z
                                 (
                                 f
                                 )
                              
                            is the set of nodes/arcs at which the trader f and a service provider of type Z are both present. Note that

                              
                                 
                                    
                                       
                                          
                                             
                                                q
                                                
                                                   f
                                                   n
                                                   t
                                                
                                                L
                                             
                                          
                                          
                                             
                                                ≡
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      B
                                                      (
                                                      n
                                                      )
                                                   
                                                
                                                
                                                   
                                                      q
                                                      
                                                         f
                                                         n
                                                         m
                                                         t
                                                      
                                                      B
                                                   
                                                   
                                                      LOSS
                                                      n
                                                      L
                                                   
                                                
                                                ,
                                                
                                                and
                                             
                                          
                                       
                                       
                                          
                                             
                                                q
                                                
                                                   f
                                                   m
                                                   t
                                                
                                                R
                                             
                                          
                                          
                                             
                                                ≡
                                                
                                                   ∑
                                                   
                                                      n
                                                      ∈
                                                      B
                                                      (
                                                      m
                                                      )
                                                   
                                                
                                                
                                                   LOSS
                                                   
                                                      n
                                                      m
                                                   
                                                   B
                                                
                                                
                                                   q
                                                   
                                                      f
                                                      n
                                                      m
                                                      t
                                                   
                                                   B
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    q
                                    
                                       f
                                       n
                                       t
                                    
                                    L
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    q
                                    
                                       f
                                       n
                                       m
                                       t
                                    
                                    B
                                 
                                 ,
                              
                            and 
                              
                                 q
                                 
                                    f
                                    m
                                    t
                                 
                                 R
                              
                            are the flows at arrival at the service providers, and 
                              
                                 LOSS
                                 n
                                 L
                              
                            and 
                              
                                 LOSS
                                 
                                    n
                                    m
                                 
                                 B
                              
                            are the loss factors from liquefaction and shipment; 
                              
                                 q
                                 
                                    f
                                    n
                                    t
                                 
                                 L
                              
                            and 
                              
                                 q
                                 
                                    f
                                    m
                                    t
                                 
                                 R
                              
                            will therefore be substituted for the remainder of this work.

Each trader’s profit maximization is subject to several volume balances to ensure that the solution is reasonable: per trader f, all inflows have to match the outflows in each node n and each period t, and the yearly inflows into a storage unit have to be equal to the outflows in each node n.

                              
                                 (2.8)
                                 
                                    
                                       
                                          
                                             
                                                h
                                                
                                                   f
                                                   n
                                                   t
                                                
                                                
                                                   F
                                                   1
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   q
                                                   
                                                      f
                                                      n
                                                      t
                                                   
                                                   P
                                                
                                                +
                                                
                                                   q
                                                   
                                                      f
                                                      n
                                                      t
                                                   
                                                   X
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      A
                                                      (
                                                      n
                                                      )
                                                   
                                                
                                                
                                                   LOSS
                                                   
                                                      m
                                                      n
                                                   
                                                   A
                                                
                                                
                                                   q
                                                   
                                                      f
                                                      m
                                                      n
                                                      t
                                                   
                                                   A
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      B
                                                      (
                                                      n
                                                      )
                                                   
                                                
                                                
                                                   LOSS
                                                   
                                                      m
                                                      n
                                                   
                                                   B
                                                
                                                
                                                   LOSS
                                                   n
                                                   R
                                                
                                                
                                                   q
                                                   
                                                      f
                                                      m
                                                      n
                                                      t
                                                   
                                                   B
                                                
                                                −
                                                
                                                   q
                                                   
                                                      f
                                                      n
                                                      t
                                                   
                                                   I
                                                
                                                −
                                                
                                                   q
                                                   
                                                      f
                                                      n
                                                      t
                                                   
                                                   C
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      A
                                                      (
                                                      n
                                                      )
                                                   
                                                
                                                
                                                   q
                                                   
                                                      f
                                                      n
                                                      m
                                                      t
                                                   
                                                   A
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                −
                                                
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      B
                                                      (
                                                      n
                                                      )
                                                   
                                                
                                                
                                                   
                                                      q
                                                      
                                                         f
                                                         n
                                                         m
                                                         t
                                                      
                                                      B
                                                   
                                                   
                                                      LOSS
                                                      n
                                                      L
                                                   
                                                
                                                =
                                                0
                                                
                                                
                                                   (
                                                   
                                                      ϕ
                                                      
                                                         f
                                                         n
                                                         t
                                                      
                                                      N
                                                   
                                                   )
                                                
                                                
                                                ∀
                                                n
                                                ,
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (2.9)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                   
                                                      f
                                                      n
                                                   
                                                   
                                                      F
                                                      2
                                                   
                                                
                                                =
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   LOSS
                                                   n
                                                   I
                                                
                                                
                                                   q
                                                   
                                                      f
                                                      n
                                                      t
                                                   
                                                   I
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   q
                                                   
                                                      f
                                                      n
                                                      t
                                                   
                                                   X
                                                
                                                =
                                                0
                                                
                                                
                                                   (
                                                   
                                                      ϕ
                                                      
                                                         f
                                                         n
                                                      
                                                      S
                                                   
                                                   )
                                                
                                                
                                                ∀
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           Some incoming and outgoing flows are multiplied and divided, respectively, by 
                              
                                 
                                    LOSS
                                    z
                                    Z
                                 
                                 ∈
                                 
                                    (
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 ,
                              
                            to account for incurring transaction losses. 
                              
                                 ϕ
                                 
                                    f
                                    n
                                    t
                                 
                                 N
                              
                            and 
                              
                                 ϕ
                                 
                                    f
                                    n
                                 
                                 S
                              
                            are the associated dual variables (Lagrange multipliers).

Finally, all the decision variables 
                              
                                 q
                                 
                                    f
                                    n
                                    t
                                 
                                 C
                              
                            and 
                              
                                 q
                                 
                                    f
                                    z
                                    t
                                 
                                 Z
                              
                            can be upper and lower bounded due to contracts, certain policies, sanctions, etc. We state these equations in the following, but for simplicity of notation will neglect them for the remainder of the paper.

                              
                                 (2.10)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                   
                                                      f
                                                      n
                                                      t
                                                   
                                                   C
                                                
                                                ≤
                                             
                                          
                                          
                                             
                                                
                                                
                                                   UPP
                                                   
                                                      f
                                                      n
                                                      t
                                                   
                                                   C
                                                
                                                
                                                
                                                   (
                                                   
                                                      
                                                         ξ
                                                         ¯
                                                      
                                                      
                                                         f
                                                         n
                                                         t
                                                      
                                                      C
                                                   
                                                   )
                                                
                                                
                                                ∀
                                                f
                                                ,
                                                n
                                                ,
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (2.11)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                   
                                                      f
                                                      n
                                                      t
                                                   
                                                   C
                                                
                                                ≥
                                             
                                          
                                          
                                             
                                                
                                                
                                                   LOW
                                                   
                                                      f
                                                      n
                                                      t
                                                   
                                                   C
                                                
                                                
                                                
                                                   (
                                                   
                                                      
                                                         ξ
                                                         ̲
                                                      
                                                      
                                                         f
                                                         n
                                                         t
                                                      
                                                      C
                                                   
                                                   )
                                                
                                                
                                                ∀
                                                f
                                                ,
                                                n
                                                ,
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (2.12)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                   
                                                      f
                                                      z
                                                      t
                                                   
                                                   Z
                                                
                                                ≤
                                             
                                          
                                          
                                             
                                                
                                                
                                                   UPP
                                                   
                                                      f
                                                      z
                                                      t
                                                   
                                                   Z
                                                
                                                
                                                
                                                   (
                                                   
                                                      
                                                         ξ
                                                         ¯
                                                      
                                                      
                                                         f
                                                         z
                                                         t
                                                      
                                                      Z
                                                   
                                                   )
                                                
                                                
                                                ∀
                                                f
                                                ,
                                                z
                                                ,
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (2.13)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                   
                                                      f
                                                      z
                                                      t
                                                   
                                                   Z
                                                
                                                ≥
                                             
                                          
                                          
                                             
                                                
                                                
                                                   LOW
                                                   
                                                      f
                                                      z
                                                      t
                                                   
                                                   Z
                                                
                                                
                                                
                                                   (
                                                   
                                                      
                                                         ξ
                                                         ̲
                                                      
                                                      
                                                         f
                                                         z
                                                         t
                                                      
                                                      Z
                                                   
                                                   )
                                                
                                                
                                                ∀
                                                f
                                                ,
                                                z
                                                ,
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Each service provider Zz
                            determines the total volume contracted to traders 
                              
                                 s
                                 
                                    z
                                    t
                                 
                                 Z
                              
                            by maximizing profits 
                              
                                 Π
                                 z
                                 Z
                              
                            over all time periods t:

                              
                                 (2.14)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                   
                                                      
                                                         s
                                                         
                                                            z
                                                            t
                                                         
                                                         Z
                                                      
                                                      ≥
                                                      0
                                                   
                                                
                                                
                                                
                                                   Π
                                                   z
                                                   Z
                                                
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      
                                                         z
                                                         t
                                                      
                                                      Z
                                                   
                                                   
                                                      s
                                                      
                                                         z
                                                         t
                                                      
                                                      Z
                                                   
                                                   −
                                                   
                                                      c
                                                      
                                                         z
                                                         t
                                                      
                                                      Z
                                                   
                                                   
                                                      (
                                                      
                                                         s
                                                         
                                                            z
                                                            t
                                                         
                                                         Z
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (2.15)
                                 
                                    
                                       
                                          
                                             
                                                s.t.
                                                
                                                
                                                   g
                                                   
                                                      z
                                                      t
                                                   
                                                   
                                                      Z
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   
                                                      CAP
                                                      ¯
                                                   
                                                   
                                                      z
                                                      t
                                                   
                                                   Z
                                                
                                                −
                                                
                                                   s
                                                   
                                                      z
                                                      t
                                                   
                                                   Z
                                                
                                                ≥
                                                0
                                                
                                                
                                                   (
                                                   
                                                      α
                                                      
                                                         z
                                                         t
                                                      
                                                      Z
                                                   
                                                   )
                                                
                                                
                                                ∀
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (2.16)
                                 
                                    
                                       
                                          
                                             
                                                g
                                                z
                                                
                                                   Z
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   
                                                      CAP
                                                      ¯
                                                   
                                                   z
                                                   
                                                      Z
                                                      T
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   s
                                                   
                                                      z
                                                      t
                                                   
                                                   Z
                                                
                                                ≥
                                                0
                                                
                                                
                                                   (
                                                   
                                                      α
                                                      z
                                                      
                                                         Z
                                                         T
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    c
                                    
                                       z
                                       t
                                    
                                    Z
                                 
                                 
                                    (
                                    
                                       s
                                       
                                          z
                                          t
                                       
                                       Z
                                    
                                    )
                                 
                              
                            are the costs arising for the service provider Zz
                            by contracting 
                              
                                 s
                                 
                                    z
                                    t
                                 
                                 Z
                              
                            and are assumed to be convex and twice differentiable, 
                              
                                 
                                    CAP
                                    ¯
                                 
                                 
                                    z
                                    t
                                 
                                 Z
                              
                            and 
                              
                                 
                                    CAP
                                    ¯
                                 
                                 z
                                 
                                    Z
                                    T
                                 
                              
                            are the service providers’ capacity limits per time period t and per year, and 
                              
                                 α
                                 
                                    z
                                    t
                                 
                                 Z
                              
                            and 
                              
                                 α
                                 z
                                 
                                    Z
                                    T
                                 
                              
                            are the dual variables associated with the capacity constraints. As stated above, 
                              
                                 λ
                                 
                                    z
                                    t
                                 
                                 Z
                              
                            is the market price for using the service and is exogenous to the service provider.

Note that 
                              
                                 g
                                 n
                                 
                                    X
                                    2
                                 
                              
                            can be used to model the working gas volume of a storage: 
                              
                                 
                                    
                                       CAP
                                       ¯
                                    
                                    n
                                    
                                       X
                                       T
                                    
                                 
                                 −
                                 
                                    ∑
                                    
                                       t
                                       ∈
                                       T
                                    
                                 
                                 
                                    s
                                    
                                       n
                                       t
                                    
                                    X
                                 
                                 ≥
                                 0
                                 ,
                              
                            where 
                              
                                 
                                    CAP
                                    ¯
                                 
                                 n
                                 
                                    X
                                    T
                                 
                              
                            is the maximum storable working gas in node n. Limiting the total extractable gas is equal to limiting the total storable gas under the assumption that the injection and extraction periods are separated, and the maximum storage level is reached at most once per year. This is clearly true when modeling up to 
                              
                                 
                                    t
                                    ¯
                                 
                                 =
                                 3
                              
                            periods per year, but mostly also holds for 
                              
                                 
                                    t
                                    ¯
                                 
                                 >
                                 3
                              
                            in reality. Also, the traders have perfect foresight over the entire simulation period, and therefore it is not necessary to specify whether the withdrawal or the injection period is first in the simulation. It suffices to ensure that the storage levels are equal or higher at the end of a storage cycle than before, which is guaranteed in equilibrium by Eqs. (2.9) and (2.16). To model the storage more accurately, additional constraints can be introduced in the formulation without affecting the theoretical conclusions, as long as they are affine in the decision variables.

These conditions couple the decision variables of the traders (
                              
                                 q
                                 
                                    f
                                    z
                                    t
                                 
                                 Z
                              
                           ) and the service providers (
                              
                                 s
                                 
                                    z
                                    t
                                 
                                 Z
                              
                           ). By enforcing market clearance in every node n and period t, the dual variables of these equations, the market prices 
                              
                                 
                                    λ
                                    
                                       z
                                       t
                                    
                                    Z
                                 
                                 ,
                              
                            are determined:

                              
                                 (2.17)
                                 
                                    
                                       
                                          h
                                          
                                             z
                                             t
                                          
                                          
                                             M
                                             1
                                          
                                       
                                       =
                                       
                                          s
                                          
                                             z
                                             t
                                          
                                          Z
                                       
                                       −
                                       
                                          ∑
                                          
                                             f
                                             ∈
                                             F
                                             (
                                             z
                                             )
                                          
                                       
                                       
                                          q
                                          
                                             f
                                             z
                                             t
                                          
                                          Z
                                       
                                       =
                                       0
                                       
                                       
                                          (
                                          
                                             λ
                                             
                                                z
                                                t
                                             
                                             Z
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           Furthermore, in all nodes n and periods t we enforce clearing of the wholesale markets:

                              
                                 (2.18)
                                 
                                    
                                       
                                          h
                                          
                                             n
                                             t
                                          
                                          
                                             M
                                             2
                                          
                                       
                                       =
                                       
                                          λ
                                          
                                             n
                                             t
                                          
                                          C
                                       
                                       −
                                       
                                          Λ
                                          
                                             n
                                             t
                                          
                                          C
                                       
                                       
                                          (
                                          ·
                                          )
                                       
                                       =
                                       0
                                       
                                       
                                          (
                                          
                                             λ
                                             
                                                n
                                                t
                                             
                                             C
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           
                        

We derive the Karush–Kuhn–Tucker conditions of the optimization problems of the traders and service providers, and complement them with the market clearing conditions. This leads to Problem (2.19) which takes the format of a mixed non-linear complementarity program.

                           
                              (2.19a)
                              
                                 
                                    
                                       
                                          0
                                       
                                       
                                          ≤
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   ∂
                                                   
                                                      Π
                                                      f
                                                      F
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      q
                                                      
                                                         f
                                                         z
                                                         t
                                                      
                                                      Z
                                                   
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   
                                                      n
                                                      ′
                                                   
                                                   ∈
                                                   N
                                                   
                                                      (
                                                      f
                                                      )
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   
                                                      t
                                                      ′
                                                   
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                ϕ
                                                
                                                   f
                                                   
                                                      n
                                                      ′
                                                   
                                                   
                                                      t
                                                      ′
                                                   
                                                
                                                N
                                             
                                             
                                                
                                                   ∂
                                                   
                                                      h
                                                      
                                                         f
                                                         
                                                            n
                                                            ′
                                                         
                                                         
                                                            t
                                                            ′
                                                         
                                                      
                                                      
                                                         F
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      q
                                                      
                                                         f
                                                         z
                                                         t
                                                      
                                                      Z
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                             
                                                ∑
                                                
                                                   
                                                      n
                                                      ′
                                                   
                                                   ∈
                                                   N
                                                   
                                                      (
                                                      f
                                                      )
                                                   
                                                
                                             
                                             
                                                ϕ
                                                
                                                   f
                                                   
                                                      n
                                                      ′
                                                   
                                                
                                                S
                                             
                                             
                                                
                                                   ∂
                                                   
                                                      h
                                                      
                                                         f
                                                         
                                                            n
                                                            ′
                                                         
                                                      
                                                      
                                                         F
                                                         2
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      q
                                                      
                                                         f
                                                         z
                                                         t
                                                      
                                                      Z
                                                   
                                                
                                             
                                             ⊥
                                             
                                                q
                                                
                                                   f
                                                   z
                                                   t
                                                
                                                Z
                                             
                                             ≥
                                             0
                                             
                                             ∀
                                             f
                                             ,
                                             z
                                             ,
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2.19b)
                              
                                 
                                    
                                       
                                          0
                                       
                                       
                                          ≤
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   ∂
                                                   
                                                      Π
                                                      f
                                                      F
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      q
                                                      
                                                         f
                                                         n
                                                         t
                                                      
                                                      C
                                                   
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   
                                                      n
                                                      ′
                                                   
                                                   ∈
                                                   N
                                                   
                                                      (
                                                      f
                                                      )
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   
                                                      t
                                                      ′
                                                   
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                ϕ
                                                
                                                   f
                                                   
                                                      n
                                                      ′
                                                   
                                                   
                                                      t
                                                      ′
                                                   
                                                
                                                N
                                             
                                             
                                                
                                                   ∂
                                                   
                                                      h
                                                      
                                                         f
                                                         
                                                            n
                                                            ′
                                                         
                                                         
                                                            t
                                                            ′
                                                         
                                                      
                                                      
                                                         F
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      q
                                                      
                                                         f
                                                         n
                                                         t
                                                      
                                                      C
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                             
                                                ∑
                                                
                                                   
                                                      n
                                                      ′
                                                   
                                                   ∈
                                                   N
                                                   
                                                      (
                                                      f
                                                      )
                                                   
                                                
                                             
                                             
                                                ϕ
                                                
                                                   f
                                                   
                                                      n
                                                      ′
                                                   
                                                
                                                S
                                             
                                             
                                                
                                                   ∂
                                                   
                                                      h
                                                      
                                                         f
                                                         
                                                            n
                                                            ′
                                                         
                                                      
                                                      
                                                         F
                                                         2
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      q
                                                      
                                                         f
                                                         n
                                                         t
                                                      
                                                      C
                                                   
                                                
                                             
                                             ⊥
                                             
                                                q
                                                
                                                   f
                                                   n
                                                   t
                                                
                                                C
                                             
                                             ≥
                                             0
                                             
                                             ∀
                                             f
                                             ,
                                             n
                                             ,
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2.19c)
                              
                                 
                                    
                                       
                                          0
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                h
                                                
                                                   f
                                                   n
                                                   t
                                                
                                                
                                                   F
                                                   1
                                                
                                             
                                             ⊥
                                             
                                                ϕ
                                                
                                                   f
                                                   n
                                                   t
                                                
                                                N
                                             
                                             
                                                (
                                                free
                                                )
                                             
                                             
                                             ∀
                                             f
                                             ,
                                             n
                                             ,
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2.19d)
                              
                                 
                                    
                                       
                                          0
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                h
                                                
                                                   f
                                                   n
                                                
                                                
                                                   F
                                                   2
                                                
                                             
                                             ⊥
                                             
                                                ϕ
                                                
                                                   f
                                                   n
                                                
                                                S
                                             
                                             
                                                (
                                                free
                                                )
                                             
                                             
                                             ∀
                                             f
                                             ,
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2.19e)
                              
                                 
                                    
                                       
                                          0
                                       
                                       
                                          ≤
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   ∂
                                                   
                                                      Π
                                                      z
                                                      Z
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      s
                                                      
                                                         z
                                                         t
                                                      
                                                      Z
                                                   
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   
                                                      t
                                                      ′
                                                   
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                α
                                                
                                                   z
                                                   
                                                      t
                                                      ′
                                                   
                                                
                                                Z
                                             
                                             
                                                
                                                   ∂
                                                   
                                                      g
                                                      
                                                         z
                                                         
                                                            t
                                                            ′
                                                         
                                                      
                                                      
                                                         Z
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      s
                                                      
                                                         z
                                                         t
                                                      
                                                      Z
                                                   
                                                
                                             
                                             −
                                             
                                                α
                                                z
                                                
                                                   Z
                                                   T
                                                
                                             
                                             
                                                
                                                   ∂
                                                   
                                                      g
                                                      z
                                                      
                                                         Z
                                                         2
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      s
                                                      
                                                         z
                                                         t
                                                      
                                                      Z
                                                   
                                                
                                             
                                             ⊥
                                             
                                                s
                                                
                                                   z
                                                   t
                                                
                                                Z
                                             
                                             ≥
                                             0
                                             
                                             ∀
                                             z
                                             ,
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2.19f)
                              
                                 
                                    
                                       
                                          0
                                       
                                       
                                          ≤
                                       
                                       
                                          
                                             
                                                g
                                                
                                                   z
                                                   t
                                                
                                                
                                                   Z
                                                   1
                                                
                                             
                                             ⊥
                                             
                                                α
                                                
                                                   z
                                                   t
                                                
                                                Z
                                             
                                             ≥
                                             0
                                             
                                             ∀
                                             z
                                             ,
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2.19g)
                              
                                 
                                    
                                       
                                          0
                                       
                                       
                                          ≤
                                       
                                       
                                          
                                             
                                                g
                                                z
                                                
                                                   Z
                                                   2
                                                
                                             
                                             ⊥
                                             
                                                α
                                                z
                                                
                                                   T
                                                   Z
                                                
                                             
                                             ≥
                                             0
                                             
                                             ∀
                                             z
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2.19h)
                              
                                 
                                    
                                       
                                          0
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                h
                                                
                                                   z
                                                   t
                                                
                                                
                                                   M
                                                   1
                                                
                                             
                                             ⊥
                                             
                                                λ
                                                
                                                   z
                                                   t
                                                
                                                Z
                                             
                                             
                                                (
                                                free
                                                )
                                             
                                             
                                             ∀
                                             z
                                             ,
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2.19i)
                              
                                 
                                    
                                       
                                          0
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                h
                                                
                                                   n
                                                   t
                                                
                                                
                                                   M
                                                   2
                                                
                                             
                                             ⊥
                                             
                                                λ
                                                
                                                   n
                                                   t
                                                
                                                C
                                             
                                             
                                                (
                                                free
                                                )
                                             
                                             
                                             ∀
                                             n
                                             ,
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                     

A solution to Problem (2.19) is simultaneously an optimal solution to the problems of all the traders and service providers. The solution represents a Nash equilibrium, in which all traders and service providers optimize their volume flows given the other traders’ and service providers’ decisions, and no party has an incentive to move away from the equilibrium.

In this section, we address the mathematical characteristics of Model (2.19), particularly the existence and uniqueness properties of its solution. Before we start, we restate the model in a more compact way by eliminating superfluous variables, specifying the cost functions, and setting all loss factors 
                        
                           
                              LOSS
                              z
                              Z
                           
                           =
                           1
                        
                     .

First, we want to reduce the number of variables and equations by substituting the decision variables of the service providers 
                           
                              s
                              
                                 z
                                 t
                              
                              Z
                           
                         and the service prices 
                           
                              λ
                              
                                 z
                                 t
                              
                              Z
                           
                         and eliminating Eqs. (2.19e) and (2.19h). This saves programming time, simplifies maintenance, and potentially reduces calculation times. Since 
                           
                              
                                 h
                                 
                                    z
                                    t
                                 
                                 
                                    M
                                    1
                                 
                              
                              =
                              0
                           
                         for all arcs/nodes z and time periods t, we can immediately set 
                           
                              
                                 s
                                 
                                    z
                                    t
                                 
                                 Z
                              
                              :
                              =
                              
                                 ∑
                                 
                                    f
                                    ∈
                                    F
                                    (
                                    z
                                    )
                                 
                              
                              
                                 q
                                 
                                    f
                                    z
                                    t
                                 
                                 Z
                              
                           
                         for all z, t and eliminate Eq. (2.19h). The wholesale prices 
                           
                              λ
                              
                                 z
                                 t
                              
                              C
                           
                         and Eq. (2.19i) could be substituted/eliminated in a similar way, however, we refrain from applying these changes to obtain a more favorable mathematical representation of the model for the derivation of our results.

Eliminating the service prices 
                           
                              λ
                              
                                 z
                                 t
                              
                              Z
                           
                         and Eq. (2.19e) is somewhat more involved. We consider the complementarity constraint (2.19e) and distinguish two cases: for a specific z, t, either

                           
                              (i)
                              
                                 
                                    
                                       
                                          
                                             s
                                             
                                                z
                                                t
                                             
                                             Z
                                          
                                          >
                                          0
                                          ⇒
                                          
                                             λ
                                             
                                                z
                                                t
                                             
                                             Z
                                          
                                          =
                                          
                                             
                                                d
                                                
                                                   c
                                                   
                                                      z
                                                      t
                                                   
                                                   Z
                                                
                                                
                                                   (
                                                   
                                                      s
                                                      
                                                         z
                                                         t
                                                      
                                                      Z
                                                   
                                                   )
                                                
                                             
                                             
                                                d
                                                
                                                   s
                                                   
                                                      z
                                                      t
                                                   
                                                   Z
                                                
                                             
                                          
                                          +
                                          
                                             α
                                             
                                                z
                                                t
                                             
                                             Z
                                          
                                          +
                                          
                                             α
                                             z
                                             
                                                Z
                                                T
                                             
                                          
                                          ,
                                       
                                    
                                  or


                                 
                                    
                                       
                                          
                                             s
                                             
                                                z
                                                t
                                             
                                             Z
                                          
                                          =
                                          0
                                          ⇒
                                          
                                             λ
                                             
                                                z
                                                t
                                             
                                             Z
                                          
                                          ≤
                                          
                                             
                                                d
                                                
                                                   c
                                                   
                                                      z
                                                      t
                                                   
                                                   Z
                                                
                                                
                                                   (
                                                   
                                                      s
                                                      
                                                         z
                                                         t
                                                      
                                                      Z
                                                   
                                                   )
                                                
                                             
                                             
                                                d
                                                
                                                   s
                                                   
                                                      z
                                                      t
                                                   
                                                   Z
                                                
                                             
                                          
                                          +
                                          
                                             α
                                             
                                                z
                                                t
                                             
                                             Z
                                          
                                          +
                                          
                                             α
                                             z
                                             
                                                Z
                                                T
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         d
                                                         
                                                            c
                                                            
                                                               z
                                                               t
                                                            
                                                            Z
                                                         
                                                         
                                                            (
                                                            
                                                               s
                                                               
                                                                  z
                                                                  t
                                                               
                                                               Z
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         d
                                                         
                                                            s
                                                            
                                                               z
                                                               t
                                                            
                                                            Z
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                             
                                                
                                                   s
                                                   
                                                      z
                                                      t
                                                   
                                                   Z
                                                
                                                =
                                                0
                                             
                                          
                                          ,
                                       
                                    
                                  the marginal costs for service provider Zz
                                  at zero throughput. 
                                    
                                       
                                          α
                                          
                                             z
                                             t
                                          
                                          Z
                                       
                                       =
                                       0
                                    
                                  and 
                                    
                                       
                                          α
                                          z
                                          
                                             Z
                                             T
                                          
                                       
                                       =
                                       0
                                    
                                  under the assumption that 
                                    
                                       
                                          
                                             CAP
                                             ¯
                                          
                                          
                                             z
                                             t
                                          
                                          Z
                                       
                                       >
                                       0
                                    
                                  and 
                                    
                                       
                                          
                                             CAP
                                             ¯
                                          
                                          z
                                          
                                             Z
                                             T
                                          
                                       
                                       >
                                       0
                                       ,
                                    
                                  which is reasonable, since otherwise the variable 
                                    
                                       s
                                       
                                          z
                                          t
                                       
                                       Z
                                    
                                  would not have been introduced in the first place.

Hence, we set the service price 
                           
                              
                                 
                                    λ
                                    
                                       z
                                       t
                                    
                                    Z
                                 
                                 :
                                 =
                                 
                                    
                                       d
                                       
                                          c
                                          
                                             z
                                             t
                                          
                                          Z
                                       
                                       
                                          (
                                          
                                             s
                                             
                                                z
                                                t
                                             
                                             Z
                                          
                                          )
                                       
                                    
                                    
                                       d
                                       
                                          s
                                          
                                             z
                                             t
                                          
                                          Z
                                       
                                    
                                 
                                 +
                                 
                                    α
                                    
                                       z
                                       t
                                    
                                    Z
                                 
                                 +
                                 
                                    α
                                    z
                                    
                                       Z
                                       T
                                    
                                 
                              
                           
                         for all z, t regardless of the contracted volume flow 
                           
                              s
                              
                                 z
                                 t
                              
                              Z
                           
                         being greater or equal to zero. This is an easily justifiable change to the model, since the only expected change in the output is that the service price 
                           
                              λ
                              
                                 z
                                 t
                              
                              Z
                           
                         is also unambiguous for nonoperating services Zz
                        .

Second, for homogeneity of notation we relax Equalities (2.19c), (2.19d), and (2.19i) to 
                           
                              
                                 h
                                 
                                    f
                                    n
                                    t
                                 
                                 
                                    F
                                    1
                                 
                              
                              ≥
                              0
                              ,
                           
                        
                        
                           
                              
                                 h
                                 
                                    f
                                    n
                                 
                                 
                                    F
                                    2
                                 
                              
                              ≥
                              0
                              ,
                           
                         and 
                           
                              
                                 h
                                 
                                    n
                                    t
                                 
                                 
                                    M
                                    2
                                 
                              
                              ≥
                              0
                              ,
                           
                         and simultaneously force non-negativity on the respective dual variables. This reformulation does not change the outcome of the model: we expect 
                           
                              
                                 h
                                 
                                    f
                                    n
                                    t
                                 
                                 
                                    F
                                    1
                                 
                              
                              =
                              
                                 h
                                 
                                    f
                                    n
                                 
                                 
                                    F
                                    2
                                 
                              
                              =
                              0
                           
                         in equilibrium, because the trader would otherwise be wasting gas, which is never optimal because production costs are assumed positive. Furthermore, in equilibrium we either have 
                           
                              
                                 h
                                 
                                    n
                                    t
                                 
                                 
                                    M
                                    2
                                 
                              
                              =
                              0
                           
                         and wholesale prices 
                           
                              
                                 λ
                                 
                                    n
                                    t
                                 
                                 C
                              
                              ≥
                              0
                           
                         (as before), or 
                           
                              
                                 h
                                 
                                    n
                                    t
                                 
                                 
                                    M
                                    2
                                 
                              
                              >
                              0
                           
                         and 
                           
                              
                                 λ
                                 
                                    n
                                    t
                                 
                                 C
                              
                              =
                              0
                           
                         (instead of 
                           
                              
                                 h
                                 
                                    n
                                    t
                                 
                                 
                                    M
                                    2
                                 
                              
                              =
                              0
                           
                         and 
                           
                              
                                 λ
                                 
                                    n
                                    t
                                 
                                 C
                              
                              <
                              0
                           
                        ). But since it is never optimal for traders to sell gas at 
                           
                              
                                 λ
                                 
                                    n
                                    t
                                 
                                 C
                              
                              ≤
                              0
                           
                         due to production cost being larger than zero, the second situation never arises. In reality, these assumptions may not always hold: it may be cheaper for a supplier to flare superfluous gas or sell gas at negative prices than reducing production. However, in our framework we do not impose any constraints which would lead to such behavior (as for instance ramp constraints), and therefore 
                           
                              
                                 h
                                 
                                    f
                                    n
                                    t
                                 
                                 
                                    F
                                    1
                                 
                              
                              ≠
                              0
                              ,
                           
                        
                        
                           
                              
                                 h
                                 
                                    f
                                    n
                                 
                                 
                                    F
                                    2
                                 
                              
                              ≠
                              0
                              ,
                           
                         and 
                           
                              
                                 h
                                 
                                    n
                                    t
                                 
                                 
                                    M
                                    2
                                 
                              
                              ≠
                              0
                           
                         never result in our model, even after relaxation.

Third, we define the cost functions of the service providers 
                           
                              
                                 c
                                 
                                    z
                                    t
                                 
                                 Z
                              
                              
                                 (
                                 
                                    s
                                    
                                       z
                                       t
                                    
                                    Z
                                 
                                 )
                              
                           
                         such that sufficiency and necessity of the Karush–Kuhn–Tucker conditions is preserved. Hence, 
                           
                              
                                 c
                                 
                                    z
                                    t
                                 
                                 Z
                              
                              
                                 (
                                 
                                    s
                                    
                                       z
                                       t
                                    
                                    Z
                                 
                                 )
                              
                           
                         have to be convex and differentiable. In recent studies (Chyong & Hobbs, 2014; Gabriel et al., 2012; Moryadee, Gabriel, & Rehulka, 2014) we find that the cost functions are chosen affine, except for production for which a quadratic and a logarithmic term is added to represent the sharp increase in cost close to the capacity limit. (The quadratic and the logarithmic term are both convex.) We adopt these cost structures, except that we omit the logarithmic term in the production cost functions. This allows the problem to be represented as linear complementarity problem while maintaining strict convexity in the production cost function. The derivatives of our cost functions read

                           
                              (3.1)
                              
                                 
                                    
                                       
                                          
                                             
                                                d
                                                
                                                   c
                                                   
                                                      z
                                                      t
                                                   
                                                   
                                                      Z
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   
                                                      s
                                                      
                                                         z
                                                         t
                                                      
                                                      
                                                         Z
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                d
                                                
                                                   s
                                                   
                                                      z
                                                      t
                                                   
                                                   
                                                      Z
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                LINC
                                                
                                                   z
                                                   t
                                                
                                                
                                                   Z
                                                   ′
                                                
                                             
                                             ,
                                             
                                             
                                                Z
                                                ′
                                             
                                             ∈
                                             Z
                                             ∖
                                             
                                                {
                                                P
                                                }
                                             
                                             
                                             ∀
                                             z
                                             ,
                                             t
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3.2)
                              
                                 
                                    
                                       
                                          
                                             
                                                d
                                                
                                                   c
                                                   
                                                      n
                                                      t
                                                   
                                                   P
                                                
                                                
                                                   (
                                                   
                                                      s
                                                      
                                                         n
                                                         t
                                                      
                                                      P
                                                   
                                                   )
                                                
                                             
                                             
                                                d
                                                
                                                   s
                                                   
                                                      n
                                                      t
                                                   
                                                   P
                                                
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                LINC
                                                
                                                   n
                                                   t
                                                
                                                P
                                             
                                             +
                                             
                                                QUAC
                                                
                                                   n
                                                   t
                                                
                                                P
                                             
                                             
                                                s
                                                
                                                   n
                                                   t
                                                
                                                P
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3.3)
                              
                                 
                                    
                                       
                                       
                                          
                                             =
                                             
                                                LINC
                                                
                                                   n
                                                   t
                                                
                                                P
                                             
                                             +
                                             
                                                QUAC
                                                
                                                   n
                                                   t
                                                
                                                P
                                             
                                             
                                                q
                                                
                                                   f
                                                   n
                                                   t
                                                
                                                P
                                             
                                             
                                             ∀
                                             n
                                             ,
                                             t
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              LINC
                              
                                 z
                                 t
                              
                              Z
                           
                         and 
                           
                              QUAC
                              
                                 z
                                 t
                              
                              Z
                           
                         are the linear and quadratic cost function terms for service Z located at node/arc z in period t. Note that the last equality holds because every trader has only one associated producer (Section 2.1).

We state the full problem including all mentioned changes in Appendix B. After dividing the left-hand side of Eq. (B.1k) by the slope of the inverse demand curve 
                           
                              
                                 SLP
                                 
                                    n
                                    t
                                 
                                 C
                              
                              ,
                           
                         the problem can be brought into the following form:

                           
                              (3.4a)
                              
                                 
                                    
                                       
                                          
                                             M
                                             x
                                             +
                                             b
                                          
                                       
                                       
                                          
                                             ⪰
                                             0
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3.4b)
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             ⪰
                                             0
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3.4c)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                T
                                             
                                             
                                                (
                                                M
                                                x
                                                +
                                                b
                                                )
                                             
                                          
                                       
                                       
                                          
                                             =
                                             0
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3.4d)
                              
                                 
                                    
                                       
                                          
                                             M
                                             :
                                             =
                                             
                                                [
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                               E
                                                               T
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                               F
                                                               T
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                               G
                                                               T
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         H
                                                      
                                                   
                                                
                                                ]
                                             
                                             ,
                                             
                                          
                                       
                                       
                                          
                                             x
                                             :
                                             =
                                             
                                                [
                                                
                                                   
                                                      
                                                         q
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                   
                                                   
                                                      
                                                         ϕ
                                                      
                                                   
                                                   
                                                      
                                                         λ
                                                      
                                                   
                                                
                                                ]
                                             
                                             ,
                                             
                                             b
                                             :
                                             =
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            b
                                                            q
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                            α
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                            ϕ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                            λ
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              M
                              ∈
                              
                                 R
                                 
                                    p
                                    ×
                                    p
                                 
                              
                              ,
                           
                        
                        
                           
                              x
                              ∈
                              
                                 R
                                 p
                              
                              ,
                           
                         and 
                           
                              b
                              ∈
                              
                                 R
                                 p
                              
                           
                        . As usual, ≽, ⪯, ≻, ≺ are interpreted component-wise. The components of x are defined as

                           
                              (3.5)
                              
                                 
                                    q
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   q
                                                   P
                                                
                                             
                                          
                                          
                                             
                                                
                                                   q
                                                   I
                                                
                                             
                                          
                                          
                                             
                                                
                                                   q
                                                   X
                                                
                                             
                                          
                                          
                                             
                                                
                                                   q
                                                   A
                                                
                                             
                                          
                                          
                                             
                                                
                                                   q
                                                   B
                                                
                                             
                                          
                                          
                                             
                                                
                                                   q
                                                   C
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                    
                                    α
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   α
                                                   Z
                                                
                                             
                                          
                                          
                                             
                                                
                                                   α
                                                   
                                                      Z
                                                      T
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                    
                                    ϕ
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   ϕ
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ϕ
                                                   S
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                    
                                    λ
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   λ
                                                   C
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                        where each sub-component of q, α, ϕ and λ is again a vector containing all variables of its respective type, for example the vector qP
                         contains all the produced volumes 
                           
                              q
                              
                                 f
                                 n
                                 t
                              
                              P
                           
                         and is of appropriate dimension. The first block row of M and bq
                         corresponds to Eqs. (B.1a)–(B.1f) and contains the stationarity conditions of the traders’ optimization problems (with substituted service prices 
                           
                              λ
                              
                                 z
                                 t
                              
                              Z
                           
                        ). 
                           
                              E
                              q
                              +
                              
                                 b
                                 α
                              
                           
                         corresponds to Eqs. (B.1i) and (B.1j), and consists of the primal feasibility constraints of the service providers’ problems (with substituted decision variables 
                           
                              s
                              
                                 z
                                 t
                              
                              Z
                           
                        ). 
                           
                              F
                              q
                              +
                              
                                 b
                                 ϕ
                              
                           
                         corresponds to Eqs. (B.1g) and (B.1h), comprising the primal feasibility constraints of the traders’ problems. 
                           
                              G
                              q
                              +
                              H
                              λ
                              +
                              
                                 b
                                 λ
                              
                           
                         corresponds to the wholesale market clearing conditions contained in Eq. (B.1k). Note that the inverse demand functions 
                           
                              
                                 Λ
                                 
                                    n
                                    t
                                 
                                 C
                              
                              
                                 (
                                 ·
                                 )
                              
                           
                         have to be affine for all n and t to represent Model (2.19) by Eq. (3.4). Some of the sub-matrices of M and b have special properties: D is diagonal and positive semi-definite, E ≽ 0, G ⪯ 0, H is diagonal and positive definite, bq
                         ≽ 0, bα
                        ≻0, 
                           
                              
                                 b
                                 ϕ
                              
                              =
                              0
                              ,
                           
                         and bλ
                        ≺0.

According to Cottle, Pang, and Stone (1992, Theorem 3.1.2), a solution to Problem (3.4) exists if

                           
                              (i)
                              
                                 M is positive semi-definite,

a vector x exists satisfying Eqs. (3.4a) and (3.4b).

Since

                           
                              (3.6)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                T
                                             
                                             M
                                             x
                                          
                                       
                                       
                                          
                                             =
                                             
                                                [
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         α
                                                      
                                                      
                                                         ϕ
                                                      
                                                      
                                                         λ
                                                      
                                                   
                                                
                                                ]
                                             
                                             
                                                [
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         E
                                                      
                                                      
                                                         F
                                                      
                                                      
                                                         G
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            −
                                                            
                                                               E
                                                               T
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            −
                                                            
                                                               F
                                                               T
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            −
                                                            
                                                               G
                                                               T
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         H
                                                      
                                                   
                                                
                                                ]
                                             
                                             
                                                [
                                                
                                                   
                                                      
                                                         q
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                   
                                                   
                                                      
                                                         ϕ
                                                      
                                                   
                                                   
                                                      
                                                         λ
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3.7)
                              
                                 
                                    
                                       
                                       
                                          
                                             =
                                             
                                                q
                                                T
                                             
                                             D
                                             q
                                             +
                                             
                                                λ
                                                T
                                             
                                             H
                                             λ
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        Condition (i) is satisfied if D and H are positive (semi-) definite, which is indeed the case.

Condition (ii) is proven by construction. We begin with 
                           
                              
                                 x
                                 0
                              
                              =
                              0
                              ,
                           
                         and by exploiting the structure of M and b we subsequently alter the components of x until we find x satisfying Eqs. (3.4a) and (3.4b).


                              x
                              0 is not feasible, because 
                                 
                                    −
                                    
                                       G
                                       T
                                    
                                    
                                       q
                                       0
                                    
                                    +
                                    H
                                    
                                       λ
                                       0
                                    
                                    +
                                    
                                       b
                                       λ
                                    
                                    =
                                    
                                       b
                                       λ
                                    
                                    ≺
                                    0
                                 
                              . Therefore, we set 
                                 
                                    
                                       λ
                                       1
                                    
                                    =
                                    −
                                    
                                       H
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       b
                                       λ
                                    
                                    ⇒
                                    
                                       λ
                                       
                                          n
                                          t
                                       
                                       C
                                    
                                    =
                                    S
                                    L
                                    
                                       P
                                       
                                          n
                                          t
                                       
                                       C
                                    
                                    ·
                                    
                                       
                                          INT
                                          
                                             n
                                             t
                                          
                                          C
                                       
                                       
                                          S
                                          L
                                          
                                             P
                                             
                                                n
                                                t
                                             
                                             C
                                          
                                       
                                    
                                    =
                                    
                                       INT
                                       
                                          n
                                          t
                                       
                                       C
                                    
                                    ≥
                                    0
                                 
                              . Hence, the components of x
                              1 are:

                                 
                                    
                                       
                                          
                                             q
                                             1
                                          
                                          =
                                          0
                                          ,
                                          
                                          
                                             α
                                             1
                                          
                                          =
                                          0
                                          ,
                                          
                                          
                                             ϕ
                                             1
                                          
                                          =
                                          0
                                          ,
                                          
                                          
                                             λ
                                             1
                                          
                                          =
                                          
                                             INT
                                             C
                                          
                                          ,
                                       
                                    
                                 
                              where INTC
                               is the vector containing the intercepts of the inverse demand curves 
                                 
                                    INT
                                    
                                       n
                                       t
                                    
                                    C
                                 
                               at the positions corresponding to the indices n, t of the wholesale prices λ ≡ λC
                              .

We now consider the first block-row of inequalities: 
                                 
                                    D
                                    
                                       q
                                       1
                                    
                                    +
                                    E
                                    
                                       α
                                       1
                                    
                                    +
                                    F
                                    
                                       ϕ
                                       1
                                    
                                    +
                                    G
                                    
                                       λ
                                       1
                                    
                                    +
                                    
                                       b
                                       q
                                    
                                    =
                                    G
                                    ·
                                    
                                       INT
                                       C
                                    
                                    +
                                    
                                       b
                                       q
                                    
                                    ¬
                                    ⪰
                                    0
                                    ,
                                 
                               because we cannot guarantee 
                                 
                                    
                                       b
                                       q
                                    
                                    ⪰
                                    −
                                    G
                                    ·
                                    
                                       INT
                                       C
                                    
                                 
                              . We set 
                                 
                                    
                                       ϕ
                                       2
                                       N
                                    
                                    :
                                    =
                                    
                                       INT
                                       C
                                    
                                 
                               (again, INTC
                               is a vector containing 
                                 
                                    INT
                                    
                                       n
                                       t
                                    
                                    C
                                 
                               at the corresponding indices), which gives us

                                 
                                    
                                       
                                          
                                             q
                                             2
                                             T
                                          
                                          =
                                          0
                                          ,
                                          
                                          
                                             α
                                             2
                                             T
                                          
                                          =
                                          0
                                          ,
                                          
                                          
                                             ϕ
                                             2
                                             N
                                          
                                          =
                                          
                                             INT
                                             C
                                          
                                          ,
                                          
                                          
                                             ϕ
                                             2
                                             S
                                          
                                          =
                                          0
                                          ,
                                          
                                          
                                             λ
                                             2
                                          
                                          =
                                          
                                             INT
                                             C
                                          
                                          .
                                       
                                    
                                 
                              
                           

Since F has both positive and negative entries, we have Fϕ
                              2 ⪯ 0 for some lines of the first block-row. Since E ≽ 0, and at least one entry on each conflicting line is greater than zero (this can be deduced from the Problem formulation (B.1)), we can compensate for Fϕ
                              2 ⪯ 0 by setting the corresponding components of α sufficiently large: 
                                 
                                    
                                       α
                                       3
                                    
                                    :
                                    =
                                    
                                       INT
                                       C
                                    
                                    ⇒
                                    E
                                    α
                                    ⪰
                                    
                                       |
                                       −
                                       F
                                       
                                          ϕ
                                          2
                                       
                                       |
                                    
                                 
                              . This leads to a feasible x
                              3:

                                 
                                    
                                       
                                          
                                             q
                                             3
                                          
                                          =
                                          0
                                          ,
                                          
                                          
                                             α
                                             3
                                          
                                          =
                                          
                                             INT
                                             C
                                          
                                          ,
                                          
                                          
                                             ϕ
                                             3
                                             N
                                          
                                          =
                                          
                                             INT
                                             C
                                          
                                          ,
                                          
                                          
                                             ϕ
                                             3
                                             S
                                          
                                          =
                                          0
                                          ,
                                          
                                          
                                             λ
                                             3
                                          
                                          =
                                          
                                             INT
                                             C
                                          
                                          ,
                                       
                                    
                                 
                              which completes the proof of Condition (ii).

As stated in Cottle et al. (1992, Theorem 3.3.7), Problem (3.4) attains a unique solution for all vectors b if and only if M is a 
                           P
                        -matrix.
                           3
                        
                        
                           3
                           A matrix is a 
                                 P
                              -matrix if it has square form and all its principle minors are positive. This is the most general class of matrices for which the linear complementarity program (3.4) attains a unique solution for all vectors b. We refer to Cottle et al. (1992, Chapter 3.3) for an in-depth discussion on 
                                 P
                              -matrices.
                         This is clearly not the case as some diagonal elements 
                           
                              
                                 M
                                 
                                    i
                                    i
                                 
                              
                              =
                              0
                           
                         independent of the parameter value choices. However, given 
                           
                              M
                              +
                              
                                 M
                                 T
                              
                           
                         is diagonal, we can guarantee uniqueness of the solution x in component i if the corresponding element Mii
                         > 0; see Appendix C for a proof. The converse is not necessarily true: xi
                         may be unique even if 
                           
                              
                                 M
                                 
                                    i
                                    i
                                 
                              
                              =
                              0
                           
                         because the component is sufficiently constrained by M and b.

Consequently, results are unique in at least the produced volume qP
                        , the sold volume 
                           
                              q
                              
                                 f
                                 n
                                 t
                              
                              C
                           
                         if the corresponding market power parameter 
                           
                              
                                 θ
                                 
                                    f
                                    n
                                    t
                                 
                                 C
                              
                              >
                              0
                              ,
                           
                         and the wholesale price λC
                        . Furthermore, from Eq. (2.18) and the properties of the inverse demand function (2.3)–(2.6), we can deduce that the total consumption in a node and time period 
                           
                              
                                 ∑
                                 
                                    f
                                    ∈
                                    F
                                    (
                                    n
                                    )
                                 
                              
                              
                                 q
                                 
                                    f
                                    n
                                    t
                                 
                                 C
                              
                           
                         is unique. By combining these results, we can conclude that the total sales of perfectly competitive traders in a node and time period 
                           
                              
                                 ∑
                                 
                                    f
                                    ∈
                                    {
                                    F
                                    
                                       (
                                       n
                                       )
                                    
                                    |
                                    
                                       θ
                                       
                                          f
                                          n
                                          t
                                       
                                    
                                    =
                                    0
                                    }
                                 
                              
                              
                                 q
                                 
                                    f
                                    n
                                    t
                                 
                                 C
                              
                           
                         are unique, including the special case of 
                           
                              q
                              
                                 f
                                 n
                                 t
                              
                              C
                           
                         being unique independently of θfnt
                         if there is only one trader f in the market in node n and time period t. Finally, unique produced volumes qP
                         imply that the sold volume 
                           
                              q
                              
                                 f
                                 n
                                 t
                              
                              C
                           
                         is unique if trader f only sells gas in one node and one time period.

To determine uniqueness of xi
                         for all i for specific instances of M and b we analyze the solution space of the problem: Since M is positive semi-definite, the solution space 
                           S
                         is a convex polyhedron (Cottle et al., 1992, Theorems 3.1.7 and 3.1.8) of the form

                           
                              (3.8)
                              
                                 
                                    S
                                    =
                                    {
                                    x
                                    ∈
                                    
                                       R
                                       +
                                       p
                                    
                                    :
                                    M
                                    x
                                    +
                                    b
                                    ⪰
                                    0
                                    ,
                                    
                                       b
                                       T
                                    
                                    
                                       (
                                       x
                                       −
                                       
                                          x
                                          ^
                                       
                                       )
                                    
                                    =
                                    0
                                    ,
                                    
                                       (
                                       M
                                       +
                                       
                                          M
                                          T
                                       
                                       )
                                    
                                    
                                       (
                                       x
                                       −
                                       
                                          x
                                          ^
                                       
                                       )
                                    
                                    =
                                    0
                                    }
                                    ,
                                 
                              
                           
                        where 
                           
                              x
                              ^
                           
                         is an arbitrary solution. We have shown in Section 3.2 that a solution 
                           
                              x
                              ^
                           
                         always exists, hence the solution space can always be described by 
                           S
                        .

We are now interested in the extreme points of 
                           
                              S
                              ,
                           
                         particularly those attaining maximum or minimum values in (at least) one component: Let 
                           
                              
                                 x
                                 
                                    i
                                    ,
                                    +
                                 
                              
                              ,
                              
                                 x
                                 
                                    i
                                    ,
                                    −
                                 
                              
                              ∈
                              S
                           
                         be vectors (extreme points) attaining the maximum and minimum values of 
                           S
                         in component i. Clearly, the solution to Problem (3.4) is unique in component i if and only if 
                           
                              
                                 x
                                 
                                    i
                                    ,
                                    +
                                 
                              
                              =
                              
                                 x
                                 
                                    i
                                    ,
                                    −
                                 
                              
                           
                        .

To compute 
                           
                              x
                              
                                 i
                                 ,
                                 +
                              
                           
                         and 
                           
                              x
                              
                                 i
                                 ,
                                 −
                              
                           
                         for all i for a specific M and b, we first calculate an arbitrary solution 
                           
                              x
                              ^
                           
                         by solving Problem (3.4). Second, we solve 2p Linear Programs of the form

                           
                              (3.9)
                              
                                 
                                    
                                       min
                                       
                                          x
                                          ∈
                                          S
                                       
                                    
                                    
                                       
                                          (
                                          
                                             c
                                             
                                                i
                                                ,
                                                ±
                                             
                                          
                                          )
                                       
                                       T
                                    
                                    x
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 c
                                 
                                    i
                                    ,
                                    ±
                                 
                              
                              ∈
                              
                                 R
                                 p
                              
                           
                         is ± 1 in component i and 0 in all other components.

As noted in Section 1, lack of uniqueness may have profound implications for the interpretation of the solutions to Problem (3.4). These implications will be discussed in detail in Section 5, after we provide an example.

In this section, we demonstrate the multiplicity of solutions via a numerical example. Based on the data sources listed in Appendix D, we set up Model (B.1) to replicate the global gas market in 2012. The model comprises 50 nodes and 291 arcs, distinguishes the summer and winter half-year, and covers 97 percent of the global gas production and consumption. We refrain to go into the details of the modeling and calibration process, as any parameters fulfilling the criteria listed in the previous sections would qualitatively lead to the same outcome and therefore the exact values of the parameters are not relevant for the demonstration of the solution properties. The reason for underlying the simulations with real data is merely to generate results which are in the order of magnitude typically seen in gas market analyses.

We simulated two cases, a Base Case (BC) and a Counterfactual (CF), allowing for the comparison of (i) multiple solutions in one case, and (ii) the solution spaces of the two cases. In BC, we increased the market power parameter 
                        
                           θ
                           
                              f
                              n
                              t
                           
                           C
                        
                      to 0.01 if the calibrated value was less than 0.01, while leaving all 
                        
                           
                              θ
                              
                                 f
                                 n
                                 t
                              
                              C
                           
                           ∈
                           
                              [
                              0.01
                              ,
                              1
                              ]
                           
                        
                      at their calibrated values. This allowed testing whether 
                        
                           q
                           
                              f
                              n
                              t
                           
                           C
                        
                      attains a unique result if 
                        
                           
                              θ
                              
                                 f
                                 n
                                 t
                              
                              C
                           
                           >
                           0
                        
                      (Section 3.3), while avoiding conflicts with the solver’s tolerances
                        4
                     
                     
                        4
                        We used the standard settings of the Gurobi solver for Quadratic Programs (Version 5.6.3).
                      on one hand, and keeping the impact on the underlying market behavior low on the other hand. In CF, we changed the traders’ market power parameters 
                        
                           
                              θ
                              
                                 f
                                 n
                                 t
                              
                              C
                           
                           =
                           0
                        
                      for all f, n, t. CF corresponds to the (hypothetical) situation of perfect competition among all traders in all markets and time periods which is often taken as benchmark in case studies. We followed the procedure described in Section 3.3 to determine the solution spaces of BC and CF. The results are shown in Tables 4.1
                      and 4.2
                     .


                     Table 4.1 provides the maximum differences between all possible market equilibria in BC and CF, grouped by similar variables. We observe that the solution is unique in the produced volumes qP
                     , the dual variables associated with the capacity constraints of the services α, the wholesale prices λC
                     , the volume flows contracted by the service providers sZ
                     , and the service prices λZ
                     . However, the solution is not unique in the other volume flows (corresponding to the remaining components of q), and the dual variables associated with the volume balances of the traders ϕ. Compared to BC, the maximum differences in CF for the LNG volumes qB
                      and sold volumes qC
                      switch from zero to non-zero, while all other components remain unique/non-unique. Also, in CF the maximum differences of the volumes q are larger. The maximum difference in ϕ is also shown for the sake of completeness, although this result is not of interest in interpretation.


                     Table 4.2 compares the minimum and maximum values achieved, 
                        
                           x
                           
                              i
                              ,
                              −
                           
                        
                      and 
                        
                           
                              x
                              
                                 i
                                 ,
                                 +
                              
                           
                           ,
                        
                      in BC and CF for selected components i. The examples show that the market equilibrium in CF can be higher or lower than in BC for the sold volumes qC
                     . For the injected, extracted and piped volumes qI, qX
                     , and qA
                     , which are ambiguous in BC and CF, the examples demonstrate that the solution intervals overlap. Thus, in none of the presented examples a prediction of the market equilibrium is possible when moving from BC to CF.

@&#DISCUSSION@&#

The theoretical results derived in Section 3 and the numerical example presented in Section 4 provide deep insight in the mathematical structure of Problem (3.4) and allow drawing conclusions about the uniqueness of the individual components of the solution. In particular, the numerical example demonstrates how large the difference between two possible solutions can be in a practical case and thereby emphasizes the importance of analyzing the entire solution space when carrying out a case study. In the following, we discuss various aspects of our findings in detail.

As Table 4.1 indicates, the solution is unique in the produced volumes qP
                     , which is in line with our theoretical findings in Section 3.3 and Appendix C. Furthermore, we proved in Section 3.3 that the sold volume 
                        
                           q
                           
                              f
                              n
                              t
                           
                           C
                        
                      is unique if the corresponding market power parameter 
                        
                           
                              θ
                              
                                 f
                                 n
                                 t
                              
                              C
                           
                           >
                           0
                        
                     ; this result was also confirmed by the numerical example (Table 4.1). From CF in Table 4.1, we see that the ambiguity can be very large if the market power parameter 
                        
                           
                              θ
                              
                                 f
                                 n
                                 t
                              
                              C
                           
                           =
                           0
                        
                     : Some sold volumes 
                        
                           q
                           
                              f
                              n
                              t
                           
                           C
                        
                      attain solutions as different as 186 million cubic meters per day. As a comparison, Germany, the largest European gas consumer, consumed 293 million cubic meters per day during the winter season 2012. Hence, the sold volumes could not be predicted in general for traders behaving perfectly competitive.

Fortunately, this is not required for decision-making in most cases; The key variable in a situation with perfectly competitive traders is the wholesale market price 
                        
                           
                              λ
                              
                                 n
                                 t
                              
                              C
                           
                           ,
                        
                      which is unique independently of the market power parameters 
                        
                           θ
                           
                              f
                              n
                              t
                           
                           C
                        
                      of the traders in node n and time period t (Table 4.1). However, if some perfectly competitive traders have high market shares 
                        
                           
                              
                                 
                                    q
                                    
                                       f
                                       n
                                       t
                                    
                                    C
                                 
                                 
                                    
                                       ∑
                                       
                                          f
                                          ∈
                                          F
                                          (
                                          n
                                          )
                                       
                                    
                                    
                                       q
                                       
                                          f
                                          n
                                          t
                                       
                                       C
                                    
                                 
                              
                              ,
                           
                        
                      countries might still be concerned: Traders might develop strategic behavior over time, and such a transition may induce large changes in the volume flows, as illustrated by our example (Table 4.2).

Alternatively, by choosing the market power parameter 
                        
                           
                              θ
                              
                                 f
                                 n
                                 t
                              
                              C
                           
                           >
                           0
                        
                      for all traders f in all nodes n and time periods t we can guarantee uniqueness of the volumes sold qC
                     . However, the underlying model assumptions leading to this specific, unique qC
                      should be studied carefully: first, 
                        
                           
                              θ
                              
                                 f
                                 n
                                 t
                              
                              C
                           
                           >
                           0
                        
                      for all f, n, t, implies that all traders in the model exert market power in all markets and time periods to some extent. We argue that this is plausible for a real world case, because real markets are imperfect and therefore some market power can always be exerted by traders. Second, a market power parameter 
                        
                           
                              θ
                              
                                 f
                                 n
                                 t
                              
                              C
                           
                           >
                           0
                        
                      drives trader f to shift some of its sold volumes away from market n in period t. This originates from the fact that 
                        
                           θ
                           
                              f
                              n
                              t
                           
                           C
                        
                      is proportional to a cost on 
                        
                           
                              (
                              
                                 q
                                 
                                    f
                                    n
                                    t
                                 
                                 C
                              
                              )
                           
                           2
                        
                     . This becomes obvious when the inverse demand function 
                        
                           
                              Λ
                              
                                 n
                                 t
                              
                              C
                           
                           
                              (
                              ·
                              )
                           
                        
                      is plugged into the Revenue function (2.2) of the trader. If 
                        
                           
                              θ
                              
                                 f
                                 n
                                 t
                              
                              C
                           
                           >
                           0
                        
                      for all f, n, t, all traders diversify their consumers. Since we indeed observe that traders diversify their consumers in the real world, for instance to reduce risks associated with the counter-party, we conclude that 
                        
                           
                              θ
                              
                                 f
                                 n
                                 t
                              
                              C
                           
                           >
                           0
                        
                      for all f, n, t can be justified from an economic perspective and the resulting volume sold 
                        
                           q
                           
                              f
                              n
                              t
                           
                           C
                        
                      is well defensible. Hence, in practice it might be preferable to assign a small positive value to the market power parameter 
                        
                           θ
                           
                              f
                              n
                              t
                           
                           C
                        
                      of perfectly competitive traders, since the resulting volumes sold 
                        
                           q
                           
                              f
                              n
                              t
                           
                           C
                        
                      are unambiguous and plausible, and the exploration of the solution space can be circumvented.

The remaining volume flows 
                        
                           
                              q
                              
                                 Z
                                 
                                    ′
                                    ′
                                 
                              
                           
                           ,
                        
                      
                     Z′′ ∈ {I, X, A, B} do not attain unique solutions in the simulations (Table 4.1). On one hand, we could again achieve uniqueness by enforcing the elements in the diagonal of D, Dii
                     , to be larger than zero for those i for which 
                        
                           
                              x
                              i
                           
                           =
                           
                              q
                              
                                 f
                                 z
                                 t
                              
                              
                                 Z
                                 
                                    ′
                                    ′
                                 
                              
                           
                        
                     . This would simplify the interpretation of the results but is not justifiable from an economic perspective: Dii
                      > 0 implies that the corresponding trader f diversifies service Z′′ in z and t, because Dii
                      is a cost on 
                        
                           
                              (
                              
                                 q
                                 
                                    f
                                    z
                                    t
                                 
                                 
                                    Z
                                    
                                       ′
                                       ′
                                    
                                 
                              
                              )
                           
                           2
                        
                     . This is slightly more difficult to see from the model Eqs. (B.1), because no such term on 
                        
                           
                              (
                              
                                 q
                                 
                                    f
                                    z
                                    t
                                 
                                 
                                    Z
                                    
                                       ′
                                       ′
                                    
                                 
                              
                              )
                           
                           2
                        
                      existed in the original problem (2.19). However, by adding 
                        
                           
                              D
                              
                                 i
                                 i
                              
                           
                           
                              q
                              
                                 f
                                 z
                                 t
                              
                              
                                 Z
                                 
                                    ′
                                    ′
                                 
                              
                           
                        
                      to the corresponding inequality in Model (B.1), the analogy to the term 
                        
                           −
                           
                              θ
                              
                                 f
                                 n
                                 t
                              
                              C
                           
                           
                              SLP
                              
                                 n
                                 t
                              
                              C
                           
                           
                              q
                              
                                 f
                                 n
                                 t
                              
                              C
                           
                        
                      in Eq. (B.1f) becomes obvious, which in turn was derived from the Revenue function (2.2) and can be interpreted as a quadratic cost term as discussed above. However, traders in the real world often receive quantity discounts from service providers and therefore rarely diversify. This would correspond to Dii
                      < 0, which would lead to an overall non-convex problem and is therefore not considered here.

On the other hand, in practice multiple market equilibria can indeed be in line with a given situation, as illustrated by the following example: assume multiple traders which are moving gas from one node to another. The two nodes are interconnected by two different paths, of which the path with lower marginal costs is congested. In equilibrium, the costs for moving gas from one node to the other one are equal for all traders regardless of the path they are using, because the congestion fee charged on the cheaper path is equal to the difference in marginal costs of the two paths. Hence, which trader will eventually use which path in reality is due to factors that cannot at first glance be related to the model, such as the trader’s preferences, the point in time the capacity is booked, historical reasons, etc. We therefore recommend not to alter the model structure and instead analyze the solution space as a whole when the interpretation of these variables is of interest.

For all other variables we cannot guarantee uniqueness although they are unique in the presented example, as Table 4.1 indicates. This is particularly disadvantageous when it comes to the volumes processed by the service providers sZ
                     , and the corresponding service prices λZ
                     , since these variables are valuable for planning infrastructure expansions. In fact, we can easily find counterexamples showing that sZ
                      and λZ
                      are not unique in general: Assume 2 uncongested paths with identical start and end nodes running through different intermediate nodes. If the marginal costs for gas transportation are equal on both paths, then multiple optimal sA
                      exist. Now assume a path through 3 nodes, where the second node is only connected to the start and end node. If both arcs are congested, λA
                      is not unique; only the sum of all λA
                      of these two arcs is unique (see also Egging, 2010, p. 231). Similar examples can also be found for the other services. This said, when models reproduce a real world network, situations with non-unique sZ
                      and λZ
                      are rare, and therefore the interpretation of these variables is often facilitated. Nonetheless, the entire solution space has to be explored to guarantee uniqueness.

Finally, we discuss extensions of our results to more involved models. A first group comprises the stochastic versions of the WGM introduced by Zhuang and Gabriel (2008) and Gabriel et al. (2009). In these models the intercept INTC
                      and slope SLPC
                      of the inverse demand functions are randomized (within the usual bounds, INTC
                      > 0 and SLPC
                      < 0), and the possible realizations are reflected by a scenario tree. Since our results are valid for any INTC
                      > 0 and SLPC
                      < 0, we can conclude that the decision variables of the individual tree nodes suffer from the ambiguity described above, and therefore, the overall outcome of the model is ambiguous as well.

Another popular extension is the introduction of convex logarithmic terms in the production cost functions. Since the uniqueness-result derived in Appendix C holds for any strictly convex production cost function, we conclude that the produced volume qP
                      is also unique for this group of models. Furthermore, the solution space 
                        S
                      is polyhedral and can be described similarly as before (Section 3.3): First, we solve the non-linear complementarity problem 0 ⪯ K(x)⊥x ≽ 0 and obtain a solution 
                        
                           x
                           ^
                        
                     . Second, we express 
                        S
                      by means of K(x), x and 
                        
                           x
                           ^
                        
                     : We set 
                        
                           
                              q
                              P
                           
                           =
                           
                              
                                 q
                                 ^
                              
                              P
                           
                        
                      and insert the numerical values into K(x), which leads to an affine 
                        
                           K
                           
                              (
                              x
                              )
                           
                           =
                           
                              M
                              ¯
                           
                           x
                           +
                           
                              b
                              ¯
                           
                        
                     . Finally, we solve the Linear Problem (3.9) and obtain the extreme points of interest 
                        
                           
                              x
                              
                                 i
                                 ,
                                 +
                              
                           
                           ,
                        
                     
                     
                        
                           
                              x
                              
                                 i
                                 ,
                                 −
                              
                           
                           ∈
                           S
                        
                     .

A further example are the introduced and then dropped constraints (2.10)–(2.13) on the volume flows qC
                      and qZ
                     . They would be reflected by additional terms in the Karush–Kuhn–Tucker conditions (2.19). However, the fundamental properties of matrix M, particularly positive semi-definiteness and diagonality of 
                        
                           M
                           +
                           
                              M
                              T
                           
                           ,
                        
                      remain unchanged, and thus the derived results regarding existence and uniqueness of the solutions extend to models including constraints (2.10)–(2.13).

@&#CONCLUSIONS@&#

In this paper we introduced a SPE-CV model for the natural gas market. We specified affine costs for the service providers, quadratic costs for gas production, and affine inverse demand, and hence represented our model as linear complementarity problem. We proved that a solution to the given problem always exists and derived criteria for uniqueness of the individual components. Finally, we presented a numerical example confirming our theoretical findings and illustrating the main difficulties for the interpretation of the results.

Our findings indicate that most of the relevant variables for decision-making are unique in the presented model setting. However, one has to be particularly careful when drawing conclusions about the volume flows between the traders contract with the service providers, and the traders sell to the consumers if the traders do not exert market power, since in these cases the model allows multiple market equilibria for a fixed set of parameter values. The obtained set of solutions 
                        S
                      isolates the possible market equilibria, but which of the equilibria will materialize in practice cannot be predicted without further specifying the traders’ preferences.

The situation is even more difficult when one tries to compare market equilibria computed under different sets of parameter values: different results for the above quantities may not be due exclusively to the different parameter values, but also to non-uniqueness of the solution for each set of parameter values. In the worst case, the direction of change of some variables is ambiguous, and therefore no trend can be predicted from the simulation results.

Fortunately, we can guarantee uniqueness in the gas sales of individual traders to consumers qC
                     , perhaps the most important non-unique variable in the model, by assuming that all traders exert at least some market power. Moreover, we showed that a trader exerting market power over a group of consumers is mathematically equivalent to a trader diversifying its consumers. Since most of the traders in the real world aim for some consumer diversification, we conclude that this is a practicable approach to enforce uniqueness in qC
                     , and that the computed qC
                      is sensible from an economic perspective.

Since
                      our findings are linked to the mathematical structure of the model, they are not limited to gas markets in particular. Instead, they apply to any other oligopolistic market which is representable by the introduced model formulation. In fact, the results also hold if the presented structure is part of a larger model, for instance one including multiple energy carriers as proposed by Huppmann and Egging (2014), and therefore may be useful in a large field of applications.

@&#ACKNOWLEDGMENTS@&#

We would like to thank our colleague Dr. Peyman Esfahani for the helpful discussions on uniqueness of solutions of linear complementarity programs, and Prof. Ruud Egging and the four anonymous reviewers for their valuable comments.

​
                     
                     
                  


                     
                        
                           (B.1a)
                           
                              
                                 
                                    
                                       0
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             LINC
                                             
                                                n
                                                t
                                             
                                             P
                                          
                                          +
                                          
                                             QUAC
                                             
                                                n
                                                t
                                             
                                             P
                                          
                                          
                                             q
                                             
                                                f
                                                n
                                                t
                                             
                                             P
                                          
                                          +
                                          
                                             α
                                             
                                                n
                                                t
                                             
                                             P
                                          
                                          +
                                          
                                             α
                                             n
                                             
                                                P
                                                T
                                             
                                          
                                          −
                                          
                                             ϕ
                                             
                                                f
                                                n
                                                t
                                             
                                             N
                                          
                                          ⊥
                                          
                                             q
                                             
                                                f
                                                n
                                                t
                                             
                                             P
                                          
                                          ≥
                                          0
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ∀
                                          f
                                          ,
                                          n
                                          ,
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.1b)
                           
                              
                                 
                                    
                                       0
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             LINC
                                             
                                                n
                                                t
                                             
                                             I
                                          
                                          +
                                          
                                             α
                                             
                                                n
                                                t
                                             
                                             I
                                          
                                          +
                                          
                                             α
                                             n
                                             
                                                I
                                                T
                                             
                                          
                                          +
                                          
                                             ϕ
                                             
                                                f
                                                n
                                                t
                                             
                                             N
                                          
                                          −
                                          
                                             ϕ
                                             
                                                f
                                                n
                                             
                                             S
                                          
                                          ⊥
                                          
                                             q
                                             
                                                f
                                                n
                                                t
                                             
                                             I
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          f
                                          ,
                                          n
                                          ,
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.1c)
                           
                              
                                 
                                    
                                       0
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             LINC
                                             
                                                z
                                                t
                                             
                                             X
                                          
                                          +
                                          
                                             α
                                             
                                                n
                                                t
                                             
                                             X
                                          
                                          +
                                          
                                             α
                                             n
                                             
                                                X
                                                T
                                             
                                          
                                          −
                                          
                                             ϕ
                                             
                                                f
                                                n
                                                t
                                             
                                             N
                                          
                                          +
                                          
                                             ϕ
                                             
                                                f
                                                n
                                             
                                             S
                                          
                                          ⊥
                                          
                                             q
                                             
                                                f
                                                n
                                                t
                                             
                                             X
                                          
                                          ≥
                                          0
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ∀
                                          f
                                          ,
                                          n
                                          ,
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.1d)
                           
                              
                                 
                                    
                                       0
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             LINC
                                             
                                                n
                                                m
                                                t
                                             
                                             A
                                          
                                          +
                                          
                                             α
                                             
                                                n
                                                m
                                                t
                                             
                                             A
                                          
                                          +
                                          
                                             α
                                             
                                                n
                                                m
                                             
                                             
                                                A
                                                T
                                             
                                          
                                          −
                                          
                                             ϕ
                                             
                                                f
                                                m
                                                t
                                             
                                             N
                                          
                                          +
                                          
                                             ϕ
                                             
                                                f
                                                n
                                                t
                                             
                                             N
                                          
                                          ⊥
                                          
                                             q
                                             
                                                f
                                                n
                                                m
                                                t
                                             
                                             A
                                          
                                          ≥
                                          0
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ∀
                                          f
                                          ,
                                          n
                                          ,
                                          m
                                          ,
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.1e)
                           
                              
                                 
                                    
                                       0
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             LINC
                                             
                                                n
                                                t
                                             
                                             L
                                          
                                          +
                                          
                                             α
                                             
                                                n
                                                t
                                             
                                             L
                                          
                                          +
                                          
                                             α
                                             n
                                             
                                                L
                                                T
                                             
                                          
                                          +
                                          
                                             LINC
                                             
                                                n
                                                m
                                                t
                                             
                                             B
                                          
                                          +
                                          
                                             α
                                             
                                                n
                                                m
                                                t
                                             
                                             B
                                          
                                          +
                                          
                                             α
                                             
                                                n
                                                m
                                             
                                             
                                                B
                                                T
                                             
                                          
                                          +
                                          
                                             LINC
                                             
                                                m
                                                t
                                             
                                             R
                                          
                                          +
                                          
                                             α
                                             
                                                m
                                                t
                                             
                                             R
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             α
                                             m
                                             
                                                R
                                                T
                                             
                                          
                                          −
                                          
                                             ϕ
                                             
                                                f
                                                m
                                                t
                                             
                                             N
                                          
                                          +
                                          
                                             ϕ
                                             
                                                f
                                                n
                                                t
                                             
                                             N
                                          
                                          ⊥
                                          
                                             q
                                             
                                                f
                                                n
                                                m
                                                t
                                             
                                             B
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          f
                                          ,
                                          n
                                          ,
                                          m
                                          ,
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.1f)
                           
                              
                                 
                                    
                                       0
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          −
                                          
                                             λ
                                             
                                                n
                                                t
                                             
                                             C
                                          
                                          −
                                          
                                             θ
                                             
                                                f
                                                n
                                                t
                                             
                                             C
                                          
                                          
                                             SLP
                                             
                                                n
                                                t
                                             
                                             C
                                          
                                          
                                             q
                                             
                                                f
                                                n
                                                t
                                             
                                             C
                                          
                                          +
                                          
                                             ϕ
                                             
                                                f
                                                n
                                                t
                                             
                                             N
                                          
                                          ⊥
                                          
                                             q
                                             
                                                f
                                                n
                                                t
                                             
                                             C
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          f
                                          ,
                                          n
                                          ,
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.1g)
                           
                              
                                 
                                    
                                       0
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             q
                                             
                                                f
                                                n
                                                t
                                             
                                             P
                                          
                                          +
                                          
                                             q
                                             
                                                f
                                                n
                                                t
                                             
                                             X
                                          
                                          +
                                          
                                             ∑
                                             
                                                m
                                                ∈
                                                A
                                                (
                                                n
                                                )
                                             
                                          
                                          
                                             q
                                             
                                                f
                                                m
                                                n
                                                t
                                             
                                             A
                                          
                                          +
                                          
                                             ∑
                                             
                                                m
                                                ∈
                                                B
                                                (
                                                n
                                                )
                                             
                                          
                                          
                                             q
                                             
                                                f
                                                m
                                                n
                                                t
                                             
                                             B
                                          
                                          −
                                          
                                             q
                                             
                                                f
                                                n
                                                t
                                             
                                             I
                                          
                                          −
                                          
                                             q
                                             
                                                f
                                                n
                                                t
                                             
                                             C
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             ∑
                                             
                                                m
                                                ∈
                                                A
                                                (
                                                n
                                                )
                                             
                                          
                                          
                                             q
                                             
                                                f
                                                n
                                                m
                                                t
                                             
                                             A
                                          
                                          −
                                          
                                             ∑
                                             
                                                m
                                                ∈
                                                B
                                                (
                                                n
                                                )
                                             
                                          
                                          
                                             q
                                             
                                                f
                                                n
                                                m
                                                t
                                             
                                             B
                                          
                                          ⊥
                                          
                                             ϕ
                                             
                                                f
                                                n
                                                t
                                             
                                             N
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          f
                                          ,
                                          n
                                          ,
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.1h)
                           
                              
                                 
                                    
                                       0
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             q
                                             
                                                f
                                                n
                                                t
                                             
                                             I
                                          
                                          −
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             q
                                             
                                                f
                                                n
                                                t
                                             
                                             X
                                          
                                          ⊥
                                          
                                             ϕ
                                             
                                                f
                                                n
                                             
                                             S
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          f
                                          ,
                                          n
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.1i)
                           
                              
                                 
                                    
                                       0
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             
                                                CAP
                                                ¯
                                             
                                             
                                                z
                                                t
                                             
                                             Z
                                          
                                          −
                                          
                                             ∑
                                             
                                                f
                                                ∈
                                                F
                                                (
                                                z
                                                )
                                             
                                          
                                          
                                             q
                                             
                                                f
                                                z
                                                t
                                             
                                             Z
                                          
                                          ⊥
                                          
                                             α
                                             
                                                z
                                                t
                                             
                                             Z
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          z
                                          ,
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.1j)
                           
                              
                                 
                                    
                                       0
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             
                                                CAP
                                                ¯
                                             
                                             z
                                             
                                                Z
                                                D
                                             
                                          
                                          −
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             ∑
                                             
                                                f
                                                ∈
                                                F
                                                (
                                                z
                                                )
                                             
                                          
                                          
                                             q
                                             
                                                f
                                                z
                                                t
                                             
                                             Z
                                          
                                          ⊥
                                          
                                             α
                                             z
                                             
                                                Z
                                                T
                                             
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          z
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.1k)
                           
                              
                                 
                                    
                                       0
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                          
                                             λ
                                             
                                                n
                                                t
                                             
                                             C
                                          
                                          −
                                          
                                             (
                                             
                                                INT
                                                
                                                   n
                                                   t
                                                
                                                C
                                             
                                             +
                                             
                                                SLP
                                                
                                                   n
                                                   t
                                                
                                                C
                                             
                                             
                                                ∑
                                                
                                                   f
                                                   ∈
                                                   F
                                                   (
                                                   n
                                                   )
                                                
                                             
                                             
                                                q
                                                
                                                   f
                                                   n
                                                   t
                                                
                                                C
                                             
                                             )
                                          
                                          ⊥
                                          
                                             λ
                                             
                                                n
                                                t
                                             
                                             C
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          n
                                          ,
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                  

Problem (3.4), provided feasible, is equivalent to Problem (C.1).

                        
                           (C.1)
                           
                              
                                 
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      min
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                         T
                                                      
                                                      Q
                                                      x
                                                      +
                                                      
                                                         b
                                                         T
                                                      
                                                      x
                                                   
                                                
                                             
                                             
                                                
                                                   s.t.
                                                
                                                
                                                   
                                                      M
                                                      x
                                                      +
                                                      b
                                                      ≥
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      x
                                                      ≥
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          ,
                                          
                                          where
                                          
                                          Q
                                          =
                                          
                                             [
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      E
                                                   
                                                
                                             
                                             ]
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     The properties of 
                        
                           A
                           ∈
                           
                              R
                              
                                 r
                                 ×
                                 r
                              
                           
                        
                      and E imply that 
                        
                           Q
                           ∈
                           
                              R
                              
                                 p
                                 ×
                                 p
                              
                           
                        
                      is diagonal and positive semi-definite. We are interested in the behavior of the solution 
                        
                           x
                           ^
                        
                      under perturbation of the diagonal elements of M and Q. The diagonal elements 
                        
                           
                              M
                              
                                 i
                                 i
                              
                           
                           =
                           
                              Q
                              
                                 i
                                 i
                              
                           
                           ∈
                           
                              A
                              i
                           
                           ⊂
                           
                              R
                              0
                              +
                           
                        
                     . 
                        
                           A
                           i
                        
                      is referred to as the admissible set for element i, for which the problem remains feasible for all 
                        
                           
                              M
                              
                                 i
                                 i
                              
                           
                           ∈
                           
                              A
                              i
                           
                        
                     . We rewrite Problem (C.1) in a more general setting as a parametric convex program:

                        
                           (C.2)
                           
                              
                                 
                                    
                                       
                                          
                                             P
                                             *
                                          
                                          
                                             (
                                             
                                                M
                                                
                                                   i
                                                   i
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         min
                                                         
                                                            
                                                               x
                                                               i
                                                            
                                                            ,
                                                            
                                                               x
                                                               J
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         f
                                                         (
                                                         
                                                            x
                                                            i
                                                         
                                                         ,
                                                         
                                                            x
                                                            J
                                                         
                                                         ,
                                                         
                                                            M
                                                            
                                                               i
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      s.t.
                                                   
                                                   
                                                      
                                                         g
                                                         
                                                            (
                                                            
                                                               x
                                                               J
                                                            
                                                            )
                                                         
                                                         +
                                                         k
                                                         
                                                            (
                                                            
                                                               x
                                                               i
                                                            
                                                            ,
                                                            
                                                               M
                                                               
                                                                  i
                                                                  i
                                                               
                                                            
                                                            )
                                                         
                                                         ≥
                                                         0
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           J
                           =
                           {
                           1
                           ,
                           …
                           ,
                           p
                           }
                           ∖
                           {
                           i
                           }
                        
                     . Problem (C.2) can be described in the framework of (C.1) by setting

                        
                           (C.3)
                           
                              
                                 
                                    
                                       
                                          f
                                          (
                                          
                                             x
                                             i
                                          
                                          ,
                                          
                                             x
                                             J
                                          
                                          ,
                                          
                                             M
                                             
                                                i
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          =
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             (
                                             
                                                Q
                                                
                                                   j
                                                   j
                                                
                                             
                                             
                                                x
                                                j
                                                2
                                             
                                             +
                                             
                                                b
                                                j
                                             
                                             
                                                x
                                                j
                                             
                                             )
                                          
                                          +
                                          
                                             M
                                             
                                                i
                                                i
                                             
                                          
                                          
                                             x
                                             i
                                             2
                                          
                                          +
                                          
                                             b
                                             i
                                          
                                          
                                             x
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (C.4)
                           
                              
                                 
                                    
                                       
                                          g
                                          
                                             (
                                             
                                                x
                                                J
                                             
                                             )
                                          
                                          +
                                          k
                                          
                                             (
                                             
                                                x
                                                i
                                             
                                             ,
                                             
                                                M
                                                
                                                   i
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          =
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         M
                                                         
                                                            i
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         M
                                                         
                                                            i
                                                            J
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         M
                                                         
                                                            J
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         M
                                                         
                                                            J
                                                            J
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          ·
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         x
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                         J
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          +
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         b
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         b
                                                         J
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (C.5)
                           
                              
                                 
                                    
                                       
                                          =
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         M
                                                         
                                                            i
                                                            J
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         M
                                                         
                                                            J
                                                            J
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             x
                                             J
                                          
                                          +
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         M
                                                         
                                                            i
                                                            i
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         M
                                                         
                                                            J
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             x
                                             i
                                          
                                          +
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         b
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         b
                                                         J
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

We base our analysis on Problem (C.2) and on the following assumptions:

                        
                           (i)
                           
                              xJ
                              ↦g(xJ
                              ) convex,


                              xi
                              ↦k(xi, Mii
                              ) convex for all 
                                 
                                    
                                       M
                                       
                                          i
                                          i
                                       
                                    
                                    ∈
                                    
                                       R
                                       
                                          
                                             M
                                             
                                                i
                                                i
                                             
                                          
                                          ≥
                                          0
                                       
                                    
                                    ,
                                 
                              
                           

(xi, xJ
                              )↦f(xi, xJ, Mii
                              ) convex for all 
                                 
                                    
                                       M
                                       
                                          i
                                          i
                                       
                                    
                                    ∈
                                    
                                       R
                                       
                                          
                                             M
                                             
                                                i
                                                i
                                             
                                          
                                          ≥
                                          0
                                       
                                    
                                    ,
                                 
                              
                           

If xi
                           ↦f(xi, xJ, Mii
                           ) is a strictly convex mapping for all xJ
                           , the optimizer of Problem (C.2) admits a unique i-component.

For the sake of contradiction, suppose 
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                x
                                                ^
                                             
                                             i
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                x
                                                ^
                                             
                                             J
                                             1
                                          
                                       
                                    
                                 
                                 ]
                              
                            and 
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                x
                                                ^
                                             
                                             i
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                x
                                                ^
                                             
                                             J
                                             2
                                          
                                       
                                    
                                 
                                 ]
                              
                            are two optimizers, where 
                              
                                 
                                    
                                       x
                                       ^
                                    
                                    i
                                    1
                                 
                                 ≠
                                 
                                    
                                       x
                                       ^
                                    
                                    i
                                    2
                                 
                              
                           . Then, clearly 
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                1
                                                2
                                             
                                             
                                                
                                                   x
                                                   ^
                                                
                                                i
                                                1
                                             
                                             +
                                             
                                                1
                                                2
                                             
                                             
                                                
                                                   x
                                                   ^
                                                
                                                i
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                1
                                                2
                                             
                                             
                                                
                                                   x
                                                   ^
                                                
                                                J
                                                1
                                             
                                             +
                                             
                                                1
                                                2
                                             
                                             
                                                
                                                   x
                                                   ^
                                                
                                                J
                                                2
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                            is a feasible point with a lower objective value.□

In the specific case of Problem (C.1), note that (i) strict convexity in xi
                     ↦f(xi, xJ, Mii
                     ) for all xJ
                      implies Mii
                      > 0, and (ii) the problem is feasible in particular for all 
                        
                           
                              A
                              
                                 i
                                 i
                              
                           
                           ∈
                           
                              R
                              
                                 
                                    A
                                    
                                       i
                                       i
                                    
                                 
                                 ≥
                                 0
                              
                           
                           ,
                        
                     
                     
                        
                           i
                           ∈
                           {
                           1
                           ,
                           …
                           ,
                           r
                           }
                           ,
                        
                      since there always exists a solution 
                        
                           x
                           ^
                        
                      with 
                        
                           
                              x
                              i
                           
                           =
                           0
                        
                      for all 
                        
                           i
                           ∈
                           {
                           1
                           ,
                           …
                           ,
                           r
                           }
                        
                      (Section 3.2).

​
                     
                  

@&#REFERENCES@&#

