@&#MAIN-TITLE@&#A software platform for phase contrast x-ray breast imaging research

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A simulation platform dedicated for PhC x-ray breast imaging research is developed.


                        
                        
                           
                           Various in complexity phantoms for PhC (from simple cuboids to anthropomorphic breasts) are modelled.


                        
                        
                           
                           Generation of PhC images from thick objects (breast models) is now feasible.


                        
                        
                           
                           Simulation results are validated against measurements performed at ESRF.


                        
                        
                           
                           Experimental studies on PhC may be optimized in advance.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Phase contrast imaging

In-line x-ray Imaging

Modelling and simulation

Synchrotron facilities

Breast imaging

Breast phantoms

@&#ABSTRACT@&#


               
               
                  Purpose
                  To present and validate a computer-based simulation platform dedicated for phase contrast x-ray breast imaging research.
               
               
                  Methods
                  The software platform, developed at the Technical University of Varna on the basis of a previously validated x-ray imaging software simulator, comprises modules for object creation and for x-ray image formation. These modules were updated to take into account the refractive index for phase contrast imaging as well as implementation of the Fresnel–Kirchhoff diffraction theory of the propagating x-ray waves. Projection images are generated in an in-line acquisition geometry. To test and validate the platform, several phantoms differing in their complexity were constructed and imaged at 25keV and 60keV at the beamline ID17 of the European Synchrotron Radiation Facility. The software platform was used to design computational phantoms that mimic those used in the experimental study and to generate x-ray images in absorption and phase contrast modes.
               
               
                  Results
                  The visual and quantitative results of the validation process showed an overall good correlation between simulated and experimental images and show the potential of this platform for research in phase contrast x-ray imaging of the breast. The application of the platform is demonstrated in a feasibility study for phase contrast images of complex inhomogeneous and anthropomorphic breast phantoms, compared to x-ray images generated in absorption mode.
               
               
                  Conclusions
                  The improved visibility of mammographic structures suggests further investigation and optimisation of phase contrast x-ray breast imaging, especially when abnormalities are present. The software platform can be exploited also for educational purposes.
               
            

@&#INTRODUCTION@&#

X-ray breast imaging modalities like the traditional two-dimensional (2D) mammography and the advanced three-dimensional (3D) breast tomosynthesis use low-dose projection images of the breast acquired with dedicated x-ray based mammography systems. In 2D mammography, the typical breast screening exam includes two x-ray images of each breast taken at craniocaudal and mediolateral oblique views. In breast tomosynthesis, a limited number of x-ray projection images of the breast (typically 9 to 25) are acquired, while the x-ray source and the detector rotate along an arc around the breast. The projection images are then used with reconstruction techniques to provide a pseudo 3D image of the breast. In such exams, the total absorbed dose in the breast is typically in the order of a few mGy (0.6 to 4.0mGy) [1,2]. Each mammogram presents a 2D distribution of the intensity of the x-rays reaching the detector. This type of projection imaging is based on the absorption properties of the various breast tissues and when applied to dense breasts, it may impair the task of diagnosing tumour-like structures due to the superposition of large areas of normal glandular tissue. The overlapping of tissue structures is partly removed in the 3D tomosynthesis acquisition. However, an additional limitation of such 2D or 3D imaging modalities applied to the breast, is that they are based on x-ray absorption in the breast, where attenuation coefficients of normal and cancerous breast structures (like invasive/non-invasive ductal and lobular carcinoma) are very close and the resulting subject contrast is less than 10%, typically [3,4].

Phase-contrast (PhC) imaging uses a different approach that has proved to increase the visibility of internal details in objects (e.g. biological tissues) composed of elements with low atomic number [5]. PhC exploits the differences between the refractive index of different materials to improve the visibility between these structures in 2D x-ray images. Different techniques have been developed for detecting PhC effects. In the in-line (or so-called propagation based) PhC imaging, contrast enhancement effects are produced with an x-ray source characterized by a certain degree of lateral spatial coherence, by recording the diffracted and refracted wave field downstream of the irradiated object, with a suitable high resolution area detector [5,6]. In such a scheme, the visual appearance of PhC effects in the final image is a characteristic contrast enhancement at the interfaces between structures with different x-ray refractive indices.

The clinical implementation of every new imaging modality, however, is preceded by an optimisation work focussed on optimal energy and acquisition geometries which both depend on the sample, type of the detectors and phase retrieval algorithms in respect to the visibility of structures of interest (breast lesions). The best approach to carry out optimisation work is by the use of computer modelling and simulation.

Most computer simulations performed in the field of PhC are limited to the use of simple phantoms, composed of few geometrical forms like cylinders and spheres that approximate fibers and tumours in the breast tissue. These geometries are adopted in investigations on the optimal geometrical distances like the distance object-to-detector as a function of the object shape and its size [7–11]. Investigations also focussed on the influence of the pixel dimensions on the PhC signal [10], on the development of phase retrieval algorithms [11], to study the suitability of inverse Compton sources for PhC mammography [12], on comparison of several methods for phase retrieval for CT imaging [13,14]. All these are carried for in-line phase contrast. These simple phantoms play an important role in setting and optimising the imaging technique. Computational phantoms characterised with increased complexity are also required to test and evaluate the performance of advanced 3D imaging techniques. In the case of breast imaging, the use of advanced breast phantoms would allow to perform accurate breast dosimetry, to investigate the effect of different imaging acquisition parameters on the quality of breast structures on images, to test and optimise novel and existing reconstruction techniques, etc. Recent simulations in the field of in-line PhC mammography were performed with an average compressed breast modelled as a homogeneous slab and abnormalities represented by spheres and cylinders with different diameters [12,15–17]. Further investigations in this field, however, require simulations with more complex, anthropomorphic breast phantoms.

X-ray PhC effects can be simulated in several ways. One possible approach is the analytical one, based on the wave-optical theory (Fresnel–Kirchhoff diffraction integral and paraxial approximation) [18]. This method allows evaluating the diffraction angle of photons exiting from the object by means of simple equations [19]. In some papers, the Wigner distribution formalism was applied to modelling the phase effects [20]. Another approach is the use of an advanced wave-optical method proposed by Bravin et al. [21]. The approach was applied successfully to simulate diffraction enhanced x-ray imaging with large and thick objects, eliminating the assumption of the usual ‘weak object approximation’. Monte Carlo methods were utilised to simulate the refractive x-ray interactions [15,22,23]. However, the use of Monte Carlo techniques is still a challenge in the field of PhC imaging and simulations are still at the initial stage.

There are few published simulation platforms for PhC dedicated to 2D and 3D x-ray breast imaging. The most complete one is the Virtual X-ray Imaging (VXI) [9,19], based on a computer code dedicated to the simulation of radiographic, radioscopic or tomographic procedures [24,25]. The PhC effects are simulated based on the Fresnel–Kirchhoff integral and they can be integrated with computer-aided design objects and objects based on non-uniform rational B-spline. The usefulness and application of this code have been shown by simulating simple objects like cylinders and spheres as well as objects of different shapes embedded into a 1.5-mm thick bounding box.

Our goal is to develop and evaluate algorithms for volumetric breast reconstructions from PhC x-ray projection images, obtained in a tomosynthesis setup. The first stage of this project aims at the development of a software tool for generation of PhC x-ray images from simple phantoms as well as from more complex breast-like models. This paper presents the results from the development, validation and the initial testing of the simulation platform dedicated to PhC breast imaging studies. The validation study involved comparison of simulated images of simple phantoms with those obtained from experimental work carried out at the European Synchrotron Radiation Facility (ESRF), Grenoble, France. The in-line (or so-called propagation based) acquisition geometry was used [6]. The developed platform was exploited to generate PhC x-ray images from complex inhomogeneous and anthropomorphic breast phantoms.


                        
                        Fig. 1 shows the in-line configuration adapted for simulation of PhC x-ray images. The wave propagation is modelled based on the Fresnel–Kirchhoff diffraction theory [18]. A pure coherent radiation of wavelength λ is considered, emerging from a point-like monochromatic source, located at a distance z
                        
                           so
                         from the object plane. The object is placed in a plane located at z=0 and the detector is located at a distance z
                        
                           od
                         from the object plane.

The electric wave field in the free space, detected at a distance r from the source, has the following expression:
                           
                              (1)
                              
                                 E
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    A
                                    r
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       k
                                       r
                                    
                                 
                                 =
                                 
                                    A
                                    r
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       k
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   z
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where A is the amplitude of the wave that originates in the source point (x
                        
                           s
                        , y
                        
                           s
                        ) located in the source plane, (x
                        
                           i
                        , y
                        
                           i
                        ) are the coordinates of the detection point on the detector plane, r
                        2=(x
                        
                           i
                        
                        2+y
                        
                           i
                        
                        2), z=z
                        
                           so
                        +z
                        
                           od
                        , while 
                           k
                           =
                           
                              
                                 2
                                 π
                              
                              λ
                           
                         is the wavenumber. In mammography, incident x-ray photons are in the energy range 10–32keV, with a mean photon energy in the range 17–22keV. For this range, the corresponding wavelength, λ varies between 56pm and 73pm. Since the tissue features of diagnostic interest in the breast have much greater size compared to these wavelengths, then one can apply the small angle approximation [z
                        2
                        
                           ≫
                        (x
                        
                           i
                        −x
                        
                           s
                        )2+(y
                        
                           i
                        −y
                        
                           s
                        )2] to Eq. (1), which then becomes
                           
                              (2)
                              
                                 E
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    A
                                    r
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       k
                                       r
                                    
                                 
                                 =
                                 
                                    A
                                    r
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       k
                                       z
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       k
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                          
                                             2
                                             z
                                          
                                       
                                    
                                 
                              
                           
                        
                     

When a wave interacts with an object, both its amplitude and phase are modified. The waves (either interacting or not) detected at a point (x
                        
                           i
                        , y
                        
                           i
                        ) in the detector plane then may be expressed in the following form:
                           
                              (3)
                              
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 −
                                 
                                    i
                                    λ
                                 
                                 
                                    ∬
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       o
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       o
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       o
                                    
                                 
                                 )
                                 OTF
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                          
                                             o
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             o
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             i
                                             k
                                             
                                                
                                                   r
                                                
                                                
                                                   o
                                                   d
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             r
                                          
                                          
                                             o
                                             d
                                          
                                       
                                    
                                 
                                 
                                 cos
                                 
                                    (
                                    θ
                                    )
                                 
                                 d
                                 
                                    
                                       x
                                    
                                    
                                       o
                                    
                                 
                                 d
                                 
                                    
                                       y
                                    
                                    
                                       o
                                    
                                 
                              
                           
                        where (x
                        
                           o
                        ,y
                        
                           o
                        ) are the coordinates of a point in the object plane, which becomes a source of new wave, and E
                        0 is the incident upon the object plane (z=0) wave (
                           E
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                    
                                       o
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       o
                                    
                                 
                              
                              )
                           
                           =
                           (
                           A
                           /
                           
                              
                                 r
                              
                              
                                 s
                                 o
                              
                           
                           )
                           
                              
                                 e
                              
                              
                                 i
                                 k
                                 
                                    
                                       r
                                    
                                    
                                       s
                                       o
                                    
                                 
                              
                           
                        ). The cos(θ) term corresponds to the Fresnel’s assumption that only the forward-propagating part of the spherical waves is to be retained. The function OTF is the object transmission function and it is a 2D function in a plane perpendicular to the x-ray projection direction, placed close behind the object:
                           
                              (4)
                              
                                 OTF
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                          
                                             o
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             o
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       
                                          ∫
                                          0
                                          s
                                       
                                       i
                                       δ
                                       (
                                       r
                                       )
                                       
                                          
                                             2
                                             π
                                          
                                          λ
                                       
                                       d
                                       r
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       
                                          ∫
                                          0
                                          s
                                       
                                       
                                          
                                             µ
                                             (
                                             r
                                             )
                                          
                                          2
                                       
                                       d
                                       r
                                    
                                 
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       i
                                       
                                          
                                             2
                                             π
                                          
                                          λ
                                       
                                       
                                          ∫
                                          0
                                          s
                                       
                                       δ
                                       (
                                       r
                                       )
                                       d
                                       r
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       
                                          ∫
                                          0
                                          s
                                       
                                       
                                          
                                             µ
                                             (
                                             r
                                             )
                                          
                                          2
                                       
                                       d
                                       r
                                    
                                 
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       B
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   o
                                                
                                             
                                             ,
                                             
                                                
                                                   y
                                                
                                                
                                                   o
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       Φ
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   o
                                                
                                             
                                             ,
                                             
                                                
                                                   y
                                                
                                                
                                                   o
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        here, Φ and B are the amount of the phase change and amplitude attenuation in traversing the biological tissue, s is the total path through the object, µ(r)=4πβ(r)/λ is the linear attenuation coefficient of the tissue in the specified point, while δ(r) is the refractive index decrement of the tissue and β(r) is the absorption coefficient.

In the case of small angle approximation, Eq. (3) is transformed as follows:
                           
                              (5)
                              
                                 E
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 −
                                 
                                    i
                                    λ
                                 
                                 
                                    A
                                    
                                       
                                          
                                             z
                                          
                                          
                                             s
                                             o
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             o
                                             d
                                          
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       k
                                       z
                                    
                                 
                                 
                                    ∬
                                    
                                 
                                 OTF
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                          
                                             o
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             o
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       k
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   z
                                                
                                                
                                                   s
                                                   o
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       k
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   z
                                                
                                                
                                                   o
                                                   d
                                                
                                             
                                          
                                       
                                    
                                 
                                 d
                                 
                                    
                                       x
                                    
                                    
                                       o
                                    
                                 
                                 d
                                 
                                    
                                       y
                                    
                                    
                                       o
                                    
                                 
                              
                           
                        
                     

Simulations are based on Eq. (5): depending on the distance z
                        
                           od
                         (simulating Fresnel or Fraunhofer approximations), it is numerically solved using either the Fourier transform approach (Eq. (6)) or the convolution approach (Eq. (7)):
                           
                              (6)
                              
                                 
                                    
                                       
                                          E
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             )
                                          
                                          =
                                          −
                                          
                                             
                                                A
                                                i
                                             
                                             
                                                λ
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      s
                                                      o
                                                   
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      o
                                                      d
                                                   
                                                
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                i
                                                k
                                                z
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                
                                                   
                                                      i
                                                      k
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            o
                                                            d
                                                         
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         2
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             ∬
                                             
                                          
                                          
                                             [
                                             
                                                OTF
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      λ
                                                      i
                                                      π
                                                      M
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            o
                                                            d
                                                         
                                                      
                                                      
                                                         [
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 o
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           λ
                                                                           
                                                                              
                                                                                 z
                                                                              
                                                                              
                                                                                 o
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  )
                                                               
                                                               2
                                                            
                                                            +
                                                            
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 y
                                                                              
                                                                              
                                                                                 o
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           λ
                                                                           
                                                                              
                                                                                 z
                                                                              
                                                                              
                                                                                 o
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  )
                                                               
                                                               2
                                                            
                                                         
                                                         ]
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                e
                                             
                                             
                                                −
                                                2
                                                π
                                                i
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            λ
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  o
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            λ
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  o
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          d
                                          
                                             
                                                x
                                             
                                             
                                                o
                                             
                                          
                                          d
                                          
                                             
                                                y
                                             
                                             
                                                o
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          E
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             )
                                          
                                          =
                                          −
                                          
                                             
                                                A
                                                i
                                             
                                             
                                                λ
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      s
                                                      o
                                                   
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      o
                                                      d
                                                   
                                                
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                i
                                                k
                                                z
                                             
                                          
                                          
                                             
                                                P
                                             
                                             
                                                z
                                             
                                          
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          
                                             ∬
                                             
                                          
                                          
                                             [
                                             
                                                OTF
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      z
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      o
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      o
                                                   
                                                
                                                )
                                             
                                             ]
                                          
                                          
                                             
                                                e
                                             
                                             
                                                −
                                                2
                                                π
                                                i
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            λ
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  o
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            λ
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  o
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          d
                                          
                                             
                                                x
                                             
                                             
                                                o
                                             
                                          
                                          d
                                          
                                             
                                                y
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        P
                        z(x
                        
                           i
                        ,y
                        
                           i
                        ) being the Fresnel propagator with unit modulus and M=z/z
                        
                           od
                        .
                           
                              (7)
                              
                                 
                                    
                                       
                                          E
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             )
                                          
                                          =
                                          −
                                          
                                             
                                                A
                                                i
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                      k
                                                      z
                                                   
                                                
                                             
                                             
                                                λ
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      s
                                                      o
                                                   
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      o
                                                      d
                                                   
                                                
                                             
                                          
                                          
                                             ∬
                                             
                                          
                                          OTF
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      o
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      o
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             
                                                e
                                             
                                             
                                                i
                                                k
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  o
                                                               
                                                            
                                                            2
                                                         
                                                         +
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  o
                                                               
                                                            
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            s
                                                            o
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                
                                                   
                                                      i
                                                      k
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            o
                                                            d
                                                         
                                                      
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     o
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                      +
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     o
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                          d
                                          
                                             
                                                x
                                             
                                             
                                                o
                                             
                                          
                                          d
                                          
                                             
                                                y
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                    
                                       
                                          E
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             )
                                          
                                          =
                                          −
                                          
                                             
                                                A
                                                i
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                      k
                                                      z
                                                   
                                                
                                             
                                             
                                                λ
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      s
                                                      o
                                                   
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      o
                                                      d
                                                   
                                                
                                             
                                          
                                          
                                             ∬
                                             
                                          
                                          OTF
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      o
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      o
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             
                                                P
                                             
                                             
                                                z
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      o
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      o
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             
                                                e
                                             
                                             
                                                
                                                   
                                                      i
                                                      k
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            o
                                                            d
                                                         
                                                      
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     o
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                      +
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     o
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                          d
                                          
                                             
                                                x
                                             
                                             
                                                o
                                             
                                          
                                          d
                                          
                                             
                                                y
                                             
                                             
                                                o
                                             
                                          
                                          =
                                       
                                    
                                    
                                       
                                          
                                          
                                             
                                                A
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                      k
                                                      z
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      s
                                                      o
                                                   
                                                
                                             
                                          
                                          I
                                          F
                                          F
                                          T
                                          
                                             |
                                             
                                                (
                                                
                                                   F
                                                   
                                                      (
                                                      
                                                         u
                                                         ,
                                                         v
                                                      
                                                      )
                                                   
                                                   H
                                                   
                                                      (
                                                      
                                                         u
                                                         ,
                                                         v
                                                      
                                                      )
                                                   
                                                
                                                )
                                             
                                             |
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                        F(u,v) and H(u,v) are the Fourier transforms of OTF(x
                        
                           o
                        ,y
                        
                           o
                        )P
                        
                           z
                        (x
                        
                           o
                        ,y
                        
                           o
                        ) and 
                           
                              
                                 e
                              
                              
                                 
                                    
                                       i
                                       k
                                    
                                    
                                       2
                                       d
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      o
                                                   
                                                
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             )
                                          
                                          2
                                       
                                       +
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      o
                                                   
                                                
                                                −
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             )
                                          
                                          2
                                       
                                    
                                    ]
                                 
                              
                           
                        , while the symbol IFFT indicates the inverse Fourier transform of the product of F(u,v) and H(u,v).

For thick objects, the multislice approximation described in [26] is applied. The object is divided into slices and Eq. (6 and 7) are recursively implemented. The wave propagates from slice z to slice dz, then from slice z+dz to slice z+2dz, … until it arrives at the exit surface of the phantom. The relative intensity distribution on the detector can be described as 
                           I
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                              
                              )
                           
                           =
                           
                              
                                 |
                                 
                                    
                                       
                                          E
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                E
                                             
                                             
                                                0
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 |
                              
                              2
                           
                        .

Three physical phantoms that differ in their content and complexity, as described in 
                           Table 1, were produced for the experimental work: (a) a phantom with four air channels having a diameter of 1mm, drilled within a polymethyl methacrylate (PMMA) slab of size 6cm×6cm×4cm (specified as Ph1 in Table 1); (b) a phantom with three silica gel spheres soacked with water, placed within a paraffin slab at different heights (specified as Ph2 in Table 1); (c) a paraffin slab tightly filled with spheres made from silica gel filled with water (specified as Ph3 in Table 1). Two of the phantoms used in the experimental study are shown in 
                           Fig. 2. The first two phantoms listed in Table 1 were used to adjust software application parameters and to validate simulated images. The air in Ph1 does not represent a realistic scenario when a breast is concerned; however, it allows obtaining of high-contrast images of materials and shapes of different but known chemical compositions. Together with the second phantom, they turn out to be a good choice when a verification of a technique is performed. The third phantom is much more breast-oriented.

Six software phantoms were created in order to test and validate the software code: (a) a simple phantom consisting of a thin nylon wire 0.1mm in diameter placed free in the air; (b) computational versions of the three physical phantoms used in the experimental study and described in Table 1; (c) two software breast phantoms. 
                           Fig. 3 shows four of the six software phantoms used in the study: a paraffin slab phantom with water-filled spheres (Fig. 3a), a paraffin slab phantom with three water spheres embedded within the slab (Fig. 3b), a software breast phantom composed of acrylic spheres placed within a semi-cylinder filled with water (Fig. 3c, first row) and an anthropomorphic software breast phantom (Fig. 3c, second row).

The computational phantoms were designed with the phantom modelling module of the XRAYImagingSimulator [27]. The anthropomorphic breast phantom shown in Fig. 3c was designed with the BreastSimulator software code [28]. The phantom shown in Fig. 3a consists of 157 spheres, while the phantom that simulates the compressed breast (Fig. 3c, first row) is composed of about 33,000 spheres. The latter phantom represents a software model of the physical phantom that was previously developed, validated and tested for the purposes of 2D mammography and breast tomosynthesis [29]. The phantom is composed of two main parts: an acrylic semi-cylinder container with height, 58mm, and diameter, 200mm, and equal volumes of acrylic spheres of various diameters: 15.88mm, 12.70mm, 9.52mm, 6.35mm, 3.18mm and 1.58mm. As in the physical phantom, the total volume of each different sphere type was set to 60,806mm³.

The software breast phantom shown in Fig. 3c, second row, represents a computed 3D uncompressed breast of small size [30]. The glandular portion occupies 21% of the breast volume which was calculated to be 77cm3. The breast model was compressed to a thickness of 2.6cm; subsequently, a water sphere of diameter 10mm was inserted, in order to simulate a breast mass.

Software phantoms were explicitly modelled according to dimensions and materials used in the experimental samples. The elemental composition of the materials by weight, together with the densities used in simulations, is reported in 
                           Table 2. Mass attenuation coefficients for the individual elements that are present in the mixture were taken from the XCOM Photon Cross Sections Database from NIST [31].

The experimental work has been carried out at the ID17 Biomedical Beamline at the European Synchrotron Radiation Facility [32], Grenoble, France. The experimental arrangement used for this study is schematically shown in 
                        Fig. 4a and b for the phase contrast and the absorption modes, respectively. The beam width and height were 100mm×4mm.

The x-ray detector was a high resolution ‘FReLoN’ CCD camera with an active input surface of 94mm×94mm [33]. The phosphor screen was Gd2O2S:Tb with a thickness of 60µm. Images were acquired with size of 2048×2048pixel and a pixel size of 47µm×47µm. The distance between the x-ray source and the front of the detector was 155m. The object-to-detector distances were 0.17m and 11m for absorption and phase contrast acquisition modes, respectively.

Phantoms were placed on a motorized stage that could perform micrometric movements along the directions: vertical, horizontal and rotational (around a vertical axis). The image acquisition for each projection comprised 30 adjacent frames in total, while moving the stage vertically. Each frame contained 55 detector lines. All images were corrected by subtracting a dark-current image and then by normalising to the flat-field image acquired at the same energy, without the sample in the beam. Then, the final projection image was assembled from its component frames. The incident exposure was monitored by a calibrated TW 31010 dosimetry chamber (PTW-Freiburg, Freiburg, Germany), placed horizontally at a distance of 7m away from the detector surface. Incident monochromatic photon energies of 25keV and 60keV were used. Incident exposure was set to 2.15mGy and 3.25mGy per projection acquisition at 25keV and 60keV, respectively. Effective pixel size was estimated before each experiment. Experiments were repeated for both absorption (0.17m detector distance) and phase contrast modes (11m detector distance).

The XRAYImagingSimulator is an in-house developed software platform dedicated for in silico investigations in the field of absorption x-ray imaging [27]. Main parts are the module for object creation and the module for x-ray image formation. Computational phantoms are either composed of simple 3D geometrical primitives or represented by 3D arrays of voxels. X-ray images are simulated by exploiting the concept of ray tracing, as this includes the definition of the ray and its intersections with the objects. The x-ray image is formed by using the analytical Lambert–Beer’s expression to calculate the x-ray energy of the photons transmitted through the phantom that reach the detector surface.

The source code of the XRAYImagingSimulator is structured to allow building and adding new approaches for x-ray image simulation. Based on this, a new module has been developed dedicated to the generation of PhC images. This module included the following new features: (a) calculation of the complex refractive index, n, for each material included in the simulated phantom; (b) implementation of projection approximations to calculate the 2D distributions of the two functions Φ and B (Eq. (4)); (c) multislice approximation implementation; (d) calculation of final PhC images by using both fast Fourier transform and convolution approaches.

The complex refractive index, 
                           n
                           =
                           1
                           −
                           δ
                           +
                           i
                           β
                         is calculated by taking into account that 
                           δ
                           =
                           
                              (
                              
                                 
                                    
                                       r
                                    
                                    
                                       e
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    2
                                 
                                 /
                                 2
                                 π
                              
                              )
                           
                           
                              
                                 N
                              
                              
                                 e
                              
                           
                        , where r
                        
                           e
                         is the classical electron radius, while N
                        
                           e
                         is the electron density of the tissue. For each element and composition, N
                        
                           e
                         is calculated, knowing the chemical formula for each material simulated. To speed up calculations in the x-ray tracing subroutine, OpenMP was used. The software phantoms were divided in thin sections (slices) during the ray tracing process. Two-dimensional distributions of the two functions, Φ and B, were generated for each object slice, and those are subsequently used as input for the subroutine for the calculation of the final PhC image. The slice thickness depends on the size a of the finest features within the phantoms to be imaged, the phantom thickness d itself and the x-ray energy (in order to assume the condition of the projection approximation). In our phantoms, the size a of the finest features within the phantoms with thickness d that were imaged (and simulated) were larger than 1mm. As discussed by other authors [19], the phantom can be accepted to be “thin” as long as the smallest feature size a is larger than 
                           
                              
                                 λ
                                 d
                              
                           
                        . The incident energy for most experiments was 25keV that corresponds to a wavelength of 0.05nm. For a phantom thickness of 40mm, the size of the finest feature to be imaged should be larger than 1.41µm. In this case, the application of the multislice theorem was avoided.

X-ray images were simulated with the analytical approach. Poisson quantum noise was subsequently added to the original calculated images. A Poisson random generator was used, with a variance set equal to the number of photons that are incident on each detector pixel. The number of photons that impinge on the phantom was calculated from experimentally measured exposure at the phantom surface, similarly to the approached used in [30]. Detector blurring was simulated by a Gaussian point spread function with full-width-half-maximum (FWHM) of 30.8µm [34]. A point x-ray source was considered. Additional noise was not simulated. Images with a size of 104×104 square pixels with a pitch of 10µm were generated for each phantom: they were software versions of the physical ones, and they were convolved with the point spread function of the detector. Then, this high resolution image was down-sampled to an image with a pixel size equal to the corresponding size in the experimental images. In all cases, the simulated distances from the source to the object and from the object to the detector were set equal to the experimental distances. The software package is running under Windows as a standalone application with a graphical user interface. The executable for Windows, with relevant help and demo files, can be obtained for free, upon request [35], by any research team working in the field.

@&#RESULTS AND DISCUSSION@&#

First, the developed software platform was validated for correctly producing images in PhC imaging mode by comparison with images of physical phantoms obtained experimentally. Further, the use of the developed platform was demonstrated in a feasibility study that aimed at generating PhC images from anthropomorphic breast phantoms and at showing the appropriateness of this tool for in silico investigations dedicated to x-ray breast imaging.

The validation test included the imaging of a 100-µm nylon wire, placed at various distances away from the detector. Data were compared with data from [8]. 
                           Fig. 5 shows the interference pattern at different sample-to-detector distances, computed for the following conditions: incident monochromatic beam energy of 17keV, a point-like source and detector resolution of 0.5µm. The first row in Fig. 5 shows line profiles from [8], while the second row shows the profiles taken from the simulated images from this study. A loss of spatial resolution is observed when the distance between the source and the sample is increased.

For the 4-cm thick PMMA phantom with the four air channels, comparison of x-ray images obtained from experimental and simulation setups is shown in 
                           Fig. 6 for both absorption and phase contrast modes and incident photon energies of 25keV and 60keV. Fig. 6 reveals that simulated (Fig. 6b, e and h) and experimental (Fig. 6a, d and g) images obtained at the two distances are similar in their visual appearance for the two incident energies.

This subjective result is well supported by the results from the quantitative evaluation of the images that included comparison of profile lines and calculation of the root-mean-square error (RMSE). The comparison between the line profiles taken across the images (Fig. 6c, f and i) shows a good agreement between experimental and simulated images in all cases. In the case of the large object-to-detector distance of 11m, for both simulated and experimental images, the image contrast at the edges of the air cylinders was fairly improved compared to that in absorption mode. The good agreement between simulated and experimental data from the analysis of the profiles is demonstrated by evaluating the RMSE from data of the plotted profiles. The RMSE between the corresponding datasets from the profiles was calculated and depicted in Fig. 6. The small deviations between simulated and experimental profiles as well as in visual appearance are mainly due to differences between actual and modelled elemental compositions of the materials, as well as imperfections introduced in the physical phantom during its manufacturing. Other differences could be ascribed to the absence of photon scatter in the simulation, and the reduced coherence of the beam due to presence of defects in the x-ray optics at the beamline.

A more complex validation experiment involved phantom Ph2, the paraffin bock with the three water spheres. To account for the bare sphere shrinking that occurred in the physical phantom, and to make the computational phantom realistic, air was included around the water balls as shown in Fig. 3b, second row. Specifically, the water-filled spheres were inserted within air spheres. The obtained thin air layer was approximately 0.1mm thick. X-ray images of this phantom were generated for the object-to-detector distance of 0.17m and 11m, respectively. 
                           Fig. 7 shows comparison of x-ray images obtained experimentally and by simulation at these two distances, for photon energy of 25keV.

Regions of interest (ROIs) that focus on the image of each one of these spheres are shown in 
                           Fig. 8, while 
                           Table 3 summarises the quantitative evaluation performed for each ROI. Specifically, profiles across the middle of each ROI are taken horizontally. The grey scale image in the ROI has values ranging from 0 to 255. The profile data are further used to evaluate the mean grey value as well as the RMSE of the grey values, which are actually a measure of the difference in the grey values between the simulation and the experimental images.

There is a good agreement in terms of visual comparison between simulated and real projection images. Experimental images are characterised by a structural noise that is caused by the imperfections in the paraffin phantom. This fact, together with possible variations between the modelled elemental composition and the actual one, results in discrepancy (RMSE ranging from 2 to 7%) between real and simulated data. In addition, scatter within the sample was not simulated that may cause additional discrepancy.

The PhC platform has been used in studying the visibility of complex structures in projection images generated from complex anthropomorphic phantoms. For this purpose, phantom Ph3, the paraffin slab with the water spheres (Fig. 3a) and the two software breast phantoms (Fig. 3c) were used.


                        
                        Fig. 9 shows the comparison between simulated (Fig. 9a and b) and experimental (Fig. 9c and d) x-ray images of the paraffin slab with the water spheres, generated for different object-to-detector distances. Simulated and experimental projection images are similar; of note is in particular the improved visibility of the features in a PhC mode (Fig. 9b and d) compared to the images produced in an absorption mode (Fig. 9a and c). Quantitatively, images are evaluated by comparison of the image fractal dimension and the exponential parameter, β, of the power law spectrum for both experimental and simulated images. These two parameters were calculated by using the methodology in [30] and shown in Fig. 9. The comparison of the [log2(total power spectrum)] versus the octave number shows similar linear trend for experimental and simulated images. Difference between β parameters for simulated and real images were calculated to 2.7% and 2.4% for PhC and absorption images. A similar deviation between experimental and simulated images was obtained for the fractal dimension parameter.

The application of the developed tool is demonstrated through the generation of PhC images from the two software breast phantoms, shown in Fig. 3c. The distance from the source to the object was kept as in the previous cases. The distance from the object to the detector surface varied for the two phantoms since the objects imaged were of different size. The size of the images and their resolution was 104
                         pixels and 20µm, respectively, for the breast phantom with the 33,000 spheres, while for the anthropomorphic breast phantom these were 8×103
                        pixels and 10µm, respectively.

Comparison of simulated projection images at different imaging setups is shown in 
                        
                        Figs. 10 and 11, for both software phantoms. For this comparison, images are visualised within the same minimum and maximum displayed values. Fig. 10 shows the comparison between simulated 2D x-ray images at craniocaudal view for the breast phantom with the 33,000 spheres for four selected object-to-detector distances. At the top of the figure, ROIs taken from the whole projection images are shown. The visual comparison shows no significant difference in the appearance of the whole image. However, detailed look at the images through the ROIs shows that more and more details become visible with increasing the detector to object distance. This results in visibility of all simulated spheres in the image, obtained at object-to-detector distance of 5m.


                        Fig. 11 shows the comparison between simulated 2D x-ray images generated at craniocaudal view from the anthropomorphic breast phantom at three object-to-detector distances: 5mm, 1m, and 2m. The comparison between these images does not show observable difference in the visual appearance of the simulated breast texture. Due to the voxelized structure of the phantom and the larger voxel size (0.15mm), the borders of the different voxels appear as artifacts—well outlined at larger object-to-detector distances due to the phase effects, as shown in the ROIs. Slightly improved breast tissue visibility is observed for the case of detector placed 1m and 2m away from the object plane. These results, however, deserve also experimental validation.

The in-line PhC method is the simplest and most adopted technique for PhC imaging amongst the available ones, since it does not require, in the imaging setup, the use of any additional optics or grating elements between the sample and the detector, in order to perform wave splitting or any kind of image reconstruction. The simulations with anthropomorphic breast phantoms showed slight improvement of suspicious regions on generated mammography images. They also showed slightly better differentiation of breast structures for the two complex breast phantoms compared to the mammography images generated in absorption mode with monochromatic radiation. PhC imaging is based not only on x-ray attenuation but also on the x-ray phase change arising during ultra-small-angle x-ray scattering. Phase shift is observed when the waves are refracted by details inside the imaged sample and then the refracted waves and unperturbed wave fronts interfere in the immediate vicinity of the detail itself. The interference itself takes place along the border of the detail inside a narrow angular region (between 10 and 100µrad, typically). Thus, simulation demands are mainly related to the requirement for very high spatial resolution. The calculation time for a single simulated x-ray projection image depends on the image resolution and on the number of objects in the composite phantom. OpenMP was used in the software application to parallelize and significantly speed up the calculations. X-ray projection images of the simplest phantoms (PMMA with the air channels, the paraffin with nylon wires and the paraffin with the three water-filled spheres) with pixel resolution of 10µm and image dimension of 100mm×100mm, are generated within a few minutes by using a modern workstation with 256GB of RAM and 2 eight-core Intel Xeon processors at 3GHz clock frequency, offering 32 computational threads. To generate a PhC image from the software breast phantom composed of 33,000 spheres, with a pitch of 20µm and image dimension of 200mm×200mm, about 4h were required: the largest computational burden was mainly due to the huge number of spheres included within the phantom. Furthermore, speed optimization using Graphical Processing Units (e.g. by utilizing CUDA API), as well as facilities like computational clusters like grids and clouds, would significantly reduce the computational time. However, this has not been considered an issue in the present study.

The simulations within this study were carried out under several assumptions. Specifically, the source was considered a point-like source, the detector simulation accounted for the point spread function of the detector and the photon noise within the Gd2O2S phosphor, while x-ray scattering from the object was not simulated. In addition, the elemental composition of the different objects within the computational phantoms may differ from the commercial ones, used in the creation of hardware phantoms. For more detailed simulations, Monte Carlo techniques, which would account also for the photon scattering, would be a proper approach for future investigations. This is a next step for further improving the realism of simulated images and is currently under implementation.

Concerning the x-ray source, in real conditions it has a finite size of approximately 30µm in vertical and 120µm in horizontal directions. To simulate such a source, it can be modelled as a 3D voxel-based matrix of dimensions 120×30×1 cubic voxels, each voxel with size of 1µm. Each matrix element is then a source of photons, which leave this element towards each detector pixel based on Gaussian distribution. Similarly, the distribution of the total number of photons within the source voxels is also based on a 2D Gaussian distribution. The idea is to generate 120×30 projection images of the object, taking into account the source position from the proposed source model and then to sum these projection images, with appropriate weights.

Further development, testing and optimisation of PhC imaging is related to the realization of 3D PhC imaging techniques. As with conventional x-ray mammography, the PhC mammography lacks depth-of-interaction information. When investigating thicker, complex specimens or entire female breasts, the superposition of various features present in the sample complicates the image interpretation [36]. Overcoming these limitations requires a three-dimensional imaging technique. A related interesting approach is to investigate the advantages of combining PhC effects with breast tomosynthesis. The latter is a 3D imaging modality recently entered into clinical breast cancer screening and diagnosis examinations. Clinical studies showed the ability of this technique to improve the detection task and in addition to characterize in 3D suspicious lesions, specifically low contrast masses, at doses equal to or less than the ones used in traditional x-ray 2D mammography [37–39]. The next step coming out of the present study is to investigate the arrangement of a possible setup for phase contrast breast tomosynthesis, by exploiting the possibilities offered by the simulator presented in this work. These are related to modelling and simulation of various x-ray imaging acquisition geometries; thus generation of projection images at any geometry configuration.

The modelling and simulation approach permits fast generation of simulated but realistic x-ray images for different imaging conditions. Setting the experimental work − x-ray spectra, imaging chain properties, scanning geometry, number of radiographic images, objects to be scanned (even before their actual manufacturing, with possibility to predict, add and investigate the detection of different types of defects) – turns out to be more time-efficient and always feasible compared to the corresponding experimental work. The present investigation demonstrated the feasibility of using complex breast phantom and the software platform in the investigation of PhC applied for breast x-ray imaging. Studies may further involve the investigation at different energies, and dose issues to predict the performance of this technique prior to implementation in practice.

@&#CONCLUSIONS@&#

A software platform dedicated to phase contrast breast x-ray imaging has been developed, validated and tested to generate images of complex anthropomorphic breast phantoms for in-line phase contrast acquisition setup. Results indicate good agreement between simulated and experimental images, acquired at a synchrotron radiation source. Phase contrast images of modelled and physical phantoms showed improved visualization of edges of the different objects included in these phantoms compared to images obtained in absorption mode, as predicted by in-line phase contrast x-ray imaging theory and well confirmed in the related literature. However, for complex breast anthropomorphic phantoms, results need further validation. The developed platform will be exploited further for research in 3D phase contrast breast imaging techniques and for educational purposes, as well as for the development of a dedicated physical breast phantom for research in this field.

None declared.

@&#ACKNOWLEDGEMENTS@&#

This research has been supported by Marie Curie Career Integration Grant within the 7th European Community Framework Programme, PHASETOMO (PCIG09-GA-2011-293846). The ESRF (Grenoble, France) is acknowledged for the provision of beam time at ID17 and for financial support for four authors (K.B., I.B., G.M. and P.R.).

@&#REFERENCES@&#

