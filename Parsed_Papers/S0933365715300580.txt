@&#MAIN-TITLE@&#A wearable sensor system for medication adherence prediction

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We propose a wearable sensor system for detecting swallows.


                        
                        
                           
                           We collect data and evaluate the system's ability to detect medication using machine learning algorithms.


                        
                        
                           
                           We use a probabilistic model to improve classification accuracy based on timing information.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Pervasive computing

Wearable devices

Medication adherence

Deglutition

Piezoelectric sensor

@&#ABSTRACT@&#


               
               
                  Objective
                  Studies have revealed that non-adherence to prescribed medication can lead to hospital readmissions, clinical complications, and other negative patient outcomes. Though many techniques have been proposed to improve patient adherence rates, they suffer from low accuracy. Our objective is to develop and test a novel system for assessment of medication adherence.
               
               
                  Methods
                  Recently, several smart pill bottle technologies have been proposed, which can detect when the bottle has been opened, and even when a pill has been retrieved. However, very few systems can determine if the pill is subsequently ingested or discarded. We propose a system for detecting user adherence to medication using a smart necklace, capable of determining if the medication has been ingested based on the skin movement in the lower part of the neck during a swallow. This, coupled with existing medication adherence systems that detect when medicine is removed from the bottle, can detect a broader range of use-cases with respect to medication adherence.
               
               
                  Results
                  Using Bayesian networks, we were able to correctly classify between chewable vitamins, saliva swallows, medication capsules, speaking, and drinking water, with average precision and recall of 90.17% and 88.9%, respectively. A total of 135 instances were classified from a total of 20 subjects.
               
               
                  Conclusion
                  Our experimental evaluations confirm the accuracy of the piezoelectric necklace for detecting medicine swallows and disambiguating them from related actions. Further studies in real-world conditions are necessary to evaluate the efficacy of the proposed scheme.
               
            

@&#INTRODUCTION@&#

Prior research has shown that non-adherence to prescribed medications can result in poor patient outcomes [1]. For example, non-compliant schizophrenia patients are at significantly higher risk for depression, arrest, and substance abuse [2]. Generally speaking, non-adherence can result in medical complications, hospital readmissions, and death [3]. Besides the risk of undesirable health outcomes for patients, poor adherence can result in unnecessary healthcare expenses and increased burden on the healthcare system. This issue is also a concern for medical researchers, as patients who choose not to take the appropriate dose of their medication render the assessment of the treatment effectiveness to be much more challenging. Therefore, many methods have been proposed in recent years to address these issues, including pill counts, self-reporting, interviews, and countless interventions intended to increase adherence rates [4–6]. However, these methods are typically associated with low accuracy [7].

Digital technologies that operate with relative transparency to the end user have the potential to improve accuracy compared to manual methods, as issues of human error and intentional misreporting are minimized. Interest in health-monitoring devices have therefore increased significantly in recent years, including activity monitoring approaches such as FitBit and MisFit [8–10].

In the same vein, smart pill-bottles have recently been proposed, which can detect when they have been opened and closed [11,12]. Though this technology can be useful in a number of different circumstances, such as when individuals themselves have no recollection of whether they took their pills, there are several shortcomings associated with this approach. More specifically, there is no definitive information to suggest that the medicine has been ingested after the bottle has been opened.

First, consider a case in which the subject opens the bottle, but is then interrupted by an outside event such as a phone call. Subsequently, the subject may forget to take his or her medication, and would benefit from a reminder a short time later. Furthermore, the individual may “cheat” the system, by discarding the medication after removing it from the bottle. Lastly, the individual may remove the bottle and, inadvertently or deliberately, take more pills than necessary.

To address these shortcomings, we propose supplementing information from the smart bottle with information from a smart necklace, that can detect when a pill is swallowed using a piezoelectric sensor and associated processing algorithms. The skin motion during the swallow of a medication has a unique pattern that can be used to confirm that the medication has been ingested after the bottle is opened. Data from the necklace is acquired by sampling the piezoelectric sensor strip, which generates a voltage in response to the mechanical stress of deglutition (swallowing). Data acquired from the necklace is transmitted to an Android application for processing using the low-power Bluetooth LE protocol, where classification algorithms are capable of distinguishing between swallowed medication and other types of swallows such as saliva and water. Though this classification is not free of errors, the necklace provides an additional layer of information which can improve detection of noncompliance and provide feedback.

We evaluate adherence based on two different kinds of medicines and supplements: chewables, which are typically targeted towards children in the form of vitamins, asthma medication, Tylenol, and ADHD treatment, and capsules, which are more appropriate for adults. Various use cases are outlined in Fig. 1
                     . Our proposed system extends prior work at ensuring medication adherence; the figures in green represent those steps which cannot be detected with most smart pill boxes.

This paper is organized as follows:
                        
                           •
                           In Section 2, we describe related work in this field.

In Section 3, we describe the hardware architecture of the smart necklace.

In Section 4, we elaborate on the algorithms used to detect medication ingestion.

In Section 5, we describe the experimental procedure.

In Section 6, we present our results.

In Section 7, we discuss the results.

In Section 8, we provide concluding remarks.

@&#RELATED WORK@&#

Though many methods of improving adherence have been proposed, a recent survey by McDonald et al. has suggested that even the most effective interventions have failed to provide significant improvements in adherence, though many have managed to make marginal improvements. The various methods fall under two primary categories: indirect and direct methods [13]. Indirect methods include self-reporting, interviews, pill counting, and computerized compliance monitors [14]. Within this category, pill counts and self-reports have shown significant overestimation in user compliance. Direct methods include biological markers, assessment of body fluids, and tracer compounds [15]. As direct methods are generally unsuitable for regular use in home environment, we primarily focus our discussion and comparison on indirect methods.

Several smartphone apps such as MyMedSchedule, MyMeds, and RxmindMe, provide advanced functionality for medication reminders [16–18]. These applications issue reminders, allow users to manually enter their dosage information, and record when they have taken their medication. However, these applications are generally untested, and cannot verify compliance without user involvement [17]. In [19], Sterns et al. mounted a pill bottle onto a personal digital assistant running the RxmindMe software, and successfully trained elderly subjects with an average age of 72 to operate the software used to monitor adherence. This work suggests that users from a variety of age groups and backgrounds have the ability and motivation to use electronic monitoring devices if given adequate training. In [20], Choi et al. explored the topic of user acceptance of neckware-based health monitoring technologies for elderly populations. Their study concluded that there is a strong possibility of seamless adoption of those population groups which suffer from chronic illnesses, particularly if the medication compliance system is incorporated with other health-monitoring features.

Other works propose cell phone reminders and in-home technology to transmit reminder messages, but results are mixed [3,21]. A recent study by Bernocchi et al. [22] characterized the efficacy of home-based telemedicine services for patients with hypertension, using a networked blood pressure monitoring device and regular phone calls from physicians to ensure adherence. The study concluded that telemonitoring of patient adherence can improve patient outcomes.

The “smart blister” has been proposed as a semi-automated, indirect method of assessing adherence. When empty blister cards are returned to the pharmacy, information is scanned and downloaded. This work is a step in the right direction, but the substantial error and lack of real-time features necessitate additional refinements [23]. The work described in [7] describes a portable, wireless-enabled pillbox suitable for elderly and those suffering from dementia. Similar approaches for electronic detection and smart pill boxes have also been proposed [24]. These devices generally suffer from the same shortcoming: they cannot determine if the medication is ingested or simply removed and discarded [25,26].

One notable exception is the recently unveiled plastic sleeve from AMIKO [27], which fits on several standard types of medicine containers and reports if medication has been removed from the bottle using MEMS sensors such accelerometers and gyroscopes. They are also capable of tracking if an inhaler is used, aggregating results on a mobile application. In another work, Valin et al. successfully identified medication adherence using a series of images and associated image processing algorithms [28]. Several other digital systems have been developed for evaluation of swallow disorders and monitoring eating habits [29]. A recent smart bottle technology is the Vitality Glowcap [30]. This smart device can detect when pills are removed, reports information to caregivers, and can request prescription refills with the push of a button. Lastly, a system called “Proteus” [31] is currently in development. Proteus consists of medicine tablets with embedded sensors that transmit a beacon to a mobile phone when dissolved in the stomach. However, the issue of recurring expenses associated with smart pills must be evaluated, and this work is still in the early stages of development.

In [32], Sang et al. propose the use of wearable microphones for detection of medication adherence, using neural networks for classifiers. Though prior work has shown that audio-based activity monitoring has substantial battery life implications [33], classification accuracy from 20 subjects was over 85%. Such as a system could also benefit from integration with a smart pill bottle, to mitigate the effects of false positives. A similar scheme was proposed by Olubanjo et al. in [34]; the authors were able to classify swallow swallows unrelated to medication adherence using an IASUS NT3 throat microphone based on data collected from three subjects. In [35], Wu et al. designed and fabricated a necklace for detection of medication adherence using a microphone and flex sensor, with the addition of silicone material and 3D-printed components. The emphasis of the work was on appropriate design choices for high user acceptance, as the created prototypes were not functional.

In this section, we describe the hardware components of our system. The overall system architecture is shown in Fig. 2
                     . Movement from the smart pill bottle is coupled with swallow detection algorithms to detect ingestion of medication, which is then reported to a mobile application with cloud integration. Is necessary to consider these two events together because neither event can independently confirm medication adherence. As described previously, the fact that the bottle is opened only suggests that medication is subsequently taken. Similarly, a report from the necklace that medication has been ingested may not be sufficient evidence as the event could be a false positive. We describe this issue in greater depth in the next section.

An extensive discussion of the smart bottle technology is out of scope for this paper, various commercial devices implement this functionality [36–38]. Most methods for implementing smart bottles would embed sensors using microcontrollers and RF transceivers (Bluetooth, Wifi, 3G, XBee) into the bottle itself. The removal of the cap would terminate an electric connection which, when replaced, would restore the circuit and indicate that the bottle has been opened.

It should be noted that this primary stage of the algorithm could be implemented based on several alternate techniques that do not include a smart pill bottle. For example, our prior work [39,40] explore the issue of gesture recognition using the smartwatch platform, applied to the issue of medication adherence. Though this technique is not without its challenges, it can also be integrated in the WearSens system to improve classification accuracy. Though various other methods have been proposed for determining bottle opening gestures, the standard smart-bottle technique is predominantly the focus of our evaluation as it has been shown to operate with virtually 100% accuracy [28].

The smart necklace, known as WearSens, is shown at the top of Fig. 3
                        , is used to detect when pills are swallowed. It is based on a small piezoelectric sensor, also known as a vibration sensor, which generates a voltage in response to the mechanical stress caused by skin motion during a swallow event. The piezoelectric strip is fastened such that it is contact with the skin of the lower-neck, but not too tight as to restrict motion. The challenge of placing the piezoelectric sensor correctly is largely a function of the specific form-factor. The design shown in Fig. 4
                         shows a pendant style design that requires careful placement such that the sensor is horizontally centered and placed at the lower part of the neck. By contrast, the design more appropriate for clinical applications shown in Fig. 2 wraps around the neck, and a larger piezoelectric strip can be used to make correct positioning simpler. The output from the piezoelectric sensor is sampled at a rate of 20Hz by the small Bluetooth LE enabled microcontroller board, and transmitted to a mobile phone for processing.

The mobile application uses several algorithms to classify the incoming data into broad categories: saliva swallow, medication swallow, chewable-vitamin swallows, and neither. This smart-necklace technology has previously been shown to be effective in detecting eating behavior, and successfully classifying between a small subset of foods [41]. Though the original design of the necklace was in the form of a band placed tightly around the neck, the technology evolved into a pendant-style design as shown in Fig. 4. Though this new design introduced some stability issues, it was intended to address concerns about comfort, ergonomics, and appearance. For a more comprehensive system description of the WearSens necklace, please refer to the work by Kalantarian et al. [42].

The piezoelectric sensor used is the LDT0-028K, which consists of a 28μm PDVDF polymer film laminated to a 0.125mm substrate, which produces voltages within standard CMOS input voltage ranges when deflected directly. The necklace can operate under conditions ranging from 0 to 85°C. The LDT0 is available with added masses at the tip, which reduce the resonant frequency but can greatly increase the sensitivity of the device. In the configuration without an added mass at the tip, the baseline sensitivity is approximately 50mV/g, with sensitivity at resonance of 1.4V/g [43]. The necklace also includes a microcontroller for sampling data from the sensor, and an integrated Bluetooth 4.0 LE transceiver to transmit acquired data to an aggregator device for processing. This Arduino-compatible board is easily programmed, compact, and features an RFD22301 SMT module. The embedded processor is an ARM Cortex M0 with 256kB of flash memory and 16kB of RAM. The overall system includes a 225mAh coincell battery and can remain powered by approximately 18h. If a rechargeable coincell battery is used, the battery can be recharged by simply connecting the board to a USB power source.

The system flow for the necklace is shown in Fig. 5
                     . The process is initiated when the bottle is first opened, using a commercially-available smart-bottle technology. Immediately thereafter, a timer is set which measures the interval between the opening of the bottle and a swallow. In Fig. 5, the simplified finite-state-machine shows a return to the initial condition if the timer expires. In this case, the timer value would be set such that any detected swallow occurs a large interval after the bottle is opened, suggesting the two events are unrelated. However, in practice it is preferred not to associate the timer with an arbitrary threshold, and instead to use the interval ΔT as a classification feature as described in subsequent sections. As the state diagram in Fig. 5 shows, the detection that a swallow occurred and that the swallow corresponded with medication intake are entirely separate procedures that we refer to as the detection and classification algorithms, respectively. We begin our discussion by describing the detection algorithm.

Piezoelectric material exhibits the piezoelectric effect, in which the material generates an electric charge in response to the application of mechanical stress. When the necklace is worn such that the piezoelectric sensor is placed flat against the lower part of the neck, just above the collarbone, swallowing causes movement in the skin which stresses the sensor and creates a brief spike in the output voltage. Using the Analog-to-Digital converter of the microcontroller housed on the necklace, we acquire signals from the piezoelectric sensor and analyze the data for disturbances that are indicative of swallow events. Typically, it has been shown that sampling the piezoelectric sensor at a rate between 10Hz and 20Hz is appropriate for this approach [42].

After the piezoelectric sensor data is acquired by the microcontroller and transmitted to a mobile phone using the Bluetooth 4.0 LE protocol, it is buffered locally until there are 2s of data available. Once the buffer is full, a moving-average filter of span 5 is applied in order to reduce the impact of high-frequency noise. Subsequently, a sliding window of length 9, corresponding with 45s of data, is applied to compute the standard deviation of that point with its neighbors. This produces a new standard deviation waveform, to which a threshold is applied in order to detect the peaks which correspond with swallows. This procedure is shown in Fig. 6
                        , in which the raw data is at the top. the standard deviation of the raw data is shown in the middle, and the filtered, thresholded final waveform used in peak detection is shown at the bottom. The particular thresholds and values used in the algorithm were determined to be optimal based on simulations. A more extensive description of this procedure is omitted because a comprehensive description is available in [42,44].

The technique described in this subsection is generally shown to be a reliable and energy-efficient approach for detecting swallows from a piezoelectric sensor, consuming as little as .06mW of power with a sample rate of 16Hz [33], excluding Bluetooth transmission overhead. Though in our experimental evaluation the swallow events were manually annotated, this approach can be used for automatic time-series segmentation in a real-time implementation of the system. After the swallow has been identified, the signal can be segmented and analyzed using the method described in the next subsection.

After determining that a swallow has taken place using the previously outlined algorithm and segmenting the data into a 250ms window centered around the swallow peak, we are now interested in understanding more about the swallow itself. More specifically, we must determine if the swallow is associated with medication intake, a saliva swallow, a sip of water, a chewable vitamin, or a false-positive caused by talking. Rather than using a simplistic peak detection algorithm, we must analyze complex time and frequency-domain features of the data to correctly assign a class label to the extracted data window.

The time-domain waveforms acquired by the piezoelectric sensor, which are transmitted to the mobile application for processing, are shown in Fig. 7
                         as a subject performed several actions. Clearly, different activities such as water sips and chewable vitamin intake can be distinguished visually. The time domain waveforms show not only the swallows, represented clearly by a peak or a dip in the waveform, but also show chewing in the form of low-frequency noise. Useful features that can be extracted from the time domain waveforms include standard deviation, maximum value, and detection of multiple swallows within a time frame. Additional features can be extracted by producing a spectrogram, which is essentially a heat map showing time on one axis and frequency on the other. The color of the spectrogram at a particular time and frequency represents the magnitude of the frequency component at that time, on a logarithmic scale. Spectrograms can clearly show changes in the frequency spectrum over time for different food types, which are useful features for classification and detection. The spectrograms for several actions can be seen in Fig. 8
                        . Visually, the differences are quite pronounced; chewable vitamin ingestion patterns have a relatively uniform frequency distribution over an extended period of time, followed by a pause right before the swallow at the end of the time sample. Otherwise, capsule swallow spectrograms show a brief period of high frequency components (between 6 and 10Hz) lasting approximately 2s centered around the swallow, followed by primarily lower frequencies between 0 and 5Hz between swallows.

For each one-second swallow window, the time axis was divided into 7 bins, and the frequency axis was divided into 17 bins. A Hamming window was used of length w
                        =32, and an FFT length of nfft=32 was used with 50% overlap. A selection of features extracted in both time and frequency domain are shown in Table 1
                        . After the classification model is trained, the best features are selected using the correlation-based feature subset selection algorithm described in [45]. This algorithm considers both the predictive ability of features as well as redundancy between them to produce the best results. Moreover, limiting the selected features using this algorithm ensures that the classification results are generalizable, and the model is computationally feasible in a real-time system. Spectrogram-based feature extraction for a piezoelectric sensor is described in more depth in [41].

Using the WEKA Data Mining software [46], we can then evaluate the performance of a classifier in determining the appropriate class label for a particular window of data, based on the extracted time and frequency-domain feature set. Leave-one-subject-out cross validation can be used to avoid biasing the data, and the Correlation-based Feature Selection (CFS) Subset Evaluation tool is used to reduce the feature set to avoid overfitting.

When the necklace software detects a swallow and classifies it as a pill, the probability that this classification is correct is generally a function of the precision of the classifier. However, the precision reported by the classifier does not take into consideration the relative likelihoods of the different events taking place. This information is significant, as pill swallows are a much less common event than saliva swallows and water sips. In this section, we describe the mathematical formulation for the probability that a pill has been ingested, p when the classifier reports a pill swallow, 
                           
                              
                                 
                                    p
                                 
                              
                              ˆ
                           
                        , using Bayes theorem [47].
                           
                              (1)
                              
                                 Pr
                                 
                                    (
                                    
                                       
                                          p
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                p
                                                ˆ
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 Pr
                                 
                                    (
                                    
                                       
                                          
                                             
                                                p
                                                ˆ
                                             
                                          
                                       
                                    
                                    |
                                    
                                       
                                          p
                                       
                                    
                                    )
                                 
                                 ·
                                 
                                    
                                       Pr
                                       (
                                       
                                          
                                             p
                                          
                                       
                                       )
                                    
                                    
                                       Pr
                                       (
                                       
                                          
                                             
                                                
                                                   p
                                                   ˆ
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                                 =
                                 Recall
                                 (
                                 
                                    
                                       p
                                    
                                 
                                 )
                                 ·
                                 
                                    
                                       Pr
                                       (
                                       
                                          
                                             p
                                          
                                       
                                       )
                                    
                                    
                                       Pr
                                       (
                                       
                                          
                                             
                                                
                                                   p
                                                   ˆ
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

Alternatively, the probability p given b and 
                           
                              
                                 
                                    p
                                 
                              
                              ˆ
                           
                        , in which b is the event in which the bottle is opened, is shown below. Note that Pr(b and 
                           
                              
                                 
                                    p
                                 
                              
                              ˆ
                           
                         is defined as the probability of detecting a pill swallow some time τ after the bottle is opened.
                           
                              (2)
                              
                                 Pr
                                 
                                    (
                                    
                                       
                                          p
                                       
                                    
                                    |
                                    
                                       
                                          b
                                       
                                    
                                    ∧
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                          
                                          ˆ
                                       
                                    
                                    )
                                 
                                 =
                                 Pr
                                 
                                    (
                                    
                                       
                                          b
                                       
                                    
                                    ∧
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                          
                                          ˆ
                                       
                                    
                                    |
                                    
                                       
                                          
                                             p
                                          
                                       
                                    
                                    )
                                 
                                 ·
                                 
                                    
                                       Pr
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                       
                                       )
                                    
                                    
                                       Pr
                                       (
                                       
                                          
                                             b
                                          
                                       
                                       ∧
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                             
                                             ˆ
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

This can be approximated as the following:
                           
                              (3)
                              
                                 Pr
                                 
                                    (
                                    
                                       
                                          p
                                       
                                    
                                    |
                                    
                                       
                                          b
                                       
                                    
                                    ∧
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                          
                                          ˆ
                                       
                                    
                                    )
                                 
                                 =
                                 Recall
                                 (
                                 
                                    
                                       
                                          p
                                       
                                    
                                 
                                 )
                                 ·
                                 
                                    
                                       Pr
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                       
                                       )
                                    
                                    
                                       Pr
                                       (
                                       
                                          
                                             b
                                          
                                       
                                       ∧
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                             
                                             ˆ
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 =
                                 
                                    
                                       Pr
                                       (
                                       
                                          
                                             p
                                          
                                       
                                       )
                                       ·
                                       Recall
                                       (
                                       
                                          
                                             p
                                          
                                       
                                       )
                                    
                                    
                                       Pr
                                       (
                                       
                                          
                                             b
                                          
                                       
                                       )
                                       ·
                                       prc
                                       (
                                       
                                          
                                             p
                                          
                                       
                                       )
                                       +
                                       Pr
                                       (
                                       other
                                       )
                                       ·
                                       (
                                       1
                                       −
                                       prc
                                       (
                                       
                                          
                                             other
                                          
                                       
                                       )
                                       )
                                    
                                 
                              
                           
                        
                     

Lastly, we make some simplifying assumptions. First, we define f
                        
                           p
                         and f
                        
                           b
                         as the frequency of pill swallows and bottle openings. Then, we assume that the majority of false positives for medication adherence come from saliva swallows, as prior research has confirmed. This is due to their high frequency, as well as their resemblance to the characteristics of pill swallows. Therefore, the final equation to describe the probability that a pill has been swallowed, given a bottle opening event f
                        
                           b
                         and a possible pill swallow f
                        
                           p
                        , can be shown below:
                           
                              (5)
                              
                                 Pr
                                 
                                    (
                                    
                                       
                                          p
                                       
                                    
                                    |
                                    
                                       
                                          b
                                       
                                    
                                    ∧
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                          
                                          ˆ
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          f
                                          p
                                       
                                       ·
                                       Recall
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          f
                                          b
                                       
                                       ·
                                       prc
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                       
                                       )
                                       +
                                       
                                          f
                                          slv
                                       
                                       ·
                                       (
                                       1
                                       −
                                       prc
                                       (
                                       slv
                                       )
                                       )
                                    
                                 
                              
                           
                        
                     

In this section, we describe how sensor data was collected from the smart necklace, as well as how the online survey was conducted. This enabled us to collect statistics on common behavioral patterns associated with medication intake, which is used in algorithm development.

An online survey was conducted to determine specific habits in medication ingestion that could be used to improve classification accuracy. The purpose of the survey was to provide an understanding of medicine timing information, that could be used to develop a probabilistic model to improve classification accuracy. Though an online assessment of medicine habits may be unreliable, it was used as a simple baseline to show that knowledge of medicine intake patterns can be used to improve classification accuracy.

Subjects were first asked to report some basic demographic information, all of which was optional. They were asked to report the gender with which they most closely identify, their ethnicity, and their age. They were then provided with a use case in which they were to take a tablet-based medicine. Subjects were asked if they would remove the pill from the bottle before pouring a glass of water, or after pouring the water. An option was also provided for individuals who would prefer to take the medication without water. Several other questions in the survey asked subjects to describe the consistency with which they take their medication with respect to time of day, and their best estimate of how much time elapses between the moment they open a pill bottle and take their medicine.

Each subject was instructed to swallow ten empty gel capsules and chewable vitamins over the course of several days. An internal dataset of 20 subjects was used for data corresponding with saliva swallows and water sips to establish a baseline, while additional data collection from five subjects were obtained for the chewable vitamins and gel capsules. The subjects consisted of 8 females and 12 males in the first data collection, with four females and one male participating in the second. The age ranges represented by the study ranged from 21 to 40. Swallows were annotated using a button on the associated Android mobile application, which modified the log files accordingly. The subjects were instructed to take at least one sip of water with the gel capsules, and to pause for a few seconds before proceeding to the next capsule. The chewable vitamins were taken one at a time without water. Each session lasted approximately 3min and was typically carried over three different days. The experiments were conducted in a laboratory environment, and research assistants helped subjects wear the necklace properly. This was necessary because the subjects had no previous experience with the WearSens necklace, and therefore required basic supervision and instruction.

The ability to distinguish speaking samples from medicine swallows is significant, because individuals spend significant amounts of their day in conversation. Speaking can cause movement in the skin of the lower trachea, that is occasionally similar to the motions of the swallow. It is therefore essential that the proposed algorithm can distinguish medicine swallows from other commonly performed activities such as vocalization. To acquire speaking samples, individuals were asked to read a Wikipedia passage for a period of 15s. The total dataset was aggregated from all subjects, and thirty samples were selected at random for experimental evaluation. Though the audio clips were extracted automatically, several clips were discarded, as they contained only pauses that did not contain any speaking.

@&#EXPERIMENTAL RESULTS@&#

Five activities were classified using data acquired from the smart necklace. These categories as well as the classification results are shown in Table 2
                        . These results were achieved with the BayesNets classifier, which provided the strongest results. BayesNet is an implementation of a Bayesian-Network classifier, which is included in the WEKA Data Mining software [46,48]. A total of 135 instances were classified. These results indicate that gel capsule swallows can be reliably and consistently distinguished from saliva swallows and water sips. Given the thirty capsule swallows, 27 were classified correctly. Of the remaining three, two were misclassified as saliva swallows, and one as a chewable vitamin. The validation technique used was “Leave One Subject Out” cross-validation, to avoid overfitting the model. The Correlation-based Subset Evaluator tool was used for feature dimensionality reduction. This algorithm considers individual predictive ability of features as well feature redundancy to select the features best associated with the desired classification outcomes [45].

The confusion matrix in Table 2 provides values of precision and recall for the following class types: chewable vitamin, saliva swallow, gel capsule swallow, speaking, and water sips. Recall represents the percentage of instances associated with a particular class which were correctly labelled. On the other hand, precision for a particular class represents the percentage of instances labelled as such, whose labels were correct. More specifically, we define precision and recall using Eqs. (6) and (7), respectively.


                        Table 2 shows that the precision of speaking is the highest, among all classes. That is, no instance associated with speaking was assigned an incorrect class label. By comparison, the recall is slightly lower at 93.3%; two instances labelled as speaking were actually water sips. Perhaps the most significant class for this context is a capsule swallow, which had a precision and recall of 87.09% and 90.0%, respectively. The primary errors associated with this class were four instances which were incorrectly labelled as chewable vitamin swallow events.
                           
                              (6)
                              
                                 Precision
                                 =
                                 
                                    TP
                                    
                                       TP
                                       +
                                       FP
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 Recall
                                 =
                                 
                                    TP
                                    
                                       TP
                                       +
                                       FN
                                    
                                 
                              
                           
                        
                     

A total of 100 subjects participated in the online survey on medication ingestion habits. The respondents included 37 men, 59 women, and 4 who preferred not to disclose. The survey participants were primarily Caucasian (78%), with the next highest represented demographic to be Hispanic (5%). The age of participants ranged from 14 to 50, with an average of 24 and a median of 23. The standard deviation was 6.85 years. Subjects were completely anonymous, and allowed to skip any questions they did not wish to answer.

In order to improve classification accuracy, we explore the utility of medication timing in detecting ingestion. For example, an item classified as a pill is much more likely to be a correct classification if reported 10s after the medicine bottle is opened, compared to 3h later. A survey was conducted to determine how much time is typically elapsed between the bottle being opened and the pill being swallowed. Though it would be ideal to observe an individual in real-world conditions to determine these values, a survey was conducted online due to practical constraints. However, the mathematical model we describe can be applied to datasets collected in clinical environments. The results are shown in Fig. 9
                        , and reveal that most medication would be taken 4 and 8s after opening the bottle. Less than 5% of individuals reported that they would take their medication over 40s after opening the pill bottle. The results indicate that most individuals take their medication several seconds after opening the bottle, but this is not always the case.

In another survey question, 38.4% of subjects stated that they generally remove the medicine from the bottle, and only afterwards do they fill a glass with water. By comparison, 39.4% of respondents reported that they would fill up the glass of water before they open the bottle and remove the medication. Only 17.2% of respondents reported that they would take the medication without water. These discrepancies substantially increase timing complexity, which render a simple linear or Poisson-based probability distribution model to be impractical.

@&#DISCUSSION@&#

We now attempt to compute the probability that the medication has been ingested, p, based on 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                    
                                    τ
                                 
                              
                              ˆ
                           
                        , which is the observation that the pill bottle has been opened and that the classifier reports a pill swallow (which may be a misclassification), some time τ after b. This is first achieved by assigning τ to a predefined time epoch n. For example, a pill taken 7s after the bottle is opened, τ
                        =7, this falls within the bounds of the second epoch, 4≤
                        τ
                        ≤8. Based on collected survey data, we define k as the factor by which the probability of swallowing a pill at epoch n compares to that of the average epoch. For example a value of k
                        =0.5 suggests that the probability of ingesting a pill at this particular time τ is one-fourth that of an epoch with k
                        =2.

Recall that the probability of a pill swallow p given a pill swallow event, 
                           
                              
                                 
                                    p
                                 
                              
                              ˆ
                           
                        , is a function of the classifier precision prc, as well as the relative likelihood of a pill swallow, f
                           p
                         compared to other events that we refer to as f
                           slv
                         for simplicity, as saliva swallows are the most frequent events with a significant chance of misclassification. This formulation is shown below in Eq. (8), with some simplifying assumptions for clarity.
                           
                              (8)
                              
                                 Pr
                                 
                                    (
                                    
                                       
                                          p
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                          
                                          ˆ
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       prc
                                       (
                                       
                                          
                                             p
                                          
                                       
                                       )
                                       ·
                                       
                                          f
                                          p
                                       
                                    
                                    
                                       
                                          f
                                          p
                                       
                                       ·
                                       Recall
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                       
                                       )
                                       +
                                       
                                          f
                                          slv
                                       
                                       ·
                                       (
                                       1
                                       −
                                       Recall
                                       
                                          
                                             
                                                (
                                             
                                          
                                          slv
                                       
                                       )
                                       )
                                    
                                 
                              
                           
                        
                     

The probability of p given ^p
                        
                           τ
                         is shown below in Eq. (9). It is quite similar to Eq. (8), with an additional k factor to signify that the relevant frequencies of the two events occurring has changed based on the collected survey data.
                           
                              (9)
                              
                                 Pr
                                 
                                    (
                                    
                                       
                                          p
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                             
                                             ˆ
                                          
                                       
                                       τ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       prc
                                       (
                                       
                                          
                                             p
                                          
                                       
                                       )
                                       ·
                                       k
                                       ·
                                       
                                          f
                                          p
                                       
                                    
                                    
                                       k
                                       
                                          f
                                          p
                                       
                                       ·
                                       Recall
                                       (
                                       p
                                       )
                                       +
                                       
                                          f
                                          slv
                                       
                                       ·
                                       (
                                       1
                                       −
                                       Recall
                                       (
                                       slv
                                       )
                                       )
                                    
                                 
                              
                           
                        
                     

Based on Eq. (1), we evaluate the probability p given 
                           
                              
                                 
                                    p
                                 
                              
                              ˆ
                           
                        . The recall experimentally has been determined to be approximately 90.0%. We assume that the average subject takes two medications per day (a frequency f
                        
                           p
                         of 2.3e−5 swallows/second). Prior research in [49] has shown that the average adult will swallow approximately 590 times during the course of a full day. Based on [49], swallows saliva at a rate of 1.0e−2 times per second which we define as f
                        
                           slv
                        . Therefore, Eq. (1) show that the probability p given 
                           
                              
                                 
                                    p
                                 
                              
                              ˆ
                           
                         is 2.3%. Though this equation makes several simplifying assumptions, the results nevertheless suggest that a reported medication swallow is largely meaningless when taken independently, because so few pills are consumed during the course of a day compared to saliva swallows. Moreover, there are many alternative actions that may occur throughout the day that can cause false positives by creating vibrations, such as coughing, sneezing, running, eating an apple, or laughing positives. In general, identifying short duration events from sparse signals can be achieved with a two-stage classification approach in which the first stage has a high recall but low precision (opening the bottle), and the second stage has a high precision but low recall (the necklace). Using Eq. (5), we are able to represent the final probability:
                           
                              (10)
                              
                                 Pr
                                 
                                    (
                                    
                                       
                                          p
                                       
                                    
                                    |
                                    
                                       
                                          b
                                       
                                    
                                    ∧
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                          
                                          ˆ
                                       
                                    
                                    )
                                 
                                 =
                                 .
                                 90
                                 ·
                                 
                                    2
                                    
                                       2
                                       ·
                                       prc
                                       +
                                       1
                                       ·
                                       (
                                       1
                                       −
                                       prc
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          96
                                          %
                                       
                                    
                                 
                              
                           
                        
                     

This confirms that bottle timing is a critical supplement to the smart necklace in estimating adherence.

@&#LIMITATIONS@&#

However, our system also has several significant limitations. First, the histogram of timing data is based on self-report rather than observation. Clearly, this introduces substantial reliability issues with respect to the data, as a practical realization of this system requires an observational study. Second, the comfort and user acceptance of the necklace should be evaluated in a focus group or long-term trial. Though the proposed pendant-style revision appears to be more comfortable than the earlier design, this should be formally validated. Furthermore, the ability of the necklace to disambiguate between other activities beyond speaking, water sips, and saliva swallows, should be evaluated. This is necessary because of the wide variety of activities that an individual may undertake throughout the course of a day. Lastly, though medication adherence is an issue that affects all age groups, it would be preferred to conduct experiments with seniors, as they would benefit the most from such technologies.

Besides medication timing, several other questions were posed to participants in the survey on medication adherence. Another resource that can be used for classification is to evaluate the time of day at which medication is taken, since it is likely that many individuals take their pills at a particular time every day. Therefore, a possible pill swallow event 
                           
                              
                                 
                                    p
                                 
                              
                              ˆ
                           
                         is much less likely to be a correct classification if it takes place in the middle of the night or a random part of the day. As a future work, it may be beneficial to consider this as an additional factor to improve classification accuracy. Our survey results show that 40% of individuals take their medication within 2h of the same time every day, 45% of individuals stated that they take the medication within an hour of the same time every day, at least 80% of the time, and 35% stated that they take their medication within 30min of the same time every day, 70% of the time.

The time of day can be used as a feature directly in the classifier model used, though this would require that the experimental data set be much more extensive as implementing this in a smaller dataset could result in overfitting.

@&#CONCLUSION@&#

Patient adherence is critical to the successful treatment of many diseases, as well as the effective assessment of treatment effectiveness for research purposes. In this paper, we propose and evaluate a two-step system for detecting when a pill bottle is opened using commercial smart-bottle technologies, and when a pill is consumed using a custom-designed smart necklace using a piezoelectric sensor. These two mechanisms coupled with the mobile application can passively monitor adherence and inform caregivers of patient status. Results confirm that medications can be identified using the smart necklace, and are clearly distinguishable from saliva swallows and water sips. Furthermore, we show that the probability of correct classification can significantly vary based on the amount of time that has elapsed between the bottle cap removal and the swallow.

@&#REFERENCES@&#

