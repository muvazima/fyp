@&#MAIN-TITLE@&#Hidden Markov model for municipal waste generation forecasting under uncertainties

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A model-driven learning method is proposed to trace fluctuations dynamically.


                        
                        
                           
                           The fluctuation forecasting under uncertainties is made possible using the HMM.


                        
                        
                           
                           Case studies of different scenarios are presented to show the validity of the HMM.


                        
                        
                           
                           Two forecasting formulas are proposed to cope with two scenarios separately.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Forecasting

Waste generation

Wavelet de-noising

Hidden Markov model

Gaussian mixture model

@&#ABSTRACT@&#


               
               
                  Waste generation forecasting is a complex process that is found to be influenced by some latent influencing parameters and their uncertainties, such as economic growth, demography, individual behaviors, activities and events, and management policies. These hidden features play an important role in forecasting the fluctuations of waste generation. We therefore focus on revealing the trend of waste generation in megacities which face significant influences of social and economic changes to achieve urban sustainable development. To dynamically trace fluctuations caused by these uncertainties, we propose a probability model-driven statistical learning approach which hybridizes a wavelet de-noising, a Gaussian mixture model, and a hidden Markov model. First, to gain the actual underlying trend, wavelet de-noising is used to eliminate the noise of data. Next, the Expectation–Maximization and the Viterbi algorithms are employed for learning parameters and discerning the most probable sequence of hidden states, respectively. Subsequently, the state transition matrix is updated by fractional predictable changes of influencing parameters to perform non-periodic fluctuation problem forecasting, and the forward algorithm is utilized to search the most similar data pattern for the current pattern from historical data in order to forecast the future trend of the periodic fluctuation problem. Finally, we apply the approaches into two kinds of case studies that test both a small dataset and a large dataset. How uncertainty factors influence forecasted results is analyzed in the subsection of results and discussion. The computational results demonstrate that the proposed approaches are effective in solving the municipal waste generation forecasting problem.
               
            

@&#INTRODUCTION@&#

Accurate forecasting of municipal waste generation can provide theoretical guidance in disposal capacity design and capital budget planning for waste management systems (Beigl, Lebersorger, & Salhofer, 2008; Cherian & Jacob, 2012; Intharathirat, Salam, Kumar, & Untong, 2015; Rimaityte, Ruzgas, Denafas, Racys, & Martuzevicius, 2012). Waste generation forecasting in megacities is a complex process that is found to be influenced by some latent influencing factors and their uncertainties, such as rapid economic growth or economic crisis, relentless demographic forces, ever-changing individual behaviors, special activities and events, and complex waste management measures (Cherian & Jacob, 2012; Denafas et al., 2014; Ghiani, Laganà, Manni, Musmanno, & Vigo, 2014; Pires, Martinho, & Chang, 2011). For example, the annual waste generation trend in a megacity could be altered by large-scale activities (such as the Olympic Games and the World EXPO), long-term epidemic diseases (such as SARS), or a new regulation policy for municipal waste. The fluctuation of waste generation comes from unmeasured uncertainties of the economy, individual behaviors, population mobility, and unexpected disasters. The latent factors and their uncertainties are difficult to quantify, and they play an important role in tracing the fluctuation of waste generation dynamically and forecasting the consequences of changes. The fluctuation and nonlinearity of both municipal solid waste (MSW) and wastewater generation is a huge obstacle for accurate forecasting. It is difficult to forecast fluctuation of waste generation accurately via traditional statistical models, such as the moving average and linear regression models.

In this study, we focus on fluctuation forecasting problem. Three major contributions are made in this paper: (1) a probability model-driven statistical learning approach, that hybridizes a wavelet de-noising (WDE), a Gaussian mixture model (GMM), and a hidden Markov model (HMM), is proposed to trace waste generation fluctuations under uncertainties dynamically; (2) the way of weighted average Gaussian mixture and the way of searching the most similar pattern are proposed as two concrete HMM-based forecasting ways to cope with the periodic and non-periodic fluctuation problems, respectively; and (3) two kinds of case studies of different scenarios are presented in this study. They correspond to a small sample and a large sample datasets to show the effectiveness of the proposed approaches. The first case uses annual MSW generation in Shanghai and Beijing from 1978 to 2010, and the second case utilizes the daily wastewater level of a Spanish urban sewage treatment plant from 1990 to 1991.

The paper is organized as follows: Section 2 summarizes the details of related studies. Problem description and forecasting modelling are presented in Section 3. Section 4 provides two kinds of case studies to test the effectiveness of the proposed approaches. Finally, we close this paper with some conclusions and guidelines for future work.

So far, a number of forecasting techniques have been applied to waste generation forecasting. Mainstream methods include traditional statistical models, the gray and fuzzy models, simulation models, and non-probabilistic statistical learning models. In this section, we summarize the application scope, advantages, and weaknesses of these mainstream methods. Subsequently, literature of probability model-driven statistical learning approaches as a comparison is introduced briefly.

Traditional statistical models include linear regression models (LRM), autoregressive moving average (ARMA), autoregressive integrated moving average (ARIMA), seasonal ARIMA (sARIMA), exponential smoothing (ES), and seasonal ES (sES). LRM aims to discover a linear function to quantify waste generation. Essentially, the problem of waste generation is nonlinear, so LRM is just an approximate fitting method for waste generation forecasting. The ARMA, a mixture of autoregressive and moving average models, can be employed to forecast waste generation of stationary time series (Katsamaki, Willems, & Diamadopoulos, 1998). ARIMA stochastic models are effective time series forecasting tools which can take influence factors into consideration, and can also process periodic time series data effectively. ARIMA model has been applied to a range of forecasting fields, such as portfolio optimization (Ustun & Kasimbeyli, 2012), and MSW generation (Owusu-Sekyere, 2013). The ES model is performed by utilizing the weighted mean of all values in time series, which assigns exponentially decreasing weights over time. Both sARIMA and sES can take into account seasonal changes and trends (Denafas et al., 2014; Rimaityte et al., 2012; Song & He, 2014; Xu, Gao, Cui, & Liu, 2013). Traditional statistical models can forecast the moving average or discover smooth trend effectively; however, fluctuations are hard to be traced accurately.

The gray and fuzzy models are based on fuzzy set theory. The fuzzy mathematic method can solve problems with uncertainty, and can also obtain reliable models given poor data. Chen and Chang (2000) applied a gray fuzzy dynamic prediction technique to forecast MSW generation when the sample numbers were low. Karavezyris, Timpe, and Marzi (2002) employed fuzzy logic to enhance confidence in the validity of the system dynamics model. Fuzzy logic is an attractive method; however, the knowledge base of the fuzzy model is founded on expert experience. Gray model is suitable to study the uncertainty of systems and handle small sample dataset (Intharathirat et al., 2015); however, the conventional gray prediction model is sensitive to initial values (Guo, Liu, Wu, & Tang, 2014).

Simulation models are suitable for simulating complex systems which are difficult to express via mathematic formula. System dynamics (SD) is one of the promising of these methods for studying complex feedback systems. SD models have been widely used for predicting waste generation (Ahmad, 2012; Dyson & Chang, 2005; Karavezyris et al., 2002; Kollikkathara, Feng, & Yu, 2010). SD models use a multivariate method and are far more complex due to the multifarious interactions between the selected parameters (Beigl et al., 2008). Therefore, it is hard to achieve model validation.

Non-probabilistic statistical learning models for waste generation forecasting mainly include artificial neural networks (ANN) and support vector machines (SVM). ANN, one of the most widespread of intelligent statistical-learning models, has powerful ability to deal with nonlinear forecasting problems (Setzler, Saydam, & Park, 2009) and has been applied to generation forecasting fields (Ali Abdoli, Falah Nezhad, Salehi Sede, & Behboudian, 2012; Antanasijevic, Pocajt, Popovic, Redzic, & Ristic, 2013; Jalili Ghazi Zade & Noori, 2008). Although ANN is promising, the disadvantages, such as over-fitting and local minimum, limit its application. SVM is a nonlinear and kernel-based intelligent technique. Abbasi, Abduli, Omidvar, and Baghvand (2013), Noori, Abdoli, Ghasrodashti, and Jalili Ghazizade (2009), and Abbasi, Abduli, Omidvar, and Baghvand (2014)) proposed SVM models to implement weekly prediction of waste generation in the Iranian cities of Mashhad and Tehran, respectively. Compared with ANN, SVM overcomes the problem of over-fitting training data and local minimum. However, SVM is still a black box technique which cannot establish a mathematical functional mapping between the input variables and the drifting parameters (Dong et al., 2009).

Recently, probability model-driven statistical learning approaches have been effectively applied to perform forecasting under uncertainties. Compared with ANN and SVM, they are white box methods which focus more on the components of the mathematical model. For example, Bayesian network (BN) is a combination of graph theory and probability theory which has unique advantages for handling problems with uncertainty, and mining causality among variables. BN has been introduced into forecasting areas, such as traffic flow forecasting (Sun, Zhang, & Yu, 2006) and wastewater inflow monitoring (Cheon, Kim, Kim, & Kim, 2008). The quality of results produced by the BN method largely depends on the amount of evidence (Dong et al., 2009); however, they are not available in most cases. Another example is HMM which became popular for classification and pattern recognition problems after its appearance. The HMM has been applied to a range of fields, such as stock market forecasting (Hassan, 2009), PM2.5 concentration prediction (Dong et al., 2009), failure prognosis (Kim, Jiang, Makis, & Lee, 2011; Zhou, Hu, Xu, Chen, & Zhou, 2010), and manpower planning (Guerry, 2011). However, to the best of our knowledge, no study has previously forecasted waste generation via an HMM.

Although the first four stream methods have respective merits for various applications, there are still some difficulties using these methods for measuring and tracing fluctuations of waste generation dynamically. The advantages of the HMM lie in its theoretical basis, rigorous mathematical structure, and its proven fitness for modelling dynamic systems under uncertainties.

In this section, the study problems and their characteristics are first introduced. Then, models are constructed to forecast MSW and wastewater generation.

Municipal waste generation in megacities is a complex process of the interaction of intertwined systems, which is found to be influenced by latent influencing factors and their uncertainties. So waste generation has the characteristics of nonlinearity, fluctuation, and strong interference. The key challenges for waste generation forecasting problem of both MSW and wastewater lie in generation fluctuations which include non-periodic and periodic fluctuation. Annual MSW generation is a non-stationary time series. The increment rate, transformed from MSW generation, shows an obvious non-periodic fluctuation (Fig. 1
                        
                        
                        
                        ). Daily wastewater generation level is an approximate stationary time series with periodic fluctuation (Fig. 2).

Two techniques based on HMM are proposed to deal with above challenges of fluctuations:

                           
                              (1)
                              For the periodic fluctuation problem, all data from each period are selected to set up data patterns. For instance, we will obtain 9 patterns as shown in Fig. 2. Once two similar patterns are revealed (e.g., patterns 3 and 6, or patterns 4 and 7), we employ the similar pattern to forecast waste generation trend in the coming period.

For the non-periodic fluctuation problem, the variable to be forecasted and other observable factors can be integrated to constitute data patterns. Then, we can use the approach as above to forecast waste generation. However, if the number of searchable patterns is too small, the error of forecasted results becomes unacceptable. In this situation, one alternative forecasting way (weighted average Gaussian mixture) is employed to solve this problem.

A probability model-driven statistical learning approach, which hybridizes a wavelet de-noising, a Gaussian mixture model, and a hidden Markov model, is constructed to dynamically trace fluctuations of waste generation. An HMM is a double embedded stochastic process which includes a Markov process and a general stochastic process. Fig. 3 shows a simple HMM component structure sketch with a hidden state sequence and a directly visible observation sequence.

In this study, we define the total uncertainty degree of waste generation as a hidden variable. The hidden state sequence is assumed to follow a discrete-time, finite-state, and first-order Markov chain which implies that the current state is dependent only on the previous state. We also regard the variable to be forecasted as an observation which is a continuous random variable. The observation is assumed to be conditionally independent of all others given the state that generated it. Uncertainties do not need to be measured directly; instead, we let historical data tell us what the total uncertainty degree is most likely to be through data analysis.


                        Fig. 4 illustrates the process of HMM-based forecasting which includes three parts: Part I: data preprocessing, Part II: HMM modelling, and Part III: forecasting. There are two scenarios which follow different processes in Part III. Scenario I is for the non-periodic fluctuation problem with small sample sizes, and Scenario II is for the periodic fluctuation problem with large sample sizes. In this paper, we present two kinds of case studies that represent the different scenarios. MSW generation forecasting for Shanghai and Beijing (Scenario I) is carried out via the way of weighted average Gaussian mixture (WAGM) based on an HMM, while wastewater generation forecasting for the Spain Manresa sewage treatment plant (Scenario II) is implemented via the way of searching the most similar pattern (SMSP) based on an HMM.

This subsection mainly focuses on the preprocessing process for the whole model. This involves two steps: variable selection and data preprocessing.


                           Step 1. Variable selection
                        

The total uncertainty of latent influencing factors (non-observable variables) is taken as an integrated hidden variable which is called the total uncertainty degree of waste generation. The variable to be forecasted is regarded as a manifest variable (i.e., observation variable). In Fig. 3, hidden state sequence is composed of different total uncertainty degrees of waste generation, and observation sequence is consists of the actual values of the manifest variable.


                           Step 2. Data preprocessing
                        

This section includes wavelet de-noising and data pattern setup. The former is a tool for removing noise in the data series, and the latter is the basis step of pattern recognition in an HMM.


                           (I) Wavelet de-noising
                        

The municipal waste generation is fluctuant and nonlinear due to uncertainties. The statistic data of waste generation is not a true reflection of the underlying trend caused by sources of noises. Wavelet de-noising, that uses scaled and translated versions of the mother wavelet ψ
                           
                              j, k
                           (x) to build an approximation 
                              
                                 
                                    f
                                    ˜
                                 
                                 
                                    (
                                    x
                                    )
                                 
                              
                            of an original function f(x), is a reliable method to eliminate the data noise of a time series signal (De Souza e Silva, Legey, & de Souza e Silva, 2010). Wavelet translation can be expressed as follows:

                              
                                 (1)
                                 
                                    
                                       
                                          f
                                          ˜
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       
                                          ∑
                                          
                                             ∀
                                             j
                                             ,
                                             k
                                          
                                       
                                       
                                          c
                                          
                                             j
                                             ,
                                             k
                                          
                                       
                                       
                                          ψ
                                          
                                             j
                                             ,
                                             k
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                    
                                 
                              
                           
                           
                              
                                 (2)
                                 
                                    
                                       
                                          ψ
                                          
                                             j
                                             ,
                                             k
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       δ
                                       ψ
                                       
                                          (
                                          
                                             2
                                             j
                                          
                                          x
                                          −
                                          k
                                          )
                                       
                                       
                                       
                                    
                                 
                              
                           
                           
                              
                                 (3)
                                 
                                    
                                       
                                          c
                                          
                                             j
                                             ,
                                             k
                                          
                                       
                                       =
                                       
                                          ∫
                                          
                                             −
                                             ∞
                                          
                                          
                                             +
                                             ∞
                                          
                                       
                                       
                                          f
                                          
                                             (
                                             x
                                             )
                                          
                                          
                                             ψ
                                             
                                                j
                                                ,
                                                k
                                             
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          d
                                          x
                                       
                                    
                                 
                              
                           where c
                           
                              j, k
                            is wavelet coefficients; δ is a constant; k decides the translated versions of a wavelet; and 2
                              j
                            is its scale parameter.

Ingrid Daubechies invented compactly supported orthonormal wavelets, which makes the analysis of discrete wavelets practicable. The families of orthonormal wavelets are also called Daubechies wavelets. The Symlets are nearly symmetrical wavelets that were proposed as modifications to the Daubechies wavelets (Misiti, Misiti, Oppenheim, & Poggi, 2011, chap. 1). In this study, the Daubechies and Symlets wavelets were employed to carry out wavelet decomposition and synthesis-reconstruction. After wavelet decomposition, data signal could be decomposed into two categories of filters: low-pass filter (the approximation part) and high-pass filter (the detailed parts). The underlying trend of the all factors can be captured by the approximation part, and the noise features can be recorded by the detailed parts. Eq. (4) reconstructs the approximation part (AJ
                           ) and the detailed parts (
                              
                                 
                                    D
                                    1
                                 
                                 ,
                                 
                                    D
                                    2
                                 
                                 ,
                                 …
                                 ,
                                 
                                    D
                                    J
                                 
                              
                           ) into a new time series data signal (Misiti et al., 2011, chap. 1):

                              
                                 (4)
                                 
                                    
                                       S
                                       =
                                       
                                          A
                                          J
                                       
                                       +
                                       
                                          D
                                          1
                                       
                                       +
                                       
                                          D
                                          2
                                       
                                       +
                                       ⋯
                                       +
                                       
                                          D
                                          J
                                       
                                    
                                 
                              
                           where S is new signal, and J is scale parameter. After reconstruction, the new time series will be regarded as updated data for training and testing of the WDE-HMM approach. This will be illustrated by a specific example in Section 4.


                           (II) Data pattern setup
                        

Data patterns that can reflect the characteristics of fluctuation refer to specific and similar data vectors which follow a defined rule. In order to forecast fluctuations of waste generation in a large sample via an HMM, datasets of observations are usually arranged in a specific order so that every data vector forms a pattern which is the basis for data pattern recognition in an HMM. For example, the wastewater generation data for each week (no data on Saturday) of the Manresa sewage treatment plant is arranged in a data pattern [Monday, Tuesday, Wednesday, Thursday, Friday, and Sunday]. This pattern can interpret the wastewater generation behavior of each week. Waste generation in historical municipal activities or incidents can provide reference for future forecasting. When a similar situation reoccurs, this historical pattern can be used to forecast.

The main difference between continuous HMMs and discrete HMMs lies in the statistic property of observations. In this study, the observation of each state is a vector of continuous random variables. This subsection includes four steps: continuous HMM modelling, parameter initialization, training and parameter determination, and Viterbi decoding.


                           Step 1. Continuous HMM modelling
                        


                           Fig. 5
                            shows the translation relationship of hidden states and observations in a continuous HMM. For each hidden state, a probability exists for the current state to transform into any possible state, while each observation vector (i.e., data pattern) can be observed with a probability in its corresponding hidden state.

The primary notations that will be used for the rest of this paper are listed as follows:

                              
                                 
                                    N: The number of the hidden states of this model;


                                    T: Length of the state sequence or observation sequence. 
                                       
                                          t
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          T
                                       
                                    ;


                                    S: A set of states. 
                                       
                                          S
                                          =
                                          {
                                          
                                             s
                                             1
                                          
                                          ,
                                          
                                             s
                                             2
                                          
                                          ,
                                          …
                                          ,
                                          
                                             s
                                             i
                                          
                                          ,
                                          …
                                          ,
                                          
                                             s
                                             N
                                          
                                          }
                                       
                                     and 
                                       
                                          i
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          N
                                       
                                    ;


                                    Q: State sequence 
                                       
                                          {
                                          
                                             q
                                             1
                                          
                                          ,
                                          
                                             q
                                             2
                                          
                                          ,
                                          …
                                          ,
                                          
                                             q
                                             T
                                          
                                          }
                                       
                                    , where 
                                       
                                          
                                             q
                                             t
                                          
                                          =
                                          
                                             s
                                             i
                                          
                                       
                                     represents the hidden state at time t;


                                    
                                       O
                                    : Observation vector sequence, 
                                       
                                          O
                                          =
                                          {
                                          
                                             O
                                             1
                                          
                                          ,
                                          
                                             O
                                             2
                                          
                                          ,
                                          …
                                          ,
                                          
                                             O
                                             t
                                          
                                          ,
                                          …
                                          ,
                                          
                                             O
                                             T
                                          
                                          }
                                       
                                    ;


                                    π: The prior probability of initial state {πi
                                    };


                                    A: Transition matrix 
                                       
                                          
                                             A
                                             =
                                          
                                          {
                                          
                                             a
                                             
                                                i
                                                j
                                             
                                          
                                          }
                                       
                                    , aij
                                     represents state transition probability from the hidden state i to state j,
                                       
                                          j
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          N
                                       
                                    ;


                                    B: A family of probability density functions 
                                       
                                          B
                                          =
                                          {
                                          
                                             b
                                             j
                                          
                                          
                                             (
                                             O
                                             )
                                          
                                          }
                                       
                                    ;


                                    bj
                                    (
                                       O
                                    ): The occurrence probability of observation at state j. bj
                                    (
                                       O
                                    ) is illustrated by a widely used multi-dimensional Gaussian distribution:
                                       
                                          (5)
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            b
                                                            j
                                                         
                                                         
                                                            (
                                                            O
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                            k
                                                         
                                                         
                                                            P
                                                            (
                                                            
                                                               K
                                                               j
                                                            
                                                            =
                                                            k
                                                            |
                                                            
                                                               s
                                                               t
                                                            
                                                            =
                                                            j
                                                            )
                                                            
                                                         
                                                         
                                                            b
                                                            
                                                               j
                                                               k
                                                            
                                                         
                                                         
                                                            (
                                                            O
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                            k
                                                         
                                                         
                                                            P
                                                            
                                                               (
                                                               
                                                                  K
                                                                  j
                                                               
                                                               =
                                                               k
                                                               |
                                                               
                                                                  s
                                                                  t
                                                               
                                                               =
                                                               j
                                                               )
                                                            
                                                            Φ
                                                            
                                                               [
                                                               O
                                                               ,
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     j
                                                                     k
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     Σ
                                                                  
                                                                  
                                                                     j
                                                                     k
                                                                  
                                                               
                                                               ]
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                            k
                                                         
                                                         
                                                            
                                                               c
                                                               
                                                                  j
                                                                  k
                                                               
                                                            
                                                            Φ
                                                            
                                                               [
                                                               O
                                                               ,
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     j
                                                                     k
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     Σ
                                                                  
                                                                  
                                                                     j
                                                                     k
                                                                  
                                                               
                                                               ]
                                                            
                                                            ,
                                                         
                                                         
                                                         
                                                         1
                                                         ≤
                                                         j
                                                         ≤
                                                         N
                                                         ,
                                                         
                                                         1
                                                         ≤
                                                         k
                                                         ≤
                                                         K
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 


                           λ: The overall parameters 
                              
                                 λ
                                 =
                                 (
                                 π
                                 ,
                                 A
                                 ,
                                 B
                                 )
                              
                           , and 
                              
                                 
                                    ∑
                                    i
                                 
                                 
                                    π
                                    i
                                 
                                 =
                                 1
                              
                           , 
                              
                                 
                                    ∑
                                    j
                                 
                                 
                                    a
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 1
                              
                           , 
                              
                                 
                                    ∫
                                    
                                       −
                                       ∞
                                    
                                    
                                       +
                                       ∞
                                    
                                 
                                 
                                    
                                       b
                                       j
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    d
                                    x
                                 
                                 =
                                 1
                              
                           .


                           Step 2. Parameter initialization
                        

Prior knowledge about probabilities of parameters 
                              
                                 λ
                                 =
                                 (
                                 π
                                 ,
                                 A
                                 ,
                                 B
                                 )
                              
                            is extremely useful for parameter initialization, but it is often not available. For case with prior information, parameters can be initialized easily. For case without prior knowledge, we only consider the basic constraints above to initialize parameters (λ) randomly. Note that the proper number of hidden states is unknown in this step which will be eventually decided in parameter determination of Step 3.


                           Step 3. Training and parameter determination
                        

In this step, parameters are updated through training the HMM. The most suitable number of hidden states and the proper number of mixture components of a GMM are determined by Akaike's information criterion (AIC).


                           (I) Training
                        

In the training step, once we obtain the observation sequence 
                              
                                 O
                                 =
                                 {
                                 
                                    O
                                    1
                                 
                                 ,
                                 
                                    O
                                    2
                                 
                                 ,
                                 …
                                 ,
                                 
                                    O
                                    t
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       O
                                    
                                    T
                                 
                                 }
                              
                            the parameters (λ) of an HMM can be trained by the Expectation–Maximization (EM) algorithm (Bilmes, 1998; Rabiner, 1989) which iterates ceaselessly until it converges to the maximum likelihood. After updating all parameters, the new parameter set is 
                              
                                 
                                    
                                       λ
                                       ¯
                                    
                                    
                                       M
                                       L
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       π
                                       ¯
                                    
                                    ,
                                    
                                       A
                                       ¯
                                    
                                    ,
                                    
                                       B
                                       ¯
                                    
                                    )
                                 
                              
                           
                           
                              
                                 =
                                 arg
                                 
                                    max
                                    λ
                                 
                                 P
                                 
                                    (
                                    
                                       O
                                       |
                                       λ
                                    
                                    )
                                 
                              
                           , where 
                              
                                 
                                    π
                                    ¯
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          π
                                          ¯
                                       
                                       i
                                    
                                    }
                                 
                              
                           , 
                              
                                 
                                    A
                                    ¯
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          a
                                          ¯
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    }
                                 
                              
                           , and 
                              
                                 
                                    B
                                    ¯
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          b
                                          ¯
                                       
                                       j
                                    
                                    
                                       (
                                       O
                                       )
                                    
                                    }
                                 
                              
                           . The updated initial state probability (
                              
                                 
                                    π
                                    ¯
                                 
                                 i
                              
                           ), transition probability (
                              
                                 
                                    a
                                    ¯
                                 
                                 
                                    i
                                    j
                                 
                              
                           ), mixture coefficients (
                              
                                 
                                    c
                                    ¯
                                 
                                 
                                    j
                                    k
                                 
                              
                           ), mean vector (
                              
                                 
                                    
                                       μ
                                       ¯
                                    
                                 
                                 
                                    j
                                    k
                                 
                              
                           ), and covariance matrix (
                              
                                 
                                    
                                       Σ
                                       ¯
                                    
                                 
                                 
                                    j
                                    k
                                 
                              
                           ) are expressed as follows:

                              
                                 (6)
                                 
                                    
                                       
                                          
                                             π
                                             ¯
                                          
                                          i
                                       
                                       =
                                       
                                          ξ
                                          1
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                 
                              
                           
                           
                              
                                 (7)
                                 
                                    
                                       
                                          
                                             a
                                             ¯
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             ξ
                                             t
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                       
                                       /
                                       
                                          ∑
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             ξ
                                             t
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                       
                                    
                                 
                              
                           
                           
                              
                                 (8)
                                 
                                    
                                       
                                          
                                             c
                                             ¯
                                          
                                          
                                             j
                                             k
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             t
                                             =
                                             1
                                          
                                          T
                                       
                                       
                                          
                                             ξ
                                             t
                                          
                                          
                                             (
                                             j
                                             ,
                                             k
                                             )
                                          
                                       
                                       /
                                       
                                          ∑
                                          
                                             t
                                             =
                                             1
                                          
                                          T
                                       
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          
                                             
                                                ξ
                                                t
                                             
                                             
                                                (
                                                j
                                                ,
                                                k
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (9)
                                 
                                    
                                       
                                          
                                             
                                                μ
                                                ¯
                                             
                                          
                                          
                                             j
                                             k
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             t
                                             =
                                             1
                                          
                                          T
                                       
                                       
                                          
                                             ξ
                                             t
                                          
                                          
                                             (
                                             j
                                             ,
                                             k
                                             )
                                          
                                       
                                       ·
                                       
                                          O
                                          t
                                       
                                       /
                                       
                                          ∑
                                          
                                             t
                                             =
                                             1
                                          
                                          T
                                       
                                       
                                          
                                             ξ
                                             t
                                          
                                          
                                             (
                                             j
                                             ,
                                             k
                                             )
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (10)
                                 
                                    
                                       
                                          
                                             
                                                Σ
                                                ¯
                                             
                                          
                                          
                                             j
                                             k
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             t
                                             =
                                             1
                                          
                                          T
                                       
                                       
                                          
                                             ξ
                                             t
                                          
                                          
                                             (
                                             j
                                             ,
                                             k
                                             )
                                          
                                       
                                       ·
                                       
                                          (
                                          
                                             O
                                             t
                                          
                                          −
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                                k
                                             
                                          
                                          )
                                       
                                       
                                          
                                             (
                                             
                                                O
                                                t
                                             
                                             −
                                             
                                                
                                                   μ
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                             )
                                          
                                          T
                                       
                                       /
                                       
                                          ∑
                                          
                                             t
                                             =
                                             1
                                          
                                          T
                                       
                                       
                                          
                                             ξ
                                             t
                                          
                                          
                                             (
                                             j
                                             ,
                                             k
                                             )
                                          
                                       
                                    
                                 
                              
                           where ξt
                           (i) and ξt
                           (j) represent the probability of being in si
                            and sj
                            at time t, respectively; ξt
                           (i, j) represents the probability of being in si
                            at time t and in sj
                            at time 
                              
                                 t
                                 +
                                 1
                              
                           ; ξt
                           (j, k) represents the probability of being in sj
                            at time t with the kth mixture component; and 
                              O
                           
                           
                              t
                            is the observation at time t in the observation sequence. The forward–backward variables α and β can be used to illustrate these probabilities:

                              
                                 (11)
                                 
                                    
                                       
                                          ξ
                                          t
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                       =
                                       
                                          α
                                          t
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                       
                                          β
                                          t
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                       /
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             α
                                             t
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                          
                                             β
                                             t
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (12)
                                 
                                    
                                       
                                          ξ
                                          t
                                       
                                       
                                          (
                                          j
                                          )
                                       
                                       =
                                       
                                          α
                                          t
                                       
                                       
                                          (
                                          j
                                          )
                                       
                                       
                                          β
                                          t
                                       
                                       
                                          (
                                          j
                                          )
                                       
                                       /
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             α
                                             t
                                          
                                          
                                             (
                                             j
                                             )
                                          
                                          
                                             β
                                             t
                                          
                                          
                                             (
                                             j
                                             )
                                          
                                       
                                       
                                       
                                    
                                 
                              
                           
                           
                              
                                 (13)
                                 
                                    
                                       
                                          ξ
                                          t
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                α
                                                t
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             
                                                a
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                b
                                                j
                                             
                                             
                                                (
                                                
                                                   O
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                β
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                                   
                                                      α
                                                      t
                                                   
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                   
                                                      a
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   
                                                      b
                                                      j
                                                   
                                                   
                                                      (
                                                      
                                                         O
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      β
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (14)
                                 
                                    
                                       
                                          ξ
                                          t
                                       
                                       
                                          (
                                          j
                                          ,
                                          k
                                          )
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   α
                                                   t
                                                
                                                
                                                   (
                                                   j
                                                   )
                                                
                                                
                                                   β
                                                   t
                                                
                                                
                                                   (
                                                   j
                                                   )
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                                   
                                                      α
                                                      t
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                   
                                                      β
                                                      t
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       
                                          [
                                          
                                             
                                                
                                                   c
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                Φ
                                                
                                                   [
                                                   
                                                      O
                                                      t
                                                   
                                                   ,
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                   ]
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   K
                                                
                                                
                                                   
                                                      c
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                   Φ
                                                   
                                                      [
                                                      
                                                         O
                                                         t
                                                      
                                                      ,
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            Σ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                      ]
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                        

Since the EM algorithm easily converges to a local optimum or a saddle point, the log-likelihood estimator of the EM algorithm may less than from the maximum log-likelihood estimator. To improve the quality of parameter estimation, in this study, the model is trained by varied initial parameters (λ) with multiple runs to obtain the updated parameters (
                              
                                 λ
                                 ¯
                              
                           ) by choosing the biggest log-likelihood estimator.


                           (II) Parameter determination
                        

It is difficult yet crucial to determine the number of hidden states and components of the GMM in an HMM. Tradeoff always exists between a more accurate result and a smaller computing complexity for this problem. In this paper, AIC (Akaike, 1973), which is a simple and useful model selection criterion based on K–L information, is employed to determine the numbers, as the method attempts to optimize the tradeoff between complexity and goodness of fit (Eq. (15)). We consider the number combination of hidden states and mixture components with the smallest AIC as the best parameter for modeling.

                              
                                 (15)
                                 
                                    
                                       A
                                       I
                                       C
                                       =
                                       −
                                       2
                                       ln
                                       (
                                       L
                                       )
                                       +
                                       2
                                       p
                                    
                                 
                              
                           
                           
                              
                                 (16)
                                 
                                    
                                       p
                                       =
                                       N
                                       +
                                       N
                                       
                                          (
                                          
                                             N
                                             −
                                             1
                                          
                                          )
                                       
                                       +
                                       N
                                       
                                          (
                                          
                                             K
                                             +
                                             K
                                             (
                                             
                                                K
                                                +
                                             
                                             1
                                             )
                                             /
                                             2
                                          
                                          )
                                       
                                    
                                 
                              
                           where L is the likelihood function; p is the number of parameters to be estimated which include state, transition, and emission parameters; N is the number of hidden states; and K is the number of components of the GMM.


                           Step 4. Viterbi decoding
                        

In the decoding step, the new parameter set 
                              
                                 λ
                                 ¯
                              
                            and the observation sequence 
                              O
                            are available. The most probable sequence of states 
                              
                                 
                                    
                                       Q
                                    
                                    *
                                 
                                 =
                                 
                                    {
                                    
                                       q
                                       1
                                       *
                                    
                                    ,
                                    
                                       q
                                       2
                                       *
                                    
                                    ,
                                    .
                                    .
                                    .
                                    ,
                                    
                                       q
                                       T
                                       *
                                    
                                    }
                                 
                              
                            can be calculated by the Viterbi decoding (Rabiner, 1989). Q* can be expressed as:

                              
                                 (17)
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          *
                                       
                                       =
                                       arg
                                       
                                          max
                                          Q
                                       
                                       
                                          {
                                          P
                                          
                                             (
                                             Q
                                             |
                                             O
                                             ,
                                             
                                                λ
                                                _
                                             
                                             )
                                          
                                          }
                                       
                                    
                                 
                              
                           
                        

Let δt
                           (i) be the maximal probability of state sequences {
                              
                                 
                                    q
                                    1
                                 
                                 ,
                                 
                                    q
                                    2
                                 
                                 ,
                                 …
                                 ,
                                 
                                    q
                                    t
                                 
                                 ,
                                 
                                    q
                                    t
                                 
                                 =
                                 
                                    s
                                    i
                                 
                              
                           } at time t which generate the observations {
                              
                                 
                                    O
                                    1
                                 
                                 ,
                                 
                                    O
                                    2
                                 
                                 ,
                                 …
                                 ,
                                 
                                    O
                                    t
                                 
                              
                           } for the given model.

                              
                                 (18)
                                 
                                    
                                       
                                          δ
                                          t
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                       =
                                       
                                          max
                                          
                                             
                                                q
                                                1
                                             
                                             ,
                                             
                                                q
                                                2
                                             
                                             ,
                                             …
                                             ,
                                             
                                                q
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       P
                                       
                                          (
                                          
                                             q
                                             1
                                          
                                          ,
                                          
                                             q
                                             2
                                          
                                          ,
                                          …
                                          ,
                                          
                                             q
                                             t
                                          
                                          ,
                                          
                                             q
                                             t
                                          
                                          =
                                          
                                             s
                                             i
                                          
                                          ,
                                          
                                             O
                                             1
                                          
                                          ,
                                          
                                             O
                                             2
                                          
                                          ,
                                          …
                                          ,
                                          
                                             O
                                             t
                                          
                                          |
                                          
                                             λ
                                             _
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        

The Viterbi decoding is a dynamic programming method. 
                              
                                 
                                    
                                       Q
                                    
                                    *
                                 
                                 =
                                 
                                    {
                                    
                                       q
                                       1
                                       *
                                    
                                    ,
                                    
                                       q
                                       2
                                       *
                                    
                                    ,
                                    …
                                    ,
                                    
                                       q
                                       T
                                       *
                                    
                                    }
                                 
                              
                            can be derived when achieving recursive results as max[δt
                           (i)].

This section includes two steps: forecasting waste generation for the two scenarios in Fig. 4 and data post-preprocessing by the bootstrapping.


                           Step 1. Forecasting
                        

The way of weighted average Gaussian mixture and the way of searching the most similar pattern (Hassan, 2009) can be employed to forecast non-periodic and non-periodic fluctuations via the HMM, respectively. After repeated experiments, we found that the former is suitable for both small sample (approximately 25–30 data points with non-periodic fluctuation) and large sample forecasting, and that the latter is proper for large sample forecasting.


                           (I) Forecasting way for Scenarios I
                        

Conventionally, a sample size less than 30 is considered small, making it difficult to detect similar patterns from historical data with such limited training data. In this situation, the way of weighted average Gaussian mixture, which integrates states transition and observations probability, is a better choice than the way of searching the most similar pattern.

The state transition matrix A(i, j), learned by the training dataset, can reflect historical relations among hidden states. Some fresh information about changes of fractional latent influencing parameters is available at some forecasting points beforehand, such as a new issuing management policy on controlling MSW generation, a deteriorating economic crisis, or an expected large-scale activity. Although the controlling effects of the policy, real deteriorating degree of the crisis, and concrete participation degree of residents in the activity are also uncertain, they can still provide useful information to update the state transition matrix A(i, j) to a new one 
                              
                                 
                                    A
                                    ˜
                                 
                                 
                                    (
                                    
                                       i
                                       ,
                                       j
                                    
                                    )
                                 
                              
                           . The forecasted amount Fτ
                            at time 
                              
                                 
                                    T
                                    +
                                 
                                 τ
                              
                            is given by:

                              
                                 (19)
                                 
                                    
                                       
                                          F
                                          τ
                                       
                                       =
                                       
                                          F
                                          
                                             τ
                                             −
                                             1
                                          
                                       
                                       
                                          (
                                          1
                                          +
                                          
                                             r
                                             τ
                                          
                                          )
                                       
                                    
                                 
                              
                           
                           
                              
                                 (20)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                   τ
                                                
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     j
                                                                     =
                                                                     1
                                                                  
                                                                  N
                                                               
                                                               
                                                                  
                                                                     
                                                                        A
                                                                        ˜
                                                                     
                                                                  
                                                                  τ
                                                               
                                                               
                                                                  (
                                                                  
                                                                     q
                                                                     T
                                                                  
                                                                  ,
                                                                  
                                                                     s
                                                                     j
                                                                  
                                                                  )
                                                               
                                                               
                                                                  E
                                                                  j
                                                               
                                                               
                                                                  (
                                                                  X
                                                                  )
                                                               
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               if
                                                               
                                                               fresh
                                                               
                                                               information
                                                               
                                                               exists
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     j
                                                                     =
                                                                     1
                                                                  
                                                                  N
                                                               
                                                               
                                                                  A
                                                                  τ
                                                               
                                                               
                                                                  (
                                                                  
                                                                     q
                                                                     T
                                                                  
                                                                  ,
                                                                  
                                                                     s
                                                                     j
                                                                  
                                                                  )
                                                               
                                                               
                                                                  E
                                                                  j
                                                               
                                                               
                                                                  (
                                                                  X
                                                                  )
                                                               
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               if
                                                               
                                                               no
                                                               
                                                               fresh
                                                               
                                                               information
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where rτ
                            is the MSW increment rate at time 
                              
                                 
                                    T
                                    +
                                 
                                 τ
                              
                           , forecasted via the proposed model; 
                              
                                 
                                    F
                                    0
                                 
                                 =
                                 
                                    O
                                    T
                                 
                              
                            when 
                              
                                 τ
                                 =
                                 1
                              
                           ; X is a continuous random variable which represents the MSW increment rate; Ej
                           (X) is the expectation of X under hidden state j; qT
                            is the hidden state at time T; sj
                            represents one state in the set of states 
                              
                                 S
                                 =
                                 {
                                 
                                    s
                                    1
                                 
                                 ,
                                 
                                    s
                                    2
                                 
                                 ,
                                 …
                                 ,
                                 
                                    s
                                    N
                                 
                                 }
                              
                           ; and updated 
                              
                                 
                                    
                                       A
                                       ˜
                                    
                                    τ
                                 
                                 
                                    (
                                    
                                       q
                                       T
                                    
                                    ,
                                    
                                       s
                                       j
                                    
                                    )
                                 
                              
                            is the τ-step state transition probability from the state of time T to the state sj
                           .


                           (II) Forecasting way for Scenarios II
                        

For a large data sample, once the HMM is trained, the log-likelihood estimator of each data pattern can be calculated by the forward algorithm (Rabiner, 1989). Then, we use Eq. (21) to discover the time point with the most similar pattern in historical data to the current pattern (i.e., the pattern at time T).

                              
                                 (21)
                                 
                                    
                                       
                                          t
                                          *
                                       
                                       =
                                       arg
                                       
                                          min
                                          t
                                       
                                       
                                          {
                                          |
                                          L
                                          L
                                       
                                       
                                          E
                                          T
                                       
                                       −
                                       L
                                       L
                                       
                                          E
                                          t
                                       
                                       
                                          |
                                          }
                                       
                                       
                                       1
                                       ≤
                                       t
                                       ≤
                                       T
                                       −
                                       1
                                    
                                 
                              
                           where LLET
                            and LLEt
                            are log-likelihood estimators at current time (T) and historical time (t), respectively.

Theoretically, the nearest log-likelihood estimators can be discerned at time point t* from the historical data. The waste generation behavior of time point t* is most similar to that of current time point T. We assume that the increment rate that follows the reference point is the same as the point we are attempting to forecast. Thus, the ith forecasted amount in the data pattern at time 
                              
                                 T
                                 +
                                 1
                              
                            is 
                              F
                           
                           
                              i
                           :

                              
                                 (22)
                                 
                                    
                                       
                                          F
                                          i
                                       
                                       =
                                       
                                          O
                                          T
                                          i
                                       
                                       
                                          [
                                          
                                             (
                                             
                                                O
                                                
                                                   
                                                      t
                                                      *
                                                   
                                                   +
                                                   1
                                                
                                                i
                                             
                                             −
                                             
                                                O
                                                
                                                   
                                                      t
                                                      *
                                                   
                                                
                                                i
                                             
                                             )
                                          
                                          /
                                          
                                             O
                                             
                                                
                                                   t
                                                   *
                                                
                                             
                                             i
                                          
                                          +
                                          1
                                          ]
                                       
                                       
                                       1
                                       ≤
                                       i
                                       ≤
                                       I
                                    
                                 
                              
                           where I is the element number of the data pattern defined in a specific case.


                           Step 2. Data post-processing
                        

Discovering the most similar pattern is crucial for the second forecasting way. Due to the local optimum characteristic of EM algorithm, the HMM would find several similar patterns to the current one from the historical data. The local optimum may be a better predictor of behavior than a temporally distant global optimum as similar patterns that are closer in time should have more impact on one another. Here we make use of this fact by training the model via multi-simulation of K runs. After each multi-simulation training, we extract the most similar pattern and calculate a forecasted amount Fk
                            (
                              
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 K
                              
                           ). Then, the bootstrapping method (Efron, 1979) was utilized to estimate 95 percent confidence intervals of the forecasted amount

                              
                                 {
                                 
                                    F
                                    1
                                 
                                 ,
                                 
                                    F
                                    2
                                 
                                 ,
                                 …
                                 ,
                                 
                                    F
                                    K
                                 
                                 }
                              
                           , which is an especially proper statistical resampling algorithm for small sample dataset with unknown distribution.

This section illustrates two kinds of cases, that are yearly MSW generation with non-periodic fluctuation for both Shanghai and Beijing (case I), and daily wastewater generation with periodic fluctuation for the Manresa sewage treatment plant (case II). The original datasets were extracted from the Shanghai Statistical Yearbook 2011 (Shanghai Bureau, 2011), the Beijing Statistical Yearbook 2011 (Beijing Bureau, 2011), and the UC Irvine Machine Learning Repository (Bache & Lichman, 2013), respectively.

To assess the forecasting accuracy, four frequently used criteria were applied for comparisons of the proposed models and other models. The mean absolute error (MAE), the mean square error (MSE), the coefficient of determination (R
                     2), and the adjusted coefficient of determination (adjusted 
                     R
                     2) are given by:

                        
                           (23)
                           
                              
                                 
                                    M
                                    A
                                    E
                                    =
                                 
                                 
                                    1
                                    n
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    |
                                    
                                       
                                          A
                                          i
                                       
                                       −
                                       
                                          F
                                          i
                                       
                                    
                                    |
                                 
                              
                           
                        
                     
                     
                        
                           (24)
                           
                              
                                 
                                    M
                                    S
                                    E
                                 
                                 =
                                 
                                    1
                                    n
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    
                                       (
                                       
                                          A
                                          i
                                       
                                       −
                                       
                                          F
                                          i
                                       
                                       )
                                    
                                    2
                                 
                                 
                              
                           
                        
                     
                     
                        
                           (25)
                           
                              
                                 
                                    R
                                    2
                                 
                                 =
                                 1
                                 −
                                 S
                                 S
                                 E
                                 /
                                 S
                                 S
                                 T
                                 =
                                 1
                                 −
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    
                                       (
                                       
                                          A
                                          i
                                       
                                       −
                                       
                                          F
                                          i
                                       
                                       )
                                    
                                    2
                                 
                                 /
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    
                                       (
                                       
                                          A
                                          i
                                       
                                       −
                                       
                                          A
                                          ¯
                                       
                                       )
                                    
                                    2
                                 
                              
                           
                        
                     
                     
                        
                           (26)
                           
                              
                                 a
                                 d
                                 j
                                 u
                                 s
                                 t
                                 e
                                 d
                                 
                                 
                                    R
                                    2
                                 
                                 =
                                 1
                                 −
                                 
                                    
                                       n
                                       −
                                       1
                                    
                                    
                                       n
                                       −
                                       k
                                       −
                                       1
                                    
                                 
                                 S
                                 S
                                 E
                                 /
                                 S
                                 S
                                 T
                              
                           
                        
                     where Ai
                      is the actual amount; Fi
                      is the forecasted amount; n is the testing sample size; k is the number of explanatory variables.

ARIMA and sARIMA, ES and sES, ANN, and SVM, introduced in Section 2, are all widely used and effective models to perform waste generation forecasting. Therefore, they were also implemented to compare and assess the effectiveness of the proposed models. For building ARIMA and sARIMA models, the autocorrelation function plot and AIC were both considered to discover the best-fitted model from the profile of different parameters (p, d, q). To build ES model for non-seasonal trend forecasting, the best suitable model is selected out among simple ES, double (Brown) ES, linear (Holt) ES, and damped-trend linear ES. To analysis seasonal trend by sES model, simple sES, winters additive algorithm based ES, and winters multiplicative algorithm based ES were tested on the formatted time series. The most suitable ES or sES models were selected by the Expert Modeler in the SPSS 19.0 software. The BP neural network, the most frequently used architecture of ANN, was utilized in this study, which is a three-layer network including input layer, hidden layer, and output layer. The classical Levenberg–Marquardt backpropagation algorithm is employed to update weights and bias states. Optimized parameters of ANN are given in Sections 4.1.3 and 4.2.3. The SVM regression was performed using the LIBSVM software (Chang & Lin, 2011). SVM regression with four types of kernel functions (i.e. linear, polynomial, radial basis function, and sigmoid) were tested to find out the most appropriate kernel function for the given application, according to criteria of MSE and R
                     2 during training and testing stages. A two-step grid search method consisted of coarse grid search and finer grid search was used to select the best parameter of gamma function and loss function. In the process of parameters selection, the cross validation was employed to avoid over fitting problem.

@&#BACKGROUND@&#

Shanghai, the economic center of China, is a megacity with a resident population over 23 million and yearly GDP of more than ¥2 trillion; Beijing, the capital city of China, is another megacity even in the world. The waste generation of both Shanghai and Beijing remains a strong upward trend over the past three decades. Fig. 6
                            shows MSW generation with non-periodic fluctuation in these two cities from 1978 to 2010.

The dataset of waste generation increment rate was chosen as input data in order to meet the requirement of stationary time series which was tested by the autocorrelations function and the Q–Q plot. An assumption test method, the one-sample Kolmogorov–Smirnov test, was used to explore the distribution of input data which can be utilized to initialize the state transition matrix. The testing results are presented in Table 1
                           , which show that we cannot reject the null hypothesis that the data in MSW increment rate dataset comes from a normal distribution at the significance level of 0.05. Testing for independent and identically distributed (i.i.d.) hypothesis with the correlogram was implemented for the time series of the MSW increment rate. The results show that only 1 of the 32 values of 
                              
                                 
                                    ρ
                                    ^
                                 
                                 k
                              
                            lies outside the bounds 
                              
                                 ±
                                 1.96
                                 /
                                 
                                    T
                                 
                              
                            (
                              
                                 α
                                 =
                                 0.05
                              
                           ), and there is no evidence to reject the null hypothesis (
                              
                                 
                                    H
                                    0
                                 
                                 :
                                 
                                    ρ
                                    k
                                 
                                 =
                                 0
                              
                           ) that the observations are independently distributed.

The selected dataset was divided into two sets, one for training and the other for testing. To avoid random error, the HMM was tested using data from 2004 to 2010. We trained it using the data from 1978 to 2003 to forecast waste generation in 2004, continued to train it using the data from 1978 to 2004 to forecast waste generation in 2005, and so forth. In order to forecast waste generation via the WDE-HMM approach, waste generation data signal was decomposed by Symlets of level 5 for Shanghai and level 3 for Beijing, and then de-noised by the penalized high thresholding function via the MATLAB wavelet toolbox. Using AIC, we define the number of hidden states (N) as 5 and the mixture components (K) of a GMM as 3 (see bold values in Table 2
                           ).

In this study, the total uncertainty degree of waste generation (denoted as ζ) is taken as a hidden variable. The lower the total uncertainty degree is, the smaller the increment rate fluctuation around the mean value will be; while the higher it is, the larger the increment rate fluctuation will be. 
                              
                                 ζ
                                 =
                                 ζ
                                 (
                                 
                                    
                                       ς
                                       1
                                    
                                    ,
                                    
                                       ς
                                       2
                                    
                                    ,
                                    
                                       ς
                                       3
                                    
                                    ,
                                    
                                       ς
                                       4
                                    
                                    ,
                                    
                                       ς
                                       5
                                    
                                    ,
                                    …
                                 
                                 )
                              
                            expresses that ζ is correlated to a number of uncertainties, mainly such as uncertainty from the economy (ς1), population mobility (ς2), individual behaviors (ς3), management policy (ς4), unexpected disasters (ς5), etc. In case I, the number of hidden states is 5. So total uncertainty degree can be divided into five discrete states (denoted as “–high,” “–low,” “0,” “+low,” and “+high”), where “–” means total uncertainty of negative effects which resulting in a waste increment rate that is lower than the mean increment rate, while “+” indicates the total uncertainty of positive effects which cause the waste increment rate to be higher than the mean. The initial state transition probability among different total uncertainty degrees can be expressed by Gaussian distribution of the MSW increment rate and a random parameter, for example, 
                              
                                 
                                    A
                                    0
                                 
                                 
                                    (
                                    3
                                    ,
                                    3
                                    )
                                 
                                 =
                                 Φ
                                 
                                    (
                                    μ
                                    +
                                    α
                                    σ
                                    )
                                 
                                 −
                                 Φ
                                 
                                    (
                                    μ
                                    −
                                    α
                                    σ
                                    )
                                 
                              
                           , 
                              
                                 
                                    A
                                    0
                                 
                                 
                                    (
                                    3
                                    ,
                                    2
                                    )
                                 
                                 =
                                 
                                    A
                                    0
                                 
                                 
                                    (
                                    3
                                    ,
                                    4
                                    )
                                 
                                 =
                                 Φ
                                 
                                    (
                                    μ
                                    −
                                    α
                                    σ
                                    )
                                 
                                 −
                                 Φ
                                 
                                    (
                                    μ
                                    −
                                    2
                                    α
                                    σ
                                    )
                                 
                              
                            and 
                              
                                 
                                    A
                                    0
                                 
                                 
                                    (
                                    3
                                    ,
                                    1
                                    )
                                 
                                 =
                                 
                                    A
                                    0
                                 
                                 
                                    (
                                    3
                                    ,
                                    5
                                    )
                                 
                                 =
                                 Φ
                                 
                                    (
                                    μ
                                    −
                                    2
                                    α
                                    σ
                                    )
                                 
                              
                           , where μ is the mean value of the increment rate; σ is standard deviation; and α ∈ [0.5, 1] is a random term. The initial transition matrix can be expressed as:

                              
                                 (27)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                       
                                                                                       
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 
                                                                                    
                                                                                    
                                                                                    
                                                                                    −
                                                                                    h
                                                                                    i
                                                                                    g
                                                                                    h
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           −
                                                                           l
                                                                           o
                                                                           w
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                  0
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                  +
                                                                  l
                                                                  o
                                                                  w
                                                               
                                                            
                                                            
                                                               
                                                                  +
                                                                  h
                                                                  i
                                                                  g
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            A
                                                            0
                                                         
                                                         
                                                            (
                                                            i
                                                            ,
                                                            
                                                            j
                                                            )
                                                         
                                                         =
                                                         
                                                            
                                                               
                                                                  
                                                                     −
                                                                     h
                                                                     i
                                                                     g
                                                                     h
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              −
                                                                              l
                                                                              o
                                                                              w
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     +
                                                                     l
                                                                     o
                                                                     w
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     +
                                                                     h
                                                                     i
                                                                     g
                                                                     h
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            
                                                               
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           −
                                                                           h
                                                                           ,
                                                                           −
                                                                           h
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           −
                                                                           h
                                                                           ,
                                                                           −
                                                                           l
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           −
                                                                           h
                                                                           ,
                                                                           0
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           −
                                                                           h
                                                                           ,
                                                                           +
                                                                           l
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           −
                                                                           h
                                                                           ,
                                                                           +
                                                                           h
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           −
                                                                           l
                                                                           ,
                                                                           −
                                                                           h
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           −
                                                                           l
                                                                           ,
                                                                           −
                                                                           l
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           −
                                                                           l
                                                                           ,
                                                                           0
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           −
                                                                           l
                                                                           ,
                                                                           +
                                                                           l
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           −
                                                                           l
                                                                           ,
                                                                           +
                                                                           h
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           0
                                                                           ,
                                                                           −
                                                                           h
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           0
                                                                           ,
                                                                           −
                                                                           l
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           0
                                                                           ,
                                                                           0
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           0
                                                                           ,
                                                                           +
                                                                           l
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           0
                                                                           ,
                                                                           +
                                                                           h
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           +
                                                                           l
                                                                           ,
                                                                           −
                                                                           h
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           +
                                                                           l
                                                                           ,
                                                                           −
                                                                           l
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           +
                                                                           l
                                                                           ,
                                                                           0
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           +
                                                                           l
                                                                           ,
                                                                           +
                                                                           l
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           +
                                                                           l
                                                                           ,
                                                                           +
                                                                           h
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           +
                                                                           h
                                                                           ,
                                                                           −
                                                                           h
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           +
                                                                           h
                                                                           ,
                                                                           −
                                                                           l
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           +
                                                                           h
                                                                           ,
                                                                           0
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           +
                                                                           h
                                                                           ,
                                                                           +
                                                                           l
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        
                                                                           +
                                                                           h
                                                                           ,
                                                                           +
                                                                           h
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            ]
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

For each annual forecasting, 150 training runs were carried out via different initial parameters (λ) to obtain updated parameters (
                              
                                 λ
                                 ¯
                              
                           ) by choosing the largest log-likelihood estimator. The iterative curve of the largest log-likelihood estimator of Year 2009 is plotted in Fig. 7
                           , and it shows that the log-likelihood estimator achieves its maximum (−91.0) after 21 iterations. The most probable state sequence from 1979 to 2008 (Fig. 8
                           ) can be revealed via Viterbi decoding, which illustrates the changes in the levels of hidden states. An assumption test method, the chi-square test, was used to verify the Markov property of the hidden state sequence. 
                              
                                 
                                    χ
                                    2
                                 
                                 =
                                 41.6
                              
                            (the case of Beijing) and 
                              
                                 
                                    χ
                                    2
                                 
                                 =
                                 36.0
                              
                           (the case of Shanghai), 
                              
                                 
                                    χ
                                    2
                                 
                                 >
                                 
                                    χ
                                    α
                                    2
                                 
                                 
                                    (
                                    
                                       
                                          (
                                          q
                                          −
                                          1
                                          )
                                       
                                       2
                                    
                                    )
                                 
                                 =
                                 26.3
                              
                            (
                              
                                 q
                                 =
                                 5
                              
                            and 
                              
                                 α
                                 =
                                 0.05
                              
                           ), where α is significance level, and 
                              
                                 
                                    (
                                    q
                                    −
                                    1
                                    )
                                 
                                 2
                              
                            is the degree of freedom. The test result shows the hidden state sequence 
                              
                                 {
                                 
                                    q
                                    1
                                 
                                 ,
                                 
                                    q
                                    2
                                 
                                 ,
                                 …
                                 ,
                                 
                                    q
                                    T
                                 
                                 }
                              
                            satisfies the Markov property.

Fresh information of uncertainty factors can be utilized to update state transition matrix and improve forecasted results. In Year 2008, Beijing hosted the Olympic Games, and Beijing government encouraged citizens to conserve energy and reduce emissions. After the Olympic Games, the government issued a policy on comprehensively advancing domestic waste sorting on April 28, 2009. The effect of this policy would likely last a few years. Shanghai is another city that experiences the same effect. In order to transform itself into a National Environmental Protection Model City, the government issued a policy on comprehensively controlling environment pollution on July 9, 2007. The policy emphasized on carrying out diagnostic investigations in rest months of Year 2007 and completing control task at the end of Year 2008. The effect of this policy would be significant in the target year but limited for following years, as it is a short term task whose aim is to win the title of Model City.

The fresh information makes intuitive sense that waste generation of next year will change and state transition matrix should be updated to respond to the new information. Once fresh information is obtained, we can consult experts in waste management system two questions: (1) Which is the most probable state of the next year considering fresh information? (2) How many probabilities will this state absorb from other states? Experts can give a probability interval if they are uncertain about the exact value. Then, the most common method (the weighted average) in group decision problem was utilized to aggregate experts’ knowledge. The updated transition matrix can be expressed as (taking Beijing's situation of Year 2009 for instance):

                              
                                 (28)
                                 
                                    
                                       
                                    
                                 
                              
                           where 
                              
                                 R
                                 
                                    j
                                    ,
                                    −
                                    h
                                 
                              
                            is the absorption ratio of probabilities from other states. To simplify this process, the same ratios are chosen for 
                              
                                 R
                                 
                                    j
                                    ,
                                    −
                                    h
                                 
                              
                            of different j.

ES model can only utilize waste generation variable to perform forecasting. However, the two major drivers for waste generation, the Resident Population and the Real GDP (Wang & Nie, 2001), were chosen as predictors in the ARIMA model to improve its forecasting accuracy. In ANN and SVM models, the best suitable predictors are the Resident population, the Real GDP and the Resident Consumption Level, which were selected by criteria of MSE and R
                           2 during training and testing stages. The increment rate of waste generation in 
                              
                                 t
                                 +
                                 1
                              
                            year (
                              
                                 R
                                 
                                    t
                                    +
                                    1
                                 
                                 W
                              
                           ) is a function of the increment rate in t year (
                              
                                 R
                                 t
                                 W
                              
                           ) and increment rates of another three factors in t year (
                              
                                 R
                                 t
                                 P
                              
                           , 
                              
                                 R
                                 t
                                 
                                    G
                                    D
                                    P
                                 
                              
                           , and 
                              
                                 R
                                 t
                                 C
                              
                           ).

All models used in this study are data-driven style, which means it is needed to retrain these models once new data is obtained. As a result, the best parameters for each year forecasting may be different. In the case of Shanghai, ARIMA (1, 1, 1) was selected for years of 2004, 2005, and 2009; ARIMA (1, 2, 1) was used for another 4 years. Linear (Holt) ES is the best fitted ES model for Shanghai case. In the case of Beijing, ARIMA (1, 1, 1) was selected for years 2004 to 2010. Linear (Holt) ES was used for years 2004 and 2008, and double (Brown) ES was chosen for other years. The basic parameters of non-probabilistic statistical learning models for Shanghai and Beijing cases are the same. Optimized BP neural network parameters: learn rate equals to 0.2; transfer function of hidden layer is tansig; error goal is 0.0001; input nodes are 4; maximum iterations is 5000; hidden nodes are 10; output node is 1; training algorithm is Levenberg–Marquardt backpropagation. In SVM regression, radial basis function (RBF) was selected as kernel function, which is consistent with the work of Abbasi et al. (2014). The parameter of gamma function and penalty parameter are both set to be the range [2−8, 28] in coarse grid search. Parameter ranges were narrowed in finer grid search via the results of coarse grid search. The steps of two searches are set to be 1 and 0.2, respectively.

@&#RESULTS AND DISCUSSION@&#

We compare the results of ARIMA, ES, ANN, SVM, HMM, and WDE-HMM approaches for Shanghai and Beijing cases in Figs. 9
                            and 10
                           , respectively. Tables 3
                            and 4
                            summarize MAE, MSE, R
                           2, and adjusted R
                           2 of the forecasted results for Shanghai and Beijing cases, respectively. The results indicate that HMM outperforms ARIMA, ES, ANN, and SVM (except for the MAE of HMM is slightly more than that of ES in Shanghai case). After wavelet de-noising, WDE-HMM performs better than HMM. The forecasting accuracies of HMM* and WDE-HMM* are further improved after taking into fresh information of management policies consideration.

All the forecasted amount of the proposed approaches are close to actual amount in Figs. 9 and 10. Not only does WDE-HMM have more accurate results in regular years but also it appears to be more reliable than other methods when encountering a drastic fluctuation, such as the fluctuation points of Year 2008 in Shanghai case and Year 2009 in Beijing case. The disadvantages of comparison methods are revealed in these two cases. ARIMA cannot catch the fluctuation effectively. ES chooses a compromise between general and fluctuation points. Although ES can effectively reflect the upward trend, it would lost lots of fluctuation information. ANN is not stable due to its characteristic of over-fitting and local minimum. Both ANN and SVM depends on influencing factors (predictors) heavily.

As mentioned in Section 3.2, uncertainties are not measured directly; instead, historical data indicate the likely total uncertainty degree. The total uncertainty degree 
                              
                                 ζ
                                 =
                                 ζ
                                 (
                                 
                                    
                                       ς
                                       1
                                    
                                    ,
                                    
                                       ς
                                       2
                                    
                                    ,
                                    
                                       ς
                                       3
                                    
                                    ,
                                    
                                       ς
                                       4
                                    
                                    ,
                                    
                                       ς
                                       5
                                    
                                    ,
                                    …
                                 
                                 )
                              
                            is determined by many uncertainties. In most cases, ζ is high when one or two of the uncertainty factors vary sharply, and ζ is low if all uncertainties are general. According to the calculated result of the total uncertainty degree (Fig. 8), we can search for the source of uncertainty in reality from the five major sources. ζ of Year 2000 is “+high”, likely due to government policy regarding increasing environmental sanitation facilities. ζ of Year 2003 is “+high” in Shanghai and “+low” in Beijing, probably because of an explosion of disposable supplies during the SARS outbreak. The global economic crisis and winning a title of Model City are the probable reasons that ζ of Year 2008 is “−high” in Shanghai; however, ζ in the same year of Beijing is “0”, partly caused by the fact that the Olympic Games was held. ζ of Years 2006 and 2007 in Shanghai, and ζ of Year 2007 in Beijing are “0” since there were few changes in economic, population mobility, individual behaviors, and management policy.

The way of weighted average Gaussian mixture was proposed to deal with the case I. Once we have determined the total uncertainty degree in a year, the emission matrix (B), and the state transition probability matrix (A) which are updated by training the model via the historical dataset and even some fresh information, we can forecast weighted waste generation of the next year via probability calculation. Thus, fluctuation forecasting of waste generation can be implemented even when some of the uncertainty factors vary sharply.

@&#BACKGROUND@&#

The study site is the Manresa sewage treatment plant, located in Barcelona (Spain) which is one of the most populous cities in the world. Spain, the fourth largest country in Europe, is located at the western edge of the Mediterranean. Spain has a population of over 47 million people which ranks in the top 30 worldwide. The wastewater treatment system of Spain is well developed, with more than 80 percent of the wastewater being treated. Spain has been actively promoting the reuse of wastewater that has been treated by urban sewage treatment plants as an aspect of implementing sustainable urban development. The original dataset of wastewater generation with periodic fluctuation has 477 daily data, which is a period from January 1, 1990 to July 10, 1991, not including Saturdays (see the original signal in Fig. 11
                           ).

Using MATLAB wavelet toolbox, the original signal was decomposed by Daubechies of level 2, and then de-noised by the penalized medium thresholding function. Fig. 11 shows both the original signal and the de-noised signal. Considering weekly periodicity, the datasets for HMM and WDE-HMM approaches were transformed into a matrix datasets with rows that form a weekly time series, and columns that follow a pattern [Monday, Tuesday, Wednesday, Thursday, Friday, and Sunday]. Each row data is a stationary time series tested by the autocorrelations function and the Q–Q plot. The distribution of input data was explored by the one-sample Kolmogorov–Smirnov test (Table 5
                           ). Testing for i.i.d. hypothesis with the correlogram was also implemented for time series data of wastewater generation. The results show that 2, 1, 2, 1, 1, and 3 of the 78 values of 
                              
                                 
                                    ρ
                                    ^
                                 
                                 k
                              
                            lie outside the bounds 
                              
                                 ±
                                 1.96
                                 /
                                 
                                    T
                                 
                              
                            (
                              
                                 α
                                 =
                                 0.05
                              
                           ) for datasets of Monday, Tuesday, Wednesday, Thursday, Friday, and Sunday, respectively. So there is no evidence to reject the null hypothesis that the observations are independently distributed. The selected dataset was also divided into two sets, one for training and the other for testing. We tested the proposed approaches using the 79th and the 80th week data. Using AIC criterion, we set the number of hidden states to 5 and the mixture components of a GMM to 3 (see bold values in Table 6
                           ). The result of the chi-square test is: 
                              
                                 
                                    χ
                                    2
                                 
                                 =
                                 71.8
                                 >
                                 
                                    χ
                                    α
                                    2
                                 
                                 
                                    (
                                    
                                       
                                          (
                                          q
                                          −
                                          1
                                          )
                                       
                                       2
                                    
                                    )
                                 
                                 =
                                 26.3
                              
                            (
                              
                                 q
                                 =
                                 5
                              
                            and 
                              
                                 α
                                 =
                                 0.05
                              
                           ), which shows that the hidden state sequence 
                              
                                 {
                                 
                                    q
                                    1
                                 
                                 ,
                                 
                                    q
                                    2
                                 
                                 ,
                                 …
                                 ,
                                 
                                    q
                                    T
                                 
                                 }
                              
                            satisfies the Markov property.

To facilitate the forecasting accuracies of HMM and WDE-HMM approaches, we carried out 20 runs of multi-simulations (30 simulations each run) from different initial parameters (λ) to obtain 20 total forecasted amount 
                              
                                 {
                                 
                                    F
                                    1
                                 
                                 ,
                                 
                                    F
                                    2
                                 
                                 ,
                                 …
                                 ,
                                 
                                    F
                                    20
                                 
                                 }
                              
                            via choosing the biggest log-likelihood estimator. For the WDE-HMM approach, only the top three most similar historical patterns of the current pattern were selected to illustrate the result of pattern recognition in Fig. 12.
                           
                        

Historical data of influencing factors for wastewater generation is not available in this case. So only historical data of wastewater generation can be utilized as predictors for ANN and SVM models. However, this does not affect sES and sARIMA models since they were supposed to utilize wastewater generation data to implement forecasting. As the week period is 6, for one week ahead forecasting of ANN and SVM models, the wastewater generation in 
                              
                                 t
                                 +
                                 1
                              
                            day (
                              
                                 W
                                 
                                    t
                                    +
                                    1
                                 
                              
                           ) is a function of wastewater generation in 
                              
                                 t
                                 −
                                 5
                              
                            day (
                              
                                 W
                                 
                                    t
                                    −
                                    5
                                 
                              
                           ), 
                              
                                 t
                                 −
                                 6
                              
                            (
                              
                                 W
                                 
                                    t
                                    −
                                    6
                                 
                              
                           ), …, and 
                              
                                 t
                                 −
                                 10
                              
                            (
                              
                                 W
                                 
                                    t
                                    −
                                    10
                                 
                              
                           ). For one day ahead forecasting, the wastewater generation in 
                              
                                 t
                                 +
                                 1
                              
                            day (
                              
                                 W
                                 
                                    t
                                    +
                                    1
                                 
                              
                           ) is a function of wastewater generation in t day (Wt
                           ), 
                              
                                 t
                                 −
                                 1
                              
                            day (
                              
                                 
                                    W
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 
                                    )
                                    ,
                                    …
                                    ,
                                 
                              
                            and 
                              
                                 t
                                 −
                                 5
                              
                            day (
                              
                                 W
                                 
                                    t
                                    −
                                    5
                                 
                              
                           ).

The best-fitted model of sARIMA in this case was selected to be sARIMA (2, 0, 1) (1, 0, 1)6. A time lag for 6 days was used as the seasonal parameter for the Auto Regressive. Winters' Multiplicative algorithm based ES is the most suitable model for wastewater generation forecasting with seasonal period of 6. Optimized BP neural network parameters: learn rate equals to 0.2; transfer function of hidden layer is tansig; error goal is 0.0001; input nodes are 6; maximum iterations is 10,000; hidden nodes are 15; output node is 1; training algorithm is Levenberg–Marquardt backpropagation. In SVM regression, RBF was selected as the best kernel function. The parameter of gamma function and penalty parameter are both set to be the range [2−8, 28] in coarse grid search. The steps of coarse grid search and finer grid search are set to be 1 and 0.1, respectively.

@&#RESULTS AND DISCUSSION@&#

For each day, the mean value of 20 forecasted amount of the proposed approaches was regarded as the final forecasted amount. The forecasted results of sARIMA, sES, ANN, SVM, HMM, and WDE-HMM approaches are compared in Fig. 13.
                           
                        


                           Table 7
                            summarizes MAE, MSE, and R
                           2 of the forecasted results. The results indicate that the HMM approach outperforms sARIMA, sES, ANN, and SVM. The WDE-HMM approach also performs better than the HMM approach after wavelet de-noising. Since data of influencing factors is not available, the forecasting accuracies for one week ahead forecasting of ANN and SVM are much worse than the proposed approaches; however, the forecasting accuracies were raised under one day ahead forecasting.

Next, a bootstrapping method was utilized to calculate 95 percent confidence intervals of forecasted amount derived from HMM and WDE-HMM approaches (Figs. 14
                            and 15
                           ). The 95 percent confidence intervals of WDE-HMM are narrower than those of HMM. The scope of the confidence intervals of WDE-HMM encapsulates a greater number of observation data points. This visually displays that the forecasting precision of WDE-HMM is higher than HMM.


                           Fig. 15 shows that all actual wastewater generations (except for the 6th point) are within the scope of 95 percent confidence intervals, and that the trend of forecasted amount is similar to that of actual amount. The reason why the 6th point is not in the 95 percent confidence intervals is that new waste generation uncertainties exist for the current pattern which cannot be fully traced in history. However, the good news is that this new feature can be utilized in the future forecasting.

In the case II, the way of searching the most similar pattern was used to forecast wastewater generation with periodic fluctuation for a large sample case. The results demonstrate that this approach is a good way to dynamically trace historical patterns. This also indicates that we have achieved the goal of forecasting fluctuations of waste generation.

@&#CONCLUSIONS AND FUTURE WORK@&#

In this study, we have proposed a probability model-driven statistical learning approach to forecast the fluctuant generation of municipal waste under uncertainties. The proposed approaches, which hybridizes a wavelet de-noising, a Gaussian mixture model, and a hidden Markov model, were tested by two kinds of case studies. They are Shanghai and Beijing annual MSW generation with non-periodic fluctuation, and daily wastewater generation with periodic fluctuation of the Manresa sewage treatment plant. The results have indicated that the HMM approach generally outperforms the ARIMA, sARIMA, ES, sES, ANN, and SVM approaches in both MAE, MSE, R
                     2, and adjusted R
                     2 criteria. The WDE-HMM approach performs better after the wavelet de-noising. The computational results have demonstrated that the proposed approaches are effective in solving the municipal waste generation forecasting problem.

We presented two concrete forecasting ways, the way of weighted average Gaussian mixture (WAGM) and the way of searching the most similar pattern (SMSP), to forecast the MSW generation with non-periodic fluctuation, and the wastewater generation with periodic fluctuation, respectively. Actually, different steps of state transition in the state probability matrix can be chosen in the way of WAGM. Therefore, the way of WAGM is suitable for short or medium term forecasting of both small and large samples; while the way of SMSP is advantageous for short term forecasting with large samples.

In this study, we have implemented the fluctuation forecasting of waste generation which is found to be influenced by some latent influencing factors and their uncertainties. How uncertainty factors influence forecasted results was illustrated in the subsection of results and discussion. In MSW generation cases, the fresh information is effectively utilized to update the state transition matrix to better foresee future trend.

Future work is needed to improve the EM algorithm. Due to the local optimum characteristics of the EM algorithm, the model was trained repeatedly. This required a significant computing effort. In addition, one can further attempt to forecast middle-term waste generation via an improved hidden Markov model. Furthermore, in this study, the transition matrix is time homogeneous in each forecasting process although it can be updated online when new data is available, and can be updated once fresh information is obtained. However, non-homogeneous hidden Markov models are likely to achieve higher forecasting accuracy.

@&#ACKNOWLEDGEMENTS@&#

This work is jointly supported by the National Research Foundation Singapore under its Campus for Research Excellence and Technological Enterprise (CREATE), and Research Foundation of China (No. 14ZDB152, No. 20130073110040). The authors are grateful to anonymous reviewers and the editor for their constructive comments.

@&#REFERENCES@&#

