@&#MAIN-TITLE@&#Recursive non-rigid structure from motion with online learned shape prior

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel approach is proposed for recursive non-rigid structure from motion.


                        
                        
                           
                           An adaptive algorithm is employed for online update of shape prior.


                        
                        
                           
                           Data storage requirements are reduced by removing original data once the shape model is recursively updated.


                        
                        
                           
                           The algorithm is able to handle the measurements with missing data.


                        
                        
                           
                           The method is not overly sensitive with respect to missing data, missing frames and measurement noise.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Structure from Motion

Sequential approach

Non-rigid structure

Missing data

Online learning

@&#ABSTRACT@&#


               
               
                  Most existing approaches in structure from motion for deformable objects focus on non-incremental solutions utilizing batch type algorithms. All data is collected before shape and motion reconstruction take place. This methodology is inherently unsuitable for applications that require real-time learning. Ideally the online system is capable of incrementally learning and building accurate shapes using current measurement data and past reconstructed shapes. Estimation of 3D structure and camera position is done online. To rely only on the measurements up until that moment is still a challenging problem.
                  In this paper, a novel approach is proposed for recursive recovery of non-rigid structures from image sequences captured by a single camera. The main novelty in the proposed method is an adaptive algorithm for construction of shape constraints imposing stability on the online reconstructed shapes. The proposed, adaptively learned constraints have two aspects: constraints imposed on the basis shapes, the basic “building blocks” from which shapes are reconstructed; as well as constraints imposed on the mixing coefficients in the form of their probability distribution. Constraints are updated when the current model no longer adequately represents new shapes. This is achieved by means of Incremental Principal Component Analysis (IPCA). The proposed technique is also capable to handle missing data. Results are presented for motion capture based data of articulated face and simple human full-body movement.
               
            

@&#INTRODUCTION@&#

The Structure from Motion (SfM) problem is to jointly reconstruct 3D deformable shapes and estimate the corresponding camera external parameters from a set of images, assuming camera internal parameters to be unknown. This technique has become an active area of research in computer vision, with applications in many different domains including augmented reality, autonomous navigation and medical imaging.

A direct solution for recovery of both the motion and structure of the object is the classical algorithm of point based SfM with factorization. Tomasi and Kanade [31] first proposed a factorization algorithm based on the Singular Value Decomposition (SVD), which was used for reconstruction of a rigid object under an orthographic camera model. In this, the algorithm factorizes the measurement matrix into shape and rotation matrices under a rank constraint. Since then techniques for rigid shape recovery via point based SfM have achieved maturity over the following decades [11,19,30]. Subsequent work has focused on the factorization approach applied to multiple rigid objects [15] and articulated rigid objects [33]. In contrast to rigid objects, in real environments many objects deform over time, e.g. human body due to movement [2,14], face due to articulation [4,35] and other objects of interest [10]. This makes the problem difficult to solve because the shape of the object is varying from frame to frame. Therefore research has expanded into the Non-Rigid Structure from Motion (NRSfM).

Most factorization based SfM techniques begin with the assumption of an affine camera model approximating the real projection with either weak perspective or paraperspective viewing conditions. NRSfM with perspective camera can be seen as an extension of the classical reconstruction under orthographic projection. Perspective reconstruction has been successfully applied where the object model can be assumed rigid: Sturm and Triggs [27] described a non-iterative factorization method for uncalibrated cameras. Han and Kanade [15] proposed an alternative method using bilinear projective factorization algorithm; this iteratively improves the depth information, eliminating need for calculation of fundamental matrices. An investigation of different camera models is presented in [16]. Using the full perspective camera model can indeed help obtain a correct 3D reconstruction of the object, but too many unknown variables leads to an under constrained problem. However in some cases perspective projection model is unnecessary if the size of the object is relatively small compared to the distance between camera centre and the object.

To extend rigid SfM into the case of recovering 3D non-rigid objects [1], the seminal work of Bregler et al. [4] first described a low rank shape model for varying shapes. They factorize the 2D data matrix into shape coefficients, a camera motion matrix and 3D basis shapes using SVD, a method similar to that proposed in [31]. Following this shape model, factorization for articulated NRSfM was proposed in [25], but small inaccuracies in the affine values obtained from the initial affine decomposition greatly affect the subsequent estimation process. Xiao et al. [35] proposed a closed-form solution and demonstrated an ambiguity in orthonormality constraints, that using only orthonormality constraints is insufficient to provide unique solutions to estimated structures. They employ the traditional orthonormality constraints, but also introduce additional constraints to further determine shape basis, however this method does not cope well with noisy data. To overcome this, iterative optimization methods based on bundle adjustment were introduced in [34] as a last step of reconstruction, in order to improve the quality of estimation. Recent approaches have focused on solving problems related to the inherently large number of degrees of freedom, which together with motion degeneracy (very limited camera motion during data acquisition) may eventually result in worthless reconstructions. As a time-varying object usually cannot arbitrarily deform, the object can be represented in either shape space [32] or trajectory space [14,12] in order to reduce the dimensionality of the problem.

Prior knowledge, using learning techniques of shape and motion may eliminate the ambiguity and can be used to improve accuracy of shape and motion recovery. Additional constraints such as prior scene information [16,36] can be learned in advance. Bartoli et al. [3] introduced a coarse-to-fine low rank shape model. They ordered the basis shapes, starting from a mean shape and iteratively added deformation modes. Recently Zhou et al. [38] proposed a method operating in the presence of nonlinear motion and non-Gaussian distribution using Markov chain Monte Carlo technique which is applied to minimize the residuals of the estimated shapes. An alternative approach of bundle adjustment demonstrated by Del Bue introduces object shape prior information [5]. This optimization approach may improve performance for both non-rigid and articulated SfM, obtaining reliable 3D reconstructions when an appropriate initial value is provided. This method especially overcomes the problems caused by strong degeneracy within the input image sequence. But in practice, when only constrained by minimization of the 2D re-projection error and a single basis shape, the optimization often converges to a local minimum, due to large number of variables requiring a high quality initial guess.

Although tremendous progress has been made on SfM for both rigid and deformable shapes, the main limitation of most extant works is that they only refer to off-line (batch method) computations. The downside of batch methods is that the reconstruction can only start once all measurement data has been collected. To extend batch mode to the case of online (recursive) operation, Morita and Kanade [21] first presented a sequential factorization method, by considering the feature positions as a vector time series and updating only the first three eigenvectors instead of computation of singular value decomposition. Subsequent research for sequential shape and motion recovery has been developed by Mouragnon et al. [22] who demonstrated a generic and incremental method by minimizing an angular error between rays. Similarly, for the work in [9] the authors added a smoothing penalty on the camera trajectory, updating the structure accordingly as new views are added. Solutions to execute SfM in real-time can be classified as filter-based framework [26,7] or keyframe-based [18] optimization and have proven to be successful. These methods give motivation for real-time implementations, which nevertheless, have so far only dealt with rigid objects or static environment. As yet a limited number of works have been published covering online deformable structure recovery. Most recently Paladini et al. [24] have made progress in this, proposing a rank-growing system which updates the current shape model when the 2D re-projection error exceeds an expected value. This technique makes online NRSfM more tractable, but whilst the higher number of degrees of freedom may lead to smaller re-projection error, this can result in unrealistic reconstructed shapes, unrepresentative of the true object. The method does not address the self-occlusion problem either, where measurements are assumed to be complete, which is rarely valid.

In this paper, an incremental approach is proposed to recursively reconstruct 3D deformable structures, such as articulated face, from 2D video sequences taken by an orthographic camera. The first contribution is to present an alternative multi-part cost function by superposition of specific constraints, for both basis shapes and its coefficients within the state-of-the-art batch-processing scheme. The advantage of this approach is that the proposed prior knowledge reduces likelihood of a nonlinear optimization procedure converging to a local minimum. Furthermore, the final results are not strongly dependent on the initial estimate used in the optimization process, ensuring the system does not require complex initialisation.

The key contribution of this paper is exploitation of a methodology bridging the gap between current batch mode NRSfM and online NRSfM, which respectively process image frames recursively. A new method is proposed to update the model with regards to prior probability of the shape coefficients; this is motivated by incremental principal component analysis [23]. With each successive frame the new algorithm updates the parameters in 3D shape space to firstly estimate the current shape and camera pose, but also with the purpose of efficiently avoiding unrealistic shapes that may have smaller 2D error. To the best of our knowledge, such incremental approach has never been applied in the context of non-rigid shape reconstruction with missing data.

This paper is an updated and expanded version of papers [28,29] with additional step in the algorithm solving the missing data problem and more comprehensive experiments in results section. A significant difference between this paper and the previous papers is that the new algorithm can efficiently handle the case of missing data in both batch and sequential mode. Missing data is a common problem when dealing with real video sequences. If the input data is incomplete, we predict the 2D coordinates of these points only based on the current measurement and learned eigenshapes. The remainder of this paper is organized as follows: Section 3 gives a short review of existing non-rigid factorization frameworks, including a mathematical representation of deformable object formulated as a linear combination of a set of basis shapes and an adjustable set of configuration weights representing the shapes at each time instant. This section also provides description of the reconstruction problem. Section 4 introduces the proposed shape model including the method to estimate the weights’ probability density function, together with the nonlinear optimization. Construction of the proposed recursive NRSfM algorithm, including incremental PCA, is given in Section 5. Section 6 describes an extension of NRSfM for the missing data problem. Finally Section 7 presents results obtained for data acquired from 3D motion capture system. The section also includes performance comparison of the proposed methods and couple of state-of-the-art NRSfM techniques.

Given a point in the world coordinate system, denoted as s
                     
                        n
                     
                     =[x
                     
                        n
                     ,
                     y
                     
                        n
                     ,
                     z
                     
                        n
                     ]
                        T
                      and transformed into mth image coordinate system through rotation 
                        
                           
                              
                                 R
                              
                              
                                 m
                              
                           
                        
                      and translation t
                     
                        m
                     , its orthographic projection x
                     
                        mn
                      onto mth image, is given by:
                        
                           (1)
                           
                              
                                 
                                    x
                                 
                                 
                                    mn
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      mn
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      mn
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      m
                                                   
                                                
                                                |
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ·
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      m
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      m
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      m
                                                      3
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      xm
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      m
                                                      4
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      m
                                                      5
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      m
                                                      6
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ym
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ·
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                           
                        
                     where x
                     
                        mn
                      represents the nth 3D point s
                     
                        n
                      projected onto mth image; the orthographic camera matrix 
                        
                           
                              
                                 R
                              
                              
                                 m
                              
                           
                        
                      only encodes the first two rows of rotation matrix with rotation constraint 
                        
                           
                              
                                 R
                              
                              
                                 m
                              
                           
                           
                              
                                 R
                              
                              
                                 m
                              
                              
                                 T
                              
                           
                           =
                           I
                        
                     . It is shown in [31] that when x
                     
                        mn
                      are given with respect to the origin at the centre of gravity calculated for all projected points in the mth frame, t
                     
                        m
                     
                     =
                     0.

Considering a set of monocular 2D video sequences, tracking P feature points in F video frames, the 2F
                     ×
                     P observation matrix can be expressed as:
                        
                           (2)
                           
                              W
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      11
                                                   
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                      P
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      mn
                                                   
                                                
                                             
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      F
                                                      1
                                                   
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      FP
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      F
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      P
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              MS
                           
                        
                     where M is a stack of motion (rotation) matrices representing camera orientation for each frame and S represents all 3D feature points on reconstructed objects concatenated into a single matrix.

To reconstruct a rigid object or a static scene, factorization is a long-standing and well-known algorithm. Kanatani and Sugaya provided comprehensive descriptions and complete derivation of this technique [17]. Given its simplicity this is widely exploited in many applications and also frequently used as first step in an optimization procedure designed to reconstruct time-varying shape structure.

The general idea is to factorize observation matrix W into two components M and S. Decomposition of W with a straightforward SVD based factorization leads to the affine approximation 
                           
                              
                                 
                                    M
                                 
                                 
                                    ^
                                 
                              
                           
                         and 
                           
                              
                                 
                                    S
                                 
                                 
                                    ^
                                 
                              
                           
                         of the real camera motion and shape represented by M and S respectively.
                           
                              (3)
                              
                                 SVD
                                 (
                                 W
                                 )
                                 =
                                 
                                    
                                       U
                                    
                                    
                                       2
                                       F
                                       ×
                                       3
                                    
                                 
                                 
                                    
                                       Σ
                                    
                                    
                                       3
                                       ×
                                       3
                                    
                                 
                                 
                                    
                                       V
                                    
                                    
                                       3
                                       ×
                                       P
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       2
                                       F
                                       ×
                                       3
                                    
                                 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       3
                                       ×
                                       P
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       ˆ
                                    
                                 
                                 H
                                 )
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                                 =
                                 MS
                              
                           
                        In order to recover correct rotation and shape, a unique linear transformation H can be found enforcing the orthonormality of the rotations in 
                           
                              
                                 
                                    M
                                 
                                 
                                    ^
                                 
                              
                           
                        .

When compared with the rigid model, a non-rigid object contains a larger number of unknown variables and can be seen as a problem of estimating individual 3D structure for each frame. A large number of degrees of freedom makes the shape recovery a complicated task. Assuming that all the points detected in the image are represented with respect to their centre of gravity, the dynamic structure under orthographic projection can be represented as:
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         1
                                                         P
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         mn
                                                      
                                                   
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         F
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         FP
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                
                                                   ⋱
                                                
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         F
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   -
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   -
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   -
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         F
                                                      
                                                   
                                                   -
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 MS
                              
                           
                        Describing the deformation using F independent shapes S
                        
                           m
                        
                        =[s
                        
                           m1,…,
                        s
                        
                           mP
                        ], with s
                        
                           mn
                         representing coordinates of the nth 3D feature point in frame m may entail more unknown variables than constraints. However, it is clear that motion is not random, feature points are highly correlated in time and space. Therefore, an object is unlikely to undergo completely arbitrarily deformation over time. Using basis shapes and basis trajectories are two major approaches to determine structure defined on a lower dimensional subspace.

Using a shape model to represent the non-rigid structure is one way of reducing dimensionality of the problem. A linear combination of K basis shapes, B
                        
                           d
                        , could be used to mathematically represent a morphable 3D model represented in each frame.
                           
                              (5)
                              
                                 
                                    
                                       S
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 ,
                                 ⋯
                                 ,
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       K
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       K
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       d
                                    
                                 
                              
                           
                        where basis shapes B
                        
                           d
                         are unknown but fixed, whilst deformation coefficients (weights) α
                        
                           d
                         are adjustable over time. Fig. 1
                         illustrates an example of deformable model. As shown symbolically in the figure, first basis shape provides a greater contribution than any other basis shape.

The whole shape matrix S can be rearranged as:
                           
                              (6)
                              
                                 S
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   -
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   -
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   -
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         F
                                                      
                                                   
                                                   -
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         1
                                                         K
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         mn
                                                      
                                                   
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         F
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         FK
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   -
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   -
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   -
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                   -
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        To deal with the case of non-rigid shapes under orthographic camera model, a low rank shape model has proved to be successful representation. The advantage of this approach is that it can tackle the problem without any prior information about the object or the scene, or without multiple views and 3D input. The core of this method is to express the measurement matrix as a trilinear product of three matrices: pose, basis models and time varying coefficients. Such that:
                           
                              (7)
                              
                                 W
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         1
                                                         K
                                                      
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                                
                                                   ⋱
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         F
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         F
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         FK
                                                      
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         F
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   -
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   -
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   -
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                   -
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 MB
                              
                           
                        where motion M is a 2F
                        ×3K matrix which contains rotations R
                        
                           m
                         with weighting factors and basis shapes B has size 3K
                        ×
                        P, the rank of W must be at most 3K in the absence of noise. According to the closed-form solution [35] substituting 
                           
                              
                                 
                                    G
                                 
                                 
                                    d
                                 
                              
                              =
                              
                                 
                                    H
                                 
                                 
                                    d
                                 
                              
                              
                                 
                                    H
                                 
                                 
                                    d
                                 
                                 
                                    T
                                 
                              
                           
                        , the constraints are written as:
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                         m
                                                         -
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                         m
                                                         -
                                                         1
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                         m
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   =
                                                   0
                                                   ,
                                                
                                                
                                                   m
                                                   =
                                                   1
                                                   :
                                                   F
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                         m
                                                         -
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                         m
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   =
                                                   0
                                                   ,
                                                
                                                
                                                   m
                                                   =
                                                   1
                                                   :
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        H
                           d
                         can be determined by using SVD or other decomposition algorithm, once G
                           d
                         has been obtained.

The limitation of this approach is that the motion matrix is nonlinear. When an inaccurate set of basis shapes have been chosen, it may not be possible to remove the affine ambiguity.

As mentioned in previous section, the results obtained without using any prior information about shape and/or trajectory are sensitive to the level of noise present in the data and the algorithm initialisation. The greater number of degrees of freedom may lead to smaller re-projection error, but result in unrealistic reconstructed shapes. Appropriate prior shape information can help to augment the accuracy of motion and shape recovery. The key idea in our method is to use a learned shape space model.

Our method departs somewhat from the linear combination of weighted shape basis model presented in the preceding section. We propose to use standard Principal Component Analysis (PCA) to impose constraints on the basis shapes.

Principal Component Analysis is an effective statistical technique for dimensionality reduction. In the last two decades, it has been employed in a wide range of applications across many areas of computer vision. In this application the idea is to represent each of the shapes in the training dataset in a low dimensional shape space that reduces the large number of observed variables into a small number of principal components. Suppose a training dataset has N shapes and the set of points in ith shape are represented by X
                        
                           i
                        . The mean shape, 
                           
                              
                                 
                                    X
                                 
                                 
                                    ¯
                                 
                              
                           
                        , of all the training dataset is given by: 
                           
                              
                                 
                                    X
                                 
                                 
                                    ¯
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                           
                         and eigenshapes E
                        
                           i
                         and eigenvalues γ
                        
                           i
                         are obtained from the covariance matrix, defined as 
                           
                              C
                              =
                              
                                 
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    X
                                 
                                 
                                    ¯
                                 
                              
                              )
                              
                                 
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          X
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    T
                                 
                              
                           
                         where 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                           
                         is the 
                           
                              
                                 
                                    i
                                 
                                 
                                    th
                                 
                              
                           
                         shape given in the Lexicographic format. Any of the shapes from the training dataset can be then approximated by:
                           
                              (9)
                              
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 ≅
                                 
                                    
                                       X
                                    
                                    
                                       ¯
                                    
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                                 E
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       ¯
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         i
                                                         1
                                                      
                                                   
                                                
                                                
                                                   …
                                                
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         iK
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        K is the number of dimensions after reducing the dimensionality, γ
                        
                           i
                         describes the contribution of ith eigenshape and is calculated using the inner product between E
                        
                           i
                         and 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    X
                                 
                                 
                                    ¯
                                 
                              
                           
                        .

Inspired by the idea of PCA and following the deformable shape representation described in Eq. (6), our proposed shape model is given by:
                           
                              (10)
                              
                                 
                                    
                                       S
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 μ
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         m
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         mK
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        There are K
                        +1 basis shapes, B
                        0 as the first basis shape is similar to mean shape 
                           
                              
                                 
                                    X
                                 
                                 
                                    ¯
                                 
                              
                           
                         computed from all the faces in the training datasets. Therefore μ is a scaling factor for first basis shape which controls the overall size of the shape. The rest of the basis shapes, B
                        1 to B
                        
                           K
                         are forced to be close to the corresponding eigenshapes. The basis shapes are only encouraged to be close to the mean shape and eigenshapes instead of being forced to exactly match.

By stacking the shapes S
                        
                           m
                         for each time instant, then projecting them onto the 2D images using orthographic projection model, Eq. (10) can be re-written in compact matrix form:
                           
                              (11)
                              
                                 W
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         F
                                                      
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         F
                                                      
                                                   
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         1
                                                         K
                                                      
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                                
                                                   ⋱
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         F
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         F
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         FK
                                                      
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         F
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Given that deformation is not random, with prior knowledge it is possible to restrict the estimated deformation of the object; assuming it is known how the weighting coefficients α
                        
                           md
                         are distributed in K dimensional space. If the prior is not applied to constrain the weights, it may lead the reconstructed shapes representing unfeasible deformations.

To further constraint the reconstructed shapes, a prior probability on the values of the weighting coefficients is added to the model. The Parzen window density estimation in the eigenspace was used for this purpose.
                           
                              (12)
                              
                                 p
                                 (
                                 α
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ϕ
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                α
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where N is the number of shapes used to estimate the probability density function, and ϕ(·) is a kernel function. For the isotropic Gaussian kernel function the estimate of the density function is given by:
                           
                              (13)
                              
                                 p
                                 (
                                 α
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             2
                                             π
                                          
                                       
                                       σ
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                ‖
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                α
                                                
                                                   
                                                      ‖
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The dimensionality of this function is defined by the number of eigenshapes used in the approximation. As an example shape coefficients probability distribution for 2D face shape space is shown in Fig. 2
                        .

As the information about shapes and weights probability distribution is learned in advance, the optimization process comes down to minimizing a cost function built as a superposition of four components.

The first component of the cost function measures the re-projection error between the feature points detected in the observed images and corresponding projection of 3D points in the estimated shapes. The re-projection error is given by:
                           
                              (14)
                              
                                 
                                    
                                       ε
                                    
                                    
                                       re
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          F
                                       
                                    
                                 
                                 ‖
                                 
                                    
                                       w
                                    
                                    
                                       m
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 
                                 with
                                 
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          0
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       md
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       d
                                    
                                 
                              
                           
                        Assuming that the reconstructed object is viewed by an orthographic camera, rotation matrix R
                        
                           m
                         represents orthographic camera matrix. The second component of the cost function enforces orthonormality of all R
                        
                           m
                         and is expressed as:
                           
                              (15)
                              
                                 
                                    
                                       ε
                                    
                                    
                                       rot
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          F
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   m
                                                
                                             
                                             
                                                
                                                   R
                                                
                                                
                                                   m
                                                
                                                
                                                   T
                                                
                                             
                                             -
                                             I
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        The prior on the shape basis given in Eq. (16) is included as the third component of the cost function:
                           
                              (16)
                              
                                 
                                    
                                       ε
                                    
                                    
                                       bs
                                    
                                 
                                 =
                                 ‖
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                                 -
                                 
                                    
                                       X
                                    
                                    
                                       ¯
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 ‖
                                 
                                    
                                       B
                                    
                                    
                                       d
                                    
                                 
                                 -
                                 
                                    
                                       E
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        Given that the reconstructed object is not part of the training dataset, we are much more concerned about recovering the 3D shapes rather than having accurate basis shapes.

Last but not least, following from the discussion in Section 4.2, the fourth component of the cost function introduces constraints on the weighting coefficients. We restrict the search for optimal weights within the high probability region of the learned weights probability distribution by maximizing p(α
                        
                           m
                        ).

The overall proposed cost function combines minimization of the re-projection error with efficient constraints for rotation matrices, shape basis, as well as weighting coefficients:
                           
                              (17)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                R
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                             
                                                B
                                             
                                             
                                                d
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       ε
                                    
                                    
                                       re
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                             
                                                B
                                             
                                             
                                                d
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       φ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       rot
                                    
                                 
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       m
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       φ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       bs
                                    
                                 
                                 (
                                 
                                    
                                       B
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       φ
                                    
                                    
                                       3
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       m
                                    
                                 
                                 )
                                 )
                              
                           
                        where scalars φ
                        1, φ
                        2, φ
                        3 are the designed parameters controlling importance of each constraint in the cost function. A nonlinear optimization based on bundle adjustment using Levenberg–Marquardt algorithm was applied to minimize this compound cost function. The adopted method is efficient and is able to converge to the correct solution even in cases where the initial point is far from the expected minimum.

Rather than initialize the data using the method described in Section 3.2, the initialization is obtained using the generalized SVD (GSVD) [5] followed by orthonormal decomposition [6]. An initial shape is given by a rigid shape which is computed from measured data and prior shape model. To initialize rotation and weights, orthonormal decomposition is applied to decompose the remaining factors in the observation matrix.

For the recursive NRSfM, the shape is divided into off-line and online components: 
                        
                           
                              
                                 S
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 S
                              
                              
                                 t
                              
                              
                                 off
                              
                           
                           +
                           
                              
                                 S
                              
                              
                                 t
                              
                              
                                 on
                              
                           
                        
                     . The off-line part is mainly used to indicate the static overall shape and the online part is responsible for representing the dynamic shape changes. The method described in the preceding section was used to estimate the off-line shape S
                     
                        t
                     
                     off with the prior information about shapes and weights probability distribution learned in advance using standard PCA technique on a training database of co-registered shapes. The online (dynamic) shape S
                     
                        t
                     
                     on is modelled in a similar way as the off-line shape:
                        
                           (18)
                           
                              
                                 
                                    S
                                 
                                 
                                    t
                                 
                                 
                                    on
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      t
                                                      1
                                                   
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      tM
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                   
                                                   
                                                      M
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     As for the off-line model, the online shapes are represented by a linear combination of basis shapes 
                        
                           
                              
                                 
                                    
                                       B
                                    
                                    
                                       ∼
                                    
                                 
                              
                              
                                 i
                              
                           
                        
                      weighted by the shape coefficients β
                     
                        i
                     . The main difference between S
                     
                        t
                     
                     off and S
                     
                        t
                     
                     on is the way in which the shape and coefficient constraints are calculated. Whereas constraints for the off-line shapes are calculated using standard PCA, the constraints for the online shapes are learned recursively using the incremental PCA (IPCA) method. Although standard PCA is allowed to optimize reconstruction of the training data by projecting the input data onto its principal axes, it is not suitable for online learning. It requires all the data in advance. Once each new sample arrives the PCA is performed for both original and new data again. The main advantage of incremental version of the PCA is that it enables estimation of the shape space based on partial observations. As an additional benefit the original data can be removed once the eigenspace is updated, therefore reducing the data storage requirements.

A summary of the algorithm for recursive NRSfM is given in Algorithm 1. Initial shapes are estimated from the first N frames (20 frames in the case of experiments described in Section 7), these shapes are obtained via a nonlinear optimization with shape constraints, through integration of the prior information in the cost function following the method described in Section 4. For each new frame a local bundle adjustment is used over all frames in a sliding window of length l to optimize parameters for shape coefficients and basis shapes in order to reconstruct the current shape. Our approach for model updating is inspired by the work of Neto and Ulrich [23]. They perform online novelty detection by comparing the magnitude of a residual vector which defines the error between reconstruction of a projection and its original data with a predefined threshold r
                        T
                     . The model is updated only if the value exceeds the threshold or the magnitude of the two residual vectors between two reconstructed shapes is relatively large which implies that the current model is unlikely to be able to recover the deformation in the subsequently arriving frame. When all data has been updated in this stage, a re-estimation for the current frame ensures the model better fits the observation.
                        Algorithm 1
                        Outline of recursive NRSfM algorithm 
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             Input:
                                             Stream of 2D correspondence points.
                                       
                                       
                                          
                                             Output:
                                             3D deformable shapes S
                                             t and camera motion R
                                             t for each frame.
                                       
                                       
                                          1:
                                          Build matrix W
                                             
                                                t∣t=N
                                              where W is a 2N
                                             ×
                                             P matrix.
                                       
                                       
                                          2:
                                          Using method described in Section 4 estimate:{R
                                             1,⋯,
                                             R
                                             
                                                N
                                             }, {α
                                             1,⋯,
                                             α
                                             
                                                N
                                             }, and 
                                                
                                                   B
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     B
                                                                  
                                                                  
                                                                     0
                                                                  
                                                                  
                                                                     T
                                                                  
                                                               
                                                               ,
                                                               ⋯
                                                               ,
                                                               
                                                                  
                                                                     B
                                                                  
                                                                  
                                                                     K
                                                                  
                                                                  
                                                                     T
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          3:
                                          Calculate 
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         off
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   B
                                                
                                             ; 
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  t
                                                                  ,
                                                                  0
                                                               
                                                            
                                                            ,
                                                            ⋯
                                                            ,
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  t
                                                                  ,
                                                                  K
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             ; t
                                             =1,…,
                                             N.
                                       
                                       
                                          4:
                                          For t
                                             =
                                             N
                                             +1, initialize model to mean shape 
                                                
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             , eigenvectors U
                                             t−1, and projected vector A
                                                t−1 estimated via batch PCA for S
                                             off.
                                       
                                       
                                          5:
                                          
                                             loop
                                          
                                       
                                       
                                          6:
                                          
                                             Input new frame f
                                             
                                                t
                                              with 2D correspondence points.
                                       
                                       
                                          7:
                                          
                                             Build local measurement matrix 
                                                
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     t
                                                                     -
                                                                     l
                                                                     +
                                                                     1
                                                                  
                                                                  
                                                                     T
                                                                  
                                                               
                                                               ,
                                                               ⋯
                                                               ,
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     T
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          8:
                                          
                                             Using Levenberg–Marquardt algorithm solve: 
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  
                                                                     
                                                                        B
                                                                     
                                                                     
                                                                        ∼
                                                                     
                                                                  
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            arg
                                                            min
                                                         
                                                         
                                                            β
                                                            ,
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                            ,
                                                            R
                                                         
                                                      
                                                   
                                                   
                                                   (
                                                   ε
                                                   )
                                                
                                              where ε is given by Eq. (21), 
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   =
                                                   [
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   ⋯
                                                   ,
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   ]
                                                   
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         [
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           B
                                                                        
                                                                        
                                                                           ̃
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     ˆ
                                                                  
                                                               
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                         ,
                                                         ⋯
                                                         ,
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           B
                                                                        
                                                                        
                                                                           ̃
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     ˆ
                                                                  
                                                               
                                                            
                                                            
                                                               M
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                         ]
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          9:
                                          
                                             Compute current shape: 
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         off
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               ∼
                                                            
                                                         
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                              and rotation: 
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          10:
                                          
                                             Compute the projection of S
                                             
                                                t
                                              on the shape space: 
                                                
                                                   a
                                                   =
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          11:
                                          
                                             Compute the residual vector 
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  U
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            a
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          12:
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                               
                                                            
                                                            >
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   or
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           r
                                                                        
                                                                        
                                                                           t
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           r
                                                                        
                                                                        
                                                                           t
                                                                           -
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            >
                                                            0.1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          13:
                                          
                                             
                                             Update the shape space and the corresponding shape vectors as defined in the Incremental PCA.
                                       
                                       
                                          14:
                                          
                                             
                                             Re-estimate the current frame by nonlinear optimization with new eigenvectors U
                                             
                                                t
                                              
                                             S
                                             
                                                t
                                              and R
                                             
                                                t
                                             
                                          
                                       
                                       
                                          15:
                                          
                                             
                                             end if
                                          
                                       
                                       
                                          16:
                                          
                                             Update mean shape 
                                                
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                   (
                                                   t
                                                   -
                                                   1
                                                   )
                                                   /
                                                   t
                                                   +
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   /
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          17:
                                          
                                             go to next frame, t
                                             ←
                                             t
                                             +1.
                                       
                                       
                                          18:
                                          
                                             end loop
                                          
                                       
                                    
                                 
                              
                           
                        

The optimization during recursive computation is based on local bundle adjustment incorporating the proposed additional constraints. The online basis shapes 
                        
                           
                              
                                 B
                              
                              
                                 ∼
                              
                           
                        
                      are forced to be close to learned eigenvectors U, which are updated in each iteration. The constraint imposed on the basis shapes is given by:
                        
                           (19)
                           
                              
                                 
                                    ε
                                 
                                 
                                    bs
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       d
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              ‖
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    d
                                 
                              
                              -
                              
                                 
                                    U
                                 
                                 
                                    d
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                        
                     According to Eq. (12), the prior probability of the on-line shape coefficients β can be written as:
                        
                           (20)
                           
                              p
                              (
                              β
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          2
                                          π
                                       
                                    
                                    σ
                                 
                              
                              exp
                              
                                 
                                    
                                       -
                                       
                                          
                                             ‖
                                             
                                                
                                                   A
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             β
                                             
                                                
                                                   ‖
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     where A
                        i
                      is the ith shape vector. An example of the weight probability distribution for the first two weights is shown in Fig. 3
                     .

The cost function is built as:
                        
                           (21)
                           
                              ε
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       f
                                       -
                                       l
                                       +
                                       1
                                    
                                    
                                       f
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         off
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            d
                                                            =
                                                            1
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         td
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               ∼
                                                            
                                                         
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    φ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       f
                                       -
                                       l
                                       +
                                       1
                                    
                                    
                                       f
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                R
                                             
                                             
                                                t
                                             
                                             
                                                T
                                             
                                          
                                          -
                                          I
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    φ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    ε
                                 
                                 
                                    bs
                                 
                              
                              -
                              
                                 
                                    φ
                                 
                                 
                                    3
                                 
                              
                              p
                              (
                              
                                 
                                    β
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        
                     Minimizing ε by the same method applied in Eq. (17).

The two algorithms proposed above assume that the measurement matrix W is complete, with all the feature points detected in all the images. This is unlikely to happen in practice as some of the feature points will not be detected in all the images. This could be because of the feature point detection problems or because some parts of the 3D object may not be visible from all the camera positions. This means some of the entries in the measurement matrix W may be unknown. This section describes a simple but efficient method for solving NRSfM with missing data by recovering the missing entries in measurement W before reconstruction of 3D shapes and camera motion.

If the input data is incomplete, instead of using more complex and time-consuming optimization process to estimate the missing values [13,8], we predict the 2D coordinates of these points only based on the current measurement and learned eigenshapes. Assuming the total P feature points are to be reconstructed, we can write 
                        
                           I
                           =
                           
                              
                                 
                                    
                                       Π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 m
                              
                           
                           +
                           
                              
                                 
                                    
                                       Π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 m
                              
                              
                                 ∗
                              
                           
                        
                     , where 
                        
                           I
                        
                      is an identity matrix and 
                        
                           
                              
                                 
                                    
                                       Π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 m
                              
                           
                        
                      is a P
                     ×
                     P diagonal matrix:
                        
                           (22)
                           
                              
                                 
                                    
                                       
                                          Π
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    m
                                 
                              
                              (
                              n
                              ,
                              n
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                if
                                                
                                                the
                                                
                                                point
                                                
                                                n
                                                
                                                is
                                                
                                                missing
                                                
                                                in
                                                
                                                m
                                                
                                                image
                                             
                                          
                                          
                                             
                                                1
                                                ,
                                             
                                             
                                                if
                                                
                                                the
                                                
                                                point
                                                
                                                n
                                                
                                                presents
                                                
                                                in
                                                
                                                m
                                                
                                                image
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     According to Eq. (7), measurement matrix can be factorised into motion M and shape basis B matrices. The incomplete measurements, which contains only detected points in m frame. can be represented as:
                        
                           (23)
                           
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    m
                                 
                              
                              =
                              
                                 
                                    w
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    Π
                                 
                                 
                                    m
                                 
                              
                           
                        
                     and the missing measurements as:
                        
                           (24)
                           
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    m
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    w
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    Π
                                 
                                 
                                    m
                                 
                                 
                                    ∗
                                 
                              
                           
                        
                     where matrix Π
                        m
                      and 
                        
                           
                              
                                 Π
                              
                              
                                 m
                              
                              
                                 ∗
                              
                           
                        
                      are obtained from 
                        
                           
                              
                                 
                                    
                                       Π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 m
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       Π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 m
                              
                              
                                 ∗
                              
                           
                        
                      by removing all columns for which entries are all zeros, w
                     
                        m
                      represents row 2m
                     −1 and 2m of the matrix W. Substituting Eq. (23) into Eq. (7), the incomplete measurement can be written as: 
                        
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 m
                              
                           
                           =
                           
                              
                                 M
                              
                              
                                 m
                              
                           
                           B
                           
                              
                                 Π
                              
                              
                                 m
                              
                           
                        
                     .

We first compute the motion matrix M
                     
                        m
                      in terms of the visible points and its corresponding eigenshapes in m frame, 
                        
                           
                              
                                 M
                              
                              
                                 m
                              
                           
                           =
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 m
                              
                           
                           
                              
                                 (
                                 E
                                 
                                    
                                       Π
                                    
                                    
                                       m
                                    
                                 
                                 )
                              
                              
                                 †
                              
                           
                        
                     , where (EΠ
                        m
                     )† represents Moore–Penrose pseudoinverse of EΠ
                        m
                     , with eigenshapes E used as basis shapes. Once the motion M
                     
                        m
                      is obtained, the missing values can be calculated as 
                        
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 m
                              
                              
                                 ∗
                              
                           
                           =
                           
                              
                                 M
                              
                              
                                 m
                              
                           
                           E
                           
                              
                                 Π
                              
                              
                                 m
                              
                              
                                 ∗
                              
                           
                        
                     . Thus the completed measurement matrix is:
                        
                           (25)
                           
                              
                                 
                                    w
                                 
                                 
                                    m
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    Π
                                 
                                 
                                    m
                                 
                                 
                                    T
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    m
                                 
                                 
                                    ∗
                                 
                              
                              
                                 
                                    Π
                                 
                                 
                                    m
                                 
                                 
                                    ∗
                                    T
                                 
                              
                           
                        
                     In the case of batch processing, the eigenshapes E are learned during off-line training and the whole measurement W is calculated before doing further reconstructions. In sequential mode, missing values in each frame have to be estimated when the new frame arrives. Note that the eigenshapes have been updated using incremental PCA, the eigenshapes used for calculating the missing values should consist of off-line eigenvectors E and online learned eigenvectors U.

@&#RESULTS AND DISCUSSION@&#

The experiments to evaluate the proposed methodology were based on batch formulation and sequential recovery of an articulated face and human motion. In the case of reconstruction of objects undergoing only small deformations, the estimated shape can be accurately represented using a model with a relatively small number of degrees of freedom, thereby allowing for linear deformations. To demonstrate the performance of the proposed methods, extensive experimental evaluation has been provided. We show qualitative and quantitative results on different datasets, and compare the proposed method with previous approaches. We have applied our approaches to Hi4D-ADSIP [20] database, including video clips of seven different facial expressions (anger, disgust, fear, happiness, sadness, surprise and pain) at three intensity levels (mild, normal and extreme) and videos showing people reading predefined phrases (“talking subjects”). Ground truth data of an articulated face was captured using Passive 3-D scanner with 3D tracking of 83 feature points. The human body movement data was obtained from CMU motion capture database. The points were projected onto the image sequences under the orthographic camera model. The models and algorithms used for comparison are as follows:
                        
                           
                              SP: Factorisation with shape priors [5].


                              MP: The metric projection method [25].


                              BPCA: The batch mode [28]
                           


                              IPCA: The proposed incremental approach.

The off-line training datasets are taken from the BU-3DFE database [37]. A total number of 2400 with 83 feature points, rigidly co-registered, 3D face images of different subjects exhibiting different facial expressions were used for learning the shape model and the distribution of weights. Fig. 4
                         shows an example of the shapes built using the learned mean face with eigenfaces.

The performance of our proposed shape model with prior information based on batch type operation was evaluated in a number of experiments.

The accuracy of 3D shape reconstruction is affected by the number of basis shapes. For the first set of experiments, we start with testing on four facial sequences, three for extreme level of facial expression (happiness, sadness and surprise) data and one for “talking subjects”. The results are listed in Table 1
                        , evaluated in terms of 3D reconstructed shape error and 2D re-projection error, for cases where differing number of basis shapes are used for reconstruction. The 3D error is measured by normalized mean error over all frames and all points:
                           
                              (26)
                              
                                 e
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       Δ
                                       FP
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          F
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          P
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       mn
                                    
                                 
                                 ,
                                 
                                 Δ
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       3
                                       F
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          F
                                       
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       mx
                                    
                                 
                                 +
                                 
                                    
                                       Δ
                                    
                                    
                                       my
                                    
                                 
                                 +
                                 
                                    
                                       Δ
                                    
                                    
                                       mz
                                    
                                 
                                 )
                              
                           
                        where Δ
                           mx
                        , Δ
                           my
                        , Δ
                           mz
                         are the standard deviations of x, y and z coordinates of ground truth shape at mth frame and e
                        
                           mn
                         is the Euclidean distance between corresponding point n at frame m in the reconstructed and ground truth shapes.The 2D re-projection error is calculated using
                           
                              (27)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          F
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          P
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                mn
                                             
                                          
                                          -
                                          
                                             
                                                w
                                             
                                             
                                                mn
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 /
                                 σ
                                 FP
                              
                           
                        where σ is the standard deviation of the measurement data and 
                           
                              
                                 
                                    W
                                 
                                 
                                    mn
                                 
                                 
                                    ′
                                 
                              
                           
                         represents re-projection 2D points getting from the projection of reconstructed shapes using recovered camera motion. As expected, more accurate results were obtained when increasing the number of basis shapes due to greater number of trained eigenfaces used to constrain the reconstructed shapes. Without noise, the recovered shape is very similar to the true shape with the reconstruction error close to zero. With noise present in the measurements, reasonably accurate shapes are still obtainable, showing that the method is robust.


                        Fig. 5
                         shows representative sequential results. The top graph plots the 3D reconstruction error, with selected illustrative corresponding faces; the bottom shows the magnitude of residual vector of reconstructed shapes for each frame. The input is an image sequence with a facial expression of happiness. As expected, at first the error increases as each new frame arrives. Once the online adaptive learning algorithm has learned the shapes the error decreases gradually. The error increases as new type of variations appear, but the algorithm still can learn quickly. As the new shapes occur, which is the case when the shape is a variation of a similar shape which has already been learned. Then the residual drops off to almost zero, an incidence of this is seen in the last 10–15 frames.

In the on-line reconstruction, some frames may be dropped out when the calculations for the current frame are not finished before the next frame arrives. The following experiment was designed to test the sensitivity of our method with respect to percentage of missing frames. The simulated missing frames were selected randomly at 5%, 10%, 20% and 40% of the total number of frames. The results for the happiness facial expression sequence are shown in Table 2
                        . The average 3D error and the standard deviation were estimated based on 10 trials. The 3D reconstruction error for this sequence without missing data is 0.0980. The experiment has been repeated twice with respectively one and two frames missing at any given time. It should be noticed that the method is not very sensitive with respect to the number of missing frames. This can be explained by the fact that the proposed algorithm does not explicitly model temporal variations of the data and therefore the method is not too sensitive with respect to missing frames as long as the data can be well modelled by the online learned shape space.

The results shown in Fig. 6
                         are for tracking 83 points over a 229 frame sequence of a surprised facial expression, a 269 frame sequence of fear and a 259 frame sequence of anger. We present both front and side views of a selection of facial reconstructions extracted from the sequences. For comparison the side view of reconstructions is to demonstrate the relative performance of depth information recovery. As is visible in the figures, both approaches yield satisfactory reconstructions, whereas IPCA performs better in depth recovery.

In real image sequences, feature points often disappear and reappear from the image as the object deforms and camera moves. As result the measurement matrix is incomplete due to occlusions. To test the performance of the proposed methods in that case, we follow the evaluation procedure originally proposed in [32] to simulate the missing data by discarding 2D entries uniformly at random with 10%, 20%, 30%, 40% and 50% probability. To simplify results visualization, all the sequences are separated into four groups: three for different intensities of facial expression and one for “talking subjects”, with 10 sequences taken from different subjects per group.

3D reconstruction errors for IPCA and BPCA and their corresponding standard deviation calculated for each group are shown in Fig. 7
                        . Our recursive method IPCA has small standard deviation over all the tested levels of occlusion and achieved much smaller errors both in terms of the mean and standard deviations. It is important to note that the results for talking sequences from BPCA has large error when the amount of missing data increases, whereas the recursive method clearly outperforms batch method. It is because the basis shapes we used to predict missing measurement data are obtained from the updated eigenvectors, while the batch mode algorithm has only learned eigenvectors from the training data, which only contain facial expressions.

In most cases, measurement noise usually appear when inaccurate tracking takes place, affecting the 2D observation data. The aim of the following experiment is to evaluate the performance with noise in measurement and different ratios of missing data. Gaussian noise with noise levels up to 8% was applied for extreme surprise facial expression sequence where the missing points were selected randomly with levels between 0% and 50%. The measurement W was perturbed by Gaussian noise according to the standard deviation of the measurement data with given level of noise. The experiments for each level of noise and each level of occlusion were repeated 10 times. Fig. 8
                         shows the results of the proposed batch and recursive method.

For the comparative evaluation, performance of the proposed methods, both batch and recursive, are tested against two previously proposed approaches, namely: factorisation with shape priors (SP) [5]; and the metric projection method (MP) [25]. The experiments in this case were performed for all 30 facial expression sequences and 10 talking sequences. To better visualize the results the data was divided into the same groups (mild, normal, extreme and talking) as in Section 7.4. The average 3D error, maximum error and standard deviation of each group were calculated. Table 3
                         summarises results of these tests.

Other existing sequential algorithms [21,24] for either rigid or non-rigid object recovery did not display any difference in the results when compared with original batch method. This is expected, as these methods are essentially based on the same theory. The results demonstrate that the proposed method performs better than those algorithms without online shape model updates. This is because the probability distribution of shape coefficients is updated with incoming new shapes. As shown in the Table 3, MP is able to provide comparable results to the proposed batch method BPCA. But the errors are still much bigger than errors obtained for the proposed recursive method IPCA.

For real cases most previously proposed approaches are very sensitive to noise leading to failure to converge to correct solution. The next experiment is design to test the influence of inaccurate measurement by adding increasing levels of Gaussian noise to the measurement data W. We compare all four methods in terms of sensitivity to the noise present in the measurement data. The reconstruction errors are evaluated for 10 trials with measurement error modelled by independent Gaussian noise. The level of additive noise is set to 2%, 4%, 6% and 8%. The results are shown in Fig. 9
                        . For higher levels of noise, the increase in average 3D error is similar for all four methods, but the proposed methods are relatively stable when compared to the previous methods and can achieve much smaller errors, especially the recursive method, even when the noise level has increased to 8%, the estimated maximum error is 0.1958.

Finally more qualitative reconstruction comparison for different methods is shown in Fig. 10
                         on one of the human full-body motion data. Since there is no separate training data for this, the half of the sequence was used for training and the other half for testing. The testing sequence has 551 frames with 41 feature points. The reconstruction errors for SP, MP, BPCA and IPCA are 0.6634, 0.3310, 0.2333 and 0.0843 respectively.

@&#CONCLUSIONS AND FUTURE WORK@&#

We have presented a new approach to solve the recursive NRSfM problem and have demonstrated the accuracy and robustness of our method on a series of challenging situations. Our method successfully recovers shape and camera motion parameters as new frames arrive; additionally it allows for updates to the model, thus accounting for new shape variations as objects deform over the sequence. We have also developed several extensions to the algorithm for deformable object recovery, which include use of learned shape model and distribution of the weights in the cost function, thus improving performance of the optimization process. We believe our method is a suitable groundwork for later exploitation in real-time applications.

However, the current approach relies on a linear subspace model to represent the deformations of the object of interest. This approach is applicable to a relatively simple non-rigid object, especially when the reconstructed object is based on only a small number of basis shapes. To address this deficiency, we are currently working on shapes constrained to a smooth manifold representing learned nonlinear shape variability. The planned approach should be more accurate and well-adapted to large deformation models which cannot be accurately represented by a linear subspace.

@&#ACKNOWLEDGMENT@&#

The “drink” motion capture data used in this project was obtained from mocap.cs.cmu.edu.

@&#REFERENCES@&#

