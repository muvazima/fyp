@&#MAIN-TITLE@&#Load mapping for seamless interface between hydrodynamics and structural analyses

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A seamless interface between the hydro and structural analyses is addressed.


                        
                        
                           
                           We propose a method of transferring pressure to a structural model.


                        
                        
                           
                           We propose a method of transferring viscous forces to a structural model.


                        
                        
                           
                           We propose a method of removing force and moment imbalances.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Pressure

Hydrodynamic analysis

Panel

Seakeeping

Structural analysis

Mapping

@&#ABSTRACT@&#


               
               
                  This paper addresses the problem of a seamless interface between hydrodynamics and structural analyses. A pressure distribution on a hydro model computed from seakeeping analysis needs to be transferred to a structural model for evaluating structural strength and its integrity. However, due to the differences in the computation and representation methods for both analyses, the load on the hydro model may not be correctly transferred to the structural model, leading to a different load distribution on the structural model and resulting in some unbalanced force and moment components. In this paper, a method is proposed to solve this problem. A pressure distribution on the hydro model is mapped on the structural model through projection, and force and moment imbalances on the structural model are eliminated through optimization of the nodal forces on the structural model. Moreover, a viscous force distribution along the center of each member of the hydro model is transferred to the nodal forces on the structural model based on the minimum distance measure with resolving any force and moment imbalance. Examples are presented to demonstrate the validity of the proposed method.
               
            

@&#INTRODUCTION@&#

As a demand for novel types of ships and offshore structures for operating in severe sea conditions is growing, traditional design methods may not sufficiently reflect various design requirements for such vessels. Thus, a different design strategy should be introduced during the design. To design ships or offshore structures of such types for a safe and efficient operation, ship owners and ship registers have started to consider seakeeping performance in the design phase. Theoretical and practical approaches on this problem have attracted many researchers’ interest around the world [1].

Seakeeping indicates motions of a floating body when there exist waves, wind and a current. The motions in such conditions are estimated using fluid forces acting on the body, which can be computed using potential theory. Once the forces are computed, an equation of motion for the body is solved with the loads as input, and the body motions are computed with respect to time. This information is a useful reference in the hull shape design. In addition, the computed loads on the body are important in the structural design of the body because the body should be designed to avoid any structural failure under such external loads.

The loads acting on the body computed in seakeeping analysis are pressure and viscous forces. In order to compute the distribution of pressure on the body, the hull is discretized into panels, and pressure values for the panels are computed. On the other hand, the viscous forces are computed at the center points of each member of the model using an empirical formula, called the Morison’s equation, which computes approximate resultant viscous forces for a structure. These two external forces need to be provided as input to structural analysis. However, when the input is prepared, the two forces should be handled differently because of the different properties of each force.

Pressure is computed on the panel model during seakeeping analysis. The panel model consists of panels approximating the shape of a ship hull or an offshore structure. The panels for seakeeping analysis are usually coarser than finite element meshes for structural analysis. Because of the difference of the models, pressure on the panel model cannot be directly used as an external load for structural analysis.

The pressure load on the panel model can be transferred to the structural mesh model through integration. Transferring the pressure, however, poses a few problems due to the difference of the model representation. The hydro panels and the structural meshes would not be the same although they are generated using the same underlying geometry. Therefore, the pressure load on the hydro panels may not be so transferred to the structural meshes that some unbalanced force and moments on the structural meshes are obtained, resulting in a load distribution on the structural model, which is different from that on the hydro panel model. Namely, inappropriate transfer of dynamic pressure on the body surface can result in the unbalance of the total force, which may lead to non-zero moment in the ends ofthe floating body. This is a physically incorrect situation, which must be avoided before the structural analysis is performed.

Transferring viscous forces to the structural mesh model can be considered as an extreme case of the pressure transfer. Viscous forces are computed on the skeletal structure of the body, and forces need to be transferred on the surface of each member. This implies that the acting positions of the forces are distinctly different, causing unbalanced force and moment components on the structural model. Therefore, the computational results for the structural analysis using these loads on the structural model cannot be trusted. Thus, achieving the same load condition on the structural mesh model is important for an accurate structural analysis.

Despite its current interest in the related fields, little literature on this problem has been reported so far. There exists a guideline called the inertia relief, which uses acceleration terms to introduce fictitious inertia forces to adjust the forces in the structural mesh model to eliminate unbalanced components [2]. Due to its conceptual simplicity, the inertia relief method has been widely used in practice in order to counterbalance any imbalances of the input loads on the structural mesh. However, this approach has a few shortcomings as was presented in [3]. The paper indicates that additional inertial loads are needed to rebalance the structural model, which may cause a change of structural response such as bending moment, and the additional fictitious loads are required to be relatively small to prevent any significant change of original structural loads. To overcome these problems, the load distributions are frequently inspected and adjusted manually in practice, which is not an efficient process.

A direct transfer of loads from a hydro panel model to a structural mesh model based on the sectional forces and moments of the hydrodynamic analysis is discussed in [3]. They used corrective nodal forces on the structural mesh model to counter any unbalanced component. The corrective force terms are computed using an optimization method based on quadratic programming. At each node, a corrective force component is obtained, which forms a revised force distribution satisfying the force and moment balance condition. Moreover, the unrealistic sway and surge force caused by hydrostatic restoring pressure integration is further studied, and a method to solve the problem is presented [4]. Quadratic programming is employed to compute the amount of corrective nodal forces for the structural mesh model to provide a correct load condition for the structural analysis. Malenica et al. [5] proposed a method to eliminate such a force imbalance by reformulating the equations of motion of a body for seakeeping on the structural mesh model and solving them. This approach can discard any force imbalance on the structural mesh model because no transfer of force components is performed from the hydro panel model to the structural mesh model. However, this approach requires a complicated computation on the structural model, and the computational conditions on the hydro and structural models may be different because the two methods would yield different hydrodynamic coefficients for the seakeeping analysis.

In these methods, however, the similarity of the load distribution patterns on the hydro and structural models is not taken into account. This similarity would be important to assess the local structural strength. The use of corrective nodal forces was also mentioned in [6], which presents a guide to compute such force terms on the structural mesh model manually.

In this paper, a method for transferring loads on the hydro model to the structural model is proposed. Two methods are presented: one is for mapping a pressure distribution on the hydro panels to the structural meshes, and the other is for mapping viscous forces due to the fluid to the structural meshes. For the former mapping, hydro panels influencing a structural mesh are selected, and pressure values on the panels are projected onto the mesh. The projected pressure on the mesh is then converted to the equivalent nodal forces. Once this mapping is completed, the force and moment imbalances are eliminated using an optimization method. The viscous force mapping is different from the pressure mapping. Viscous forces are provided as concentrated forces along the centers of each member of a floating body. Therefore, for the viscous force mapping, a method of distributing the forces on the structural meshes is required. In this work, a procedure is proposed that structural meshes that would be influenced by a viscous force at a point using the minimum distance measure are selected, and the force is then distributed on the meshes. This process is applied to all the viscous forces, which are then adjusted to satisfy the force and moment balance conditions.

The contributions of this paper are as follows: a novel method is proposed for a consistent transfer of a pressure distribution on the hydro panel model to the structural mesh model. The hydro panel and structural mesh models represent the same geometric shape in different domains. There exists no link between the models except for the same underlying geometry. In order to associate the hydro panel model with the structural mesh model, projection of the hydro panels onto the corresponding structural meshes is used in a local coordinate system, which is created for each structural mesh. Through this projection, the pressure distribution on the hydro panels can be mapped onto the structural meshes, and the distribution pattern of pressure on the hydro panels can be maintained on the structural mesh model. Therefore, more accurate local structural assessment can be performed. This approach is not limited only to potential flow theory. Instead, any physical properties can be transferred from one model to another when they are represented in panels or meshes. Therefore, the proposed method provides an interface connecting two different models each of which is intended for different disciplines.

Second, a novel method is proposed for transferring viscous forces on the hydro panel model to the structural mesh model. The viscous forces are computed along the centers of each member of the model, which are given as vectors at points. Therefore, mapping of a point onto surface meshes is necessary. In this paper, a new strategy for this mapping is presented and the forces are mapped on the structural meshes with maintaining the similar distribution patterns of the viscous forces.

The paper is structured as follows: in Section 2, a theoretical background necessary for the presentation of the proposed method is briefly explained. Section 3 formulates the problem of mapping between hydro and structural representation, and presents a method to solve the problem. Examples are provided in Section 4 to demonstrate the performance of the proposed method. Section 5 concludes this paper with future work.

Seakeeping indicates the behavior of a ship or a floating structure in waves. The behavior in waves is modeled as a second order differential equation with restoring, Froude–Krylov and hydrodynamic forces as external components to the equation. The forces are usually calculated using potential theory for the fluid near the body with the assumptions that the fluid is inviscid and incompressible, and undergoes no rotational motion.

The seakeeping problem can be solved using Rankin panel method [7]. The surfaces on the body and the free surface are discretized into triangular or quadrilateral panels, and Rankine sources are distributed on each panel. Then, the potential is computed using the panels and the sources numerically. The shape and number of panels are important parameters that affect the accuracy of the numerical computation. In particular the rapid fluctuation of the free surface can happen near the floating body. In order to consider such an influence of the free surface to the seakeeping behavior, dense panels are used around the body. On the other hand, coarse panels can be used for the free surface far from the body.

Potential theory assumes that fluid is inviscid. Therefore, no viscous force on the body from the fluid is considered. The theory usually gives a reasonable result for a large and bluff hull because the inertia force on the body dominates the viscous force in terms of magnitude. However, a viscous effect becomes an essential component to obtain a reliable result when the body is slender and its waterplane area is small. When the viscous force cannot be ignored, it can be estimated using the Morison’s equation [8].

Consider a cylinder as shown in Fig. 1
                        . The Morison’s equation is applied to a sectional element of the thickness dh, yielding a resultant force at the center for the given the normal component of the relative velocity between the fluid and the element UR
                         as illustrated in Fig. 1. Then the force for the element is estimated by
                           
                              (1)
                              
                                 d
                                 
                                    
                                       F
                                    
                                    
                                       Vis
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 ρ
                                 
                                    
                                       C
                                    
                                    
                                       D
                                    
                                 
                                 D
                                 |
                                 
                                    
                                       U
                                    
                                    
                                       R
                                    
                                 
                                 |
                                 
                                    
                                       U
                                    
                                    
                                       R
                                    
                                 
                                 dh
                                 .
                              
                           
                        Here, CD
                         denotes the drag coefficient, D is a characteristic diameter of the cross section. The drag coefficient depends on the shape of the cross section and the velocity of inflow of the fluid. Determining a proper value of CD
                         is critical for estimating a reasonable viscous force. For a simple shape such as a circle or a rectangle, values from 1.0 to 2.0 are usually chosen. Then successive computation of the viscous forces at each position along the cylinder gives a distribution of viscous forces for the cylinder. For diverse shapes, empirical coefficients are chosen to reasonably estimate the viscous forces.

Physically, the viscous force is induced in the form of shear stress on the wetted surface of the element, whereas the Morison equation estimates the resultant of the viscous force components at the center of the element. Therefore, the forces need to be converted to force components on the structural meshes for structural analysis.

Consider a quadrilateral structural mesh bst
                         with the surface force f
                        
                           S
                         on the surface of the mesh. Then, the nodal forces on the mesh, R
                        
                           S
                        , are computed by
                           
                              (2)
                              
                                 
                                    
                                       R
                                    
                                    
                                       S
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       S
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       s
                                    
                                 
                                 
                                 d
                                 s
                                 .
                              
                           
                        Here, H is a matrix containing interpolation functions h
                        1, h
                        2, h
                        3 and h
                        4
                        
                           
                              (3)
                              
                                 H
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  4
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                             
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        f
                        
                           S
                         is a surface force and S indicates the surface area. By introducing parameters, u and v, (−1⩽
                        u
                        ⩽1, −1⩽
                        v
                        ⩽1), any point V(u,
                        v) on the mesh is represented by the linear combination of the interpolation functions
                           
                              (4)
                              
                                 V
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 =
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       y
                                    
                                 
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                             
                                             
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                             
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where V
                        1, V
                        2, V
                        3 and V
                        4 are the nodal points of the mesh and the interpolation functions are
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          u
                                          ,
                                          v
                                          )
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                4
                                             
                                          
                                          (
                                          1
                                          -
                                          u
                                          )
                                          (
                                          1
                                          -
                                          v
                                          )
                                          ,
                                          
                                          
                                             
                                                h
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          u
                                          ,
                                          v
                                          )
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                4
                                             
                                          
                                          (
                                          1
                                          +
                                          u
                                          )
                                          (
                                          1
                                          -
                                          v
                                          )
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                3
                                             
                                          
                                          (
                                          u
                                          ,
                                          v
                                          )
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                4
                                             
                                          
                                          (
                                          1
                                          +
                                          u
                                          )
                                          (
                                          1
                                          +
                                          v
                                          )
                                          ,
                                          
                                          
                                             
                                                h
                                             
                                             
                                                4
                                             
                                          
                                          (
                                          u
                                          ,
                                          v
                                          )
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                4
                                             
                                          
                                          (
                                          1
                                          -
                                          u
                                          )
                                          (
                                          1
                                          +
                                          v
                                          )
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

Then, Eq. (2) is transformed into
                           
                              (6)
                              
                                 
                                    
                                       R
                                    
                                    
                                       S
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       -
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 
                                    ∫
                                    
                                       -
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 det
                                 J
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 
                                 d
                                 u
                                 
                                 d
                                 v
                                 .
                              
                           
                        Here, 
                           
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              
                           
                         is a parametric function of the surface force f
                        
                           s
                        . det J(u,
                        v) is the determinant of Jacobian matrix given by
                           
                              (7)
                              
                                 J
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                      
                                                         ∂
                                                         u
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∂
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                      
                                                         ∂
                                                         v
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                      
                                                      
                                                         ∂
                                                         u
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∂
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                      
                                                      
                                                         ∂
                                                         v
                                                      
                                                   
                                                
                                             
                                             
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Three force components are considered for the external loads acting on the body: hydro pressure, viscous and concentrated forces. These components need to be transferred onto the structural mesh for structural analysis. The final load on the structural model is, therefore, given as forces on each node, which are the sum of the three force components. In this section, methods of transferring the load components to the structural mesh are proposed.

We consider a time-domain Rankine method, with which all the hydrodynamics solutions are obtained in the time domain.Therefore, the structural analysis should be performed in the time domain, too. In the case of our time-domain approach, the inertia components are automatically included in the dynamic structural analysissince the structural finite elements have mass information. In the hydrodynamics aspect, the inertia forces/moments are imposed into the equation of motion. That is, the kinematic information of body motion is properly applied in the dynamic structural analysis. However, the hydrodynamic pressure should be imposed as a set of external loads on the finite elements of the wetted body surface. One critical concern in this kind of load mapping is the occurrence of unbalanced forceor moment. In many cases, the force equilibrium does not guarantee the balance of moment. In that case, the moments in the ends of a body may not be zero, even though the body is freely floating. Therefore, accurate and appropriate mapping with zero moment in the ends of the floating body should be achieved.

Suppose that the result of seakeeping analysis on a floating body is a pressure distribution on a hydro panel of SB
                        (t). On each panel, constant pressure is assumed. Nodal forces of the structural mesh model need to be computed from the pressure distribution.

Consider a structural model with meshes 
                              
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                    
                                       st
                                    
                                 
                              
                            (i
                           =1,…,
                           nst
                           ) and a hydro model with panels 
                              
                                 
                                    
                                       b
                                    
                                    
                                       j
                                    
                                    
                                       hyd
                                    
                                 
                              
                            (j
                           =1,…,
                           nhyd
                           ). A hydro force for a panel 
                              
                                 
                                    
                                       b
                                    
                                    
                                       j
                                    
                                    
                                       hyd
                                    
                                 
                              
                           , denoted by 
                              
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                    
                                       hyd
                                    
                                 
                              
                           , is computed by multiplying the area of 
                              
                                 
                                    
                                       b
                                    
                                    
                                       j
                                    
                                    
                                       hyd
                                    
                                 
                              
                            by the pressure Pk
                           . Then, the problem of pressure mapping is to find the nodal forces 
                              
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                    
                                       stk
                                    
                                 
                              
                            (k
                           =1,…,
                           mst
                           ) such that
                              
                                 (8)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   st
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                       
                                       
                                          stk
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   hyd
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          j
                                       
                                       
                                          hyd
                                       
                                    
                                 
                              
                           
                           
                              
                                 (9)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   st
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          k
                                       
                                       
                                          stk
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   hyd
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          j
                                       
                                       
                                          hyd
                                       
                                    
                                 
                              
                           are satisfied. Here, 
                              
                                 
                                    
                                       M
                                    
                                    
                                       k
                                    
                                    
                                       stk
                                    
                                 
                              
                            is the moment for the node k of the structural model, and 
                              
                                 
                                    
                                       M
                                    
                                    
                                       j
                                    
                                    
                                       hyd
                                    
                                 
                              
                            is the moment of the hydro panel 
                              
                                 
                                    
                                       b
                                    
                                    
                                       j
                                    
                                    
                                       hyd
                                    
                                 
                              
                           . Once the nodal force distribution on 
                              
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                    
                                       st
                                    
                                 
                              
                            satisfying Eqs. (8) and (9) is computed, then the structural model is in equilibrium, and the physically correct loading condition is provided for the analysis of the structural model with the same external load as the pressure load on 
                              
                                 
                                    
                                       b
                                    
                                    
                                       j
                                    
                                    
                                       hyd
                                    
                                 
                              
                           .

However, in the actual computation, both equations are not usually satisfied due to the force and moment imbalances (Δf and ΔM) introduced during the mapping, which would cause incorrect computation results. Therefore, the imbalances should be eliminated in order to obtain the correct external loads on the structural model.
                              
                                 (10)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   st
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                       
                                       
                                          stk
                                       
                                    
                                    +
                                    Δ
                                    f
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   hyd
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          j
                                       
                                       
                                          hyd
                                       
                                    
                                 
                              
                           
                           
                              
                                 (11)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   st
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          k
                                       
                                       
                                          stk
                                       
                                    
                                    +
                                    Δ
                                    M
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   hyd
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          j
                                       
                                       
                                          hyd
                                       
                                    
                                 
                              
                           
                        

The overall procedure to counter the imbalances is as follows. First, the pressure distribution on the hydro model is mapped on the structural model to produce the nodal forces on each mesh of the structural model using the projection method. Second, the force imbalance Δf is computed and then evenly distributed over the mesh nodes corresponding to the wetted panels of the hydro model. Then, the force imbalance can be removed but the moment imbalance ΔM still remains in most cases. In order to counter ΔM, the nodal forces are adjusted systematically while Eq. (10) is maintained. Once these two steps are completed, the structural model is perfectly in equilibrium, and the correct structural external load corresponding to the hydro pressure distribution is obtained.

Consider a structural mesh. All the hydro panels that overlap the mesh are extracted. Assume that such hydro panels are 
                              
                                 
                                    
                                       b
                                    
                                    
                                       l
                                    
                                    
                                       hyd
                                    
                                 
                              
                            (l
                           =1,…,
                           nl
                           ). Then, the mesh and the panels in the global coordinate system, o–xyz, are represented with respect to a local coordinate system O–XYZ as follows.

Suppose that 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                       
                                          st
                                       
                                    
                                 
                               is a quadrilateral mesh with four nodes V
                              
                                 i
                              
                              1, V
                              
                                 i
                              
                              2, V
                              
                                 i
                              
                              3 and V
                              
                                 i
                              
                              4. Choose V
                              
                                 i
                              
                              1 as the origin of the local coordinate system, O. Using the following relations, the local coordinate system O–XYZ is created.
                                 
                                    (12)
                                    
                                       X
                                       =
                                       
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   i
                                                   21
                                                
                                             
                                          
                                          
                                             |
                                             
                                                
                                                   V
                                                
                                                
                                                   i
                                                   21
                                                
                                             
                                             |
                                          
                                       
                                       ,
                                       
                                       Z
                                       =
                                       
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   i
                                                   21
                                                
                                             
                                             ×
                                             
                                                
                                                   V
                                                
                                                
                                                   i
                                                   41
                                                
                                             
                                          
                                          
                                             |
                                             
                                                
                                                   V
                                                
                                                
                                                   i
                                                   21
                                                
                                             
                                             ×
                                             
                                                
                                                   V
                                                
                                                
                                                   i
                                                   41
                                                
                                             
                                             |
                                          
                                       
                                       ,
                                       
                                       Y
                                       =
                                       Z
                                       ×
                                       X
                                       .
                                    
                                 
                              Here, V
                              
                                 iab
                              
                              =
                              V
                              
                                 ia
                              
                              −
                              V
                              
                                 ib
                              . Any point p in o–xyz can be represented with respect to O–XYZ by
                                 
                                    (13)
                                    
                                       P
                                       =
                                       
                                          
                                             Ω
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       (
                                       p
                                       -
                                       
                                          
                                             V
                                          
                                          
                                             i
                                             1
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             V
                                          
                                          
                                             i
                                             1
                                          
                                       
                                       .
                                    
                                 
                              Here, Ω is a 3 by 3 matrix, showing the rotational relation between o–xyz and O–XYZ, 
                                 
                                    Ω
                                    =
                                    [
                                    
                                       
                                          X
                                       
                                       
                                          T
                                       
                                    
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          T
                                       
                                    
                                    
                                    
                                       
                                          Z
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                 
                               with X
                              T, Y
                              T and Z
                              T as the column vectors given in Eq. (12). The local and global coordinate systems and their relation are shown in Fig. 2
                              .

Suppose that there are 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          ir
                                       
                                       
                                          hyd
                                       
                                    
                                    (
                                    r
                                    =
                                    1
                                    ,
                                    
                                    …
                                    
                                    ,
                                    
                                    
                                       
                                          n
                                       
                                       
                                          hyd
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                               near the structural mesh 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                       
                                          st
                                       
                                    
                                 
                              . 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          ir
                                       
                                       
                                          hyd
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          st
                                       
                                    
                                 
                               are the transformed meshes and panels in the O–XYZ system. They are projected onto XY plane by setting zero to the Z components of each vertex. 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          p
                                          ,
                                          ir
                                       
                                       
                                          hyd
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          p
                                          ,
                                          i
                                       
                                       
                                          st
                                       
                                    
                                 
                               are the projected meshes and panels, and 
                                 
                                    
                                       
                                          O
                                       
                                       
                                          ir
                                       
                                       
                                          ν
                                       
                                    
                                 
                               is the overlapped region between 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          p
                                          ,
                                          ir
                                       
                                       
                                          hyd
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          p
                                          ,
                                          i
                                       
                                       
                                          st
                                       
                                    
                                 
                              . Then, we have three cases for the computation of overlapped regions.
                                 
                                    •
                                    
                                       Case 1: 
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   p
                                                   ,
                                                   ir
                                                
                                                
                                                   hyd
                                                
                                             
                                          
                                        and 
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   p
                                                   ,
                                                   i
                                                
                                                
                                                   st
                                                
                                             
                                          
                                        are the same. In this case, 
                                          
                                             
                                                
                                                   O
                                                
                                                
                                                   ir
                                                
                                                
                                                   v
                                                
                                             
                                             =
                                             
                                                
                                                   B
                                                
                                                
                                                   p
                                                   ,
                                                   i
                                                
                                                
                                                   st
                                                
                                             
                                          
                                       .


                                       Case 2: 
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   p
                                                   ,
                                                   i
                                                
                                                
                                                   st
                                                
                                             
                                          
                                        is overlapped by several 
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   p
                                                   ,
                                                   ir
                                                
                                                
                                                   hyd
                                                
                                             
                                          
                                       ’s, 
                                          
                                             (
                                             r
                                             =
                                             1
                                             ,
                                             
                                             …
                                             
                                             ,
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   hyd
                                                
                                                
                                                   ∗
                                                
                                             
                                             )
                                          
                                       . Then, the overlapped regions 
                                          
                                             (14)
                                             
                                                
                                                   
                                                      O
                                                   
                                                   
                                                      ir
                                                   
                                                   
                                                      v
                                                   
                                                
                                                =
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      p
                                                      ,
                                                      ir
                                                   
                                                   
                                                      hyd
                                                   
                                                
                                                ∩
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      p
                                                      ,
                                                      i
                                                   
                                                   
                                                      st
                                                   
                                                
                                                ,
                                                
                                                for
                                                
                                                r
                                                =
                                                1
                                                ,
                                                
                                                …
                                                
                                                ,
                                                
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      hyd
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                ,
                                             
                                          
                                        are computed for each 
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   p
                                                   ,
                                                   ir
                                                
                                                
                                                   hyd
                                                
                                             
                                          
                                        and 
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   p
                                                   ,
                                                   i
                                                
                                                
                                                   st
                                                
                                             
                                          
                                       . Here, the union of 
                                          
                                             
                                                
                                                   O
                                                
                                                
                                                   ir
                                                
                                                
                                                   ν
                                                
                                             
                                             (
                                             r
                                             =
                                             1
                                             ,
                                             
                                             …
                                             
                                             ,
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   hyd
                                                
                                                
                                                   ∗
                                                
                                             
                                             )
                                          
                                        should be equal to 
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   p
                                                   ,
                                                   i
                                                
                                                
                                                   st
                                                
                                             
                                          
                                       . Fig. 3
                                       (a) shows an illustrative example. One structural mesh is overlapped by four hydro panels. For each 
                                          
                                             
                                                
                                                   O
                                                
                                                
                                                   ir
                                                
                                                
                                                   ν
                                                
                                             
                                          
                                        a pressure value is assigned.


                                       Case 3: Part of 
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   p
                                                   ,
                                                   i
                                                
                                                
                                                   st
                                                
                                             
                                          
                                        is below the free surface. Then, Eq. (14) is used for computation. However, the union of 
                                          
                                             
                                                
                                                   O
                                                
                                                
                                                   ir
                                                
                                                
                                                   ν
                                                
                                             
                                             (
                                             r
                                             =
                                             1
                                             ,
                                             
                                             …
                                             
                                             ,
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   hyd
                                                
                                                
                                                   ∗
                                                
                                             
                                             )
                                          
                                        is not be equal to 
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   p
                                                   ,
                                                   i
                                                
                                                
                                                   st
                                                
                                             
                                          
                                       . Fig. 3(b) shows an illustrative example that part of one structural mesh is below the free surface. The overlapped regions are similarly computed using Eq. (14) with pressure values for each overlapped region. The remaining region above the free surface is considered as a overlapped region with zero pressure.

For each 
                                 
                                    
                                       
                                          O
                                       
                                       
                                          ir
                                       
                                       
                                          ν
                                       
                                    
                                 
                              , a pressure value Pir
                               is assigned, which is used as a surface load on 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                       
                                          st
                                       
                                    
                                 
                              . The problem of computing 
                                 
                                    
                                       
                                          O
                                       
                                       
                                          ir
                                       
                                       
                                          ν
                                       
                                    
                                 
                               is reduced to clipping 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          p
                                          ,
                                          ir
                                       
                                       
                                          hyd
                                       
                                    
                                 
                               against 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          p
                                          ,
                                          i
                                       
                                       
                                          st
                                       
                                    
                                 
                              , which can be solved by Vatti clipping algorithm [9].

Vatti clipping algorithm is an algorithm [9] to clip a general polygon against a general polygon. It does not restrict the shape of polygons, and efficiently computes the intersection between them. Consider two polygons. One is a clipping polygon, and the other is a subject. The subject is clipped against the clipping polygon resulting in one or multiple polygons or none. The edges of the subject and the clipping polygon are arranged in such a way that the vertices of each edge of the polygons are sorted incrementally with respect to the vertical y-axis. Then horizontal sweep lines are introduced, whose y values are the vertices of each polygon. These sweep lines subdivide the space into scanbeams, the spaces between two consecutive sweep lines. The lowermost scanbeam is then first processed to produce the clipped parts in the subject. In this process, the edges of the subject and the clipping polygon are investigated in each scanbeam. Clipping is performed by finding the intersections between the edges. Then, the intersections points are new vertices defining the edges of the clipped polygon. The newly created edges are determined based on intersection rules, and boolean clipping operations such as difference, union and xor, are employed to compute the resulting edges after clipping, which are then linked to form a final clipped polygon or polygons from the subject against the clipping polygon. This algorithm is designed to process general polygons with reasonable performance.

When the pressure 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          ir
                                       
                                       
                                          hyd
                                       
                                    
                                 
                               is assigned to the overlapped region in 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          p
                                          ,
                                          i
                                       
                                       
                                          st
                                       
                                    
                                 
                              , the geometric configuration of 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          ir
                                       
                                       
                                          hyd
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          st
                                       
                                    
                                 
                               should be considered. Suppose that 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          ir
                                       
                                       
                                          hyd
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          Bi
                                       
                                       
                                          st
                                       
                                    
                                 
                               are positioned as shown in Fig. 4
                              . In the figure, N
                              
                                 hyd
                               and N
                              
                                 st
                               are the normal vectors of the hydro panel and the structural mesh, respectively, and θ is the angle between the two normal vectors. The resultant force due to the pressure 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          ir
                                       
                                       
                                          hyd
                                       
                                    
                                 
                               on the hydro panel, denoted as 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ir
                                       
                                       
                                          hyd
                                       
                                    
                                 
                               is in the N
                              
                                 hyd
                               direction. Considering the orientation of the structural mesh relative to the hydro panel, the force on the structural mesh, 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ir
                                       
                                       
                                          st
                                       
                                    
                                 
                              , which is in the direction of N
                              
                                 st
                              , can be calculated by 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ir
                                       
                                       
                                          st
                                       
                                    
                                    =
                                    
                                       
                                          F
                                       
                                       
                                          ir
                                       
                                       
                                          hyd
                                       
                                    
                                 
                               cos
                              θ. Then, the pressure on the structural mesh is computed by dividing 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ir
                                       
                                       
                                          st
                                       
                                    
                                 
                               by the area of the mesh.

Once a pressure distribution on the structural mesh is computed, nodal forces on the mesh are computed by using the method in Section 2.3.

Eqs. (8) and (9) assure that the sums of forces and moments on the hydro and structural models are maintained. Therefore, the structural analysis can be performed with the load distribution equivalent to that on the hydro model obtained by the seakeeping analysis. However, due to various factors involved in the transfer process the equations do not hold in most cases. Such unbalanced force components result in a load distribution different from the hydro pressure load on the body, leading to incorrect structural analysis results. Therefore, without eliminating the unbalanced force and moments, the analysis will not be trusted any more.

In order to avoid such a problem, nodal forces that would satisfy Eqs. (8) and (9) should be computed. Once the mapping of the hydro pressure is completed, the nodal forces on the structural mesh model are obtained. Then, the nodal forces are adjusted so that the equations become satisfied. The adjustment method consists of two steps: first, the nodal forces are adjusted to make Eq. (8) satisfied. The force difference Δf is computed by
                              
                                 (15)
                                 
                                    Δ
                                    f
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   hyd
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          j
                                       
                                       
                                          hyd
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   st
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                       
                                       
                                          stk
                                       
                                    
                                    .
                                 
                              
                           
                        

Then, the amount of adjustment is computed by Δf
                           
                              adj
                              
                           =Δf/mst
                           , which is added to each nodal force. This adjustment only considers the force balance between the hydro and the structural models. Next, Eq. (9) is tested. If the equation is satisfied, then no more adjustment is required. Otherwise, the nodal forces are further adjusted to satisfy both equations. For this adjustment, an optimization approach is employed. Denoting the amount of adjustments for the x, y and z components by dfx
                           , dfy
                            and dfz
                           , the problem is formulated as follows:
                              
                                 (16)
                                 
                                    
                                       
                                          
                                          
                                             
                                                Minimize
                                                
                                                Λ
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               st
                                                            
                                                         
                                                      
                                                   
                                                
                                                d
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      xk
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                d
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      yk
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                d
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      zk
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                subject
                                                
                                                to
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               st
                                                            
                                                         
                                                      
                                                   
                                                
                                                d
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                0
                                                ,
                                                
                                                d
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                (
                                                d
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      xk
                                                   
                                                
                                                ,d
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      yk
                                                   
                                                
                                                ,d
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      zk
                                                   
                                                
                                                )
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               st
                                                            
                                                         
                                                      
                                                   
                                                
                                                d
                                                f
                                                ×
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               st
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      stk
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               hyd
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      hyd
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Here, two constraints are introduced. The first constraint indicates that the total amount of force adjustment is zero. The second one controls the force adjustment such that the moment induced by the adjustment should compensate the moment imbalance. Minimizing the objective function Λ means that the total amount of adjustment should be minimal. This optimization problem can be solved using the quadratic programming technique. In particular the equality constraints are imposed, and the objective function is equivalent to the general form of the quadratic programming problem. It can be shown that the KKT conditions (the Karush–Kuhn–Tucker (KKT) conditions) can be used to find the solution of the optimization problem of this type [10]. Eqs. (16) can be written as follows.
                              
                                 (17)
                                 
                                    
                                       
                                          
                                          
                                             
                                                Λ
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      T
                                                   
                                                
                                                Qx
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      T
                                                   
                                                
                                                x
                                                .
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                subject
                                                
                                                to
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                Ex
                                                =
                                                d
                                             
                                          
                                       
                                    
                                 
                              
                           Here, 
                              
                                 x
                                 =
                                 (
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       x
                                       1
                                    
                                 
                                 ,d
                                 
                                    
                                       f
                                    
                                    
                                       y
                                       1
                                    
                                 
                                 ,d
                                 
                                    
                                       f
                                    
                                    
                                       z
                                       1
                                    
                                 
                                 ,
                                 
                                 …
                                 
                                 ,
                                 
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             xm
                                          
                                          
                                             st
                                          
                                       
                                    
                                 
                                 ,d
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             ym
                                          
                                          
                                             st
                                          
                                       
                                    
                                 
                                 ,d
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             zm
                                          
                                          
                                             st
                                          
                                       
                                    
                                 
                                 )
                              
                           . Q is a diagonal matrix with 0.5 as the diagonal elements. c is a null matrix. The two constraints in Eq. (16) are merged in E and d. Using Lagrange multipliers λ, the extremum values can be computed. In the problem, Q is positive definite and only the equality constraints are considered. Then the solution of the following linear system, Eq. (17), becomes the corresponding extremum values [10].
                              
                                 (18)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                
                                                
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      -
                                                      c
                                                   
                                                
                                                
                                                   
                                                      d
                                                   
                                                
                                                
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In general the size of Eq. (16) is large. Many of the elements of the matrix are zero. Therefore, an iterative solution method such as the conjugate gradient method is employed to solve the problem efficiently [11].

The nodal force adjustment using the quadratic programming method was also discussed in [3]. This approach only computes the minimum force adjustments to eliminate the force and moment imbalances without considering the force distribution pattern. Therefore, the actual force distribution on the structural model could be different from that of the hydro pressure.

The proposed approach in this work starts with the nodal force distribution obtained from the hydro pressure distribution. Moreover, by considering only the amount of force and moment differences, which would be added to each nodal force, the overall pattern of the load distribution can be maintained.

In the mapping process, finding 
                              
                                 
                                    
                                       b
                                    
                                    
                                       ir
                                    
                                    
                                       hyd
                                    
                                 
                                 (
                                 r
                                 =
                                 1
                                 ,
                                 
                                 …
                                 
                                 ,
                                 
                                 
                                    
                                       n
                                    
                                    
                                       hyd
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                              
                            near the structural mesh 
                              
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                    
                                       st
                                    
                                 
                              
                            is very important. Suppose that 
                              
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                    
                                       st
                                    
                                 
                              
                            is a quadrilateral mesh. Then, nine points are sampled from 
                              
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                    
                                       st
                                    
                                 
                              
                           ; four nodal points, mid-points of each edge and the center point of the mesh. Next, compute the Euclidean distances from each sample to all the hydro panels, and choose one that yields the smallest distance.

The distance computation between a point and a panel consists of four steps: (1) compute the minimum distance between a point and four vertices, (2) compute the minimum distance between a point and four edges, (3) compute the minimum distance between a point and a face of the panel, and (4) choose the minimum value among (1), (2) and (3). As the numbers of the meshes and the panels grow, however, this computation would be a bottleneck for the entire mapping process because it needs to be performed nst
                           
                           ×
                           nhyd
                            times. This computation can be accelerated using the axis aligned bounding box (AABB) method.

An AABB is computed for the hydro model. It is decomposed into eight subdomains by subdividing the box at the mid points of each edge. Each subdivided box is enlarged by 10 percent to introduce overlapped regions. This step is necessary to handle the case when a test point is right near the subdivided point. Next, inclusion of the given point in a subdivided bounding box is tested. If the point is outside the box, then the hydro panels in the box are ignored in the minimum distance computation. Using this algorithm, the number of hydro panels used in the computation can be reduced significantly, enhancing the efficiency of the computation.

Viscous damping forces are given as a distribution of concentrated forces in 3D space. An example of viscous damping forces is given in Fig. 5
                        . Here, the positions of the viscous forces are given as red dots, which form a line along the center of the cylinder. A line segment extended from each point indicates the direction and magnitude of the viscous damping force on that position.

As shown in the figure, the positions of the viscous forces are not on the surface of the model. Therefore, a method is required to transfer the viscous forces to the forces on the meshes. In this section, a novel method to distribute viscous damping forces to the structural mesh model is presented.

Suppose that viscous damping forces d
                           
                              vi
                            are given at the positions p
                           
                              vi
                           , (i
                           =1,…,
                           nvs
                           ). Then, the problem is to compute f
                           
                              vk
                            (k
                           =1,…,
                           mst
                           ) such that
                              
                                 (19)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               st
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      vk
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               vs
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      vi
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               st
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      vk
                                                   
                                                
                                                ×
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               vs
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      vi
                                                   
                                                
                                                ×
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      vi
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           are satisfied. For this computation, the distribution pattern of the viscous damping forces should be reflected in the nodal force distribution.

The proposed distribution method consists of two phases: initial distribution and adjustment. The initial distribution only considers forces. The second phase adjusts the forces to satisfy the constraints (19).

Consider one viscous damping force d
                              
                                 vi
                               at p
                              
                                 vi
                               and structural meshes 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          j
                                       
                                       
                                          st
                                       
                                    
                                 
                               (j
                              =1,…,
                              nst
                              ). The first step is to compute the minimum distance dmin
                               between p
                              
                                 vi
                               and 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          j
                                       
                                       
                                          st
                                       
                                    
                                 
                              . Next, compute the total area of the meshes, A
                              
                                 vi
                               whose distances from p
                              
                                 vi
                               are less than or equal to ϒ dmin
                              , with the user-defined weight ϒ (ϒ
                              ⩾1). Then, the average pressure d
                              
                                 vi
                              /Avi
                               is assumed to act on the panel 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          j
                                       
                                       
                                          st
                                       
                                    
                                 
                              , from which the corresponding nodal forces are computed and accumulated. This process is repeated for all the viscous damping forces. In this method, the weight is a parameter that defines the range of viscous force distribution in the model. If the weight is increased, more meshes are assumed to be influenced by one viscous damping force.

The procedure for the initial distribution is developed based on the following physical observation. Using Eq. (1), the viscous damping force for the element shown in Fig. 1 is computed. It is created due to the viscosity and the relative velocity of the fluid on the surface of the object. The viscosity is a constant. Therefore, the velocity remains as the dominant factor influencing the viscous damping force. Suppose that a small element in Fig. 1 is defined by 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          j
                                       
                                       
                                          st
                                       
                                    
                                 
                               (j
                              =1,…,
                              nst
                              ). The viscous damping force can be obtained as the sum of the forces on all the meshes. Conversely, the viscous damping force can be distributed to each 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          j
                                       
                                       
                                          st
                                       
                                    
                                 
                              , and the amount of distributions for each mesh can be determined in proportion to the fluid velocity on the mesh. However, computation of the fluid velocity on the mesh requires hydrodynamic analysis for the structural mesh, which is the problem that is not intended to try in the first place due to its computational burden. To overcome this problem, two assumptions are introduced: first, an average velocity is considered for the meshes 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          j
                                       
                                       
                                          st
                                       
                                    
                                 
                               (j
                              =1,…,
                              nst
                              ). Next, the force for each mesh is proportional to its area. The first assumption implies the variation of the viscous damping force on each mesh is ignored in terms of velocity. On the other hand, the second assumption indicates that the only variation considered in the distribution is the size of each mesh. With these assumptions, the viscous damping force can be distributed to each mesh.

Once this initial distribution is completed, then the conditions in Eq. (19) should be tested. The force balance condition is automatically satisfied in the initial distribution phase. However, the moment balance could be compromised because the positions of the nodal forces on each mesh are different from the positions of the viscous damping forces. For this adjustment, the optimization approach presented in Section 3.1.3 is revisited. The problem is then formulated as follows:
                                 
                                    (20)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   Minimize
                                                   
                                                   Λ
                                                   =
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  st
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         df
                                                      
                                                      
                                                         vxk
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         df
                                                      
                                                      
                                                         vyk
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         df
                                                      
                                                      
                                                         vzk
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   subject
                                                   
                                                   to
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  st
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   d
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         vk
                                                      
                                                   
                                                   =
                                                   0
                                                   ,
                                                   
                                                   d
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         vk
                                                      
                                                   
                                                   =
                                                   (
                                                   
                                                      
                                                         df
                                                      
                                                      
                                                         vxk
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         df
                                                      
                                                      
                                                         vyk
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         df
                                                      
                                                      
                                                         vzk
                                                      
                                                   
                                                   )
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  st
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   d
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                   ×
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  st
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         vk
                                                      
                                                   
                                                   ×
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  vs
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         vi
                                                      
                                                   
                                                   ×
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         vi
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Here, dfvxk
                              , dfvyk
                              , and dfvzk
                               are the magnitudes of the adjustments on the kth node. The problem can be solved using the quadratic programming approach. The KKT condition can also be employed to find the solution of this optimization problem. The adjustments are then added to each nodal force.

Sometimes, external forces are applied to the structural mesh model directly in order to simulate various conditions. One example is to consider mooring of a floating body. A mooring system is installed at a specific local position on the body. It restricts the motion of the body against the currents or waves by providing constraint forces to the body. In order to simulate such a condition, forces due to the mooring system are estimated and provided as concentrated forces to the structural mesh model.

Meshes can be prepared such that the positions of concentrated point forces match the nodal positions. Thus, no extra mapping method is required, but the forces should be added to the corresponding nodal forces.

In this section, mapping examples are presented to demonstrate the proposed method. Three types of floating bodies are considered: ship, barge and offshore structure as shown in Fig. 6
                     . The numbers of the hydro panels and the structural meshes are summarized in Table 1
                     . In general the structural analysis requires finer meshes than the seakeeping analysis to accurately capture the structural details of a model. In this paper, the same numbers of the hydro panels and structural meshes are used for the evaluation of the program. Here, an imaginary structural model is created for the demonstration purpose. The actual structural mesh model is a private property of a company that its lease to public is not allowed.

For the computation, a computer with a CPU of Intel Core i3 (3.1GHz) and 4GB RAM was used. The software was developed using Visual C++ and OpenCascade library.

The pressure distribution for the hydro panel model is shown in Fig. 7
                           (a). The mapping was performed to yield a nodal force distribution. The sums of the forces (N) and moments (Nm) for the hydro model are (3225983.49, 3741.59, −228752623.66) and (9946.09, −1768978954.20, 299026.00). Before adjustment, the sums of the forces and moments on the structural mesh model are (2820977.08, 2042838.01, −219568674.59) and (3112128.43, −1805788334.87, −72186225.43). The force and moment differences are (405006.41, −2039096.42, −9183949.07) and (−3102182.33, 36809380.66, 72485251.43), respectively. After adjustment, the force and moment differences become zero and the final force distribution on the structural mesh model is shown in Fig. 7(b). The forces near the stem, stern and the bottom are oriented outward, whereas the forces on the side are directed inward. These force directions match the pressure distribution.

As shown in the figure, the load distribution on the structural mesh model matches that on the hydro panel model. The computation time of this mapping is 1min and 36s.

The pressure distribution for the hydro panel model of the barge is shown in Fig. 8
                           (a). The sums of the forces (N) and moments (Nm) for the hydro model are (186016.17, 297714.34,-10652165.25) and (−543076.36, −3546149.03, −9516039.16). Before adjustment, the force and moment differences are (3432.20, 4542.64, −97865.65) and (−152075.57, 18069.63, −146162.29), respectively. After adjustment, the force and moment differences become zero and the final force distribution on the structural mesh model is shown in Fig. 8(b). For this example, the computation time is 2min and 44s.

The pressure distribution for the hydro panel model of the offshore structure is shown in Fig. 9
                           (a). The sums of the forces (N) and moments (Nm) for the hydro model are (−1217863.36, −326.98, −502175056.54) and (−14415.35, 6721166.91, 53240.91). The force and moment differences are (40690.63, 0.86, −5875553.43) and (1298224.80, 2207268.15, 581.38), before adjustment. After adjustment, the force and moment differences become zero and the final force distribution on the structural mesh model is shown in Fig. 9(b). For this example, the computation time is 1min and 10s. The computation time is shorter than the two previous examples even though the offshore structure contains more panels and meshes. This is because of the geometric shape of the offshore structure that is composed of local shapes such as cylinders and boxes.


                           Table 2
                            summarizes the percentage values of the unbalanced components for the three experimental cases. The moment of the offshore structure case shows a big difference in this computation. It was caused by the accumulated errors during the force mapping. However, after the adjustment, all the imbalanced components were removed.

In this example, the offshore structure is used. Viscous damping forces are given as pairs of a position and a force vector, which are visualized in Fig. 10
                        (a). The result of the distribution is shown in Fig. 10(b). As shown in the figure, the overall distribution pattern is similar to that of the given viscous damping forces.

The total force and moment of the viscous damping force distribution are (114563.05, 0.01, −33301.73) and (0.16, 2820251.18, −0.12). After the force transfer on the structural mesh model, the total force and moment are (−114563.05, 0.01, −33301.73) and (0.17, 2896399.51, −0.08). The resultant force remains the same. However, there exists an unbalanced moment component (−0.01, −76148.32, −0.040). After the adjustment of the nodal forces, the resultant force remains the same but the unbalanced moment components are eliminated.

@&#CONCLUSIONS@&#

Providing a seamless interface between two different geometric representations is one important goal of CAD and this paper addresses such a problem. In this paper, a novel procedure for achieving an interface between the seakeeping and structural analyses by providing a method of mapping pressure and viscous forces on the hydro panel model to the structural mesh models. Using the procedure, seakeeping analysis can be used for designing the hull shape of a floating body through analyzing its motions and for designing the strength of the structure of the body.

The idea of the mapping methods proposed in this work can be used for other mapping problems involving two distinct representations of one geometric model. The link between them can be created through the projection with respect to local coordinate systems associated with one representation. Through this geometric link, any property can be transferred from one representation to the other.

The mapping process involves a step of searching panels close to a mesh. The searching time grows as the numbers of panels and meshes increase as demonstrated in the examples. The performance can be improved using various techniques that prevent the overall computation time from increasing too much. Moreover, the projection step could be improved by considering the geometric relations of a mesh and the associated panels. Improving the searching time and the projection accuracy is recommended for future work.

@&#ACKNOWLEDGEMENTS@&#

This research was supported in part by the Basic Research Project through a grant provided by GIST in 2013. Also this study is partly supported through WISH joint industry project, which was supported by Hyundai Heavy Industry, Daewoo Shipbuilding and Marine Engineering Co., Samsung Heavy Industry, STX Offshore and Shipbuilding Co., Hanjin Heavy Industry, and Korean Register. Their support is appreciated.

@&#REFERENCES@&#

