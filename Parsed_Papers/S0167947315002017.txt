@&#MAIN-TITLE@&#On stepwise pattern recovery of the fused Lasso

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We provided necessary and sufficient conditions such that fused Lasso consistently recovers the piecewise constant pattern.


                        
                        
                           
                           We found that in general the fused Lasso is not consistent.


                        
                        
                           
                           We proposed a preconditioned fused Lasso to overcome the non-consistent issue.


                        
                        
                           
                           Simulation studies support our findings.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Fused Lasso

Non-asymptotic

Pattern recovery

Preconditioning

@&#ABSTRACT@&#


               
               
                  We study the property of the Fused Lasso Signal Approximator (FLSA) for estimating a blocky signal sequence with additive noise. We transform the FLSA to an ordinary Lasso problem, and find that in general the resulting design matrix does not satisfy the irrepresentable condition that is known as an almost necessary and sufficient condition for exact pattern recovery. We give necessary and sufficient conditions on the expected signal pattern such that the irrepresentable condition holds in the transformed Lasso problem. However, these conditions turn out to be very restrictive. We apply the newly developed preconditioning method — Puffer Transformation (Jia and Rohe, 2015) to the transformed Lasso and call the new procedure the preconditioned fused Lasso. We give non-asymptotic results for this method, showing that as long as the signal-to-noise ratio is not too small, our preconditioned fused Lasso estimator always recovers the correct pattern with high probability. Theoretical results give insight into what controls the ability of recovering the pattern — it is the noise level instead of the length of the signal sequence. Simulations further confirm our theorems and visualize the significant improvement of the preconditioned fused Lasso estimator over the vanilla FLSA in exact pattern recovery.
               
            

@&#INTRODUCTION@&#

Assume we have a sequence of signals 
                        
                           (
                           
                              
                                 y
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 y
                              
                              
                                 n
                              
                           
                           )
                        
                      and it follows the additive model 
                        
                           (1)
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    μ
                                 
                                 
                                    i
                                 
                                 
                                    ∗
                                 
                              
                              +
                              
                                 
                                    ϵ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              ,
                           
                        
                      where 
                        Y
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                           
                           
                              T
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              n
                           
                        
                      is the observed signal vector, 
                        
                           
                              μ
                           
                           
                              ∗
                           
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       μ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       μ
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                           
                           
                              T
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              n
                           
                        
                      the expected signal vector, and 
                        ϵ
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       ϵ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       ϵ
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                           
                           
                              T
                           
                        
                      the white noise such that 
                        
                           
                              ϵ
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              ϵ
                           
                           
                              n
                           
                        
                      are assumed to be i.i.d. Gaussian random variables with mean 0 and variance 
                        
                           
                              σ
                           
                           
                              2
                           
                        
                     . The model is assumed to be blocky in the sense that the signals come in blocks and have only a few change-points. To be exact, there exists a partition of 
                        
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                           }
                        
                        =
                        
                           
                              ∪
                           
                           
                              j
                              =
                              1
                           
                           
                              J
                           
                        
                        
                           {
                           
                              
                                 L
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 L
                              
                              
                                 j
                              
                           
                           +
                           1
                           ,
                           …
                           ,
                           
                              
                                 U
                              
                              
                                 j
                              
                           
                           }
                        
                      with 
                        
                           
                              L
                           
                           
                              1
                           
                        
                        =
                        1
                        ,
                        
                           
                              U
                           
                           
                              J
                           
                        
                        =
                        n
                        ,
                        
                           
                              U
                           
                           
                              j
                           
                        
                        ≥
                        
                           
                              L
                           
                           
                              j
                           
                        
                        ,
                        
                           
                              L
                           
                           
                              j
                              +
                              1
                           
                        
                        =
                        
                           
                              U
                           
                           
                              j
                           
                        
                        +
                        1
                     , and the following stepwise function holds: 
                        
                           
                              
                                 
                                    μ
                                 
                                 
                                    i
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    J
                                 
                              
                              
                                 
                                    ν
                                 
                                 
                                    j
                                 
                                 
                                    ∗
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          j
                                       
                                    
                                    ≤
                                    i
                                    ≤
                                    
                                       
                                          U
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              ,
                           
                        
                      with 
                        
                           
                              ν
                           
                           
                              j
                           
                           
                              ∗
                           
                        
                        ,
                        
                           
                              L
                           
                           
                              j
                           
                        
                        ,
                        
                           
                              U
                           
                           
                              j
                           
                        
                      fixed but unknown. We also assume that the vector 
                        ν
                        =
                        
                           (
                           
                              
                                 ν
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ν
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 ν
                              
                              
                                 J
                              
                           
                           )
                        
                      is sparse, meaning that only a few of 
                        
                           
                              ν
                           
                           
                              j
                           
                        
                     ’s are nonzeros. We point out that the Gaussian noise is not necessary, but we still use it to get insight of the fused Lasso. The variance 
                        
                           
                              σ
                           
                           
                              2
                           
                        
                      of 
                        
                           
                              ϵ
                           
                           
                              i
                           
                        
                      is the measure of noise level and does not have to be a constant here. In many cases, each observation of 
                        
                           
                              y
                           
                           
                              i
                           
                        
                      can be an average of multiple measurements and so 
                        
                           
                              σ
                           
                           
                              2
                           
                        
                      decreases when the number of measurements increases. Rinaldo (2009) considers the model when 
                        
                           
                              σ
                           
                           
                              2
                           
                        
                        =
                        
                           
                              σ
                           
                           
                              0
                           
                           
                              2
                           
                        
                        /
                        n
                     , where 
                        
                           
                              σ
                           
                           
                              0
                           
                        
                      is a constant. We do not make this specific assumption in the development of our theory.

Featured by blockiness and sparseness, this model has many applications. For example, in tumor studies, based on the Comparative Genomic Hybridization (CGH) data, it can be used to automatically detect the gains and losses in DNA copies by taking the “signal” above as the log-ratio between the number of DNA copies in tumor cells and that in reference cells (Tibshirani and Wang, 2008). For more applications, see Tibshirani and Taylor (2011), Friedman et al. (2007) and Hoefling (2010).

One way to estimate the unknown parameters is via the Fused Lasso Signal Approximator (FLSA) defined as follows (Tibshirani et al., 2004; Friedman et al., 2007): 
                        
                           (2)
                           
                              
                                 
                                    μ
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    argmin
                                 
                                 
                                    μ
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       ‖
                                       Y
                                       −
                                       μ
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       ‖
                                       μ
                                       ‖
                                    
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       ‖
                                       μ
                                       ‖
                                    
                                 
                                 
                                    T
                                    V
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              
                                 ‖
                                 μ
                                 ‖
                              
                           
                           
                              1
                           
                        
                        =
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              n
                           
                        
                        
                           |
                           
                              
                                 μ
                              
                              
                                 i
                              
                           
                           |
                        
                        ,
                        
                           
                              
                                 ‖
                                 μ
                                 ‖
                              
                           
                           
                              2
                           
                           
                              2
                           
                        
                        =
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              n
                           
                        
                        
                           
                              μ
                           
                           
                              i
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              
                                 ‖
                                 μ
                                 ‖
                              
                           
                           
                              T
                              V
                           
                        
                        =
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              n
                              −
                              1
                           
                        
                        
                           |
                           
                              
                                 μ
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 μ
                              
                              
                                 i
                              
                           
                           |
                        
                     . The 
                        
                           
                              L
                           
                           
                              1
                           
                        
                     -norm regularization controls the sparsity (number of zeros) and the total variation seminorm 
                        
                           (
                           
                              
                                 
                                    ‖
                                    μ
                                    ‖
                                 
                              
                              
                                 T
                                 V
                              
                           
                           )
                        
                      regularization controls the blockiness (number of blocks or partitions).


                     Fig. 1
                      gives some CGH data, a typical example of signals with such features and a proper FLSA estimate on the data. More details and examples can be seen in Tibshirani and Wang (2008).

One important question for the FLSA is how good the estimator defined in Eq. (2) is. We analyze in this paper if the FLSA can recover the “stepwise pattern” or not. We also try to answer the following question: what do we do if the FLSA does not recover the “stepwise pattern”? To measure how good an estimator is, we introduce the following definition of Pattern Recovery.


                     
                        Definition 1
                        Pattern Recovery


                        An FLSA solution 
                              
                                 
                                    μ
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                       n
                                    
                                 
                                 )
                              
                            recovers the signal pattern if and only if there exist 
                              
                                 
                                    λ
                                 
                                 
                                    1
                                    n
                                 
                              
                            and 
                              
                                 
                                    λ
                                 
                                 
                                    2
                                    n
                                 
                              
                           , such that 
                              
                                 (3)
                                 
                                    s
                                    i
                                    g
                                    n
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                                n
                                             
                                          
                                          ,
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                                n
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                                n
                                             
                                          
                                          ,
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                                n
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    =
                                    s
                                    i
                                    g
                                    n
                                    
                                       (
                                       
                                          
                                             μ
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                          
                                             ∗
                                          
                                       
                                       −
                                       
                                          
                                             μ
                                          
                                          
                                             i
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    −
                                    1
                                    .
                                 
                              
                           
                        

We use 
                        
                           
                              μ
                           
                           
                              ˆ
                           
                        
                        
                           
                              =
                           
                           
                              j
                              s
                           
                        
                        
                           
                              μ
                           
                           
                              ∗
                           
                        
                      to shortly denote (3) (
                        j
                        s
                      is the acronym for 
                        j
                        u
                        m
                        p
                        
                        s
                        i
                        g
                        n
                     ). The FLSA with the property of pattern recovery means that it can be used to identify both the groups and the jump directions (up or down) between groups.

The concept of pattern recovery of the FLSA is very similar to the sign recovery of the Lasso (Zhao and Yu, 2006). In fact, we will see in Section  2 that the pattern recovery property of the FLSA is equivalent to the sign recovery property of the Lasso after transformation.

For observation pairs 
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           )
                        
                        ,
                        i
                        =
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        n
                      with 
                        
                           
                              x
                           
                           
                              i
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              p
                           
                        
                      and 
                        
                           
                              y
                           
                           
                              i
                           
                        
                        ∈
                        R
                     , the Lasso estimator is defined as follows (Tibshirani, 1996): 
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 λ
                                 )
                              
                              =
                              
                                 
                                    argmin
                                 
                                 
                                    β
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                          
                                             T
                                          
                                       
                                       β
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              λ
                              
                                 
                                    
                                       ‖
                                       β
                                       ‖
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                           
                        
                      or equivalently, in the matrix form, 
                        
                           (4)
                           
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 λ
                                 )
                              
                              =
                              
                                 
                                    argmin
                                 
                                 
                                    β
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       ‖
                                       Y
                                       −
                                       X
                                       β
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              λ
                              
                                 
                                    
                                       ‖
                                       β
                                       ‖
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                           
                        
                      where 
                        Y
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                           
                           
                              T
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              n
                           
                        
                      and 
                        X
                        ∈
                        
                           
                              R
                           
                           
                              n
                              ×
                              p
                           
                        
                      with 
                        
                           
                              x
                           
                           
                              i
                           
                           
                              T
                           
                        
                      as its 
                        i
                     th row. We use 
                        
                           
                              X
                           
                           
                              j
                           
                        
                      to denote the 
                        j
                     th column of 
                        X
                     . Lasso is a regularized method that gives sparse solutions. The 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      term in the objective function makes the solution sparse. For different purposes, other loss functions could be used. Xu et al. (2015) used Cauchy loss in the objective function to get robust estimators. For matrix parameters, nuclear norm and its variations could be used to get low rank estimators (Cai et al., 2010; Xu et al., 2014).

Sign recovery of the Lasso is defined as follows.


                     
                        Definition 2
                        Sign Recovery (Zhao and Yu, 2006)


                        Suppose that data 
                              
                                 (
                                 X
                                 ,
                                 Y
                                 )
                              
                            follow a linear model: 
                              Y
                              =
                              X
                              
                                 
                                    β
                                 
                                 
                                    ∗
                                 
                              
                              +
                              ϵ
                           , where 
                              Y
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                              ,
                              X
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                    ×
                                    p
                                 
                              
                            with 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                            as its 
                              i
                           th row, 
                              
                                 
                                    β
                                 
                                 
                                    ∗
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    p
                                    ×
                                    1
                                 
                              
                            and 
                              ϵ
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             ϵ
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             ϵ
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                    ×
                                    1
                                 
                              
                            with 
                              E
                              
                                 (
                                 
                                    
                                       ϵ
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              =
                              0
                           . A Lasso estimator 
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                            has the sign recovery property if and only if there exists 
                              
                                 
                                    λ
                                 
                                 
                                    n
                                 
                              
                            such that 
                              
                                 (5)
                                 
                                    s
                                    i
                                    g
                                    n
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          
                                             
                                                λ
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    =
                                    s
                                    i
                                    g
                                    n
                                    
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             j
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    p
                                    .
                                 
                              
                           
                        

We will use 
                        
                           
                              β
                           
                           
                              ˆ
                           
                        
                        
                           
                              =
                           
                           
                              s
                           
                        
                        
                           
                              β
                           
                           
                              ∗
                           
                        
                      to shortly denote this property. In particular, this property, if satisfied, means that the Lasso selects the correct set of predictors. Asymptotically, we say the Lasso estimator 
                        
                           
                              β
                           
                           
                              ˆ
                           
                        
                        
                           (
                           
                              
                                 λ
                              
                              
                                 n
                              
                           
                           )
                        
                      is sign consistent if there exists a sequence of 
                        
                           
                              λ
                           
                           
                              n
                           
                        
                      such that 
                        P
                        
                           (
                           
                              
                                 β
                              
                              
                                 ˆ
                              
                           
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    n
                                 
                              
                              )
                           
                           
                              
                                 =
                              
                              
                                 s
                              
                           
                           β
                           )
                        
                        →
                        1
                     , as the sample size 
                        n
                        →
                        ∞
                     .

A rich theoretical literature has studied the consistency of the Lasso, highlighting several potential pitfalls (Knight and Fu, 2000; Fan and Li, 2001; Greenshtein and Ritov, 2004; Donoho et al., 2006; Meinshausen and Bühlmann, 2006; Tropp, 2006; Zhao and Yu, 2006; Zhang and Huang, 2008; Wainwright, 2009). The sign consistency of the Lasso requires the irrepresentable condition, a stringent assumption on the design matrix (Zhao and Yu, 2006). Now it is well understood that if the design matrix violates the irrepresentable condition, the Lasso will perform poorly in sign recovery, even with increased sample size.

The analyses of the FLSA are fairly recent. Tibshirani and Taylor (2011) consider the FLSA as a special case of the generalized Lasso problem and give the boundary lemma, a remarkable property of the FLSA saying that along the solution path, the coordinates on the boundary will always stay on the boundary as 
                        λ
                      decreases. Rinaldo (2009) considers the sign consistency of the FLSA and proposes the adaptive fused Lasso. It shows that under some conditions, the FLSA can be consistent in both block reconstruction and model selection. The fused Lasso applied to general graphs, called the edge Lasso, is considered in Sharpnack et al. (2012). The ability of exact pattern recovery depends heavily on the structural properties of the graph. In particular, the author mentions the sign inconsistency of the 1D fused Lasso, the FLSA here, but does not attempt at addressing this issue.

There is a very close connection between the fused Lasso and change point estimation. In Harchaoui and Lévy-Leduc (2008) and Harchaoui and Lévy-Leduc (2010), the authors study the change point estimation problem using the total variation penalty, which is the fused Lasso when 
                        
                           
                              λ
                           
                           
                              1
                           
                        
                      is taken as 0. Harchaoui and Lévy-Leduc (2010) have a very nice result for consistency on the estimation of the signal mean. They also point out that the total variation penalized least squares cannot consistently estimate the locations of change points. Instead, they show that under a few regularity conditions, the estimated locations of the change points are close to the true locations. In this paper, we give deeper analysis of the total variation penalized least squares. We give a necessary and sufficient condition on consistently recovering the piecewise constant pattern, which is also called consistent recovery of change points.

We borrow analytical tools used to study the LASSO in the paper. There are several differences between the fused Lasso and Lasso that should be highlighted, though the former can be transformed to the latter by reparametrization. First, though could be seen as a specific kind of Lasso problem under reparametrization, the recovery of piecewise constant signals, or detection of multiple change points itself is an important class of problems and has very wide applications. So it is worthwhile to gain more insight into this problem beyond general Lasso’s and to consider fast and consistent algorithms as we do here. Second, the analysis of sign consistency is different than classic Lasso problems in that the attempt to transform to Lasso introduces an intercept term that is not penalized as other coefficients. The intercept can be replaced by the mean of observations, however, extra care should be taken before directly applying the Lasso theories. We adapt the argument for standard Lasso to general noise structures other than independent noise.

In this paper, we not only study the sign recovery of the FLSA using the irrepresentable condition for the Lasso, but more importantly, by preconditioning the design matrix, our newly proposed method significantly improves the performance of pattern recovery. For preparation, we first prove that even for the linear model with correlated noise, the irrepresentable condition is still necessary for sign consistency. We then analyze the design matrix in the transformed Lasso problem. We give necessary and sufficient condition such that the design matrix in the transformed Lasso problem complies with the irrepresentable condition. We show that, only for a special class of models (with special designed stepwise function on 
                        
                           
                              μ
                           
                           
                              i
                           
                           
                              ∗
                           
                        
                     ), the irrepresentable condition holds. For other signal patterns, the irrepresentable condition does not hold and thus the FLSA may fail to keep consistent. A recent paper “Preconditioning to comply with the irrepresentable condition” by Jia and Rohe (2015) suggests a Puffer Transformation that will improve the Lasso and make the Lasso estimator sign consistent under some mild conditions. We apply this technique, propose the preconditioned fused Lasso and show that it significantly improves the FLSA and recovers the signal pattern with high probability. We also point out that we did not fully solve the change point estimation problem. Our results show that if the signal is strong and the noise is small, then no matter what the pattern is, the preconditioned fused Lasso gives consistent estimation of the change point locations. In change point literature, people also study some special patterns — say when the block size is big enough. With more information on the signal pattern, one may have stronger results. This is now out of our research scope and will be our further study. In this paper, we try to understand the fused Lasso (equivalently the total variation penalized least squares) for one dimensional signals.

The rest of the paper is organized as follows. In Section  2, we establish connection between the FLSA and a Lasso problem via proper transformation. Section  3 discusses when the FLSA can recover the signal pattern and when it cannot. In Section  4, we propose a new algorithm called the preconditioned fused Lasso that improves the FLSA by using the preconditioning technique. We show that for a wide range of designs of the stepwise function on 
                        
                           
                              μ
                           
                           
                              ∗
                           
                        
                     , this algorithm can recover the signal pattern with high probability. In Section  5, simulations are implemented to compare the performances between the preconditioned fused Lasso and the vanilla FLSA. Section  6 concludes the paper. The proofs are given in the Appendix.

In this section, we transform the FLSA problem into a Lasso problem by change of variables. Define the soft thresholding function 
                        S
                        
                           
                              H
                           
                           
                              λ
                           
                        
                        
                           (
                           x
                           )
                        
                      as 
                        
                           
                              S
                              
                                 
                                    H
                                 
                                 
                                    λ
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          x
                                          +
                                          λ
                                       
                                       
                                          x
                                          <
                                          −
                                          λ
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          −
                                          λ
                                          ≤
                                          x
                                          ≤
                                          λ
                                       
                                    
                                    
                                       
                                          x
                                          −
                                          λ
                                       
                                       
                                          x
                                          >
                                          λ
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Let 
                        
                           
                              μ
                           
                           
                              ˆ
                           
                        
                        
                           (
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           )
                        
                      be the fused Lasso estimator defined in (2). We have the following result.


                     
                        Lemma 1
                        
                           Friedman et al., 2007
                        


                        
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    S
                                    
                                       
                                          H
                                       
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             μ
                                          
                                          
                                             ˆ
                                          
                                       
                                       
                                          (
                                          0
                                          ,
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        

From Lemma 1, to study the properties of 
                        
                           
                              μ
                           
                           
                              ˆ
                           
                        
                        
                           (
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           )
                        
                     , we can set 
                        
                           
                              λ
                           
                           
                              1
                           
                        
                        =
                        0
                      first. Since pattern recovery is our main concern here, we only consider the case 
                        
                           
                              λ
                           
                           
                              1
                           
                        
                        =
                        0
                      in this paper. When 
                        
                           
                              λ
                           
                           
                              1
                           
                        
                        =
                        0
                     , we can solve the FLSA by change of variables. Let 
                        
                           
                              θ
                           
                           
                              1
                           
                        
                        =
                        
                           
                              μ
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              θ
                           
                           
                              i
                           
                        
                        =
                        
                           
                              μ
                           
                           
                              i
                           
                        
                        −
                        
                           
                              μ
                           
                           
                              i
                              −
                              1
                           
                        
                        ,
                        i
                        =
                        2
                        ,
                        …
                        ,
                        n
                     , or in the matrix form, 
                        μ
                        =
                        A
                        θ
                     , where 
                        A
                        ∈
                        
                           
                              R
                           
                           
                              n
                              ×
                              n
                           
                        
                      is the lower triangular matrix with nonzero elements equal to one. So by using 
                        θ
                      instead of 
                        μ
                     , we have an equivalent solution of 
                        
                           
                              μ
                           
                           
                              ˆ
                           
                        
                        
                           (
                           0
                           ,
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           )
                        
                      via the following 
                        
                           
                              θ
                           
                           
                              ˆ
                           
                        
                        
                           (
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           )
                        
                     : 
                        
                           (6)
                           
                              
                                 
                                    θ
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    argmin
                                 
                                 
                                    θ
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       ‖
                                       Y
                                       −
                                       A
                                       θ
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       ‖
                                       
                                          
                                             θ
                                          
                                          
                                             ̃
                                          
                                       
                                       ‖
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              θ
                           
                           
                              ̃
                           
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                           
                           
                              T
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              n
                              −
                              1
                           
                        
                     . Once we obtain 
                        
                           
                              θ
                           
                           
                              ˆ
                           
                        
                        
                           (
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           )
                        
                     , we have 
                        
                           
                              μ
                           
                           
                              ˆ
                           
                        
                        
                           (
                           0
                           ,
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           )
                        
                        =
                        A
                        
                           
                              θ
                           
                           
                              ˆ
                           
                        
                        
                           (
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           )
                        
                     . With the special form of the design matrix 
                        A
                     , (6) is a Lasso problem with intercept. In fact, (6) can be rewritten as 
                        
                           (7)
                           
                              
                                 
                                    θ
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    argmin
                                 
                                 
                                    
                                       (
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             ‖
                                             Y
                                             −
                                             
                                                1
                                             
                                             ⋅
                                             
                                                
                                                   θ
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             X
                                             
                                                
                                                   θ
                                                
                                                
                                                   ̃
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       ‖
                                       
                                          
                                             θ
                                          
                                          
                                             ̃
                                          
                                       
                                       ‖
                                    
                                 
                                 
                                    1
                                 
                              
                           
                        
                      where 
                        
                           1
                        
                        =
                        
                           
                              
                                 (
                                 1
                                 ,
                                 …
                                 ,
                                 1
                                 )
                              
                           
                           
                              T
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              n
                           
                        
                        ,
                        
                           
                              θ
                           
                           
                              ̃
                           
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                           
                           
                              T
                           
                        
                      and 
                        X
                        =
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                                 j
                              
                           
                           )
                        
                        ∈
                        
                           
                              R
                           
                           
                              n
                              ×
                              
                                 (
                                 n
                                 −
                                 1
                                 )
                              
                           
                        
                     : 
                        
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                    j
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          1
                                       
                                       
                                          i
                                          >
                                          j
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          i
                                          ≤
                                          j
                                          .
                                       
                                    
                                 
                              
                           
                        
                      Define the centered version of 
                        X
                        ∈
                        
                           
                              R
                           
                           
                              n
                              ×
                              
                                 (
                                 n
                                 −
                                 1
                                 )
                              
                           
                        
                      and 
                        Y
                        ∈
                        
                           
                              R
                           
                           
                              n
                           
                        
                      as follows: 
                        
                           (8)
                           
                              
                                 
                                    X
                                 
                                 
                                    ̃
                                 
                              
                              =
                              
                                 [
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ̄
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 ]
                              
                              
                              and
                              
                              
                                 
                                    Y
                                 
                                 
                                    ̃
                                 
                              
                              =
                              Y
                              −
                              
                                 
                                    Y
                                 
                                 
                                    ̄
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              u
                           
                           
                              ̄
                           
                        
                      is the vector with all elements equal to the average of 
                        u
                     . It is easy to see that (7) is equivalent to the following standard Lasso problem without intercept: 
                        
                           (9)
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    argmin
                                 
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   Y
                                                
                                                
                                                   ̃
                                                
                                             
                                             −
                                             
                                                
                                                   X
                                                
                                                
                                                   ̃
                                                
                                             
                                             
                                                
                                                   θ
                                                
                                                
                                                   ̃
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       ‖
                                       
                                          
                                             θ
                                          
                                          
                                             ̃
                                          
                                       
                                       ‖
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              and
                              
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    Y
                                 
                                 
                                    ̄
                                 
                              
                              −
                              
                                 
                                    X
                                 
                                 
                                    ̄
                                 
                              
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              .
                           
                        
                      Define 
                        
                           
                              θ
                           
                           
                              ∗
                           
                        
                        =
                        
                           
                              A
                           
                           
                              −
                              1
                           
                        
                        
                           
                              μ
                           
                           
                              ∗
                           
                        
                     ; that is, 
                        
                           
                              θ
                           
                           
                              1
                           
                           
                              ∗
                           
                        
                        =
                        
                           
                              μ
                           
                           
                              1
                           
                           
                              ∗
                           
                        
                        ,
                        
                           
                              θ
                           
                           
                              i
                           
                           
                              ∗
                           
                        
                        =
                        
                           
                              μ
                           
                           
                              i
                           
                           
                              ∗
                           
                        
                        −
                        
                           
                              μ
                           
                           
                              i
                              −
                              1
                           
                           
                              ∗
                           
                        
                        ,
                        i
                        =
                        2
                        ,
                        …
                        ,
                        n
                     . Let 
                        
                           
                              
                                 
                                    θ
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              ∗
                           
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       3
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                              
                           
                           
                              T
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              n
                              −
                              1
                           
                        
                     . Since the observation 
                        Y
                        =
                        
                           (
                           
                              
                                 y
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 y
                              
                              
                                 n
                              
                           
                           )
                        
                      follows the model defined in (1), we have that 
                        
                           (
                           X
                           ,
                           Y
                           )
                        
                      satisfies the linear model: 
                        
                           
                              Y
                              =
                              A
                              
                                 
                                    θ
                                 
                                 
                                    ∗
                                 
                              
                              +
                              ϵ
                              =
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                                 
                                    ∗
                                 
                              
                              +
                              X
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                              +
                              ϵ
                              ,
                           
                        
                      where 
                        X
                      is defined at (2). Thus the centered version of 
                        
                           (
                           X
                           ,
                           Y
                           )
                        
                      satisfies the following linear model: 
                        
                           (10)
                           
                              
                                 
                                    Y
                                 
                                 
                                    ̃
                                 
                              
                              =
                              
                                 
                                    X
                                 
                                 
                                    ̃
                                 
                              
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                              +
                              
                                 
                                    ϵ
                                 
                                 
                                    ̃
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              ϵ
                           
                           
                              ̃
                           
                        
                        =
                        ϵ
                        −
                        
                           
                              ϵ
                           
                           
                              ̄
                           
                        
                     , the centered version. Now we see that 
                        
                           
                              
                                 
                                    θ
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              ˆ
                           
                        
                        
                           (
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           )
                        
                      defined in (9) has the sign recovery property if and only if 
                        
                           
                              
                                 
                                    θ
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              ˆ
                           
                        
                        
                           (
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           )
                        
                        
                           
                              =
                           
                           
                              s
                           
                        
                        
                           
                              
                                 
                                    θ
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              ∗
                           
                        
                     . By the relationship between 
                        μ
                      and 
                        θ
                        
                        
                           (
                           μ
                           =
                           A
                           θ
                           )
                        
                        ,
                        
                           
                              
                                 
                                    θ
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              ˆ
                           
                        
                        
                           (
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           )
                        
                        
                           
                              =
                           
                           
                              s
                           
                        
                        
                           
                              
                                 
                                    θ
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              ∗
                           
                        
                      is equivalent to 
                        
                           
                              μ
                           
                           
                              ˆ
                           
                        
                        
                           (
                           0
                           ,
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           )
                        
                        
                           
                              =
                           
                           
                              j
                              s
                           
                        
                        
                           
                              μ
                           
                           
                              ∗
                           
                        
                     . In other words, the pattern recovery property of the FLSA is equivalent to the sign recovery of the corresponding Lasso estimator.


                     
                        Property 1
                        
                           The pattern recovery of the FLSA 
                           
                              
                                 
                                    μ
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 0
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            
                           defined in   (2)   is equivalent to the sign consistency of the Lasso estimator 
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            
                           defined in   (9)
                           .
                        

Note that the main purpose of the change of variables here is for theoretical analysis rather than computational considerations. Although there are many efficient algorithms for the Lasso such as LARS and coordinate descent, it is not recommended in practice to solve the FLSA by transforming to the Lasso and then applying these algorithms. The transformation makes the design matrix in (9) dense and is computationally unfavorable. Instead, Friedman et al. (2007) develop specialized algorithm for the FLSA based on the coordinate-wise descent. Hoefling (2010) proposes the path algorithm and extends that to more general fused Lasso problems. In our theoretical analysis, however, such transformation helps since we can use well understood techniques for the Lasso to analyze the properties of the FLSA.

From the above argument, the study of the FLSA is reduced to analyzing the Lasso problem defined in (9). It is now well understood that in a standard linear regression problem the Lasso is sign consistent when the design matrix satisfies some stringent conditions. One such condition is the irrepresentable condition (Zhao and Yu, 2006) defined as follows:


                     
                        Definition 3
                        Irrepresentable Condition


                        Suppose that data 
                              
                                 (
                                 X
                                 ,
                                 Y
                                 )
                              
                            follows a linear model: 
                              Y
                              =
                              X
                              
                                 
                                    β
                                 
                                 
                                    ∗
                                 
                              
                              +
                              ϵ
                           , where 
                              Y
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                              ,
                              X
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                    ×
                                    p
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    ∗
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    p
                                    ×
                                    1
                                 
                              
                            and 
                              ϵ
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             ϵ
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             ϵ
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                    ×
                                    1
                                 
                              
                            with 
                              E
                              
                                 (
                                 
                                    
                                       ϵ
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              =
                              0
                           . The design matrix 
                              X
                            satisfies the Irrepresentable Condition for 
                              
                                 
                                    β
                                 
                                 
                                    ∗
                                 
                              
                            with support 
                              S
                              =
                              
                                 {
                                 j
                                 :
                                 
                                    
                                       β
                                    
                                    
                                       j
                                    
                                    
                                       ∗
                                    
                                 
                                 ≠
                                 0
                                 }
                              
                            if, for some 
                              η
                              ∈
                              
                                 (
                                 0
                                 ,
                                 1
                                 ]
                              
                           , 
                              
                                 (11)
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   X
                                                
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   S
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            S
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             s
                                             i
                                             g
                                             n
                                             
                                                (
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      S
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                )
                                             
                                             ‖
                                          
                                       
                                       
                                          ∞
                                       
                                    
                                    ≤
                                    1
                                    −
                                    η
                                    ,
                                 
                              
                            where for a vector 
                              x
                              ,
                              
                                 
                                    
                                       ‖
                                       x
                                       ‖
                                    
                                 
                                 
                                    ∞
                                 
                              
                              =
                              
                                 
                                    max
                                 
                                 
                                    i
                                 
                              
                              
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 |
                              
                           , and for 
                              T
                              ⊂
                              
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 p
                                 }
                              
                            with 
                              
                                 |
                                 T
                                 |
                              
                              =
                              t
                           , 
                              
                                 
                                    X
                                 
                                 
                                    T
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                    ×
                                    t
                                 
                              
                            is a matrix which contains the columns of 
                              X
                            indexed by 
                              T
                           .

The irrepresentable condition is a key condition for the Lasso’s sign consistency. A lot of researchers noticed that the irrepresentable condition is a necessary condition for the Lasso’s sign consistency (Zhao and Yu, 2006; Wainwright, 2009; Jia et al., 2013). We also state this conclusion under a more general linear model with correlated noise terms.


                     
                        Theorem 1
                        
                           Suppose that data 
                           
                              
                                 (
                                 X
                                 ,
                                 Y
                                 )
                              
                            
                           follows a linear model 
                           
                              Y
                              =
                              X
                              
                                 
                                    β
                                 
                                 
                                    ∗
                                 
                              
                              +
                              ϵ
                           
                           , with Gaussian noise 
                           
                              ϵ
                              ∼
                              N
                              
                                 (
                                 0
                                 ,
                                 
                                    
                                       Σ
                                    
                                    
                                       ϵ
                                    
                                 
                                 )
                              
                           
                           . The irrepresentable condition   (11)   is necessary for the sign consistency of the Lasso. In other words, if
                           
                              
                                 (12)
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   X
                                                
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   S
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            S
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             s
                                             i
                                             g
                                             n
                                             
                                                (
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      S
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                )
                                             
                                             ‖
                                          
                                       
                                       
                                          ∞
                                       
                                    
                                    ≥
                                    1
                                    ,
                                 
                              
                           
                           we have
                           
                              
                                 
                                    P
                                    
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ˆ
                                          
                                       
                                       
                                          (
                                          λ
                                          )
                                       
                                       
                                          
                                             =
                                          
                                          
                                             s
                                          
                                       
                                       
                                          
                                             β
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                    
                                    ≤
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        

The proof of Theorem 1 is postponed to Appendix. This theorem says if the irrepresentable condition does not hold, it is very likely that the Lasso cannot correctly recover the signs of the coefficients.

With the above theorem, we come back to the transformed Lasso problem defined in (9) and examine if the irrepresentable condition holds or not in this case. Recall that for the Lasso problem induced from the FLSA, we have the design matrix 
                        
                           
                              
                                 
                                    X
                                 
                                 
                                    ̃
                                 
                              
                              =
                              
                                 [
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ̄
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 ]
                              
                              .
                           
                        
                      Let 
                        S
                        =
                        
                           {
                           j
                           :
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 j
                              
                              
                                 ∗
                              
                           
                           ≠
                           0
                           }
                        
                      denote the index set of the relevant variables in the true model. Then (11) can be written as 
                        
                           
                              
                                 |
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   j
                                                
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             S
                                          
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      S
                                                   
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                          )
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 s
                                 i
                                 g
                                 n
                                 
                                    (
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                                 |
                              
                              <
                              1
                              ,
                              
                              ∀
                              j
                              ∉
                              S
                              .
                           
                        
                      This is equivalent to 
                        
                           
                              
                                 |
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       j
                                    
                                    
                                       T
                                    
                                 
                                 s
                                 i
                                 g
                                 n
                                 
                                    (
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                                 |
                              
                              <
                              1
                              ,
                              
                              ∀
                              j
                              ∉
                              S
                              ,
                           
                        
                      where 
                        
                           
                              
                                 
                                    b
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              j
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              
                                 |
                                 S
                                 |
                              
                           
                        
                      is the OLS estimate of 
                        
                           
                              b
                           
                           
                              j
                           
                        
                      in the following linear regression equation: 
                        
                           (13)
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    ̃
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    S
                                 
                              
                              +
                              ϵ
                              .
                           
                        
                      Since 
                        
                           
                              X
                           
                           
                              ̃
                           
                        
                      is the centered version of 
                        X
                     , it can be easily shown that 
                        
                           
                              
                                 
                                    b
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              j
                           
                        
                      is also the OLS estimate of 
                        
                           
                              b
                           
                           
                              j
                           
                        
                      in the following linear regression equation: 
                        
                           (14)
                           
                              
                                 
                                    X
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    b
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    S
                                 
                              
                              +
                              ϵ
                              ,
                           
                        
                      where 
                        
                           
                              b
                           
                           
                              0
                           
                        
                        ∈
                        R
                      is the intercept term. Recall the irrepresentable condition defined in (11): 
                        
                           
                              
                                 
                                    
                                       ‖
                                       
                                          
                                             X
                                          
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   c
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             S
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      S
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      S
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       s
                                       i
                                       g
                                       n
                                       
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                S
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                       ‖
                                    
                                 
                                 
                                    ∞
                                 
                              
                              ≤
                              1
                              −
                              η
                              .
                           
                        
                      We can thus find all the signal patterns in (1) such that the irrepresentable condition holds for the corresponding transformed Lasso.


                     
                        Theorem 2
                        
                           Assume 
                           
                              y
                              =
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                            
                           satisfies model   (1)
                           , the collection of the indices of jump points are 
                           
                              S
                              =
                              
                                 {
                                 
                                    
                                       j
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       j
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       j
                                    
                                    
                                       s
                                    
                                 
                                 }
                              
                            
                           with 
                           
                              
                                 
                                    j
                                 
                                 
                                    k
                                 
                              
                              
                                 (
                                 1
                                 ≤
                                 k
                                 ≤
                                 s
                                 )
                              
                            
                           increasing. Formally, 
                           
                              S
                              =
                              
                                 {
                                 j
                                 :
                                 
                                    
                                       μ
                                    
                                    
                                       j
                                    
                                    
                                       ∗
                                    
                                 
                                 ≠
                                 
                                    
                                       μ
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 j
                                 =
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 }
                              
                           
                           . Then the irrepresentable condition   (11)   holds for the transformed Lasso if and only if one of the following two conditions holds.
                           
                              
                                 (1)
                                 
                                    The jump points are consecutive. That is, 
                                    
                                       s
                                       =
                                       1
                                     
                                    or
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   1
                                                   ≤
                                                   k
                                                   <
                                                   s
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             =
                                             1
                                             .
                                          
                                       
                                    
                                 


                                    If there exists one group of data points (with more than  1  point) between some two consecutive jump points and these data points have the same expected signal strength, then the two jumps are of different directions (up or down). Formally, let 
                                    
                                       
                                          
                                             j
                                          
                                          
                                             k
                                          
                                       
                                     
                                    and 
                                    
                                       
                                          
                                             j
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                     
                                    be two jump points and 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       ⋯
                                       =
                                       
                                          
                                             μ
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             −
                                             1
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                    , then 
                                    
                                       
                                          (
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                          −
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      k
                                                   
                                                
                                                −
                                                1
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                          −
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                −
                                                1
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                       <
                                       0
                                    
                                    .
                                 

The proof is given in the Appendix. Theorem 2 implies that only a few configurations of 
                        
                           
                              μ
                           
                           
                              ∗
                           
                        
                      can make the transformed Lasso comply with the irrepresentable condition. In applications, most signal patterns do not satisfy either of the two conditions in Theorem 2. Harchaoui and Lévy-Leduc (2010) also provide a result considering the irrepresentable condition. They show that the irrepresentable condition never holds for a slightly modified total variation penalty. Note that the penalty term for original total variation penalty term is 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              2
                           
                           
                              p
                           
                        
                        
                           |
                           
                              
                                 β
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                           |
                        
                     , while Harchaoui and Lévy-Leduc (2010) give a result for a slightly different penalty 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              2
                           
                           
                              p
                           
                        
                        
                           [
                           
                              |
                              
                                 
                                    β
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              |
                           
                           ]
                        
                        +
                        
                           
                              β
                           
                           
                              1
                           
                        
                     . With the small modification, the result is also different.

We noticed that Rinaldo (2009) gave a result (Theorem 2.3 on page 2930) saying that under some regularity conditions, the fused Lasso consistently recovers the signal pattern. This is a contradiction with Theorem 2, since those regularity conditions only depend on the signal strengths, the number of blocks and the minimal size of the blocks. Because these conditions do not guarantee the irrepresentable condition, that result missed this irrepresentable condition.

For sign recovery defined in (5), Jia and Rohe (2015) proposed a Puffer Transformation that preconditions the design matrix in order to comply with the irrepresentable condition. The connection between sign recovery and pattern recovery defined in (3) enables us to apply the same technique and thus improve the performance over the vanilla FLSA in pattern recovery.


                     Jia and Rohe (2015) introduce the Puffer Transformation to the Lasso when the design matrix does not satisfy the irrepresentable condition. They showed that when 
                        n
                        ≥
                        p
                     , even if the Lasso is not sign consistent, after the Puffer Transformation, the Lasso is sign consistent under some mild conditions.

We assume that the design matrix 
                        X
                        ∈
                        
                           
                              R
                           
                           
                              n
                              ×
                              p
                           
                        
                      has rank 
                        d
                        =
                        min
                        
                           {
                           n
                           ,
                           p
                           }
                        
                     . By the singular value decomposition, there exist matrices 
                        U
                        ∈
                        
                           
                              R
                           
                           
                              n
                              ×
                              d
                           
                        
                      and 
                        V
                        ∈
                        
                           
                              R
                           
                           
                              p
                              ×
                              d
                           
                        
                      with 
                        
                           
                              U
                           
                           
                              T
                           
                        
                        U
                        =
                        
                           
                              V
                           
                           
                              T
                           
                        
                        V
                        =
                        
                           
                              I
                           
                           
                              d
                           
                        
                      and a diagonal matrix 
                        D
                        ∈
                        
                           
                              R
                           
                           
                              d
                              ×
                              d
                           
                        
                      such that 
                        X
                        =
                        U
                        D
                        
                           
                              V
                           
                           
                              ′
                           
                        
                     . Define the Puffer Transformation  (Jia and Rohe, 2015), 
                        
                           (15)
                           
                              
                                 
                                    F
                                 
                                 
                                    n
                                    ×
                                    n
                                 
                              
                              =
                              U
                              
                                 
                                    D
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    U
                                 
                                 
                                    T
                                 
                              
                              .
                           
                        
                      The preconditioned design matrix 
                        F
                        X
                      has the same singular vectors as 
                        X
                     . However, all of the nonzero singular values of 
                        F
                        X
                      are set to unity: 
                        F
                        X
                        =
                        U
                        
                           
                              V
                           
                           
                              ′
                           
                        
                     . When 
                        n
                        ≥
                        p
                     , the columns of 
                        F
                        X
                      are orthonormal. When 
                        n
                        ≤
                        p
                     , the rows of 
                        F
                        X
                      are orthonormal. Jia and Rohe (2015) have a non-asymptotic result for the Lasso on 
                        
                           (
                           F
                           X
                           ,
                           F
                           Y
                           )
                        
                      stated in Theorem 4 in the Appendix. We see that with the Puffer Transformation, the Lasso does not need the irrepresentable condition any more.

As shown previously, the FLSA can be transformed to a standard Lasso problem. We have already shown that for most configurations of 
                        
                           
                              μ
                           
                           
                              ∗
                           
                        
                     , the design matrix 
                        
                           
                              X
                           
                           
                              ̃
                           
                        
                      does not satisfy the irrepresentable condition. Now we turn to the Puffer Transformation and obtain a concrete non-asymptotic result for the preconditioned fused Lasso.


                     
                        Theorem 3
                        
                           Assume 
                           
                              y
                              =
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                            
                           satisfies model   (1)
                           . 
                           
                              
                                 
                                    X
                                 
                                 
                                    ̃
                                 
                              
                            
                           and 
                           
                              
                                 
                                    Y
                                 
                                 
                                    ̃
                                 
                              
                            
                           are defined in   (8)
                           . Let 
                           
                              
                                 
                                    θ
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    A
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    ∗
                                 
                              
                            
                           (equivalently, 
                           
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    μ
                                 
                                 
                                    1
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    μ
                                 
                                 
                                    i
                                 
                                 
                                    ∗
                                 
                              
                              −
                              
                                 
                                    μ
                                 
                                 
                                    i
                                    −
                                    1
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              i
                              =
                              2
                              ,
                              …
                              ,
                              n
                            
                           ), where 
                           
                              A
                            
                           is defined to be the lower triangular matrix with nonzero elements equal to one. Let 
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             θ
                                          
                                          
                                             2
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             3
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             n
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                           
                           . Define the singular value decomposition of 
                           
                              
                                 
                                    X
                                 
                                 
                                    ̃
                                 
                              
                            
                           as 
                           
                              
                                 
                                    X
                                 
                                 
                                    ̃
                                 
                              
                              =
                              U
                              D
                              
                                 
                                    V
                                 
                                 
                                    T
                                 
                              
                           
                           . Denote the Puffer Transformation by 
                           
                              F
                              =
                              U
                              
                                 
                                    D
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    U
                                 
                                 
                                    T
                                 
                              
                           
                           . Let 
                           
                              Z
                              =
                              F
                              
                                 
                                    X
                                 
                                 
                                    ̃
                                 
                              
                            
                           and 
                           
                              a
                              =
                              F
                              
                                 
                                    Y
                                 
                                 
                                    ̃
                                 
                              
                           
                           . Define
                           
                              
                                 (16)
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ̃
                                       
                                    
                                    
                                       (
                                       λ
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             argmin
                                          
                                       
                                       
                                          b
                                       
                                    
                                    
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             a
                                             −
                                             Z
                                             b
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    λ
                                    
                                       
                                          
                                             ‖
                                             b
                                             ‖
                                          
                                       
                                       
                                          1
                                       
                                    
                                    .
                                 
                              
                           
                           If 
                           
                              
                                 
                                    min
                                 
                                 
                                    j
                                    ≥
                                    2
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                       
                                       
                                          ∗
                                       
                                    
                                    ≠
                                    0
                                 
                              
                              
                                 |
                                 
                                    
                                       θ
                                    
                                    
                                       j
                                    
                                    
                                       ∗
                                    
                                 
                                 |
                              
                              ≥
                              2
                              λ
                           
                           , then
                           
                              
                                 
                                    P
                                    
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ̃
                                          
                                       
                                       
                                          (
                                          λ
                                          )
                                       
                                       
                                          
                                             =
                                          
                                          
                                             s
                                          
                                       
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                    
                                    ≥
                                    1
                                    −
                                    2
                                    n
                                    exp
                                    
                                       {
                                       −
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             8
                                             
                                                
                                                   σ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       }
                                    
                                    .
                                 
                              
                           
                        

The proof is given in the Appendix. By the relationship between 
                        
                           
                              θ
                           
                           
                              ∗
                           
                        
                      and 
                        
                           
                              μ
                           
                           
                              ∗
                           
                        
                     , if 
                        
                           
                              β
                           
                           
                              ̃
                           
                        
                        
                           (
                           λ
                           )
                        
                      — the estimate of 
                        
                           
                              
                                 
                                    θ
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              ∗
                           
                        
                      has the sign recovery property, then the estimate of 
                        
                           
                              μ
                           
                           
                              ∗
                           
                        
                      defined as follows has the property of pattern recovery. 
                        
                           (17)
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                              =
                              A
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                           
                        
                      with 
                        
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       ̃
                                    
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                                 ]
                              
                              
                              and
                              
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    Y
                                 
                                 
                                    ̄
                                 
                              
                              −
                              
                                 
                                    X
                                 
                                 
                                    ̄
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    ̃
                                 
                              
                              
                                 (
                                 λ
                                 )
                              
                              .
                           
                        
                     
                     Theorem 3 shows that the pattern recovery of the preconditioned fused Lasso depends on the signal jump strength 
                        
                           (
                           
                              
                                 min
                              
                              
                                 j
                                 ≥
                                 2
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       j
                                    
                                    
                                       ∗
                                    
                                 
                                 ≠
                                 0
                              
                           
                           
                              |
                              
                                 
                                    θ
                                 
                                 
                                    j
                                 
                                 
                                    ∗
                                 
                              
                              |
                           
                           )
                        
                      and the noise level 
                        
                           
                              σ
                           
                           
                              2
                           
                        
                     . To get a pattern-consistent estimate, we need 
                        σ
                      small enough and 
                        
                           
                              min
                           
                           
                              j
                              ≥
                              2
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    j
                                 
                                 
                                    ∗
                                 
                              
                              ≠
                              0
                           
                        
                        
                           |
                           
                              
                                 θ
                              
                              
                                 j
                              
                              
                                 ∗
                              
                           
                           |
                        
                      big enough. To think about the small 
                        
                           
                              σ
                           
                           
                              2
                           
                        
                      issue, we can treat each 
                        
                           
                              y
                           
                           
                              i
                           
                        
                      as an average of multiple Gaussian measurements. If the number of measurements is 
                        m
                     , then 
                        
                           
                              σ
                           
                           
                              2
                           
                        
                        =
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    0
                                 
                                 
                                    2
                                 
                              
                           
                           
                              m
                           
                        
                      with some constant 
                        
                           
                              σ
                           
                           
                              0
                           
                           
                              2
                           
                        
                     . If 
                        m
                        ≫
                        log
                        
                           (
                           n
                           )
                        
                     , we can find a very small 
                        λ
                      to make the estimator defined in (17) have the pattern recovery property. One choice of 
                        λ
                      is such that 
                        
                           
                              λ
                           
                           
                              2
                           
                        
                        =
                        
                           
                              log
                              
                                 (
                                 n
                                 +
                                 1
                                 )
                              
                           
                           
                              
                                 
                                    m
                                 
                              
                           
                        
                     . For this choice of 
                        λ
                     , the probability of 
                        
                           
                              
                                 
                                    μ
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ∗
                           
                        
                        
                           
                              =
                           
                           
                              j
                              s
                           
                        
                        
                           
                              μ
                           
                           
                              ∗
                           
                        
                      is greater than 
                        1
                        −
                        2
                        exp
                        
                           (
                           −
                           
                              [
                              
                                 
                                    
                                       
                                          m
                                       
                                    
                                 
                                 
                                    8
                                    
                                       
                                          σ
                                       
                                       
                                          0
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              −
                              1
                              ]
                           
                           log
                           
                              (
                              n
                              +
                              1
                              )
                           
                           )
                        
                     , which goes to 1 as 
                        n
                      goes to 
                        ∞
                     .

We use several examples to illustrate our theory. Recall the model is set to be 
                        
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    μ
                                 
                                 
                                    i
                                 
                                 
                                    ∗
                                 
                              
                              +
                              
                                 
                                    ϵ
                                 
                                 
                                    i
                                 
                              
                              ,
                           
                        
                      where the errors 
                        
                           
                              ϵ
                           
                           
                              i
                           
                        
                     ’s are i.i.d. Gaussian variables with mean 0 and standard deviation 
                        σ
                     . In the following simulations, the length of the signal is set to be 430, not for others, but is just the same as the signal length in the example in Rinaldo (2009) and more convenient for comparison. 
                        
                           
                              μ
                           
                           
                              i
                           
                           
                              ∗
                           
                        
                      will be specified case by case, reflecting the characteristics of the signal pattern. 
                        σ
                      will generally vary between 0.05 and 0.5 to illustrate the recovery ability as a function of the noise level. Here are some implementation details of the two procedures.


                     FLSA When calculating the FLSA solution, we use a path algorithm proposed by Hoefling (2010) which is very efficient to give the entire solution path of the FLSA. An R package (“flsa”) for this algorithm is available in http://cran.r-project.org/web/packages/flsa/index.html. In fact, the entire solution path is piecewise linear in 
                        λ
                     . “flsa” only stores the 
                        λ
                     ’s corresponding to the breakpoints at which the directions of the linear function change.


                     Preconditioned fused Lasso We calculate the solution defined in (16). After the SVD and the Puffer Transformation, the task becomes much easier. It suffices to do soft-thresholding to obtain the entire solution path. This is because 
                        
                           
                              
                                 
                                    Z
                                 
                                 
                                    T
                                 
                              
                              Z
                              =
                              
                                 
                                    X
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    T
                                 
                              
                              F
                              X
                              =
                              
                                 (
                                 V
                                 D
                                 
                                    
                                       U
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              
                                 (
                                 U
                                 
                                    
                                       D
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              
                                 (
                                 U
                                 
                                    
                                       D
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              
                                 (
                                 U
                                 D
                                 
                                    
                                       V
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    I
                                 
                                 
                                    n
                                 
                              
                           
                        
                      and the property of the Lasso allows us to solve it directly by soft-thresholding (Tibshirani, 1996): 
                        
                           
                              
                                 
                                    b
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 λ
                                 )
                              
                              =
                              S
                              
                                 
                                    H
                                 
                                 
                                    λ
                                 
                              
                              
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       T
                                    
                                 
                                 a
                                 )
                              
                              .
                           
                        
                      Obviously, 
                        
                           
                              b
                           
                           
                              ˆ
                           
                        
                        
                           (
                           λ
                           )
                        
                      is piecewise linear in 
                        λ
                      and the breakpoints are 
                        
                           
                              λ
                           
                           
                              i
                           
                        
                        =
                        
                           
                              
                                 |
                                 
                                    
                                       Z
                                    
                                    
                                       T
                                    
                                 
                                 a
                                 |
                              
                           
                           
                              
                                 (
                                 i
                                 )
                              
                           
                        
                        ,
                        i
                        =
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        n
                     , where 
                        
                           
                              x
                           
                           
                              
                                 (
                                 i
                                 )
                              
                           
                        
                      denotes the 
                        i
                     th largest value in vector 
                        x
                      and 
                        n
                      is the dimension of the vector 
                        
                           
                              Z
                           
                           
                              T
                           
                        
                        a
                     .

By a little further algebra analysis, we see that the Preconditioned Fused Lasso estimator can be calculated via soft thresholding of the successive differences of the observed signals. This is because 
                        
                           
                              
                                 
                                    Z
                                 
                                 
                                    T
                                 
                              
                              a
                              =
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    T
                                 
                              
                              F
                              
                                 
                                    Y
                                 
                                 
                                    ̃
                                 
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    Y
                                 
                                 
                                    ̃
                                 
                              
                              =
                              arg
                              
                                 
                                    min
                                 
                                 
                                    θ
                                 
                              
                              
                                 
                                    
                                       ‖
                                       
                                          
                                             Y
                                          
                                          
                                             ̃
                                          
                                       
                                       −
                                       
                                          
                                             X
                                          
                                          
                                             ̃
                                          
                                       
                                       θ
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              arg
                              
                                 
                                    min
                                 
                                 
                                    θ
                                 
                              
                              
                                 
                                    
                                       ‖
                                       Y
                                       −
                                       X
                                       θ
                                       −
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    
                                       {
                                       arg
                                       
                                          
                                             min
                                          
                                          
                                             θ
                                          
                                       
                                       
                                          
                                             
                                                ‖
                                                Y
                                                −
                                                A
                                                θ
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                       
                                       }
                                    
                                 
                                 
                                    
                                       [
                                       2
                                       :
                                       n
                                       ]
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       {
                                       
                                          
                                             A
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       Y
                                       }
                                    
                                 
                                 
                                    
                                       [
                                       2
                                       :
                                       n
                                       ]
                                    
                                 
                              
                              ,
                           
                        
                      where 
                        A
                        ∈
                        
                           
                              R
                           
                           
                              n
                              ×
                              n
                           
                        
                      is the lower triangular matrix with nonzero elements equal to one, and 
                        
                           
                              x
                           
                           
                              
                                 [
                                 2
                                 :
                                 n
                                 ]
                              
                           
                        
                      stands for the vector consisting of the 
                        
                           
                              2
                           
                           
                              n
                              d
                           
                        
                      to 
                        
                           
                              n
                           
                           
                              t
                              h
                           
                        
                      elements of 
                        x
                     . So 
                        
                           
                              
                                 
                                    b
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              i
                           
                        
                        
                           (
                           λ
                           )
                        
                        =
                        S
                        
                           
                              H
                           
                           
                              λ
                           
                        
                        
                           (
                           
                              
                                 Y
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 Y
                              
                              
                                 i
                              
                           
                           )
                        
                        ,
                        i
                        =
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        n
                        −
                        1
                     .

Despite equivalence to this simplified thresholding algorithm, we point out that the preconditioned fused Lasso can be extended easily to more general settings. For example, suppose we would like to recover the blocks in an unknown coefficient sequence by solving 
                        
                           (18)
                           
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              
                                 
                                    argmin
                                 
                                 
                                    β
                                 
                              
                              
                                 
                                    
                                       ‖
                                       y
                                       −
                                       X
                                       β
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              +
                              λ
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              
                                 |
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                                 |
                              
                              .
                           
                        
                      We can do the transformation 
                        β
                        =
                        A
                        γ
                     , where 
                        A
                      is the same as in (6). The objective can again be transformed to a Lasso-type, only no penalty on 
                        
                           
                              γ
                           
                           
                              1
                           
                        
                     . Then we can apply the preconditioned technique, in particular the Puffer Transformation as in Theorem 3, to the response 
                        y
                      and the new matrix 
                        X
                        A
                      after reparametrization, and solve resulting problem. We do a few experiments for this problem and report one simulated result at the end of this section.

There are many criteria for comparison. In the context of exact pattern recovery, our principle is to check the solution path and see if there is a solution that has exactly the same jump points as the true signals.

For each 
                        σ
                      selected, we draw 1000 sample sequences and define 
                        
                           
                              P
                           
                           
                              F
                              L
                              S
                              A
                           
                        
                      and 
                        
                           
                              P
                           
                           
                              P
                              C
                              D
                              
                              F
                              L
                           
                        
                      to be the proportion of samples that the recovered blocks (jump points) exactly match the true blocks (jump points) by using the FLSA and using the preconditioned fused Lasso, respectively.

We will demonstrate that when irrepresentable condition holds, FLSA can recover the true blocks with high probability; when irrepresentable condition does not hold, FLSA performs poorly, and for this case Puffer Transformation helps a lot.

We give specific examples of the signal patterns such that the irrepresentable condition of the transformed Lasso holds and thus the FLSA can recover the pattern under mild conditions. Theorem 2 provides the necessary and sufficient conditions for irrepresentable condition. Since the second condition in Theorem 2 is more commonly met, we focus on the signals that satisfy this condition in the following.

We used two examples to show that when signal pattern follows the second condition in Theorem 2, both FLSA and preconditioned FLSA can recover the signal pattern when noise is small. The sample data and results are shown in Fig. 2
                        . The top row gives the expected signal (plotted in lines) and the sampled noisy data (plotted in dots). The two signal patterns are slightly different — the left one is more regular in the sense that the block size is almost the same. It is not clear when transformed FLSA is better than vanilla FLSA when irrepresentable condition holds. But when irrepresentable condition does not hold, which happens more likely than it holds, preconditioned FLSA definitely outperforms the vanilla FLSA. We demonstrate this in the next subsection.

When the irrepresentable condition does not hold, the FLSA cannot reliably recover the exact pattern. We analyze in more detail the numerical performances of the two procedures.

We use the same example as in Rinaldo (2009) except for larger noise (
                           σ
                           =
                           0.25
                         here). Recall that the signal pattern is set to be 
                           
                              
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             1
                                             ≤
                                             i
                                             ≤
                                             100
                                          
                                       
                                       
                                          
                                             −
                                             2
                                             ,
                                          
                                          
                                             101
                                             ≤
                                             i
                                             ≤
                                             110
                                          
                                       
                                       
                                          
                                             −
                                             0.1
                                             ,
                                          
                                          
                                             111
                                             ≤
                                             i
                                             ≤
                                             210
                                          
                                       
                                       
                                          
                                             2
                                             ,
                                          
                                          
                                             211
                                             ≤
                                             i
                                             ≤
                                             220
                                          
                                       
                                       
                                          
                                             0.1
                                             ,
                                          
                                          
                                             221
                                             ≤
                                             i
                                             ≤
                                             320
                                          
                                       
                                       
                                          
                                             −
                                             2
                                             ,
                                          
                                          
                                             321
                                             ≤
                                             i
                                             ≤
                                             330
                                          
                                       
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             331
                                             ≤
                                             i
                                             ≤
                                             430
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Fig. 3
                         shows the sample data and true signals.

We apply the FLSA and the preconditioned fused Lasso to this sample data and compare the recovery performances. Fig. 4
                         plots two solutions by different selection of tuning parameter. The solution in the left plot is the one with tuning parameter selected by recovering the same number of blocks as that of 
                           
                              
                                 μ
                              
                              
                                 ∗
                              
                           
                        , the true signals; Right panel plots the FLSA solution (in red lines) with tuning parameter selected by minimizing the 
                           
                              
                                 ℓ
                              
                              
                                 2
                              
                           
                         error between 
                           
                              
                                 
                                    
                                       μ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 ∗
                              
                           
                         and 
                           
                              
                                 μ
                              
                              
                                 ∗
                              
                           
                        . Fig. 4 shows that the FLSA cannot locate the jump points correctly and the right subfigure illustrates that a good estimate under the Euclidean norm is not reliable in exact pattern recovery. In sharp contrast, the preconditioned fused Lasso applied shown in Fig. 5
                         precisely locates all the jump points and recovers the pattern.

Note that the reported preconditioned FLSA estimate in Fig. 5 is very biased from the expected value. There is a tradeoff between the unbiasedness and the quality of pattern recovery. One possible solution for the unbiasedness is via a two-stage estimator — for the first stage the signal patten is recovered and for the second stage an unbiased estimate is obtained.

We further compare the recovery performances under different noise levels. We draw 1000 random sample sequences and compare the approximate exact recovery probability. Fig. 5 visualizes the result.

The FLSA can hardly recover the signal pattern exactly even when the noise level is as small as 
                           σ
                           =
                           0.05
                        . This is supported by the theory above. In contrast, the preconditioned fused Lasso has fairly satisfactory recovery performance till 
                           σ
                           =
                           0.25
                        .

Finally, we provide one simulation result for the problem of 
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       β
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          Y
                                          −
                                          X
                                          β
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 λ
                                 
                                    
                                       
                                          ‖
                                          β
                                          ‖
                                       
                                    
                                    
                                       T
                                       V
                                    
                                 
                                 .
                              
                           
                         In this simulation study, we choose each row of 
                           X
                         i.i.d. from 
                           N
                           
                              (
                              0
                              ,
                              Σ
                              )
                           
                        , where 
                           
                              
                                 Σ
                              
                              
                                 i
                                 j
                              
                           
                           =
                           0.4
                        , for 
                           i
                           ≠
                           j
                         and 
                           
                              
                                 Σ
                              
                              
                                 i
                                 i
                              
                           
                           =
                           1
                        . We have a design matrix 
                           X
                           ∈
                           
                              
                                 R
                              
                              
                                 n
                                 ×
                                 p
                              
                           
                         with 
                           n
                           =
                           200
                         and 
                           p
                           =
                           100
                        . We take 
                           β
                         to have the pattern of piecewise constant. The true coefficients are plotted in Fig. 6
                         (left). 
                           Y
                         is designed as 
                           X
                           β
                           +
                           ϵ
                        , where 
                           ϵ
                           ∼
                           N
                           
                              (
                              0
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        . We vary 
                           σ
                         from 0.25 to 5. We apply both preconditioned method (denoted as PCFL) and the one without preconditioning (denoted as FLSA). For each noise level 
                           σ
                        , we do 500 repetitions and then we calculate the proportion of successful cases when one method could recover the piecewise pattern of the coefficients. The results are plotted in Fig. 6 (right), from which we see the necessity of preconditioning.

In this paper we provided more understanding of the FLSA and shed some light on the insight into the FLSA. The FLSA can be transformed to a standard Lasso problem. The sign recovery of the transformed Lasso problem is equivalent to the pattern recovery of the FLSA problem. Theoretical analysis showed that the transformed Lasso problem is not sign consistent in most situations. So the FLSA might also meet this consistency problem when it is used to recover signal patterns. To overcome such problem, we introduced the preconditioned fused Lasso. We gave non-asymptotic results on the preconditioned fused Lasso. The result implies that when the signal-to-noise ratio is not so small, the preconditioned fused Lasso can recover the signal pattern with high probability. Through simulation studies, we also found that the FLSA, if the irrepresentable condition holds, is only more apt at recovering regular signals while our preconditioned fused Lasso is more robust to various kinds of signals. Some attempts also imply that the preconditioned fused Lasso does not work so well if all the signals are equally weak.

A good pattern recovery will facilitate many things afterwards. The preconditioned fused Lasso is reliable for pattern recovery, and so it can be incorporated into other processes — such as the recovery of sparsity.

@&#ACKNOWLEDGMENTS@&#

This work is partially supported by the National Basic Research Program of China (973 Program 2011CB809105), NSFC-61121002, NSFC-11101005, DPHEC-20110001120113, and MSRA. Junyang Qian is also affiliated with Department of Statistics, Stanford University.

We prove the theorems in the appendix.

We first give a well-known result that makes sure the Lasso exactly recovers the sparse pattern of 
                           
                              
                                 β
                              
                              
                                 ∗
                              
                           
                        , that is 
                           
                              
                                 β
                              
                              
                                 ˆ
                              
                           
                           
                              (
                              λ
                              )
                           
                           
                              
                                 =
                              
                              
                                 s
                              
                           
                           
                              
                                 β
                              
                              
                                 ∗
                              
                           
                        . The following Lemma gives necessary and sufficient conditions for 
                           sign
                           
                              (
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 λ
                                 )
                              
                              )
                           
                           =
                           sign
                           
                              (
                              
                                 
                                    β
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                        , which follows from the KKT conditions. The proof of this lemma can be found in Wainwright (2009).


                        
                           Lemma 2
                           
                              For the linear model 
                              
                                 Y
                                 =
                                 X
                                 
                                    
                                       β
                                    
                                    
                                       ∗
                                    
                                 
                                 +
                                 ϵ
                              
                              , assume that the matrix 
                              
                                 
                                    
                                       X
                                    
                                    
                                       S
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       S
                                    
                                 
                               
                              is invertible. Then for any given 
                              
                                 λ
                                 >
                                 0
                               
                              and any noise term 
                              
                                 ϵ
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                              
                              , there exists a Lasso estimate 
                              
                                 
                                    
                                       β
                                    
                                    
                                       ˆ
                                    
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                               
                              described in   (4)   which satisfies 
                              
                                 
                                    
                                       β
                                    
                                    
                                       ˆ
                                    
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                                 
                                    
                                       =
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       ∗
                                    
                                 
                              
                              , if and only if the following two conditions hold
                              
                                 
                                    
                                       (19)
                                       
                                          
                                             |
                                             
                                                
                                                   X
                                                
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   S
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            S
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      S
                                                   
                                                   
                                                      T
                                                   
                                                
                                                ϵ
                                                −
                                                λ
                                                s
                                                i
                                                g
                                                n
                                                
                                                   (
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         S
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                   )
                                                
                                                ]
                                             
                                             −
                                             
                                                
                                                   X
                                                
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             ϵ
                                             |
                                          
                                          ≤
                                          λ
                                          ,
                                       
                                    
                                    
                                       (20)
                                       
                                          s
                                          i
                                          g
                                          n
                                          
                                             (
                                             
                                                
                                                   β
                                                
                                                
                                                   S
                                                
                                                
                                                   ∗
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            S
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      S
                                                   
                                                   
                                                      T
                                                   
                                                
                                                ϵ
                                                −
                                                λ
                                                s
                                                i
                                                g
                                                n
                                                
                                                   (
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         S
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                   )
                                                
                                                ]
                                             
                                             )
                                          
                                          =
                                          s
                                          i
                                          g
                                          n
                                          
                                             (
                                             
                                                
                                                   β
                                                
                                                
                                                   S
                                                
                                                
                                                   ∗
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                              where the vector inequality and equality are taken elementwise. Moreover, if the inequality   (19)   holds strictly, then
                              
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ˆ
                                          
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                          
                                          ,
                                          0
                                          )
                                       
                                    
                                 
                              
                              is the unique optimal solution to the Lasso problem in Eq.   (4)
                              , where
                              
                                 
                                    (21)
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                (
                                                1
                                                )
                                             
                                          
                                       
                                       =
                                       
                                          
                                             β
                                          
                                          
                                             S
                                          
                                          
                                             ∗
                                          
                                       
                                       +
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      S
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      S
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          [
                                          
                                             
                                                X
                                             
                                             
                                                S
                                             
                                             
                                                T
                                             
                                          
                                          ϵ
                                          −
                                          λ
                                          s
                                          i
                                          g
                                          n
                                          
                                             (
                                             
                                                
                                                   β
                                                
                                                
                                                   ∗
                                                
                                             
                                             )
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Remark
                           As in Wainwright (2009), we state an equivalent condition for (19). Define 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ⃗
                                          
                                       
                                       =
                                       s
                                       i
                                       g
                                       n
                                       
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                S
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                               and define 
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             X
                                          
                                          
                                             j
                                          
                                          
                                             T
                                          
                                       
                                       
                                          {
                                          
                                             
                                                X
                                             
                                             
                                                S
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         S
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         S
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          λ
                                          
                                             
                                                b
                                             
                                             
                                                ⃗
                                             
                                          
                                          −
                                          
                                             [
                                             
                                                
                                                   X
                                                
                                                
                                                   S
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            S
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   X
                                                
                                                
                                                   S
                                                
                                                
                                                   T
                                                
                                             
                                             −
                                             I
                                             ]
                                          
                                          ϵ
                                          }
                                       
                                       .
                                    
                                 
                               By rearranging terms, it is easy to see that (19) holds if and only if 
                                 
                                    (22)
                                    
                                       M
                                       
                                          (
                                          V
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                max
                                             
                                             
                                                j
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      c
                                                   
                                                
                                             
                                          
                                          
                                             |
                                             
                                                
                                                   V
                                                
                                                
                                                   j
                                                
                                             
                                             |
                                          
                                          ≤
                                          λ
                                          }
                                       
                                    
                                 
                               holds.

With Lemma 2 and the above comments, now we prove Theorem 1. Without loss of generality, assume for some 
                           j
                           ∈
                           
                              
                                 S
                              
                              
                                 c
                              
                           
                         and 
                           ζ
                           ≥
                           0
                        , 
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       j
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       S
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      S
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                S
                                             
                                          
                                          )
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       ⃗
                                    
                                 
                                 =
                                 1
                                 +
                                 ζ
                                 .
                              
                           
                         Then 
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 λ
                                 
                                    (
                                    1
                                    +
                                    ζ
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 j
                              
                           
                           =
                           −
                           
                              
                                 X
                              
                              
                                 j
                              
                              
                                 T
                              
                           
                           
                              [
                              
                                 
                                    X
                                 
                                 
                                    S
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   S
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             S
                                          
                                       
                                       )
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          S
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              −
                              I
                              ]
                           
                           
                              
                                 ϵ
                              
                              
                                 n
                              
                           
                         is a Gaussian random variable with mean 0, so 
                           P
                           
                              (
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                              >
                              0
                              )
                           
                           =
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                        . Therefore, 
                           
                              
                                 P
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          j
                                       
                                    
                                    >
                                    λ
                                    )
                                 
                                 ≥
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         and the equality holds when 
                           ζ
                           =
                           0
                        . This implies that for any 
                           λ
                        , Condition (19) (a necessary condition) is violated with probability greater than 1/2.

In the proof of Theorem 1, we need an algebra result as follows.


                        
                           Lemma 3
                           
                              For 
                              
                                 k
                                 ≥
                                 3
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 ∈
                                 R
                               
                              and are not equal to each other. 
                              
                                 A
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          )
                                       
                                    
                                    
                                       k
                                       ×
                                       k
                                    
                                 
                              
                              , with 
                              
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       ℓ
                                    
                                 
                               
                              where 
                              
                                 ℓ
                                 =
                                 max
                                 
                                    {
                                    i
                                    ,
                                    j
                                    }
                                 
                              
                              . That is,
                              
                                 
                                    
                                       A
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   ⋯
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   ⋅
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                              Then the inverse of 
                              
                                 A
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                (
                                                A
                                                )
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                
                                                
                                                
                                                
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         22
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         23
                                                      
                                                   
                                                
                                                
                                                
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         32
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         33
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         34
                                                      
                                                   
                                                
                                                
                                                
                                             
                                             
                                                
                                                
                                                
                                                   ⋱
                                                
                                                
                                                   ⋱
                                                
                                                
                                                   ⋱
                                                
                                                
                                             
                                             
                                                
                                                
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                         −
                                                         1
                                                         ,
                                                         k
                                                         −
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                         −
                                                         1
                                                         ,
                                                         k
                                                         −
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                         −
                                                         1
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                
                                                
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                         ,
                                                         k
                                                         −
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                              where
                              
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   i
                                                   =
                                                   j
                                                   =
                                                   1
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               j
                                                               −
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   i
                                                   =
                                                   j
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               j
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   i
                                                   =
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               j
                                                               −
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               j
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  j
                                                                  −
                                                                  1
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   1
                                                   <
                                                   i
                                                   =
                                                   j
                                                   <
                                                   k
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  k
                                                                  −
                                                                  1
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   i
                                                   =
                                                   j
                                                   =
                                                   k
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      otherwise  .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                        
                           Proof
                           This lemma can be directly verified via the following equations: 
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             j
                                             i
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       1
                                       
                                       and
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                             i
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       0
                                       ,
                                       ℓ
                                       ≠
                                       j
                                       .
                                    
                                 
                               We first verify 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       j
                                       i
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 1
                              , for all 
                                 j
                              .

When 
                                 j
                                 =
                                 1
                              , 
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             1
                                             i
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             i
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             11
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             21
                                          
                                       
                                       =
                                       a
                                       1
                                       ⋅
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   a
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             2
                                          
                                       
                                       ⋅
                                       
                                          
                                             −
                                             1
                                          
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   a
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       =
                                       1
                                       .
                                    
                                 
                               When 
                                 1
                                 <
                                 j
                                 <
                                 k
                              , 
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             j
                                             i
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             a
                                          
                                          
                                             j
                                             ,
                                             j
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             j
                                             −
                                             1
                                             ,
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             j
                                             ,
                                             j
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             j
                                             ,
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             j
                                             ,
                                             j
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             j
                                             +
                                             1
                                             ,
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                       ⋅
                                       
                                          
                                             −
                                             1
                                          
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   j
                                                   −
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   a
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   j
                                                   −
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   a
                                                
                                                
                                                   j
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      j
                                                   
                                                
                                                −
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      j
                                                      +
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                       ⋅
                                       
                                          
                                             −
                                             1
                                          
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   j
                                                
                                             
                                             −
                                             
                                                
                                                   a
                                                
                                                
                                                   j
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       =
                                       1
                                       .
                                    
                                 
                               When 
                                 j
                                 =
                                 k
                              , 
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             j
                                             i
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             a
                                          
                                          
                                             k
                                             ,
                                             k
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             −
                                             1
                                             ,
                                             k
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             k
                                             ,
                                             k
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             ,
                                             k
                                          
                                       
                                       =
                                       
                                          
                                             a
                                          
                                          
                                             k
                                          
                                       
                                       ⋅
                                       
                                          
                                             −
                                             1
                                          
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             k
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                      −
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       =
                                       1
                                       .
                                    
                                 
                              
                           

We next verify 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       ℓ
                                       i
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 0
                                 
                                 
                                 for all
                                 
                                 
                                 ℓ
                                 ≠
                                 j
                              . We only verify the general case when there are three elements in one column of 
                                 
                                    
                                       A
                                    
                                    
                                       −
                                       1
                                    
                                 
                              . The other verifications are the same. 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       ℓ
                                       i
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       ℓ
                                       ,
                                       j
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       j
                                       −
                                       1
                                       ,
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       ℓ
                                       ,
                                       j
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       j
                                       ,
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       ℓ
                                       ,
                                       j
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       j
                                       +
                                       1
                                       ,
                                       j
                                    
                                 
                              . Since 
                                 ℓ
                                 ≠
                                 j
                              , there are only two situations we need to consider. (1) 
                                 ℓ
                                 ≤
                                 j
                                 −
                                 1
                               and (2) 
                                 ℓ
                                 ≥
                                 j
                                 +
                                 1
                              .

When 
                                 ℓ
                                 ≤
                                 j
                                 −
                                 1
                              , 
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                             i
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                             ,
                                             j
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             j
                                             −
                                             1
                                             ,
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                             ,
                                             j
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             j
                                             ,
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                             ,
                                             j
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             j
                                             +
                                             1
                                             ,
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             a
                                          
                                          
                                             j
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             j
                                             −
                                             1
                                             ,
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             j
                                             ,
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             j
                                             +
                                             1
                                             ,
                                             j
                                          
                                       
                                       =
                                       0
                                       .
                                    
                                 
                               When 
                                 ℓ
                                 ≥
                                 j
                                 +
                                 1
                              , 
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                             i
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                             ,
                                             j
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             j
                                             −
                                             1
                                             ,
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                             ,
                                             j
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             j
                                             ,
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                             ,
                                             j
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             j
                                             +
                                             1
                                             ,
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             j
                                             −
                                             1
                                             ,
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             j
                                             ,
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             j
                                             +
                                             1
                                             ,
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                          
                                       
                                       ⋅
                                       
                                          [
                                          
                                             
                                                −
                                                1
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      j
                                                      +
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         j
                                                         −
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         j
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          +
                                          
                                             
                                                −
                                                1
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      j
                                                   
                                                
                                                −
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      j
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       =
                                       0
                                       .
                                    
                                 
                              
                              □


                        
                           Proof
                           Note that the OLS estimate of the coefficients in the linear regression equation (14) is 
                                 
                                    (23)
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      S
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Z
                                                
                                                
                                                   S
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                    
                                 
                               where 
                                 
                                    
                                       Z
                                    
                                    
                                       S
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   S
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                               and 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       s
                                    
                                 
                              . We first attempt to find the necessary and sufficient condition such that 
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                j
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 1
                               for all 
                                 j
                              , which is a stronger condition for (11) to hold.

We know that 
                                 
                                    
                                       Z
                                    
                                    
                                       S
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       S
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                          ℓ
                                       
                                    
                                    )
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       
                                          (
                                          s
                                          +
                                          1
                                          )
                                       
                                       ×
                                       
                                          (
                                          s
                                          +
                                          1
                                          )
                                       
                                    
                                 
                               with 
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             ℓ
                                          
                                       
                                       =
                                       n
                                       −
                                       max
                                       
                                          {
                                          
                                             
                                                j
                                             
                                             
                                                k
                                                −
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                j
                                             
                                             
                                                ℓ
                                                −
                                                1
                                             
                                          
                                          }
                                       
                                       .
                                    
                                 
                               where we assume 
                                 
                                    
                                       j
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                              . According to a linear algebra result stated in Lemma 3 in the Appendix, the inverse of this matrix is a tridiagonal matrix: 
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      S
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      S
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                
                                                
                                                
                                                
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         22
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         23
                                                      
                                                   
                                                
                                                
                                                
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         32
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         33
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         34
                                                      
                                                   
                                                
                                                
                                                
                                             
                                             
                                                
                                                
                                                
                                                   ⋱
                                                
                                                
                                                   ⋱
                                                
                                                
                                                   ⋱
                                                
                                                
                                             
                                             
                                                
                                                
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         s
                                                         ,
                                                         s
                                                         −
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         s
                                                         ,
                                                         s
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         s
                                                         ,
                                                         s
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                
                                                
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         s
                                                         +
                                                         1
                                                         ,
                                                         s
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         s
                                                         +
                                                         1
                                                         ,
                                                         s
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                               where 
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             ℓ
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   k
                                                   =
                                                   ℓ
                                                   =
                                                   1
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               ℓ
                                                               −
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               ℓ
                                                               −
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   k
                                                   =
                                                   ℓ
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               ℓ
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               ℓ
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   k
                                                   =
                                                   ℓ
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               ℓ
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               ℓ
                                                               −
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  ℓ
                                                                  −
                                                                  1
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  ℓ
                                                                  −
                                                                  2
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  ℓ
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  ℓ
                                                                  −
                                                                  1
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   1
                                                   <
                                                   k
                                                   =
                                                   ℓ
                                                   <
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                         −
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               s
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  s
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  s
                                                                  −
                                                                  1
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            n
                                                            −
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  s
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   k
                                                   =
                                                   ℓ
                                                   =
                                                   s
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Denote 
                                 v
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      S
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                Z
                                             
                                             
                                                S
                                             
                                          
                                          )
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             S
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       j
                                    
                                 
                              . There are three pattern types that we need to consider. 
                                 
                                    (i)
                                    If there exists 
                                          1
                                          ≤
                                          k
                                          <
                                          s
                                        such that 
                                          
                                             
                                                j
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                j
                                             
                                             
                                                k
                                             
                                          
                                          ≥
                                          2
                                       , then for any 
                                          j
                                        with 
                                          
                                             
                                                j
                                             
                                             
                                                k
                                             
                                          
                                          <
                                          j
                                          <
                                          
                                             
                                                j
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       , 
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      j
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     n
                                                                     −
                                                                     j
                                                                     ,
                                                                     n
                                                                     −
                                                                     j
                                                                     ,
                                                                     …
                                                                     ,
                                                                     n
                                                                     −
                                                                     j
                                                                  
                                                                  ︸
                                                               
                                                            
                                                            
                                                               k
                                                               +
                                                               1
                                                            
                                                         
                                                         ,
                                                         n
                                                         −
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               k
                                                               +
                                                               1
                                                            
                                                         
                                                         ,
                                                         n
                                                         −
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               k
                                                               +
                                                               2
                                                            
                                                         
                                                         ,
                                                         …
                                                         ,
                                                         n
                                                         −
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                                .
                                             
                                          
                                        We have 
                                          
                                             
                                                v
                                                =
                                                
                                                   
                                                      
                                                         (
                                                         0
                                                         ,
                                                         …
                                                         ,
                                                         0
                                                         ,
                                                         
                                                            
                                                               
                                                                  
                                                                     j
                                                                  
                                                                  
                                                                     k
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               −
                                                               j
                                                            
                                                            
                                                               
                                                                  
                                                                     j
                                                                  
                                                                  
                                                                     k
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     j
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                         ,
                                                         −
                                                         
                                                            
                                                               
                                                                  
                                                                     j
                                                                  
                                                                  
                                                                     k
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               −
                                                               j
                                                            
                                                            
                                                               
                                                                  
                                                                     j
                                                                  
                                                                  
                                                                     k
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     j
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                         +
                                                         1
                                                         ,
                                                         0
                                                         ,
                                                         …
                                                         ,
                                                         0
                                                         )
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                                .
                                             
                                          
                                        Hence, 
                                          
                                             (24)
                                             
                                                
                                                   
                                                      
                                                         ‖
                                                         
                                                            
                                                               
                                                                  
                                                                     b
                                                                  
                                                                  
                                                                     ˆ
                                                                  
                                                               
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         ‖
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                |
                                                
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      j
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                |
                                                +
                                                |
                                                −
                                                
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      j
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                +
                                                1
                                                |
                                                =
                                                1
                                                ,
                                                
                                                since  
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      k
                                                   
                                                
                                                <
                                                j
                                                <
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    

If 
                                          j
                                          <
                                          
                                             
                                                j
                                             
                                             
                                                1
                                             
                                          
                                       , 
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      j
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         (
                                                         n
                                                         −
                                                         j
                                                         ,
                                                         n
                                                         −
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ,
                                                         n
                                                         −
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         ,
                                                         …
                                                         ,
                                                         n
                                                         −
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                                .
                                             
                                          
                                        We have 
                                          
                                             
                                                v
                                                =
                                                
                                                   
                                                      
                                                         (
                                                         1
                                                         −
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               
                                                                  
                                                                     j
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               
                                                                  
                                                                     j
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                         ,
                                                         0
                                                         ,
                                                         …
                                                         ,
                                                         0
                                                         )
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                                .
                                             
                                          
                                        Hence, 
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             |
                                             
                                                
                                                   j
                                                
                                                
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             |
                                          
                                          <
                                          1
                                       .

If 
                                          j
                                          >
                                          
                                             
                                                j
                                             
                                             
                                                s
                                             
                                          
                                       , 
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      j
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     n
                                                                     −
                                                                     j
                                                                     ,
                                                                     …
                                                                     ,
                                                                     n
                                                                     −
                                                                     j
                                                                  
                                                                  ︸
                                                               
                                                            
                                                            
                                                               s
                                                               +
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                                .
                                             
                                          
                                        We have 
                                          
                                             
                                                v
                                                =
                                                
                                                   
                                                      
                                                         (
                                                         0
                                                         ,
                                                         …
                                                         ,
                                                         0
                                                         ,
                                                         
                                                            
                                                               n
                                                               −
                                                               j
                                                            
                                                            
                                                               n
                                                               −
                                                               
                                                                  
                                                                     j
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                                .
                                             
                                          
                                        Hence, 
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             |
                                             
                                                
                                                   n
                                                   −
                                                   j
                                                
                                                
                                                   n
                                                   −
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             
                                             |
                                          
                                          <
                                          1
                                       .

These three cases for the position of 
                                 j
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       c
                                    
                                 
                               show that as long as 
                                 j
                               is not between two jump points, 
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                j
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 1
                              . Otherwise 
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                j
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 1
                              . So 
                                 
                                    
                                       s
                                       =
                                       1
                                       
                                       or
                                       
                                       
                                          
                                             max
                                          
                                          
                                             1
                                             ≤
                                             k
                                             <
                                             s
                                          
                                       
                                       
                                          (
                                          
                                             
                                                j
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                j
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       1
                                    
                                 
                               is necessary and sufficient for all 
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                j
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 1
                                 ,
                                 j
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       c
                                    
                                 
                              .

If the above condition does not hold, that is, there are at least two jump points and all the jump points are not consecutive in indices, the irrepresentable condition (11) holds if and only if for each 
                                 k
                               such that 
                                 
                                    
                                       j
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 ≥
                                 2
                                 ,
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                               have different signs. By the definition of 
                                 
                                    
                                       θ
                                    
                                    
                                       ̃
                                    
                                 
                              , we see that 
                                 
                                    (
                                    
                                       
                                          μ
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    −
                                    
                                       
                                          μ
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                k
                                             
                                          
                                          −
                                          1
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          μ
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    −
                                    
                                       
                                          μ
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          −
                                          1
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                                 <
                                 0
                               is equivalent to 
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                               having different signs.□

To prove the non-asymptotic result for the preconditioned fused Lasso, we first state a general result for the Lasso that will be the main ingredient of our proof.


                        
                           Theorem 4
                           
                              Jia and Rohe, 2015
                           


                           
                              Suppose that data 
                              
                                 
                                    (
                                    X
                                    ,
                                    Y
                                    )
                                 
                               
                              follows a linear model 
                              
                                 Y
                                 =
                                 X
                                 
                                    
                                       β
                                    
                                    
                                       ∗
                                    
                                 
                                 +
                                 ϵ
                              
                              , where 
                              
                                 Y
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       ×
                                       1
                                    
                                 
                                 ,
                                 X
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       ×
                                       p
                                    
                                 
                               
                              with 
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                               
                              as its 
                              
                                 i
                              
                              th row, 
                              
                                 
                                    
                                       β
                                    
                                    
                                       ∗
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       p
                                       ×
                                       1
                                    
                                 
                               
                              and 
                              
                                 ϵ
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                ϵ
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ϵ
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       ×
                                       1
                                    
                                 
                               
                              with 
                              
                                 ϵ
                                 ∼
                                 N
                                 
                                    (
                                    0
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          I
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                              
                              . Define the singular value decomposition of 
                              
                                 X
                               
                              as 
                              
                                 X
                                 =
                                 U
                                 D
                                 
                                    
                                       V
                                    
                                    
                                       ′
                                    
                                 
                              
                              . Suppose that 
                              
                                 n
                                 ≥
                                 p
                               
                              and 
                              
                                 X
                               
                              has rank 
                              
                                 p
                              
                              . Let 
                              
                                 
                                    
                                       Λ
                                    
                                    
                                       
                                          min
                                       
                                    
                                 
                                 
                                    (
                                    X
                                    )
                                 
                               
                              be the minimal eigenvalue of the matrix 
                              
                                 X
                               
                              and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       
                                          min
                                       
                                    
                                 
                                 =
                                 
                                    
                                       Λ
                                    
                                    
                                       
                                          min
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          S
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          S
                                       
                                    
                                    )
                                 
                              
                              , where 
                              
                                 S
                               
                              is the same as that in   
                                 Definition  3
                              . We further assume that the minimal eigenvalue 
                              
                                 
                                    
                                       Λ
                                    
                                    
                                       
                                          min
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          ′
                                       
                                    
                                    X
                                    )
                                 
                                 ≥
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       
                                          min
                                       
                                    
                                 
                                 >
                                 0
                              
                              . Define the Puffer Transformation, 
                              
                                 F
                                 =
                                 U
                                 
                                    
                                       D
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       T
                                    
                                 
                              
                              . Let 
                              
                                 Z
                                 =
                                 F
                                 X
                               
                              and 
                              
                                 a
                                 =
                                 F
                                 Y
                              
                              . Define
                              
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ̃
                                          
                                       
                                       
                                          (
                                          λ
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                argmin
                                             
                                          
                                          
                                             b
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                ‖
                                                a
                                                −
                                                Z
                                                b
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       λ
                                       
                                          
                                             
                                                ‖
                                                b
                                                ‖
                                             
                                          
                                          
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           


                              If 
                              
                                 
                                    
                                       min
                                    
                                    
                                       j
                                       ∈
                                       S
                                    
                                 
                                 
                                    |
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                       
                                          ∗
                                       
                                    
                                    |
                                 
                                 ≥
                                 2
                                 λ
                              
                              , then with probability greater than
                              
                                 
                                    (25)
                                    
                                       1
                                       −
                                       2
                                       p
                                       exp
                                       
                                          {
                                          −
                                          
                                             
                                                n
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         min
                                                      
                                                   
                                                
                                             
                                             
                                                2
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          }
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       β
                                    
                                    
                                       ̃
                                    
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                                 
                                    
                                       =
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       ∗
                                    
                                 
                              
                              .
                           

The proof can be found in Jia and Rohe (2015). From the proof we see that the assumption that 
                           ϵ
                           ∼
                           N
                           
                              (
                              0
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    I
                                 
                                 
                                    n
                                 
                              
                              )
                           
                         can be relaxed to 
                           ϵ
                           ∼
                           N
                           
                              (
                              0
                              ,
                              Σ
                              )
                           
                         with 
                           
                              
                                 max
                              
                              
                                 i
                              
                           
                           
                              
                                 Σ
                              
                              
                                 i
                                 i
                              
                           
                           ≤
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                        . Note that in Theorem 4, the minimum singular value of the design matrix plays a critical role. The following lemma addresses this issue for the special design matrix of the preconditioned fused Lasso.


                        
                           Lemma 4
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       ̃
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       ×
                                       
                                          (
                                          n
                                          −
                                          1
                                          )
                                       
                                    
                                 
                               
                              is defined in   (8)
                              . Let 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    ⋅
                                    )
                                 
                               
                              denote the 
                              
                                 j
                              
                              th largest singular value of a matrix. Then
                              
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                ̃
                                             
                                          
                                          )
                                       
                                       ≥
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                ̃
                                             
                                          
                                          )
                                       
                                       ≥
                                       ⋯
                                       ≥
                                       
                                          
                                             σ
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                ̃
                                             
                                          
                                          )
                                       
                                       ≥
                                       0.5
                                       .
                                    
                                 
                              
                           

To prove Lemma 4, we need the following two results.


                        
                           Lemma 5
                           
                              Let 
                              
                                 X
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       ×
                                       n
                                    
                                 
                               
                              be a lower triangular matrix with elements  1  on and below the diagonals and 0 in other places.
                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   i
                                                   ≥
                                                   j
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   i
                                                   <
                                                   j
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              The minimal singular value is greater or equal to  0.5.
                           


                        
                           Proof
                           Let 
                                 X
                                 =
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    )
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       ×
                                       n
                                    
                                 
                               be the matrix satisfying the condition of the lemma. Note that the singular values of this matrix 
                                 X
                               are the non-negative square roots of the eigenvalues of 
                                 
                                    
                                       X
                                    
                                    
                                       T
                                    
                                 
                                 X
                              . Hence it suffices to show that all the eigenvalues of 
                                 
                                    
                                       X
                                    
                                    
                                       T
                                    
                                 
                                 X
                               are greater or equal to 0.25.

The explicit expression of 
                                 
                                    
                                       C
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       T
                                    
                                 
                                 X
                                 =
                                 
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    )
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       ×
                                       n
                                    
                                 
                               is 
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       n
                                       +
                                       1
                                       −
                                       max
                                       
                                          {
                                          i
                                          ,
                                          j
                                          }
                                       
                                       .
                                    
                                 
                              
                           

By Lemma 3, we have 
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             n
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   −
                                                   1
                                                
                                                
                                                
                                                
                                                
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                                
                                                   2
                                                
                                                
                                                   −
                                                   1
                                                
                                                
                                                
                                                
                                             
                                             
                                                
                                                
                                                   −
                                                   1
                                                
                                                
                                                   2
                                                
                                                
                                                   −
                                                   1
                                                
                                                
                                                
                                             
                                             
                                                
                                                
                                                
                                                   ⋱
                                                
                                                
                                                   ⋱
                                                
                                                
                                                   ⋱
                                                
                                                
                                             
                                             
                                                
                                                
                                                
                                                
                                                   −
                                                   1
                                                
                                                
                                                   2
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                
                                                
                                                
                                                
                                                   −
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           

Then for any vector 
                                 u
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       ×
                                       1
                                    
                                 
                              , 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             n
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       u
                                       =
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             2
                                          
                                          
                                             n
                                          
                                       
                                       
                                          (
                                          2
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       −
                                       2
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       ≤
                                       2
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       2
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       ≤
                                       2
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          |
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                          |
                                       
                                       .
                                    
                                 
                              
                           

By the fact that 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    |
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    |
                                 
                                 ≤
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 ≤
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                              , we have 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             n
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       u
                                       ≤
                                       4
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                    
                                 
                               which implies that the eigenvalues of 
                                 
                                    
                                       C
                                    
                                    
                                       n
                                    
                                    
                                       −
                                       1
                                    
                                 
                               are less or equal to 4 and thus the eigenvalues of 
                                 
                                    
                                       C
                                    
                                    
                                       n
                                    
                                 
                               are all greater or equal to 0.25.□

The following lemma states the relationship between eigenvalues of second moments for centered and non-centered data. Let 
                           X
                           ∈
                           
                              
                                 R
                              
                              
                                 n
                                 ×
                                 p
                              
                           
                         be a data matrix. Define the (empirical) covariance matrix of 
                           X
                         to be 
                           
                              
                                 S
                                 =
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             c
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             c
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 X
                              
                              
                                 c
                              
                           
                         is the centered version of 
                           X
                         with the 
                           j
                        th column of 
                           
                              
                                 X
                              
                              
                                 c
                              
                           
                         be 
                           
                              
                                 X
                              
                              
                                 j
                              
                           
                           −
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 j
                              
                           
                        . Let the second moments of the dataset 
                           X
                         be 
                           
                              
                                 T
                                 =
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ′
                                          
                                       
                                       X
                                    
                                    
                                       n
                                    
                                 
                                 .
                              
                           
                         Then the eigenvalues of 
                           S
                         and 
                           T
                         have the following property.


                        
                           Lemma 6
                           
                              Cadima and Jolliffe, 2009
                           


                           
                              Let 
                              
                                 S
                               
                              be the covariance matrix for a given dataset, and 
                              
                                 T
                               
                              its corresponding matrix of non-central second moments. Let 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    ⋅
                                    )
                                 
                               
                              be the 
                              
                                 j
                              
                              th largest eigenvalue of a matrix. Then
                              
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                       
                                          (
                                          T
                                          )
                                       
                                       ≤
                                       
                                          
                                             λ
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          S
                                          )
                                       
                                       ≤
                                       
                                          
                                             λ
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          T
                                          )
                                       
                                       .
                                    
                                 
                              
                           


                        Lemma 6 can be found on page 5 in Cadima and Jolliffe (2009).

With the results from Lemmas 5 and 6, we now prove Lemma 4.


                        
                           Proof
                           Let 
                                 X
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       ×
                                       n
                                    
                                 
                               be a lower triangular matrix with elements 1 on and below the diagonals and 0 in other places. 
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   i
                                                   ≥
                                                   j
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   i
                                                   <
                                                   j
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                               Let 
                                 
                                    
                                       σ
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    ⋅
                                    )
                                 
                               denote the 
                                 j
                              th largest singular value of a matrix. By Lemma 5, the smallest singular value is not less than 0.5, that is 
                                 
                                    
                                       σ
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    X
                                    )
                                 
                                 ≥
                                 0.5
                                 ,
                                 ∀
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              . Now let 
                                 
                                    
                                       X
                                    
                                    
                                       c
                                    
                                 
                               be the centered version of 
                                 X
                              , then 
                                 
                                    
                                       X
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       0
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          ̃
                                       
                                    
                                    ]
                                 
                              , where 
                                 
                                    0
                                 
                               is a column vector with all elements 0, and 
                                 
                                    
                                       X
                                    
                                    
                                       ̃
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       ×
                                       
                                          (
                                          n
                                          −
                                          1
                                          )
                                       
                                    
                                 
                               as defined in Eq. (8). Let 
                                 
                                    
                                       σ
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    ⋅
                                    )
                                 
                               denote the 
                                 j
                              th largest singular value of a matrix. By Lemma 6, we have 
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                       
                                          (
                                          X
                                          )
                                       
                                       ≤
                                       
                                          
                                             σ
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                c
                                             
                                          
                                          )
                                       
                                       ≤
                                       
                                          
                                             σ
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          X
                                          )
                                       
                                       ,
                                       
                                       ∀
                                       j
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                       −
                                       1
                                       .
                                    
                                 
                               In particular, take 
                                 j
                                 =
                                 n
                                 −
                                 1
                               in the above inequalities and we have 
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          c
                                       
                                    
                                    )
                                 
                                 ≥
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    X
                                    )
                                 
                                 ≥
                                 0.5
                              . Since 
                                 
                                    
                                       X
                                    
                                    
                                       c
                                    
                                 
                               is singular, the minimal singular value 
                                 
                                    
                                       σ
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          c
                                       
                                    
                                    )
                                 
                                 =
                                 0
                              . Therefore, 
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                ̃
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                c
                                             
                                          
                                          )
                                       
                                       ≥
                                       0.5
                                       .
                                    
                                 
                              
                              □

With the above tools, we can now prove Theorem 3.


                        
                           Proof
                           By (10), 
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             ̃
                                          
                                       
                                       =
                                       
                                          
                                             X
                                          
                                          
                                             ̃
                                          
                                       
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                       +
                                       
                                          
                                             ϵ
                                          
                                          
                                             ̃
                                          
                                       
                                       ,
                                    
                                 
                               where 
                                 
                                    
                                       ϵ
                                    
                                    
                                       ̃
                                    
                                 
                                 =
                                 ϵ
                                 −
                                 
                                    
                                       ϵ
                                    
                                    
                                       ̄
                                    
                                 
                               with 
                                 E
                                 
                                    (
                                    
                                       
                                          ϵ
                                       
                                       
                                          ̃
                                       
                                    
                                    )
                                 
                                 =
                                 0
                               and 
                                 
                                    
                                       v
                                       a
                                       r
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       =
                                       v
                                       a
                                       r
                                       
                                          (
                                          
                                             
                                                ϵ
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                ϵ
                                             
                                             
                                                ̄
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             n
                                             −
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       ≤
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       .
                                    
                                 
                               According to the comments below Theorem 4, we can apply Theorem 4 to have a lower bound on 
                                 P
                                 
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          ̃
                                       
                                    
                                    
                                       (
                                       λ
                                       )
                                    
                                    
                                       
                                          =
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                              . Let 
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 ≤
                                 ⋯
                                 ≤
                                 
                                    
                                       s
                                    
                                    
                                       n
                                    
                                 
                               be the singular values of 
                                 
                                    
                                       X
                                    
                                    
                                       ̃
                                    
                                 
                              . From Lemma 4 in the Appendix, 
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ≥
                                 0.5
                              . So 
                                 
                                    
                                       Λ
                                    
                                    
                                       m
                                       i
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          ̃
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 ≥
                                 
                                    
                                       1
                                    
                                    
                                       4
                                       n
                                    
                                 
                              . Put 
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       
                                          min
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       4
                                       n
                                    
                                 
                               in expression (25) and note that 
                                 
                                    
                                       X
                                    
                                    
                                       ̃
                                    
                                 
                               has 
                                 n
                                 −
                                 1
                               columns, we have 
                                 
                                    
                                       P
                                       
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                ̃
                                             
                                          
                                          
                                             (
                                             λ
                                             )
                                          
                                          
                                             
                                                =
                                             
                                             
                                                s
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                       ≥
                                       1
                                       −
                                       2
                                       
                                          (
                                          n
                                          −
                                          1
                                          )
                                       
                                       exp
                                       
                                          {
                                          −
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                8
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          }
                                       
                                       ≥
                                       1
                                       −
                                       2
                                       n
                                       exp
                                       
                                          {
                                          −
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                8
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          }
                                       
                                       .
                                    
                                 
                              
                              □

@&#REFERENCES@&#

