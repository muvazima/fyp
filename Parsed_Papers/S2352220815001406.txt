@&#MAIN-TITLE@&#A bi-intuitionistic modal logic: Foundations and automation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We introduce a bi-intuitionistic tense logic with interrelated modalities.


                        
                        
                           
                           We have considerably extended our understanding of how the foundational structures and the bi-intuitionistic logic extend and generalize approaches to mathematical morphology.


                        
                        
                           
                           The logic is shown decidable and has the effective finite model property. Also, complexity and correspondence results are given.


                        
                        
                           
                           The second focus of the appear is automation of proof systems for the logic.


                        
                        
                           
                           We present a sound, complete and terminating tableau calculus for the logic.


                        
                        
                           
                           An experimental evaluation gave good results when using predecessor blocking.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Intuitionistic logic

Modal logic

Tableau system

Decidability

Correspondence theorem

@&#ABSTRACT@&#


               
               
                  The paper introduces a bi-intuitionistic modal logic, called BISKT, with two adjoint pairs of tense operators. The semantics of BISKT is defined using Kripke models in which the set of worlds carries a pre-order relation as well as an accessibility relation, and the two relations are linked by a stability condition. A special case of these models arises from graphs in which the worlds are interpreted as nodes and edges of graphs, and formulae represent subgraphs. The pre-order is the incidence structure of the graphs. We present a comprehensive study of the logic, giving decidability, complexity and correspondence results. We also show the logic has the effective finite model property. We present a sound, complete and terminating tableau calculus for the logic and use the MetTeL system to explore implementations of different versions of the calculus. An experimental evaluation gave good results for satisfiable problems using predecessor blocking.
               
            

@&#INTRODUCTION@&#

The paper introduces a bi-intuitionistic modal logic, called BISKT, with two adjoint pairs of tense operators. A special case of the semantics for this logic has Kripke models in which the worlds are interpreted as nodes and edges of graphs, and formulae represent subgraphs. In this context the accessibility relations are essentially ‘relations on graphs’. To motivate the logic and the structures which underlie its semantics, we start by reviewing the motivation for developing a theory of ‘relations on graphs’, which generalizes that of ‘relations on sets’. One novel feature of relations on graphs is a pair of adjoint converse operations instead of the involution found with relations on sets. One half of this pair (the ‘left converse’) plays an essential role later in defining the relational semantics of BISKT.

Relations on sets underlie the most fundamental of the operations used in the body of techniques for image processing known as mathematical morphology [23,9]. Using 
                        
                           
                              Z
                           
                           
                              2
                           
                        
                      to model a grid of pixels, binary (i.e., black and white) images are modelled by subsets of 
                        
                           
                              Z
                           
                           
                              2
                           
                        
                     . One aim of processing images is to accentuate significant features and to lessen the visual impact of the less important aspects. Several basic transformations on images are parameterized by small patterns of pixels called structuring elements. These structuring elements generate relations, which transform subsets of 
                        
                           
                              Z
                           
                           
                              2
                           
                        
                      via the correspondence between relations 
                        R
                        ⊆
                        
                           
                              Z
                           
                           
                              2
                           
                        
                        ×
                        
                           
                              Z
                           
                           
                              2
                           
                        
                      and union-preserving operations on the powerset 
                        P
                        (
                        
                           
                              Z
                           
                           
                              2
                           
                        
                        )
                     . Several fundamental properties of image processing operations can be derived using only properties of these relations.

There have been various proposals for developing a version of mathematical morphology for graphs, one of the earliest being Heijmans and Vincent's [12]. One direction in more recent work is seen in [10]. However, most work in this area does not use a relational approach, probably because a theory of relations on graphs may be constructed in several different ways. In one way [24,25], the set of relations on a graph, or more generally a hypergraph, forms a generalization of a relation algebra where, in particular, the usual involutive converse operation becomes a pair of operations (the left converse and the right converse) forming an adjoint pair. In the present paper, we use these relations to give a semantics for a bi-intuitionistic modal logic in which propositions are interpreted over subgraphs as opposed to subsets of worlds as in standard Kripke semantics.

Accessibility relations with additional structure are already well-known in intuitionistic modal logic [29]. However, the semantics for the logic we present is distinguished both from this work, and from existing related work we discuss in Section 8, by the use of the left-converse operation. This means the logic BISKT has novel features which include ◇ϕ being equivalent to 
                        ⨼
                        □
                        ¬
                        ϕ
                     , where ⨼ and ¬ are the two negations present in BISKT.

Connections between mathematical morphology and modal logic have been developed by Aiello and Ottens [1], who implemented a hybrid modal logic for spatial reasoning, and by Aiello and van Benthem [2] who pointed out connections with linear logic. Bloch [8], also motivated by applications to spatial reasoning, exploited connections between relational semantics for modal logic and mathematical morphology. These approaches used morphology operations on sets, and one motivation for our own work is to extend these techniques to relations on graphs.

In this paper, we focus on the logic itself, and the semantic setting we use is more general than that arising from relations on graphs or hypergraphs. We justify the applicability of the logic by explaining its role in developing the theory of mathematical morphology for graphs as a generalization of the set-based case.

The main contribution of the paper is a bi-intuitionistic tense logic, called BISKT, for which a Kripke frame consists of a pre-order H interacting with an accessibility relation R via a stability condition.
                        1
                     
                     
                        1
                        The name BISKT is short for bi-intuitionistic stable Kt, where Kt is the common notation for the basic tense logic.
                      The semantics interprets formulae as H-sets, the downward-closed subsets of the pre-order. A particular case arises when the worlds represent the edges and nodes of a graph and formulae are interpreted as subgraphs. We establish that BISKT is decidable and has the effective finite model property.

The semantic setting for BISKT is a relational setting in which deduction calculi can be developed systematically. We follow the methodology of tableau calculus synthesis and refinement as introduced in [21,26] to develop a tableau calculus for the logic. We give soundness, completeness and termination results as consequences of results of tableau synthesis and the effective finite model property of BISKT.

Implementing a prover is normally a time-consuming undertaking but MetTeL
                        2
                     
                     
                        2
                        
                           http://www.mettel-prover.org.
                      is software for automatically generating a tableau prover from a set of tableau rules given by the user [27]. For us, using MetTeL turned out to be useful because we could experiment with implementations of different versions of the calculus. In combination with the tableau synthesis method, it was easy to run tests on a growing collection of problems with different provers for several preliminary versions of formalizations of bi-intuitionistic tense logics before settling on the definition given in this paper. MetTeL has also allowed to us experiment with different refinements of the rules and different forms of blocking. Blocking is a technique for forcing termination of tableau calculi for decidable logics.

The paper is structured as follows. Section 2 presents the basic notions of pre-orders and relations on downward-closed sets as well as on graphs. Relations on graphs occur naturally in mathematical morphology as demonstrated by an example in Section 2.5. Section 3 defines BISKT as a bi-intuitionistic stable tense logic with a semantics in which formulae are interpreted as downward-closed sets, which include subgraphs as a special case. Just as intuitionistic propositional logic can be embedded into the modal logic S4, BISKT can be embedded into a multi-modal logic with S4 modalities, which allows us to give decidability, complexity and correspondence results for BISKT. In Section 4, the applicability of the logic to mathematical morphology on graphs is considered. The need for automated deduction tools for BISKT in the exploration of the properties of morphology operations on graphs is explained. A systematic way of deriving correspondence results for BISKT is presented in Section 5 along with a demonstration that the frame condition corresponding to the Löb formula in the classical case also holds for BISKT. Frame conditions can be seen as properties of generalized structuring elements, so Section 5 is also a necessary foundation for the programme of using BISKT as a tool to develop mathematical morphology on graphs. In Section 6, we present a terminating labelled tableau calculus for BISKT. Results and findings of an evaluation of different presentations of the tableau calculus implemented using the tableau prover generator MetTeL are given in Section 7. Connections to other work are discussed in Section 8.

Let U be a set with a subset 
                           X
                           ⊆
                           U
                        , and let 
                           R
                           ⊆
                           U
                           ×
                           U
                         be a binary relation. Dilation and erosion are key operations used in mathematical morphology and, although we use a different notation, the following definition can be found in [15, p. 61]. The symbols ⊕ and ⊖ are standard but we depart from the practice of writing erosion in the order 
                           X
                           ⊖
                           R
                         in view of Lemma 1. 
                           Definition 1
                           
                              Dilation, ⊕, and erosion, ⊖, are operations with signatures 
                                 P
                                 (
                                 U
                                 )
                                 ×
                                 P
                                 (
                                 U
                                 ×
                                 U
                                 )
                                 ⟶
                                 P
                                 (
                                 U
                                 )
                               and 
                                 P
                                 (
                                 U
                                 ×
                                 U
                                 )
                                 ×
                                 P
                                 (
                                 U
                                 )
                                 ⟶
                                 P
                                 (
                                 U
                                 )
                               respectively.
                                 
                                    
                                       
                                          
                                             
                                                X
                                                ⊕
                                                R
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                {
                                                u
                                                ∈
                                                U
                                                :
                                                ∃
                                                x
                                                
                                                (
                                                (
                                                x
                                                ,
                                                u
                                                )
                                                ∈
                                                R
                                                ∧
                                                x
                                                ∈
                                                X
                                                )
                                                }
                                                ,
                                             
                                          
                                          
                                             
                                                R
                                                ⊖
                                                X
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                {
                                                u
                                                ∈
                                                U
                                                :
                                                ∀
                                                x
                                                
                                                (
                                                (
                                                u
                                                ,
                                                x
                                                )
                                                ∈
                                                R
                                                →
                                                x
                                                ∈
                                                X
                                                )
                                                }
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           

For fixed R we obtain operations with signature 
                           P
                           (
                           U
                           )
                           ⟶
                           P
                           (
                           U
                           )
                         which form an adjunction from the lattice 
                           P
                           (
                           U
                           )
                         to itself. The operation 
                            
                           ⊕
                           R
                         is the left adjoint to 
                           R
                           ⊖
                            
                         in the following sense. 
                           Definition 2
                           Let 
                                 (
                                 X
                                 ,
                                 
                                    
                                       ⩽
                                    
                                    
                                       X
                                    
                                 
                                 )
                                 ,
                                 (
                                 Y
                                 ,
                                 
                                    
                                       ⩽
                                    
                                    
                                       Y
                                    
                                 
                                 )
                               be partially ordered sets. An adjunction between X and Y consists of a pair of functions 
                                 f
                                 :
                                 X
                                 ⟶
                                 Y
                               and 
                                 g
                                 :
                                 Y
                                 ⟶
                                 X
                               such that 
                                 x
                                 
                                    
                                       ⩽
                                    
                                    
                                       X
                                    
                                 
                                 g
                                 (
                                 y
                                 )
                               iff 
                                 f
                                 (
                                 x
                                 )
                                 
                                    
                                       ⩽
                                    
                                    
                                       Y
                                    
                                 
                                 y
                               for all 
                                 x
                                 ∈
                                 X
                               and all 
                                 y
                                 ∈
                                 Y
                              . The function f is said to be left adjoint to 
                              g, and g is right adjoint to 
                              f.

When f and g form an adjunction they are necessarily order-preserving. Erosion and dilation interact with composition of relations as follows. 
                           Lemma 1
                           
                              If R and S are any binary relations on U and 
                              
                                 X
                                 ⊆
                                 U
                              
                              , then
                              
                                 
                                    
                                       (
                                       S
                                       ;
                                       R
                                       )
                                       ⊖
                                       X
                                       =
                                       S
                                       ⊖
                                       (
                                       R
                                       ⊖
                                       X
                                       )
                                       
                                        and 
                                       
                                       X
                                       ⊕
                                       (
                                       R
                                       ;
                                       S
                                       )
                                       =
                                       (
                                       X
                                       ⊕
                                       R
                                       )
                                       ⊕
                                       S
                                       .
                                    
                                 
                              
                           

The operations ⊕ and ⊖ can be applied to subgraphs of a graph when relations on graphs are defined. We see how this works in Section 2.3, but first work in a more general setting of H-sets which we now define. Let U be a set and H a pre-order on U (i.e., a reflexive and transitive relation). 
                           Definition 3
                           A subset 
                                 X
                                 ⊆
                                 U
                               is an H
                              -set if 
                                 X
                                 ⊕
                                 H
                                 ⊆
                                 X
                              .

Since H is reflexive, the condition is equivalent to 
                           X
                           ⊕
                           H
                           =
                           X
                        , and if we were to write H as ⩾ these would be downsets. It follows from the adjunction between dilation and erosion that X satisfies 
                           X
                           =
                           X
                           ⊕
                           H
                         iff it satisfies 
                           X
                           =
                           H
                           ⊖
                           X
                        .

The H-sets are closed under unions and intersections and form a distributive lattice which is a sub-lattice of the powerset lattice of U. The H-sets are not closed under complements but when A and B are H-sets, we can construct H-sets 
                           A
                           →
                           B
                         and 
                           A
                           ᚜
                           B
                         as in Definition 4 below. These operations give the structure of a bi-Heyting algebra to the lattice of H-sets. This means that the lattice is a Heyting algebra which is also Heyting algebra under the converse of the partial order in the lattice. We do not need a formal definition of a bi-Heyting algebra here, but the interested reader may find one in Stell [25] although the concept itself is much older and was already well-known to Reyes and Zolfaghari [17]. Heyting algebras are discussed in detail by Balbes and Dwinger [3]. 
                           Definition 4
                           Let A and B be H-sets. Then the following four H-sets are defined, where − denotes the complement of a subset of U. Note that −A and −B are not necessarily H-sets but merely subsets of U, however the expressions in which they appear below all do denote H-sets.
                                 
                                    
                                       
                                          
                                             
                                                A
                                                →
                                                B
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                H
                                                ⊖
                                                (
                                                −
                                                A
                                                ∪
                                                B
                                                )
                                                
                                             
                                             
                                                
                                                
                                             
                                             
                                                relative pseudocomplement
                                             
                                          
                                          
                                             
                                                A
                                                ᚜
                                                B
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                (
                                                A
                                                ∩
                                                −
                                                B
                                                )
                                                ⊕
                                                H
                                                
                                             
                                             
                                                
                                             
                                             
                                                dual relative pseudocomplement
                                             
                                          
                                          
                                             
                                                ¬
                                                A
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                H
                                                ⊖
                                                (
                                                −
                                                A
                                                )
                                                
                                             
                                             
                                                
                                             
                                             
                                                pseudocomplement
                                             
                                          
                                          
                                             
                                                ⨼
                                                A
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                (
                                                −
                                                A
                                                )
                                                ⊕
                                                H
                                                
                                             
                                             
                                                
                                             
                                             
                                                dual pseudocomplement
                                             
                                          
                                       
                                    
                                 
                              
                           

Relations on a set U can be identified with the union-preserving functions on the lattice of subsets. When U carries a pre-order H, the union-preserving functions on the lattice of H-sets correspond to relations on U which are stable: 
                           Definition 5
                           A binary relation R on U is stable if 
                                 H
                                 ;
                                 R
                                 ;
                                 H
                                 ⊆
                                 R
                              .

Stable relations are closed under composition, with H as the identity element for this operation, but they are not closed under converse. They do however support an adjoint pair of operations, the left and the right converse, denoted by ⤻ and 
                           
                         respectively.


                        
                           Definition 6
                           The left converse of a stable relation R is 
                                 ⤻
                                 R
                                 =
                                 H
                                 ;
                                 
                                    
                                       R
                                    
                                    
                                       ˘
                                    
                                 
                                 ;
                                 H
                               where 
                                 
                                    
                                       R
                                    
                                    
                                       ˘
                                    
                                 
                               is the (ordinary) converse of R.

The stability of ⤻R is immediate since H is a pre-order, and the left converse can be characterized as the smallest stable relation which contains 
                           
                              
                                 R
                              
                              
                                 ˘
                              
                           
                        . The right converse is characterized as the largest stable relation contained in 
                           
                              
                                 R
                              
                              
                                 ˘
                              
                           
                        , but it plays no role in this paper, so we omit the explicit construction. Properties of these operations include 
                           ⤻
                           
                              
                                 
                              
                           
                           R
                           ⊆
                           R
                           ⊆
                           
                              
                                 
                              
                           
                           ⤻
                           R
                         for any stable relation R, and further details can be found in [24,25].

The connection between erosion, dilation, complementation and converse in the lemma below is well-known [9]. We need it to prove Theorem 4 below which generalizes the lemma to the case of a stable relation acting on an H-set. 
                           Lemma 2
                           
                              For any relation R on U and any 
                              
                                 X
                                 ⊆
                                 U
                              
                              , 
                              
                                 X
                                 ⊕
                                 
                                    
                                       R
                                    
                                    
                                       ˘
                                    
                                 
                                 =
                                 −
                                 (
                                 R
                                 ⊖
                                 (
                                 −
                                 X
                                 )
                                 )
                              
                              .
                           

We have introduced the operations ¬ and ⨼ on H-sets, and the operation ⤻ on stable relations. For the next result we need to talk about both these operations and the corresponding dual operations on 
                           
                              
                                 H
                              
                              
                                 ˘
                              
                           
                        -sets and on 
                           
                              
                                 H
                              
                              
                                 ˘
                              
                           
                        -stable relations. Since the operations ¬, ⨼, and ⤻ all depend on H, we need to introduce decorated versions of the symbols for these operations when we need a context in which both H and 
                           
                              
                                 H
                              
                              
                                 ˘
                              
                           
                         are used simultaneously. These versions (d indicating dual) are defined as follows, although we only need them for the proof of Theorem 4. 
                           Definition 7
                           Let A be any 
                                 
                                    
                                       H
                                    
                                    
                                       ˘
                                    
                                 
                              -set and let R be any 
                                 
                                    
                                       H
                                    
                                    
                                       ˘
                                    
                                 
                              -stable relation. We define the operations 
                                 
                                    ¬
                                    d
                                 
                              , 
                                 
                                    ⨼
                                    d
                                 
                               and 
                                 
                                    ⤻
                                    d
                                 
                               as follows.
                                 
                                    1.
                                    
                                       
                                          
                                             ¬
                                             d
                                          
                                          A
                                          =
                                          
                                             
                                                H
                                             
                                             
                                                ˘
                                             
                                          
                                          ⊖
                                          (
                                          −
                                          A
                                          )
                                       
                                    


                                       
                                          
                                             ⨼
                                             d
                                          
                                          A
                                          =
                                          (
                                          −
                                          A
                                          )
                                          ⊕
                                          
                                             
                                                H
                                             
                                             
                                                ˘
                                             
                                          
                                       
                                    


                                       
                                          
                                             ⤻
                                             d
                                          
                                          R
                                          =
                                          
                                             
                                                H
                                             
                                             
                                                ˘
                                             
                                          
                                          ;
                                          R
                                          ;
                                          
                                             
                                                H
                                             
                                             
                                                ˘
                                             
                                          
                                       
                                    

The following properties follow immediately from the definitions. 
                           Lemma 3
                           
                              Let A be an H-set and R be a stable relation. Then
                              
                                 
                                    1.
                                    
                                       
                                          −
                                          ¬
                                          A
                                          =
                                          
                                             ⨼
                                             d
                                          
                                          −
                                          A
                                       
                                    


                                       
                                          −
                                          ⨼
                                          A
                                          =
                                          
                                             ¬
                                             d
                                          
                                          −
                                          A
                                       
                                    


                                       
                                          
                                             ⤻
                                             d
                                          
                                          
                                             
                                                R
                                             
                                             
                                                ˘
                                             
                                          
                                          =
                                          (
                                          ⤻
                                          R
                                          )
                                          
                                             
                                                
                                             
                                             
                                                ˘
                                             
                                          
                                       
                                    

The following was proved in [24] for the special case of hypergraphs, but we give a direct proof of the general case as it underlies one of the novel features of the logic we consider. 
                           Theorem 4
                           
                              For any stable relation R and any H-set A,
                              
                                 
                                    
                                       A
                                       ⊕
                                       (
                                       ⤻
                                       R
                                       )
                                       =
                                       ⨼
                                       (
                                       R
                                       ⊖
                                       (
                                       ¬
                                       A
                                       )
                                       )
                                       
                                        and 
                                       
                                       (
                                       ⤻
                                       R
                                       )
                                       ⊖
                                       A
                                       =
                                       ¬
                                       (
                                       (
                                       ⨼
                                       A
                                       )
                                       ⊕
                                       R
                                       )
                                       .
                                    
                                 
                              
                           

For the first part we have this calculation.
                                 
                                    
                                       
                                          
                                             
                                                A
                                                ⊕
                                                (
                                                ⤻
                                                R
                                                )
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                A
                                                ⊕
                                                (
                                                H
                                                ;
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      ˘
                                                   
                                                
                                                ;
                                                H
                                                )
                                                
                                             
                                             
                                                 by definition of 
                                                
                                                   ⤻
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                (
                                                (
                                                A
                                                ⊕
                                                H
                                                )
                                                ⊕
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      ˘
                                                   
                                                
                                                )
                                                ⊕
                                                H
                                                
                                             
                                             
                                                 by Lemma 1
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                (
                                                A
                                                ⊕
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      ˘
                                                   
                                                
                                                )
                                                ⊕
                                                H
                                                
                                             
                                             
                                                 as 
                                                
                                                   A
                                                
                                                 is an 
                                                
                                                   H
                                                
                                                -set
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                (
                                                −
                                                (
                                                R
                                                ⊖
                                                (
                                                −
                                                A
                                                )
                                                )
                                                )
                                                ⊕
                                                H
                                                
                                             
                                             
                                                 by Lemma 2
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                ⨼
                                                (
                                                R
                                                ⊖
                                                (
                                                −
                                                A
                                                )
                                                )
                                                )
                                                
                                             
                                             
                                                 by definition of 
                                                
                                                   ⨼
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                ⨼
                                                (
                                                (
                                                R
                                                ;
                                                H
                                                )
                                                ⊖
                                                (
                                                −
                                                A
                                                )
                                                )
                                                )
                                                
                                             
                                             
                                                 by stability of 
                                                
                                                   R
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                ⨼
                                                (
                                                R
                                                ⊖
                                                (
                                                H
                                                ⊖
                                                (
                                                −
                                                A
                                                )
                                                )
                                                )
                                                
                                             
                                             
                                                 by Lemma 1
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                ⨼
                                                (
                                                R
                                                ⊖
                                                (
                                                ¬
                                                A
                                                )
                                                )
                                                
                                             
                                             
                                                 by definition of 
                                                
                                                   ¬
                                                
                                             
                                          
                                       
                                    
                                 
                               For the second part
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ⤻
                                                   d
                                                
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      ˘
                                                   
                                                
                                                ⊖
                                                (
                                                −
                                                A
                                                )
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                −
                                                (
                                                A
                                                ⊕
                                                ⤻
                                                R
                                                )
                                                
                                             
                                             
                                                 by Lemmas 2 and 3
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                −
                                                ⨼
                                                (
                                                R
                                                ⊖
                                                ¬
                                                A
                                                )
                                                
                                             
                                             
                                                 by the first part
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                
                                                   ¬
                                                   d
                                                
                                                −
                                                (
                                                R
                                                ⊖
                                                −
                                                
                                                   ⨼
                                                   d
                                                
                                                −
                                                A
                                                )
                                                
                                             
                                             
                                                 by Lemma 3
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                
                                                   ¬
                                                   d
                                                
                                                (
                                                
                                                   ⨼
                                                   d
                                                
                                                −
                                                A
                                                ⊕
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      ˘
                                                   
                                                
                                                )
                                                
                                             
                                             
                                                 by Lemma 2
                                                
                                             
                                          
                                       
                                    
                                 
                               Hence for all 
                                 
                                    
                                       H
                                    
                                    
                                       ˘
                                    
                                 
                              -sets B and all 
                                 
                                    
                                       H
                                    
                                    
                                       ˘
                                    
                                 
                              -stable relations S, 
                                 
                                    ⤻
                                    d
                                 
                                 S
                                 ⊖
                                 B
                                 =
                                 
                                    ¬
                                    d
                                 
                                 (
                                 
                                    ⨼
                                    d
                                 
                                 B
                                 ⊕
                                 S
                                 )
                               which is equivalent to the required result since this equation holds for all 
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             ˘
                                          
                                       
                                    
                                    
                                       ˘
                                    
                                 
                              -sets B and all 
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             ˘
                                          
                                       
                                    
                                    
                                       ˘
                                    
                                 
                              -stable relations S.  □

A special case of the above constructions is when U is the set of all edges and nodes of a graph in the following sense. 
                           Definition 8
                           A graph consists of disjoint sets E and N, called edges and nodes respectively, together with an incidence function 
                                 f
                                 :
                                 E
                                 ⟶
                                 P
                                 (
                                 N
                                 )
                               such that the cardinality of 
                                 f
                                 (
                                 e
                                 )
                               is either 1 or 2 for every edge e.

Graphs in this sense are sometimes called undirected multigraphs in which multiple loops are permitted. From such a graph we can obtain a set U by putting 
                           U
                           =
                           E
                           ∪
                           N
                        . We can then define a pre-order H on U as follows.
                           
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 ∈
                                 H
                                  iff 
                                 
                                    {
                                    
                                       
                                          
                                             u
                                             ∈
                                             E
                                              and 
                                             v
                                             ∈
                                             N
                                              and 
                                             v
                                             ∈
                                             f
                                             (
                                             u
                                             )
                                             ,
                                              or
                                          
                                       
                                       
                                          
                                             u
                                             =
                                             v
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In this setting, the H-sets are exactly the subgraphs, that is, sets of nodes and edges which include the incident nodes of every edge in the set. The importance of the bi-Heyting algebra of subgraphs of a directed graph has been highlighted by Lawvere as explained in [17].

We give an example for an undirected graph of the operations ¬ and ⨼ of Section 2.1 since these motivate the semantics for the two negations in our logic. Fig. 1
                         shows various subgraphs of a graph where the subgraphs are distinguished by depicting the edges and nodes in bold. For a subgraph K, the operations ¬ and ⨼ yield respectively the largest subgraph disjoint from K and the smallest subgraph containing all the edges and nodes not present in K. In Fig. 1 it can be seen that neither 
                           ¬
                           ¬
                           K
                         nor 
                           ⨼
                           ⨼
                           K
                         is equal to K. The subgraph 
                           ¬
                           ¬
                           K
                         consists of K completed by the addition of any edges all of whose incident nodes are in K. The subgraph 
                           ⨼
                           ⨼
                           K
                         is K with the removal of any nodes that have incident edges none of which is present in K. The subgraph 
                           ⨼
                           ¬
                           K
                         can be interpreted as the expansion of K to include things up to one edge away from K, and 
                           ¬
                           ⨼
                           K
                         is a kind of contraction, removing any nodes on the boundary of K and any edges incident on them.

The stable relations on a graph can be visualized as in Fig. 2
                        . The arrows used may have multiple heads and multiple tails; the meaning is that every node or edge at a tail is related to all the edges and nodes at the various heads. The stability condition implies that if a node, n, is related to something, u say, then every edge incident with n is also related to u. Stability also implies that if u, which may be an edge or a node, is related to an edge e, then u is also related to every node incident with e.

The left converse operation is illustrated in Fig. 3
                         showing that iterating this operation can lead to successively larger relations.

Mathematical morphology provides practically useful image processing operations and in several cases these operations are generated by relations on the set of pixels as mentioned in the Introduction. Given a set U of pixels and a relation 
                           R
                           ⊆
                           U
                           ×
                           U
                         the operations 
                            
                           ⊕
                           R
                         and 
                           R
                           ⊖
                            
                         take subsets of U to subsets of U. For a concrete example, imagine U to consist of all the pixels available on a particular screen. In a more abstract setting, we might take U to be 
                           
                              
                                 Z
                              
                              
                                 2
                              
                           
                         as in the examples in Figs. 4 and 5
                        
                         which we now discuss.

A subset of U can be depicted by shaded pixels, as with the subset X shown in Fig. 5. It is usual to specify the relation R by means of a ‘structuring element’, although it should be noted that not all relations arise from structuring elements. A structuring element is, informally speaking, a pattern of pixels, such as the cross shaped structuring element shown in Fig. 4. A structuring element also includes identification of an origin, which is typically one of the pixels in the pattern. In the case of Fig. 4, choosing the origin as the central pixel induces a relation in which this central pixel is related to all the pixels in the pattern. In this example, this then leads to a relation on all the pixels in U in which each pixel is related to itself and to the four pixels sharing an edge with it.

The operations of dilation and erosion defined in Definition 1 are illustrated in Fig. 5. Opening of the subset X can be defined as erosion followed by dilation, but can also be visualized as the largest subset of X which can be covered by (possibly overlapping) copies of the structuring element.

Cousty et al. [10] show how to construct various morphological operators on subgraphs of a graph. These operators are shown to outperform (in a sense explained in [10]) operators based on relations on a set of pixels in certain cases. We now show how stable relations presented in this paper underlie these operators on subgraphs. To illustrate this, we consider one example: the operation which Cousty et al. [10] denoted by 
                           [
                           δ
                           ,
                           Δ
                           ]
                        . This operation expands a subgraph by augmenting it with every edge and every node that shares respectively an incident node or an incident edge with an edge or a node present in the subgraph. The notation 
                           [
                           δ
                           ,
                           Δ
                           ]
                         follows well-established conventions in mathematical morphology.

Cousty et al. [10] describe the operation 
                           [
                           δ
                           ,
                           Δ
                           ]
                         in terms of its action on sets of edges and on sets of nodes separately. We can, however, find a stable relation, R, such that dilation by R provides a graph-theoretic description of 
                           [
                           δ
                           ,
                           Δ
                           ]
                        . This stable relation is defined by 
                           R
                           =
                           Q
                           ;
                           ⤻
                           Q
                           ∪
                           ⤻
                           Q
                           ;
                           Q
                         where Q is the stable relation expressing incidence as follows: A graph G with edges E and nodes N, has incidence relation 
                           Q
                           ⊆
                           E
                           ×
                           N
                         where a pair 
                           (
                           e
                           ,
                           n
                           )
                         belongs to Q if and only if the edge e is incident with the node n. Note that Q can be obtained from the relation H introduced earlier by removing all the reflexive loops from H.

To illustrate the relation R, we consider the graph which is shown in Fig. 6
                        . The nodes of the graph in this figure correspond to the pixels in Fig. 5 and the edges of the graph correspond to cases where pixels are 4-adjacent (sharing a 1-dimensional boundary). The graph in Fig. 6 has 
                           
                              
                                 Z
                              
                              
                                 2
                              
                           
                         for its set of nodes. Subgraphs are indicated by drawing their nodes and edges in bold lines. Fig. 7
                         shows how relation R can be visualized for the case of the graph in Fig. 6.

Besides dilation by R, Fig. 6 also shows the result of erosion and opening by the same relation. Observe that there are pairs of adjacent nodes included in the opening but where the edge between them is not included. A set of pixels corresponds to a set of nodes in this example but does not determine a unique subgraph as different sets of edges between these nodes may be present. Subgraphs thus allow finer distinctions than mere sets of pixels, and this is one of the reasons why mathematical morphology on graphs can lead to better performing operations on images.

The significance of stable relations for mathematical morphology on graphs is that they allow an essentially graph-theoretic account of the operations involved. This contrasts with the set-theoretic description in [10] where operations on subgraphs are constructed from operations on sets of nodes and on sets of edges separately. Having shown how stable relations arise in mathematical morphology on graphs, we next introduce the logic BISKT. The applicability of this logic to mathematical morphology is then justified in Section 4.

We now propose a modal logic BISKT for which a Kripke frame is a pre-ordered set 
                        (
                        U
                        ,
                        H
                        )
                      together with a stable binary relation on U. Formulae of BISKT are interpreted as H-sets. A particular case is when the worlds (elements of U) are the edges and nodes of a graph. In this case a valuation assigns subgraphs to propositional variables and given such a valuation each formula is interpreted as a subgraph which can be thought of as the edges and nodes where the formula holds. 
                        Definition 9
                        The language of BISKT consists of a set Vars of propositional variables: 
                              p
                              ,
                              q
                              ,
                              …
                           , a constant: ⊥, unary connectives: ¬ and ⨼, binary connectives: ∧, ∨, →, ᚜, and unary modal operators: □, ⧫, ◇, and ■. The set Form of formulae is defined in the usual way.


                     
                        Definition 10
                        An H-frame 
                           
                              F
                              =
                              (
                              U
                              ,
                              H
                              ,
                              R
                              )
                            is a pre-order 
                              (
                              U
                              ,
                              H
                              )
                            together with a stable binary relation R on U. A valuation on an H-frame 
                              F
                            is a function 
                              V
                              :
                              
                                 Vars
                              
                              ⟶
                              H
                              
                                 -Set
                              
                           , where 
                              H
                              
                                 -Set
                              
                            is the set of all H-sets.

A valuation 
                        V
                      on 
                        F
                      extends to a function 
                        
                           
                              〚
                              
                              〛
                           
                           
                              V
                           
                        
                        :
                        
                           Form
                        
                        ⟶
                        H
                        
                           -Set
                        
                      by setting 
                        
                           
                              〚
                              p
                              〛
                           
                           
                              V
                           
                        
                        =
                        V
                        (
                        p
                        )
                     , for any propositional variable p, and extending this to formulae as follows.
                        
                           
                              
                                 
                                    
                                       〚
                                       ⊥
                                       〛
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       ∅
                                       
                                    
                                    
                                       
                                    
                                    
                                       〚
                                       ⊤
                                       〛
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       U
                                    
                                 
                                 
                                    
                                       〚
                                       ϕ
                                       ∨
                                       ψ
                                       〛
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       〚
                                       ϕ
                                       〛
                                       ∪
                                       〚
                                       ψ
                                       〛
                                       
                                    
                                    
                                       
                                    
                                    
                                       〚
                                       ϕ
                                       ∧
                                       ψ
                                       〛
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       〚
                                       ϕ
                                       〛
                                       ∩
                                       〚
                                       ψ
                                       〛
                                    
                                 
                                 
                                    
                                       〚
                                       ¬
                                       ϕ
                                       〛
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       H
                                       ⊖
                                       (
                                       −
                                       〚
                                       ϕ
                                       〛
                                       )
                                       
                                    
                                    
                                       
                                    
                                    
                                       〚
                                       ⨼
                                       ϕ
                                       〛
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       (
                                       −
                                       〚
                                       ϕ
                                       〛
                                       )
                                       ⊕
                                       H
                                    
                                 
                                 
                                    
                                       〚
                                       ϕ
                                       →
                                       ψ
                                       〛
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       H
                                       ⊖
                                       (
                                       (
                                       −
                                       〚
                                       ϕ
                                       〛
                                       )
                                       ∪
                                       〚
                                       ψ
                                       〛
                                       )
                                       
                                    
                                    
                                       
                                    
                                    
                                       〚
                                       ϕ
                                       ᚜
                                       ψ
                                       〛
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       (
                                       〚
                                       ϕ
                                       〛
                                       ∩
                                       (
                                       −
                                       〚
                                       ψ
                                       〛
                                       )
                                       )
                                       ⊕
                                       H
                                    
                                 
                                 
                                    
                                       〚
                                       □
                                       ϕ
                                       〛
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       R
                                       ⊖
                                       〚
                                       ϕ
                                       〛
                                       
                                    
                                    
                                       
                                    
                                    
                                       〚
                                       ◇
                                       ϕ
                                       〛
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       〚
                                       ϕ
                                       〛
                                       ⊕
                                       (
                                       ⤻
                                       R
                                       )
                                    
                                 
                                 
                                    
                                       〚
                                       ⧫
                                       ϕ
                                       〛
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       〚
                                       ϕ
                                       〛
                                       ⊕
                                       R
                                       
                                    
                                    
                                       
                                    
                                    
                                       〚
                                       ■
                                       ϕ
                                       〛
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       (
                                       ⤻
                                       R
                                       )
                                       ⊖
                                       〚
                                       ϕ
                                       〛
                                    
                                 
                              
                           
                        
                      Usually the valuation is clear from the context and we often write 
                        〚
                        
                        〛
                      instead of 
                        
                           
                              〚
                              
                              〛
                           
                           
                              V
                           
                        
                     .


                     
                        Definition 11
                        Given a frame 
                              F
                           , a valuation 
                              V
                            on 
                              F
                            and a world 
                              w
                              ∈
                              U
                            we define ⊩ by
                              
                                 
                                    F
                                    ,
                                    V
                                    ,
                                    w
                                    ⊩
                                    ϕ
                                     iff 
                                    w
                                    ∈
                                    
                                       
                                          〚
                                          ϕ
                                          〛
                                       
                                       
                                          V
                                       
                                    
                                    .
                                 
                              
                            When 
                              F
                              ,
                              V
                              ,
                              w
                              ⊩
                              ϕ
                            holds for all 
                              w
                              ∈
                              U
                            we write 
                              F
                              ,
                              V
                              ⊩
                              ϕ
                           , and when 
                              F
                              ,
                              V
                              ⊩
                              ϕ
                            holds for all valuations 
                              V
                            we write 
                              F
                              ⊩
                              ϕ
                           .

In the special case that H is the identity relation on U, stability places no restriction on R and ⤻R is just the ordinary converse of R. The semantics is then equivalent to the usual relational semantics for tense logic when time is not assumed to have any specific properties.


                     Fig. 8
                      illustrates how the semantics of ◇ and ■ are interpreted on subgraphs. In the figure, R is denoted by the broken lines and H is determined by the graph. The H-sets are shown in bold.

We can give a temporal interpretation to the example by taking the nodes to be time points, the edges to be open intervals, and R to relate each open interval to all instants that either end the interval or end some later interval. The times when ◇p holds are then the open intervals for which p holds at some later instant, together with both endpoints of those intervals. The times when ■q holds are all the closed intervals where q holds at all times and has always held.


                     
                        Lemma 5
                        
                           The formulae listed in 
                           
                              Tables 1, 2, 3, and 4
                           
                           
                           
                           
                           
                           , together with the implications between formulae in the diagrams in 
                           
                              Figs. 9 and 10
                           
                           
                            
                           are all valid in BISKT.
                        

An alternative semantics, decidability and complexity results for BISKT can be obtained by embedding the logic into the tense logic 
                        
                           Kt
                        
                        (
                        H
                        ,
                        R
                        )
                     . 
                        
                           Kt
                        
                        (
                        H
                        ,
                        R
                        )
                      is a traditional propositional modal logic defined over two accessibility relations H and R and their converse relations. In [19] it is shown that: 
                        Theorem 6
                        
                           (See 
                           
                              [19]
                           
                           .) 
                           
                              
                                 Kt
                              
                              (
                              H
                              ,
                              R
                              )
                            
                           is decidable and has the effective finite model property, that is, there is an effective function μ such that every satisfiable formula ϕ has a finite model bounded in size by 
                           
                              μ
                              (
                              ϕ
                              )
                           
                           . Moreover, satisfiability in 
                           
                              
                                 Kt
                              
                              (
                              H
                              ,
                              R
                              )
                            
                           is PSPACE-complete.
                        

These results carry over to BISKT via an embedding of BISKT into 
                        
                           Kt
                        
                        (
                        H
                        ,
                        R
                        )
                      (as an extension of the standard embedding of intuitionistic propositional logic into the modal logic S4). This allows us to conclude: 
                        Theorem 7
                        
                           BISKT has the effective finite model property and is decidable. Moreover, satisfiability in BISKT is PSPACE-complete.
                        

A formula containing a single propositional variable can be understood as an operation on subgraphs. For example, the formula ⧫p can be understood as the operation which for any subgraph 
                        〚
                        p
                        〛
                      returns the subgraph 
                        〚
                        ⧫
                        p
                        〛
                      for the appropriate valuation. Table 5
                      lists some principal operations and is immediately established from definitions. In the case of set-based morphology operations generated by a structuring element, the converse versions in the table correspond to working with the structuring element rotated by 180°.

Mathematical morphology on graphs is still relatively unexplored compared with the extensive research for the set-based case. One of the reasons that such exploration can be expected to be challenging is that concepts which are familiar for set-based mathematical morphology can have several different counterparts for graphs. This is particularly true of operators defined using the Boolean complement of a set of pixels. Such operators may generalize to more than one morphological operator on graphs since occurrences of the complement can be replaced by the pseudocomplement or by its dual. We illustrate this situation by some examples.

Relationships between morphological operations can correspond to the validity of formulae in BISKT. Simple examples of this are the relationships between erosion and converse dilation and between converse erosion and dilation (which follow from Theorem 4):
                        
                           (3)
                           
                              ◊
                              p
                              ↔
                              ⨼
                              □
                              ¬
                              p
                              
                              and
                              
                              ■
                              p
                              ↔
                              ¬
                              ⧫
                              ⨼
                              p
                              .
                           
                        
                      Although the white diamond can thus be defined in terms of the white box in BISKT, there does not appear to be any simple valid formula which allows the definition of white box in terms of white diamond. Similarly we can define black box in terms of black diamond but there does not appear to be any way to define the black diamond in terms of the black box. It is certainly the case that formulae such as 
                        ¬
                        ◊
                        ⨼
                        p
                      and 
                        ⨼
                        ■
                        ¬
                        p
                     , which in the classical Boolean case would be equivalent to □p and ⧫p respectively, are not equivalent to these in BISKT. The same is true for these formulae if ¬ is substituted for ⨼, or vice versa, or if both of these substitutions are made. The fact that formulae such as 
                        ¬
                        ◊
                        ⨼
                        p
                        ↔
                        □
                        p
                      are not valid in BISKT shows that the relationship of erosion to converse dilation for mathematical morphology on graphs is considerably more subtle than in the set-based case.

The two equivalences in (3) above can be used to derive the generalization of a well-known result in set-based mathematical morphology. The result provides a description of closing by a structuring element in terms of opening by the rotated structuring element and complementation. In detail, the closing can be achieved by opening the complement of the image with the rotated structuring element and then taking the complement of the result. This provides a useful way of visualizing closing as what remains of a set of pixels after copies of the rotated structuring element are fitted around the outside of the image. In the case of mathematical morphology on graphs the closing is expressible in a more complex way:
                        
                           (4)
                           
                              ◊
                              ■
                              p
                              ↔
                              ⨼
                              □
                              ¬
                              ¬
                              ⧫
                              ⨼
                              p
                              .
                           
                        
                      The examples of valid BISKT formulae (3) and (4) above are relatively simple and can readily be derived by hand. However the exploration of the properties of other morphological operations on graphs will be more complex and the support of automated deduction tools based on the tableau calculus presented later in the paper will be needed to carry out calculations. This can be expected to be the case in particular for the theory of self-dual operators [13]. For morphological operations on sets of pixels, binary (that is black and white) images consist of two complementary subsets: the foreground and the background. As [13, p. 15] makes clear, operators that act in the same way on the foreground and on the background are important in image processing. If U is a set and φ is a function taking subsets of U to subsets of U, then φ is defined to be self-dual if 
                        φ
                        (
                        X
                        )
                        =
                        −
                        (
                        φ
                        (
                        −
                        X
                        )
                        )
                      for all 
                        X
                        ⊆
                        U
                      where − denotes the complement.

For graphs, the two kinds of complement and the four possible combinations of two of these as discussed in Section 2.3, together with the identity, provide seven distinct operations on subgraphs compared with just two for the corresponding Boolean case. Alternating sequences of the pseudocomplement and its dual provide yet further distinct operations on graphs. There are thus several different possible notions of self-duality for morphological operators on graphs. The two weaker forms of complement and their combinations all correspond to meaningful operations on subgraphs, and therefore provide more than one notion of self-duality. To explore all these many possibilities and properties of morphological operators, it would clearly be of value to have a tool which automatically establishes the validity or otherwise of BISKT formulae. The machinery for building such a tool is developed later in this paper.

In the next section, we consider correspondence theory for the logic. The frame conditions appearing in the correspondence theory are conditions on the relations which, in mathematical morphology, are generalized structuring elements, as explained in Sections 2.4 and 2.5. Some of the results in papers such as [13] depend on properties of the structuring elements used to define morphological operations. Correspondence results provide counterparts in the logic for generalizations of these properties defined on graphs.

In this section we derive a number of correspondence results. First we present a method that allows us, for first-order frame conditions in a particular form, to derive correspondence results in BISKT automatically. Later, we examine the case of a frame condition that has no first-order equivalent in Section 5.2 where we show that the Löb formula in BISKT corresponds to the same frame condition as in the classical case.

A number of frame conditions can be expressed as inclusions between relations. For example, the condition that R is reflexive can be expressed as the identity relation being included in R. Frame conditions expressible as inclusions have modal correspondents in BISKT that can be obtained in a systematic way and which depend essentially on little more than basic properties of adjunctions. The list of these BISKT correspondents presented in Table 6
                         includes the well-known classical correspondents in the case of H being the equality relation on U.

Stable relations correspond exactly to join-preserving functions on the lattice of H-sets. The set of stable relations is best understood as having the algebraic structure of a quantale [18], for a precise statement of this result see [25, Thm. 6, p. 445]. In some more detail, this correspondence is an isomorphism between (a) the quantale of stable relations under relation composition with the usual unions of relations as joins and (b) the quantale of join-preserving functions under function composition with the usual unions of set-valued functions. The isomorphism assigns the function 
                            
                           ⊕
                           R
                         to the stable relation R. The key feature of the isomorphism that we need is the following lemma. 
                           Lemma 8
                           
                              Let 
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                               
                              be any stable relations. Then the following are equivalent
                              
                                 
                                    1.
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          ⊆
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    


                                       For every H-set X, 
                                       
                                          X
                                          ⊕
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          ⊆
                                          X
                                          ⊕
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    


                                       For every H-set X, 
                                       
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                          ⊖
                                          X
                                          ⊆
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          ⊖
                                          X
                                       
                                    

It follows from Lemma 8 that for any H-set, X, the statements 
                           X
                           =
                           U
                         and 
                           H
                           ⊖
                           X
                           =
                           U
                         are equivalent. Combining this with the semantic definitions in Section 3, we establish Lemma 9. 
                           Lemma 9
                           
                              Let 
                              
                                 ϕ
                                 ,
                                 ψ
                               
                              be any BISKT formulae and 
                              
                                 V
                               
                              any valuation. Then
                              
                                 
                                    
                                       F
                                       ,
                                       V
                                       ⊩
                                       ϕ
                                       →
                                       ψ
                                       
                                        iff 
                                       
                                       
                                          
                                             〚
                                             ϕ
                                             〛
                                          
                                          
                                             V
                                          
                                       
                                       ⊆
                                       
                                          
                                             〚
                                             ψ
                                             〛
                                          
                                          
                                             V
                                          
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Theorem 10
                           
                              Let 
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 {
                                 R
                                 ,
                                 ⤻
                                 R
                                 }
                               
                              for 
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                               
                              and for each i let
                              
                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   □
                                                    if 
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   R
                                                
                                             
                                             
                                                
                                                   ■
                                                    if 
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   ⤻
                                                   R
                                                
                                             
                                          
                                       
                                        and let
                                       
                                       
                                       
                                          
                                             D
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   ⧫
                                                    if 
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   R
                                                
                                             
                                             
                                                
                                                   ◊
                                                    if 
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   ⤻
                                                   R
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                               
                              Let 
                              
                                 0
                                 ⩽
                                 k
                                 ⩽
                                 m
                               
                              and let ; be relational composition. Then the following are equivalent.
                              
                                 
                                    1.
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          ;
                                          ⋯
                                          ;
                                          
                                             
                                                S
                                             
                                             
                                                k
                                             
                                          
                                          ⊆
                                          
                                             
                                                S
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          ;
                                          ⋯
                                          ;
                                          
                                             
                                                S
                                             
                                             
                                                m
                                             
                                          
                                       
                                    


                                       
                                          F
                                          ⊩
                                          
                                             
                                                D
                                             
                                             
                                                k
                                             
                                          
                                          ⋯
                                          
                                             
                                                D
                                             
                                             
                                                1
                                             
                                          
                                          
                                          p
                                          →
                                          
                                             
                                                D
                                             
                                             
                                                m
                                             
                                          
                                          ⋯
                                          
                                             
                                                D
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          
                                          p
                                       
                                    


                                       
                                          F
                                          ⊩
                                          
                                             
                                                B
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          ⋯
                                          
                                             
                                                B
                                             
                                             
                                                m
                                             
                                          
                                          
                                          p
                                          →
                                          
                                             
                                                B
                                             
                                             
                                                1
                                             
                                          
                                          ⋯
                                          
                                             
                                                B
                                             
                                             
                                                k
                                             
                                          
                                          
                                          p
                                       
                                    

The equivalence of parts 1 and 2 is established as follows and similarly for parts 1 and 3.
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ;
                                                ⋯
                                                ;
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ⊆
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                ;
                                                ⋯
                                                ;
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                          
                                          
                                             
                                                iff
                                                
                                                For every 
                                                
                                                   H
                                                
                                                -set, 
                                                
                                                   X
                                                
                                                , 
                                                X
                                                ⊕
                                                (
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ;
                                                ⋯
                                                ;
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                ⊆
                                                X
                                                ⊕
                                                (
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                ;
                                                ⋯
                                                ;
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      m
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                iff
                                                
                                                For every 
                                                
                                                   H
                                                
                                                -set, 
                                                
                                                   X
                                                
                                                , 
                                             
                                          
                                          
                                             
                                                
                                                   iff
                                                   
                                                
                                                (
                                                ⋯
                                                (
                                                (
                                                X
                                                ⊕
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                ⊕
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                ⊕
                                                ⋯
                                                )
                                                ⊕
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ⊆
                                                (
                                                ⋯
                                                (
                                                (
                                                X
                                                ⊕
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                )
                                                ⊕
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      k
                                                      +
                                                      2
                                                   
                                                
                                                )
                                                ⊕
                                                ⋯
                                                )
                                                ⊕
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                          
                                          
                                             
                                                iff
                                                
                                                For every valuation, 
                                                
                                                   V
                                                
                                                , 
                                                
                                                
                                                   
                                                      〚
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ⋯
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                      p
                                                      〛
                                                   
                                                   
                                                      V
                                                   
                                                
                                                ⊆
                                                
                                                   
                                                      〚
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      ⋯
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      
                                                      p
                                                      〛
                                                   
                                                   
                                                      V
                                                   
                                                
                                             
                                          
                                          
                                             
                                                iff
                                                
                                                F
                                                ⊩
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ⋯
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                p
                                                →
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      m
                                                   
                                                
                                                ⋯
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                
                                                p
                                             
                                          
                                       
                                    
                                 
                                □

Note that Theorem 10 includes the cases when one side of the inclusion is the identity for composition of stable relations. These cases arise from the extremes 
                           k
                           =
                           0
                         and 
                           k
                           =
                           m
                         which yield 
                           H
                           ⊆
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           ;
                           ⋯
                           ;
                           
                              
                                 S
                              
                              
                                 m
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           ;
                           ⋯
                           ;
                           
                              
                                 S
                              
                              
                                 m
                              
                           
                           ⊆
                           H
                         respectively. The theorem allows us to obtain modal correspondents for the frame conditions listed in Table 6. These correspondents will contain only diamonds or only boxes. To obtain the correspondents appearing in the final column of the table which include both diamonds and boxes but where they are all of the same colour we need to use the basic principles for manipulating frame equivalences given in the next two results, together with the fact that the following are all valid in BISKT.
                           
                              
                                 ⧫
                                 □
                                 p
                                 →
                                 p
                                 
                                 p
                                 →
                                 □
                                 ⧫
                                 p
                                 
                                 ◊
                                 ■
                                 p
                                 →
                                 p
                                 
                                 p
                                 →
                                 ■
                                 ◊
                                 p
                              
                           
                        
                     


                        
                           Lemma 11
                           
                              
                                 
                                    1.
                                    
                                       
                                          
                                       
                                    


                                       
                                          
                                             
                                                
                                                   F
                                                   ⊩
                                                   ϕ
                                                   →
                                                   ψ
                                                
                                             
                                             
                                                
                                                   F
                                                   ⊩
                                                   M
                                                   ϕ
                                                   →
                                                   M
                                                   ψ
                                                
                                             
                                          
                                        
                                       where 
                                       
                                          M
                                          ∈
                                          {
                                          □
                                          ,
                                          ◊
                                          ,
                                          ■
                                          ,
                                          ⧫
                                          }
                                       
                                       .
                                    


                        
                           Lemma 12
                           
                              
                                 
                                    1.
                                    
                                       
                                          
                                             
                                                
                                                   ⊩
                                                   ϕ
                                                
                                             
                                             
                                                
                                                   F
                                                   ⊩
                                                   ϕ
                                                
                                             
                                          
                                       
                                    


                                       
                                          
                                             
                                                
                                                   F
                                                   ⊩
                                                   ϕ
                                                
                                             
                                             
                                                
                                                   F
                                                   ⊩
                                                   σ
                                                   (
                                                   ϕ
                                                   )
                                                
                                             
                                          
                                        
                                       where σ is any substitution of BISKT formulae for propositional variables.
                                    


                                       
                                          
                                             
                                                
                                                   F
                                                   ⊩
                                                   ϕ
                                                   →
                                                   ψ
                                                   
                                                   F
                                                   ⊩
                                                   ψ
                                                   →
                                                   θ
                                                
                                             
                                             
                                                
                                                   F
                                                   ⊩
                                                   ϕ
                                                   →
                                                   θ
                                                
                                             
                                          
                                       
                                    


                        
                           
                              
                                 
                                    
                                       
                                          F
                                          ⊩
                                          ⧫
                                          ◊
                                          p
                                          →
                                          ◊
                                          ⧫
                                          p
                                          
                                       
                                       
                                          ⇒
                                          
                                       
                                       
                                          F
                                          ⊩
                                          ◊
                                          p
                                          →
                                          □
                                          ◊
                                          ⧫
                                          p
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          ⇒
                                          
                                       
                                       
                                          F
                                          ⊩
                                          ◊
                                          □
                                          p
                                          →
                                          □
                                          ◊
                                          ⧫
                                          □
                                          p
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          ⇒
                                          
                                       
                                       
                                          F
                                          ⊩
                                          ◊
                                          □
                                          p
                                          →
                                          □
                                          ◊
                                          p
                                          
                                          since
                                          ⊩
                                          ⧫
                                          □
                                          p
                                          →
                                          p
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          F
                                          ⊩
                                          ◊
                                          □
                                          p
                                          →
                                          □
                                          ◊
                                          p
                                          
                                       
                                       
                                          ⇒
                                          
                                       
                                       
                                          F
                                          ⊩
                                          ⧫
                                          ◊
                                          □
                                          p
                                          →
                                          ◊
                                          p
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          ⇒
                                          
                                       
                                       
                                          F
                                          ⊩
                                          ⧫
                                          ◊
                                          □
                                          ⧫
                                          p
                                          →
                                          ◊
                                          ⧫
                                          p
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          ⇒
                                          
                                       
                                       
                                          F
                                          ⊩
                                          ⧫
                                          ◊
                                          p
                                          →
                                          ◊
                                          ⧫
                                          p
                                          
                                          since
                                          ⊩
                                          p
                                          →
                                          □
                                          ⧫
                                          p
                                       
                                    
                                 
                              
                           
                        
                     

For an arbitrary relation (not necessarily stable) 
                           R
                           ⊆
                           U
                           ×
                           U
                        , the reflexivity of R is equivalent to 
                           I
                           ⊆
                           R
                         where I is the identity relation on U. Now I need not be stable, and the identity for composition of stable relations is the stable relation H. Thus it would be natural to define a stable relation R to be reflexive when 
                           H
                           ⊆
                           R
                        . The following result shows that reflexivity in this sense is exactly the same as ordinary reflexivity. 
                           Lemma 13
                           
                              Let R be a stable relation. Then 
                              
                                 H
                                 ⊆
                                 R
                               
                              iff 
                              
                                 I
                                 ⊆
                                 R
                              
                              .
                           

One direction needs only 
                                 I
                                 ⊆
                                 H
                              . The other direction needs the observation that H is the least stable relation containing I.  □

We can include the frame condition that R is the empty relation, which we denote by 0. The modal correspondent for 
                           R
                           ⊆
                           0
                         does not fit the conditions of Theorem 10, but using Lemma 8 and the facts that for any H-set X, 
                           0
                           ⊖
                           X
                           =
                           U
                         and 
                           X
                           ⊕
                           0
                           =
                           ∅
                         we can argue as follows.
                           
                              
                                 
                                    
                                       
                                          R
                                          ⊆
                                          0
                                          
                                       
                                       
                                          iff
                                          
                                       
                                       
                                          ∀
                                          X
                                          ∈
                                          
                                             H
                                          
                                          -set
                                          
                                          X
                                          ⊕
                                          R
                                          ⊆
                                          X
                                          ⊕
                                          0
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          iff
                                          
                                       
                                       
                                          ∀
                                          X
                                          ∈
                                          
                                             H
                                          
                                          -set
                                          
                                          X
                                          ⊕
                                          R
                                          ⊆
                                          ∅
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          iff
                                          
                                       
                                       
                                          F
                                          ⊩
                                          ⧫
                                          p
                                          →
                                          ⊥
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          iff
                                          
                                       
                                       
                                          F
                                          ⊩
                                          ¬
                                          ⧫
                                          p
                                       
                                    
                                 
                              
                           
                         Similar arguments establish the other cases in this table.
                           
                              
                                 
                                 
                                 
                                 
                                 
                                    
                                       
                                       
                                       Diamonds
                                       Boxes
                                    
                                 
                                 
                                    
                                       
                                          R trivial
                                       
                                          R
                                          ⊆0
                                       ¬⧫p
                                       
                                       □p
                                       
                                    
                                    
                                       ⤻R trivial
                                       ⤻R
                                          ⊆0
                                       ¬◊p
                                       
                                       ■p
                                       
                                    
                                 
                              
                           
                         However, R is trivial iff ⤻R is trivial, so the four formulae above are all frame equivalent.

Although the condition that R is the universal relation is expressible as 
                           U
                           ×
                           U
                           ⊆
                           R
                        , it is known that we cannot express this in any modal formula.

Classically this formula characterizes the frames where R is transitive and where there are no infinite sequences in the direction of R like this:
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                                 
                                    ⟶
                                    R
                                 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 
                                    ⟶
                                    R
                                 
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 
                                    ⟶
                                    R
                                 
                                 
                                    
                                       w
                                    
                                    
                                       3
                                    
                                 
                                 
                                    ⟶
                                    R
                                 
                                 ⋯
                              
                           
                         Blackburn et al. [7] state, p. 186, that the proof of this was first given by van Benthem. The argument given [7, p. 130] can be adapted to the more general case of BISKT, except for the part where the classically equivalent 
                           ◊
                           p
                           →
                           ◊
                           (
                           p
                           ∧
                           −
                           ◊
                           p
                           )
                         formula is used. Since the Löb formula is not equivalent to any first order condition on frames it cannot be handled by Theorem 10. We give an explicit proof here.


                        
                           Theorem 14
                           
                              
                                 F
                                 ⊩
                                 □
                                 (
                                 □
                                 p
                                 →
                                 p
                                 )
                                 →
                                 □
                                 p
                               
                              iff R is transitive and has no infinite forward chains.
                           


                        
                           Proof
                           First we show that if R is transitive and has no infinite forward chains then 
                                 F
                                 ⊩
                                 □
                                 (
                                 □
                                 p
                                 →
                                 p
                                 )
                                 →
                                 □
                                 p
                              . Suppose there is some valuation such that 
                                 □
                                 (
                                 □
                                 p
                                 →
                                 p
                                 )
                                 →
                                 □
                                 p
                               does not hold at w. There must be 
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                               where 
                                 w
                                 H
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                               and 
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                                 ∈
                                 〚
                                 □
                                 (
                                 □
                                 p
                                 →
                                 p
                                 )
                                 〛
                               but 
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                                 ∉
                                 〚
                                 □
                                 p
                                 〛
                              . So there is 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                               where 
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                                 R
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 ∉
                                 〚
                                 p
                                 〛
                              . In addition, 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 ∈
                                 〚
                                 □
                                 p
                                 →
                                 p
                                 〛
                               holds, which implies that for every H-successor of 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                               if p does not hold then □p cannot hold there either. But 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                               is an H-successor of 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                              , so we get 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 ∉
                                 〚
                                 □
                                 p
                                 〛
                              . Hence there must be 
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                               where 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 R
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 ∉
                                 〚
                                 p
                                 〛
                               and where 
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 〚
                                 □
                                 p
                                 →
                                 p
                                 〛
                               since by transitivity 
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                               is an R-successor of 
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                              . We can repeat this argument to construct 
                                 
                                    
                                       w
                                    
                                    
                                       3
                                    
                                 
                               which is an R-successor of 
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                               and so on to produce an infinite forward chain.

To establish the converse, we consider the two cases where (1) R is not transitive and (2) where R is transitive but has an infinite forward chain. In each case we show that 
                                 F
                                 ⊩
                                 □
                                 (
                                 □
                                 p
                                 →
                                 p
                                 )
                                 →
                                 □
                                 p
                               does not hold. If R is not transitive there exist 
                                 x
                                 ,
                                 y
                                 ,
                                 z
                               where xRy and yRz but not xRz. Consider a valuation where 
                                 〚
                                 p
                                 〛
                                 =
                                 H
                                 ⊖
                                 (
                                 U
                                 ∖
                                 {
                                 y
                                 ,
                                 z
                                 }
                                 )
                              . Then 
                                 w
                                 ∈
                                 〚
                                 p
                                 〛
                               iff no H-successor of w lies in 
                                 {
                                 y
                                 ,
                                 z
                                 }
                              , so we have 
                                 x
                                 ∉
                                 〚
                                 □
                                 p
                                 〛
                               and 
                                 y
                                 ∉
                                 〚
                                 p
                                 〛
                              . The next step is to show that 
                                 □
                                 (
                                 □
                                 p
                                 →
                                 p
                                 )
                               holds at x, so suppose that w is any R-successor of x. To establish that 
                                 w
                                 ∈
                                 H
                                 ⊖
                                 (
                                 −
                                 〚
                                 □
                                 p
                                 〛
                                 ∪
                                 〚
                                 p
                                 〛
                                 )
                              , let 
                                 
                                    
                                       w
                                    
                                    
                                       ′
                                    
                                 
                               be any H-successor of w. If 
                                 
                                    
                                       w
                                    
                                    
                                       ′
                                    
                                 
                                 ∉
                                 〚
                                 p
                                 〛
                               then 
                                 
                                    
                                       w
                                    
                                    
                                       ′
                                    
                                 
                                 H
                                 y
                               since 
                                 
                                    
                                       w
                                    
                                    
                                       ′
                                    
                                 
                                 H
                                 z
                               would imply xRz. But this gives 
                                 
                                    
                                       w
                                    
                                    
                                       ′
                                    
                                 
                                 ∉
                                 〚
                                 □
                                 p
                                 〛
                               since 
                                 
                                    
                                       w
                                    
                                    
                                       ′
                                    
                                 
                                 R
                                 z
                               because 
                                 
                                    
                                       w
                                    
                                    
                                       ′
                                    
                                 
                                 H
                                 y
                                 R
                                 z
                              . Hence 
                                 w
                                 ∈
                                 〚
                                 □
                                 p
                                 →
                                 p
                                 〛
                               and 
                                 x
                                 ∈
                                 〚
                                 □
                                 (
                                 □
                                 p
                                 →
                                 p
                                 )
                                 〛
                              . But as 
                                 x
                                 ∉
                                 〚
                                 □
                                 p
                                 〛
                               we get 
                                 x
                                 ∉
                                 〚
                                 □
                                 (
                                 □
                                 p
                                 →
                                 p
                                 )
                                 →
                                 □
                                 p
                                 〛
                              .

Finally we deal with the case where R is transitive but does have an infinite forward chain. Consider a valuation where
                                 
                                    
                                       〚
                                       p
                                       〛
                                       =
                                       U
                                       ∖
                                       {
                                       u
                                       ∈
                                       U
                                       |
                                        there is an infinite chain starting at 
                                       
                                          u
                                       
                                       }
                                       .
                                    
                                 
                               This does make 
                                 〚
                                 p
                                 〛
                               an H-set since if u is not the starting point of an infinite R chain then no H-successor of u can be the starting point of an infinite R chain. With this valuation, 
                                 □
                                 p
                                 →
                                 p
                               holds everywhere because if w is any world with an H successor 
                                 
                                    
                                       w
                                    
                                    
                                       ′
                                    
                                 
                              , then if an infinite chain starts at 
                                 
                                    
                                       w
                                    
                                    
                                       ′
                                    
                                 
                               an infinite chain must start at some R successor of 
                                 
                                    
                                       w
                                    
                                    
                                       ′
                                    
                                 
                              . Let 
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                               be the starting point of an infinite chain. We then have 
                                 □
                                 p
                                 →
                                 p
                               holds at 
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                               but □p does not hold, and hence 
                                 □
                                 (
                                 □
                                 p
                                 →
                                 p
                                 )
                                 →
                                 □
                                 p
                               does not hold at 
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                              .  □

In the context of graphs, a graph consisting only of nodes and not having any edges corresponds to H being the identity relation on U. For applications to mathematical morphology this is the case of sets of pixels rather than graphs.

The logic cannot distinguish between H being an equivalence relation and actually being the identity as there is no way to refer to individual elements of U. However, when H is an equivalence relation the H-sets are exactly the unions of equivalence classes, so taking the quotient of U by H and replacing H by the identity will lose no information.


                        
                           Lemma 15
                           
                              
                                 F
                                 ⊩
                                 ⨼
                                 p
                                 →
                                 ¬
                                 p
                               
                              holds if and only if H is an equivalence relation.
                           


                              
                                 F
                                 ⊩
                                 ⨼
                                 p
                                 →
                                 ¬
                                 p
                               holds if and only if for every valuation 
                                 V
                               we have 
                                 −
                                 
                                    
                                       〚
                                       p
                                       〛
                                    
                                    
                                       V
                                    
                                 
                                 ⊕
                                 H
                                 ⊆
                                 H
                                 ⊖
                                 −
                                 
                                    
                                       〚
                                       p
                                       〛
                                    
                                    
                                       V
                                    
                                 
                              . Now we claim that for any subset 
                                 X
                                 ⊆
                                 U
                               we have 
                                 X
                                 ⊕
                                 H
                                 ⊆
                                 H
                                 ⊖
                                 X
                               if and only if X is an H-set. The proof of the claim follows from 
                                 Y
                                 ⊕
                                 H
                                 ⊆
                                 X
                               if and only if 
                                 Y
                                 ⊆
                                 H
                                 ⊖
                                 X
                               by substituting X for Y in one direction and 
                                 X
                                 ⊕
                                 H
                               for Y in the other. Hence 
                                 F
                                 ⊩
                                 ⨼
                                 p
                                 →
                                 ¬
                                 p
                               if and only if the complement of an H-set is always an H-set. So we need to show that this condition on H-sets is equivalent to H being an equivalence relation. When H is an equivalence relation, the H-sets are unions of equivalence classes so the condition is satisfied. Conversely, suppose the condition holds and that 
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 ∈
                                 H
                               and 
                                 (
                                 v
                                 ,
                                 u
                                 )
                                 ∉
                                 H
                              . Then 
                                 {
                                 v
                                 }
                                 ⊕
                                 H
                               is an H-set not containing u. Thus u belongs to the H-set 
                                 −
                                 (
                                 {
                                 v
                                 }
                                 ⊕
                                 H
                                 )
                              , but, since 
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 ∈
                                 H
                              , any H-set containing u contains v so we get the contradiction that 
                                 v
                                 ∈
                                 −
                                 (
                                 {
                                 v
                                 }
                                 ⊕
                                 H
                                 )
                              . Hence H is symmetric so must be an equivalence relation as it is a pre-order.  □

Because the accessibility relations in the Kripke models of BISKT involve converse relations it is natural to use a semantic tableau method as a deduction method. Semantic tableau methods do not place any limitations on how the proof search can be performed. We use a labelled tableau approach, as this ensures proof confluence, which means that from any point in the search space a proof (that is, a closed tableau) can be constructed for unsatisfiable problems. This means, any (fair) order of rule applications will lead to the construction of a closed tableau in which each branch is closed. This avoids expensive (don't know) non-determinism in the proof search. Because unlabelled tableau calculi are not generally proof confluent, backtracking over the search space may be needed when no suitable rule application strategy is available to avoid this. Confluent proof calculi provide more flexibility in defining search heuristics in an implementation. An additional advantage of labelled tableau calculi is that they can be generated automatically using the framework of Schmidt and Tishkovsky [21]. Moreover, labelled tableau calculi return concrete models for satisfiable formulae and are therefore well-suited for model generation and error diagnosis.

We present a tableau calculus for BISKT as a labelled signed calculus, following a standard approach for tableau calculi for intuitionistic logics. Formulae in the calculus have one of these forms:
                        
                           
                              
                                 ⊥
                                 
                                 
                                 s
                                 :
                                 S
                                 
                                 ϕ
                                 
                                 
                                 H
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 
                                 
                                 R
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 
                                 
                                 s
                                 ≈
                                 t
                                 
                                 
                                 s
                                 ≉
                                 t
                              
                           
                        
                      
                     S denotes a sign (either T or F for true or false), s and t represent worlds in the models constructed by the calculus, and ≈ is the equality symbol. Technically, s and t denote terms in the term algebra freely generated from a finite set of constants and a finite set of unary function symbols 
                        
                           
                              f
                           
                           
                              θ
                           
                        
                     , 
                        
                           
                              g
                           
                           
                              
                                 
                                    θ
                                 
                                 
                                    ′
                                 
                              
                           
                        
                     , 
                        
                           
                              g
                           
                           
                              
                                 
                                    θ
                                 
                                 
                                    ′
                                 
                              
                           
                           
                              ′
                           
                        
                     , which are uniquely associated with subformulae of the input set. Specifically, the 
                        
                           
                              f
                           
                           
                              θ
                           
                        
                      are associated with subformulae involving quantification in their semantic definition (i.e., ¬ϕ, ⨼ϕ, 
                        ϕ
                        →
                        ψ
                     , 
                        ϕ
                        ᚜
                        ψ
                     , □ϕ, ⧫ϕ, ◇ϕ, ■ϕ), and for each subformula 
                        
                           
                              θ
                           
                           
                              ′
                           
                        
                      of the form ◇ϕ or ■ϕ there is a unique function symbols 
                        
                           
                              g
                           
                           
                              
                                 
                                    θ
                                 
                                 
                                    ′
                                 
                              
                           
                        
                      and 
                        
                           
                              g
                           
                           
                              
                                 
                                    θ
                                 
                                 
                                    ′
                                 
                              
                           
                           
                              ′
                           
                        
                     . These symbols are Skolem functions and provide a convenient technical device to generate witnesses for formulae of existential import and storing dependency information.

The semantics of tableau formulae is defined by extended Kripke models. An extended Kripke model is a structure 
                        (
                        M
                        ,
                        ι
                        )
                     , where 
                        M
                        =
                        (
                        F
                        ,
                        V
                        )
                      is a Kripke model as defined in Section 3 (
                        F
                      denotes a BISKT-frame and 
                        V
                      a valuation function) and ι is an assignment mapping terms in the tableau language to worlds in U. Satisfiability of tableau formulae is defined by:
                        
                           
                              
                                 
                                    
                                    
                                       M
                                       ,
                                       ι
                                       ⊮
                                       ⊥
                                    
                                 
                                 
                                    
                                    
                                       M
                                       ,
                                       ι
                                       ⊩
                                       s
                                       :
                                       T
                                       
                                       ϕ
                                    
                                    
                                       
                                    
                                    
                                       iff
                                       
                                       ι
                                       (
                                       s
                                       )
                                       ∈
                                       〚
                                       ϕ
                                       〛
                                    
                                 
                                 
                                    
                                    
                                       M
                                       ,
                                       ι
                                       ⊩
                                       s
                                       :
                                       F
                                       
                                       ϕ
                                    
                                    
                                       
                                    
                                    
                                       iff
                                       
                                       ι
                                       (
                                       s
                                       )
                                       ∉
                                       〚
                                       ϕ
                                       〛
                                    
                                 
                                 
                                    
                                    
                                       M
                                       ,
                                       ι
                                       ⊩
                                       H
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    
                                       
                                    
                                    
                                       iff
                                       
                                       (
                                       ι
                                       (
                                       s
                                       )
                                       ,
                                       ι
                                       (
                                       t
                                       )
                                       )
                                       ∈
                                       H
                                    
                                 
                                 
                                    
                                    
                                       M
                                       ,
                                       ι
                                       ⊩
                                       R
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    
                                       
                                    
                                    
                                       iff
                                       
                                       (
                                       ι
                                       (
                                       s
                                       )
                                       ,
                                       ι
                                       (
                                       t
                                       )
                                       )
                                       ∈
                                       R
                                    
                                 
                                 
                                    
                                    
                                       M
                                       ,
                                       ι
                                       ⊩
                                       s
                                       ≈
                                       t
                                    
                                    
                                       
                                    
                                    
                                       iff
                                       
                                       ι
                                       (
                                       s
                                       )
                                       =
                                       ι
                                       (
                                       t
                                       )
                                    
                                 
                                 
                                    
                                    
                                       M
                                       ,
                                       ι
                                       ⊩
                                       s
                                       ≉
                                       t
                                    
                                    
                                       
                                    
                                    
                                       iff
                                       
                                       ι
                                       (
                                       s
                                       )
                                       ≠
                                       ι
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                        
                     
                  

Let 
                        
                           
                              Tab
                           
                           
                              BISKT
                           
                        
                      be the calculus consisting of the rules given in Fig. 11
                     . The rules are to be applied top–down. Starting with a set of tableau formulae the rules are used to decompose formulae in a goal-directed way. Since some of the rules are branching, the inference process constructs a tree derivation. As soon as a contradiction is derived in a branch (that is, when ⊥ has been derived) the branch is regarded as closed and no more rules are applied to it. If a branch is not closed then it is open. When, in an open branch, no more rules are applicable then the derivation can stop because a model for the input set can be read off from the branch. Then the branch is said to be fully-expanded. We say a tableau derivation is fully-expanded, if all branches are either closed, or open and fully-expanded.

The way to use the tableau calculus is as follows. Suppose we are interested in the validity of a formula ϕ in BISKT. Then the input to the tableau derivation is the set 
                        {
                        a
                        :
                        F
                        ϕ
                        }
                      where a is a constant representing the initial world, and the aim is to find a counter-model for ϕ. If a counter-model is found then ϕ is not valid, on the other hand, if a closed tableau is constructed then ϕ is valid.

The first group of rules in the calculus consists of the closure rule and the decomposition rules of the intuitionistic operators. The main closure rule derives ⊥ when, for a formula ϕ, both 
                        s
                        :
                        T
                        
                        ϕ
                      and 
                        s
                        :
                        F
                        
                        ϕ
                      occur on the current branch. The branch is then closed. The other rules can be thought of as ‘decomposing’ labelled formulae and building an ever growing tree derivation. These inference steps basically follow the semantics of the main logical operator of the formula being decomposed. For example, the rule for positive occurrences of implication extends the current branch with 
                        t
                        :
                        F
                        
                        ϕ
                      and 
                        t
                        :
                        T
                        
                        ψ
                      thereby creating two branches, if formulae of the form 
                        s
                        :
                        T
                        
                        ϕ
                        →
                        ψ
                      and 
                        H
                        (
                        s
                        ,
                        t
                        )
                      belong to the current branch. The rule for negative occurrences of implication extends the current branch with the three formulae 
                        H
                        (
                        s
                        ,
                        
                           
                              f
                           
                           
                              ϕ
                              →
                              ψ
                           
                        
                        (
                        s
                        )
                        )
                     , 
                        
                           
                              f
                           
                           
                              ϕ
                              →
                              ψ
                           
                        
                        (
                        s
                        )
                        :
                        T
                        
                        ϕ
                      and 
                        
                           
                              f
                           
                           
                              ϕ
                              →
                              ψ
                           
                        
                        (
                        s
                        )
                        :
                        F
                        
                        ψ
                     , if the formula 
                        s
                        :
                        F
                        
                        ϕ
                        →
                        ψ
                      occurs on the current branch. The effect is that an H-successor world is created for s and ψ is assigned false in this successor, while ϕ is assigned true.

The rules for the □ and ⧫ operators are signed versions of the standard rules for tense modalities in semantic tableaux for traditional modal logics. The rules for the ◇ and ■ operators are more complicated versions, as they refer to the composite relation 
                        H
                        ;
                        
                           
                              R
                           
                           
                              ˘
                           
                        
                        ;
                        H
                      and its converse.

The third group of rules ensures the models constructed have the required properties. For example, the (refl)-rule ensures all terms (representing worlds) are reflexive in a fully-expanded branch, and the (tr)-rule ensures the H-relation is transitively closed. The rule (mon) accommodates the property that the truth sets form downsets. It is justified since we can show monotonicity for any formula of the logic. The rule (stab) ensures the relation R is stable with respect to H in any generated model.

The rules have been systematically derived from the definition of the semantics of BISKT as given in Section 3. We first expressed the semantics in first-order logic and then converted the formulae to inference rules following the tableau synthesis method described in [21]. The subset of the rules in the calculus 
                        
                           
                              Tab
                           
                           
                              BISKT
                           
                        
                      restricted to the operators and frame conditions relevant to intuitionistic logic coincides with the tableau calculus derived there for intuitionistic logic. We note for the rule refinement step in the synthesis process, atomic rule refinement as introduced in [26] is sufficient. Atomic rule refinement is a specialization of a general rule refinement technique described in [21] with the advantage that it preserves soundness and completeness and is automatic.


                     
                        Theorem 16
                        
                           (i) The tableau calculus 
                           
                              
                                 
                                    Tab
                                 
                                 
                                    
                                       BISKT
                                    
                                 
                              
                            
                           is sound, that is, for a satisfiable set of tableau formulae any fully-expanded tableau derivation has an open fully-expanded branch. (ii) 
                           
                              
                                 
                                    Tab
                                 
                                 
                                    
                                       BISKT
                                    
                                 
                              
                            
                           is also (refutationally) complete, that is, for any unsatisfiable set of tableau formulae there is a closed tableau derivation. Moreover, (iii) the calculus is constructively complete with respect to the semantics of BISKT, which means that for every open fully-expanded branch a model exists that can be read off from the branch.
                        

This follows by the results of the tableau synthesis framework and atomic rule refinement [21,26], as we can show the semantics of BISKT defined in Section 3 is well-defined in the sense of [21].

Enhancing the calculus with the unrestricted blocking mechanism provides an easy way to achieve termination. Compared to other blocking techniques, unrestricted blocking imposes no restrictions and is generic, consequently, it is independent of any logic and can even be used for undecidable logics. Unrestricted blocking has the property that adding it to a sound and complete semantic tableau calculus guarantees termination, provided the logic has the finite model property [20–22].

The main ingredient of the unrestricted blocking mechanism is the following rule.
                        
                           
                              
                                 
                                    Unrestricted blocking rule:
                                 
                                 
                                 (
                                 
                                    ub
                                 
                                 )
                                 
                                 
                                    
                                    
                                       s
                                       ≈
                                       t
                                       |
                                       s
                                       ≉
                                       t
                                    
                                 
                              
                           
                        
                      Since this involves equality ≈, provision needs to be made for equality reasoning. This can be achieved, for example, via the inclusion of these paramodulation rules.
                        
                           
                              
                                 
                                    
                                       s
                                       ≉
                                       s
                                    
                                    ⊥
                                 
                                 
                                 
                                 
                                    
                                       s
                                       ≈
                                       t
                                    
                                    
                                       t
                                       ≈
                                       s
                                    
                                 
                                 
                                 
                                 
                                    
                                       s
                                       ≈
                                       t
                                       ,
                                       
                                       G
                                       
                                          
                                             [
                                             s
                                             ]
                                          
                                          
                                             λ
                                          
                                       
                                    
                                    
                                       G
                                       [
                                       λ
                                       /
                                       t
                                       ]
                                    
                                 
                              
                           
                        
                      Here, G denotes any tableau formula. The notation 
                        G
                        
                           
                              [
                              s
                              ]
                           
                           
                              λ
                           
                        
                      means that s occurs as a subterm at position λ in G, and 
                        G
                        [
                        λ
                        /
                        t
                        ]
                      denotes the formula obtained by replacing s at position λ with t. In MetTeL equality reasoning is provided in the form of ordered rewriting which is more efficient [27].

Unrestricted blocking systematically merges terms (sets them to be equal) in order to find small models if they exists. The intuition of the (ub)-rule is that merging two terms s and t either leads to a model, or it does not, in which case s and t cannot be equal. In order that small models are found, it is crucial that blocking is performed exhaustively before the application of any witness-creating rules. The witness-creating rules are the rules expanding formulae with implicit existential quantification. In our implementation using MetTeL, the (ub)-rule has been given higher priority than all the rules creating new Skolem terms.

By 
                        
                           
                              Tab
                           
                           
                              BISKT
                           
                        
                        (
                        
                           ub
                        
                        )
                      we denote the extension of the calculus 
                        
                           
                              Tab
                           
                           
                              BISKT
                           
                        
                      by the unrestricted blocking mechanism, including some form of reasoning with equality ≈.

Since we proved that BISKT has the effective finite model property (Theorem 7), by the results in [20], the tableau calculus 
                        
                           
                              Tab
                           
                           
                              BISKT
                           
                        
                        (
                        
                           ub
                        
                        )
                      is terminating (that is, any fully-expanded tableau derivation has a finite open branch if the input set is satisfiable). It therefore provides the basis for a decision procedure for BISKT.


                     
                        Theorem 17
                        
                           The tableau calculus 
                           
                              
                                 
                                    Tab
                                 
                                 
                                    
                                       BISKT
                                    
                                 
                              
                              (
                              
                                 ub
                              
                              )
                            
                           is sound, (constructively) complete and terminating for BISKT.
                        

There are various non-trivial and time-consuming obstacles to overcome when implementing a prover from scratch. With the availability of MetTeL, a tool for automatically generating tableau provers, implementing a tableau calculus has become straightforward [27]. The idea is that the user specifies a set of tableau rules as input to the system and it then produces code of a prover for this calculus. An input file with a specification of the rules and the logic is needed. Because MetTeL makes no assumptions about the formal language, both the language of the calculus and the logic itself need to be specified. Any language specifiable in a quantifier-free first-order language with multiple sorts and equality can be defined. Equality is the only interpreted constructor in the MetTeL specification language. It triggers the use of ordered rewriting in the generated provers.

We chose to assign priorities to the rules in order to influence the order in which they are applied. It turned out to be crucial to give lowest priority to the witness-creating rules (the rules for negative negations and implications, positive dual negations and dual implications, and positive diamonds) followed by the blocking rules, so that the creation of new terms and blocking is delayed as much as possible while still ensuring blocking is applied exhaustively before the witness-creating rules, so that termination is not jeopardized. Closure rules have been given highest priority, followed by one premise non-branching rules, two or more premise non-branching rules, and one premise branching rules. It is beneficial to delay the application of the reflexivity rule though.

Quick tests of whether properties we expected to hold are provable turned out to be tremendously helpful. We were able to experiment with several initial versions of the calculus. In combination with the tableau synthesis method, it was easy to experiment with different tableau provers for several preliminary versions of formalizations of bi-intuitionistic tense logics before settling on the definition of BISKT.

MetTeL allowed us to experiment with different variations of the rules, different rule refinements and alternative forms of blocking. The calculus 
                        
                           
                              Tab
                           
                           
                              BISKT
                           
                        
                     , as defined in the previous section, includes this
                        
                           
                              
                                 
                                    General monotonicity rule:
                                 
                                 
                                 (
                                 
                                    mon
                                 
                                 )
                                 
                                 
                                    
                                       s
                                       :
                                       T
                                       
                                       ϕ
                                       ,
                                       
                                       H
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    
                                       t
                                       :
                                       T
                                       
                                       ϕ
                                    
                                 
                              
                           
                        
                      but the
                        
                           
                              
                                 
                                    Atomic monotonicity rule:
                                 
                                 
                                 (
                                 
                                    at-mon
                                 
                                 )
                                 
                                 
                                    
                                       s
                                       :
                                       T
                                       
                                       p
                                       ,
                                       
                                       H
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    
                                       t
                                       :
                                       T
                                       
                                       p
                                    
                                 
                              
                           
                        
                      is sufficient for completeness. The second rule is a refinement of the first rule as it applies the first rule only to propositional formulae.

A natural variation of the (ub) blocking rule is given by these two rules.
                        
                           
                              
                                 
                                    Predecessor blocking rules:
                                 
                                 
                                 
                                    
                                       H
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    
                                       s
                                       ≈
                                       t
                                       |
                                       s
                                       ≉
                                       t
                                    
                                 
                                 
                                 
                                 
                                    
                                       R
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    
                                       s
                                       ≈
                                       t
                                       |
                                       s
                                       ≉
                                       t
                                    
                                 
                              
                           
                        
                      Whereas the (ub)-rule blocks any two distinct terms, these rules restrict blocking to terms connected directly by the H and R relations. Because the calculus 
                        
                           
                              Tab
                           
                           
                              BISKT
                           
                        
                      without blocking is sound and complete and both rules are sound, basing blocking on these rules instead of the (ub)-rule preserves soundness and completeness.

The rules implement a form of predecessor blocking, which is known to give decision procedures for basic multi-modal logics with reflexive and transitive modalities. It is however open whether it provides a decision procedure for BISKT. The presence of converse operators in the logic makes it likely that it is not sufficient to guarantee termination, because for modal and description logics with converse operations dynamic blocking is required [14]. In the performance evaluation, better results were however obtained with these predecessor blocking rules than with unrestricted blocking.

An experimental evaluation was performed with 105 problems on a Linux laptop with a 2.53 GHz Intel Core i5 (M 540) CPU and 8 GB of main memory. The problems included the validities given in Lemma 5, and were created during the investigations for testing purposes: for testing the properties of the operators, for testing the definition of the logic, as well as for testing the specification in MetTeL. As a consequence, the problems were mostly of modest size. The timeout for individual experimental runs with the generated provers was 200 seconds.

The evaluation gave the performance results shown in Table 7
                     . The first column of graphs is the runtime results for the calculus 
                        
                           
                              Tab
                           
                           
                              BISKT
                           
                        
                      with predecessor blocking and the general monotonicity rule (mon); the second column is the results for the calculus with predecessor blocking and the atomic monotonicity rule (at-mon); and the third column is the results for the calculus without blocking. The first row gives the results for all problems including problems where a timeout occurred (which were recorded as the maximum time allowed). The second and third rows give respectively the results for satisfiable problems and unsatisfiable problems that were solved within the timeout. Problems with a timeout are not included in these two rows.

For the prover based on 
                        
                           
                              Tab
                           
                           
                              BISKT
                           
                        
                      with predecessor blocking and general monotonicity (first column), two problems timed out (both with unknown status); with atomic monotonicity (second column), three problems timed out (two with unknown status, one unsatisfiable problem); and for the prover based on 
                        
                           
                              Tab
                           
                           
                              BISKT
                           
                        
                      without blocking (third column), 15 problems timed out (11 satisfiable problems, two unsatisfiable problems, two with unknown status).

The results for the versions with unrestricted blocking were significantly worse than those in these graphs.

Although the problem sample was small, the following findings can be drawn from the results. The best results were obtained for systems with predecessor blocking and either the general monotonicity rule or the atomic monotonicity rule. The difference between these was negligible, even though, for atomic monotonicity, there seemed to be a small speed-up, as the spikes seem generally less long in the middle column of Table 7 than the first column. With general monotonicity, however, one difficult problem was solved that was not solved with atomic monotonicity.

It is not surprising that when no blocking is used fewer satisfiable problems are solved.

For unsatisfiable problems similar numbers of problems were solved but generally lower spikes can be observed. For unsatisfiable problems, no blocking rules are needed, because the calculus 
                        
                           
                              Tab
                           
                           
                              BISKT
                           
                        
                      is complete and constructs a closed tableau even without blocking. Applying blocking is an extra overhead and this explains the better performance. It seems consequently counter-intuitive that not all unsatisfiable problems were solved without blocking. Similar observations were made in experiments with bottom-up model generation methods in a separate study by [5], which uses a similar style of tableau-based deduction and blocking. There it was found that too eager creation of Skolem terms can have a negative impact. This may be a pointer that, with a different selection of formulae for application of the witness-creating rules, better performance could have been obtained. The investigation in Baumgartner and Schmidt [5], and also [19], found however that, for unsatisfiable problems, it is better to use a resolution-based approach.

This reiterates that semantic tableau approaches are well suited for testing satisfiability and constructing models, but for testing unsatisfiability there may be better approaches.

The website http://staff.cs.manchester.ac.uk/~schmidt/publications/biskt13/, created to accompany this paper, gives MetTeL specifications of tableau calculi for BISKT, instructions how to generate the provers, the problem collection, and the performance results.

Propositional bi-intuitionistic logic was studied by Rauszer [16] who referred to it as Heyting–Brouwer (H–B) logic. The co-intuitionistic fragment of H–B logic is one of the propositional paraconsistent logics investigated by Wansing [28], but neither of these papers is concerned with bi-intuitionistic modal logics. The stable relations we use here are already well-known in intuitionistic modal logic [29, p. 219] and they provide a special case of the category-theoretic notion of a distributor [6]. However, as far as we are aware, the left converse operation that we use has not featured in either of these contexts.

Reyes and Zolfaghari [17] present modal operators with semantics in bi-Heyting algebras. Graphs are an important example, as in our work, but the modalities are quite different, arising from iterating alternations of ¬ and ⨼.

Goré et al. [11] studied a bi-intuitionistic modal logic, BiKt, with the same language as BISKT but with a semantics producing no relationship between the box and diamond operators. The four modal operators form two residuated pairs 
                        (
                        □
                        ,
                        ⧫
                        )
                      and 
                        (
                        ■
                        ,
                        ◇
                        )
                      but without any necessary relationship between □ and ◇ or between ■ and ⧫. In our case, the same pairs are residuated (or adjoint) but we have a different semantics for the 
                        (
                        ■
                        ,
                        ◇
                        )
                      pair, and consequently there are relationships between □ and ◇ and between ■ and ⧫.

We next describe the semantics for BiKt [11, p. 26], using our notation and terminology to clarify the connection with BISKT.


                     
                        Definition 12
                        A BiKt Frame, 
                              (
                              U
                              ,
                              H
                              ,
                              R
                              ,
                              S
                              )
                           , consists of a set U, a relation H on U which is reflexive and transitive, and two relations R and S on U that satisfy 
                              R
                              ;
                              H
                              ⊆
                              H
                              ;
                              R
                            and 
                              
                                 
                                    H
                                 
                                 
                                    ˘
                                 
                              
                              ;
                              S
                              ⊆
                              S
                              ;
                              
                                 
                                    H
                                 
                                 
                                    ˘
                                 
                              
                           .

The condition 
                        R
                        ;
                        H
                        ⊆
                        H
                        ;
                        R
                      is strictly more general than 
                        R
                        =
                        H
                        ;
                        R
                        ;
                        H
                     . For example, if 
                        U
                        =
                        {
                        a
                        ,
                        b
                        }
                      and 
                        H
                        =
                        {
                        (
                        a
                        ,
                        a
                        )
                        ,
                        (
                        a
                        ,
                        b
                        )
                        ,
                        (
                        b
                        ,
                        b
                        )
                        }
                      then taking R to be 
                        {
                        (
                        b
                        ,
                        a
                        )
                        ,
                        (
                        b
                        ,
                        b
                        )
                        }
                      we find that 
                        R
                        ;
                        H
                        ⊆
                        H
                        ;
                        R
                      holds but not 
                        R
                        =
                        H
                        ;
                        R
                        ;
                        H
                     . However, we see shortly that this additional generality is not essential. The semantics interprets formulae by H-sets and the modalities are defined as follows.
                        
                           
                              
                                 
                                    
                                       〚
                                       ◇
                                       ϕ
                                       〛
                                    
                                    
                                       =
                                       〚
                                       ϕ
                                       〛
                                       ⊕
                                       
                                          
                                             S
                                          
                                          
                                             ˘
                                          
                                       
                                    
                                    
                                       
                                       〚
                                       □
                                       ϕ
                                       〛
                                    
                                    
                                       =
                                       (
                                       H
                                       ;
                                       R
                                       )
                                       ⊖
                                       〚
                                       ϕ
                                       〛
                                    
                                 
                                 
                                    
                                       〚
                                       ⧫
                                       ϕ
                                       〛
                                    
                                    
                                       =
                                       〚
                                       ϕ
                                       〛
                                       ⊕
                                       R
                                    
                                    
                                       
                                       〚
                                       ■
                                       ϕ
                                       〛
                                    
                                    
                                       =
                                       (
                                       H
                                       ;
                                       
                                          
                                             S
                                          
                                          
                                             ˘
                                          
                                       
                                       )
                                       ⊖
                                       〚
                                       ϕ
                                       〛
                                    
                                 
                              
                           
                        
                      Since 
                        〚
                        ϕ
                        〛
                      is an H-set, 
                        〚
                        ϕ
                        〛
                        ⊕
                        
                           
                              S
                           
                           
                              ˘
                           
                        
                        =
                        〚
                        ϕ
                        〛
                        ⊕
                        (
                        H
                        ;
                        
                           
                              S
                           
                           
                              ˘
                           
                        
                        )
                      and 
                        〚
                        ϕ
                        〛
                        ⊕
                        R
                        =
                        〚
                        ϕ
                        〛
                        ⊕
                        (
                        H
                        ;
                        R
                        )
                     . Thus the only accessibility relations needed in the semantics are 
                        
                           
                              R
                           
                           
                              ′
                           
                        
                        =
                        H
                        ;
                        R
                      and 
                        
                           
                              S
                           
                           
                              ′
                           
                        
                        =
                        H
                        ;
                        
                           
                              S
                           
                           
                              ˘
                           
                        
                     . The following lemma shows that the constraints on R and S are equivalent to 
                        
                           
                              R
                           
                           
                              ′
                           
                        
                      and 
                        
                           
                              S
                           
                           
                              ′
                           
                        
                      being stable with respect to H. 
                        Lemma 18
                        
                           Let U be any set, let H be any pre-order on U, and let S be any binary relation on U. Then the following are equivalent.
                           
                              
                                 1.
                                 
                                    
                                       S
                                       =
                                       H
                                       ;
                                       S
                                       ;
                                       H
                                    
                                    .
                                 


                                    There is some relation 
                                    
                                       R
                                       ⊆
                                       U
                                       ×
                                       U
                                     
                                    such that 
                                    
                                       S
                                       =
                                       H
                                       ;
                                       R
                                     
                                    and 
                                    
                                       R
                                       ;
                                       H
                                       ⊆
                                       H
                                       ;
                                       R
                                    
                                    .
                                 

Thus we can rephrase the semantics in [11] (p. 26) as
                        
                           1.
                           A frame 
                                 〈
                                 U
                                 ,
                                 H
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       ′
                                    
                                 
                                 〉
                               consists of a set U, a pre-order H on U, and two stable relations 
                                 
                                    
                                       R
                                    
                                    
                                       ′
                                    
                                 
                               and 
                                 
                                    
                                       S
                                    
                                    
                                       ′
                                    
                                 
                               on U. A valuation assigns an H-set to each propositional variable, and the connectives are interpreted as for BISKT.

The semantics of the modal operators is:
                                 
                                    
                                       
                                          
                                             
                                                〚
                                                ◇
                                                ϕ
                                                〛
                                             
                                             
                                                =
                                                〚
                                                ϕ
                                                〛
                                                ⊕
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                
                                                〚
                                                □
                                                ϕ
                                                〛
                                             
                                             
                                                =
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ⊖
                                                〚
                                                ϕ
                                                〛
                                             
                                          
                                          
                                             
                                                〚
                                                ⧫
                                                ϕ
                                                〛
                                             
                                             
                                                =
                                                〚
                                                ϕ
                                                〛
                                                ⊕
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                
                                                〚
                                                ■
                                                ϕ
                                                〛
                                             
                                             
                                                =
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ⊖
                                                〚
                                                ϕ
                                                〛
                                             
                                          
                                       
                                    
                                 
                              
                           

@&#CONCLUSION@&#

Motivated by the theory of relations on graphs and applications to spatial reasoning, we have presented a bi-intuitionistic logic BISKT with modal tense operators. The need to interact with a graph structure, and more generally with a pre-order, means that the accessibility relations are stable. The stability condition itself is not novel, but stable relations are not closed under the usual converse operation and our work is the first to show that the weaker left converse, which does respect stability, can be used to define semantics for modalities.

In contrast to other intuitionistic and bi-intuitionistic tense logics where all the modal operators are independent of each other, in BISKT the white diamond can be defined in terms of the white box, although there is apparently no way of defining the white box in terms of the white diamond. Dually the black box can be defined from the black diamond, also by using a pairing of intuitionistic negation and dual intuitionistic negation. We have shown that BISKT is decidable and has the effective finite model property, and have given a tight complexity result.

A general method for establishing correspondence results for frame conditions expressible as inclusions between stable relations is presented. One example of a frame condition which is not of this form is the condition corresponding to the Löb formula. We have shown how the classical correspondence result for the Löb formula can be extended to the more general setting of BISKT.

We have presented a tableau calculus for BISKT, which was shown to be sound, complete and terminating. This was obtained and refined using the tableau synthesis methodology and refinement techniques of Schmidt and Tishkovsky [21,26]. In exploring the properties of BISKT, we made essential use of tableau systems generated using the MetTeL tool. The evaluation has shown that predecessor blocking gives good performance for satisfiable problems.

The interpretation of BISKT in modal logic provides another route to realize tableau-based reasoning for BISKT. Preliminary experiments with a tableau approach for 
                        
                           Kt
                        
                        (
                        H
                        ,
                        R
                        )
                      have however not produced better results than those reported in this paper. While a deeper analysis and more experiments are needed, we attribute this to the rules of 
                        
                           
                              Tab
                           
                           
                              BISKT
                           
                        
                      being more tailor-made because stronger rule refinement is possible for the inferences rules derived from the semantics of BISKT.

Other future work includes extending BISKT with modalities based on the right converse operator.

@&#ACKNOWLEDGEMENTS@&#

We thank the reviewers for very useful comments. This research was supported by UK EPSRC research grant EP/H043748/1.

@&#REFERENCES@&#

