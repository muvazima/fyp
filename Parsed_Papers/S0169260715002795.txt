@&#MAIN-TITLE@&#Stenosis map for volume visualization of constricted tubular structures: Application to coronary artery stenosis

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A new 3D spatial field for visualizing constricted tubular structures is proposed.


                        
                        
                           
                           Constrictions are quantified by new measures using the localized structure analysis.


                        
                        
                           
                           A new transfer function maps the degree of constriction to color and opacity.


                        
                        
                           
                           Our method provides intuitive adjustment of the visual appearance of constrictions.


                        
                        
                           
                           Our method can be applied to various constrictions with relevant parameters.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Volume rendering

Transfer function

Tubular structure

Constriction

Coronary artery stenosis

@&#ABSTRACT@&#


               
               
                  Although direct volume rendering (DVR) has become a commodity, effective rendering of interesting features is still a challenge. In one of active DVR application fields, the medicine, radiologists have used DVR for the diagnosis of lesions or diseases that should be visualized distinguishably from other surrounding anatomical structures. One of most frequent and important radiologic tasks is the detection of lesions, usually constrictions, in complex tubular structures. In this paper, we propose a 3D spatial field for the effective visualization of constricted tubular structures, called as a stenosis map which stores the degree of constriction at each voxel. Constrictions within tubular structures are quantified by using newly proposed measures (i.e. line similarity measure and constriction measure) based on the localized structure analysis, and classified with a proposed transfer function mapping the degree of constriction to color and opacity. We show the application results of our method to the visualization of coronary artery stenoses. We present performance evaluations using twenty eight clinical datasets, demonstrating high accuracy and efficacy of our proposed method. The ability of our method to saliently visualize the constrictions within tubular structures and interactively adjust the visual appearance of the constrictions proves to deliver a substantial aid in radiologic practice.
               
            

@&#INTRODUCTION@&#

Direct volume rendering (DVR) visualizes 3D volumetric data using a transfer function which maps voxel values to colors and opacities. One of the main challenges of DVR is the rendering of interested features with sufficient saliency so that they are visually distinguished from other structures [1,2]. As a solution to this challenge, first- (e.g. gradient) and second-order derivatives (e.g. curvature) of the volume data have been used to improve data classification [3–6]. Spatial characteristics (e.g. textural properties and size) around a voxel have also been proposed [2,7].

Among its various applied fields, DVR has been most widely used in medicine, especially in radiology. In medical applications, DVR is used for the generation of cognitive three-dimensional image from overwhelming 3D volumetric data from modern scanners (e.g. CT, MRI, and 3D tomosynthesis). Under the time pressure of clinical situation requiring prompt and important clinical decision, radiologists want 3D renderings wherein lesions of their interest are visualized distinguishably from other anatomical structures.

Of diverse diagnostic tasks in radiology, the detection of constricted regions in complex tubular structures (e.g. coronary artery stenosis in coronary artery, intra-thoracic airway constriction, carotid artery stenosis, and intestinal obstruction) is one of most frequent and important diagnostic tasks. However, the aforementioned first- and second-order derivatives or spatial characteristics are not so successful to classify constrictions within tubular structures. In this paper, we propose a new spatial field that can deliver a new dimension for salient visualization of constrictions within tubular structures, called as a stenosis map.

In diagnosing various diseases regarding constricted tubular structures in radiologic diagnoses, early detection of coronary artery disease (CAD) is very important because it is known to be the most common cause of death in the world [8]. Traditionally, invasive coronary artery (ICA) has been considered as gold standard for assessing CAD. However, ICA is an invasive technique and did not provide the information of the plaque because it is just luminogram. Recently, coronary computed tomography angiography (CCTA) has been widely adopted to non-invasively diagnose CAD with high diagnostic accuracy. In particular, CCTA has been reported to be useful for rapid detection of CAD in patients with acute chest pain in an emergency situation [9,10]. However, the interpretation of CCTA requires substantial clinical expertise and experience [11]: it could take about several hours for a physician without experience of cardiac imaging to detect stenosis manually in a CCTA dataset, which may be unacceptable in the emergency situation [12]. Therefore, an imaging system that visualizes the constricted regions (i.e. stenosis) saliently can be a very helpful volume navigation tool in the CAD diagnostic procedure.

In this paper, we propose a 3D spatial field for effective classification of constricted tubular structures, called as a stenosis map. For ease of explanation, we describe the proposed approach with an exemplary application to coronary artery stenoses; but, this approach can be directly applied to other constricted tubular structures only with relevant parameter exploration. First, we detect tubular structures by using a newly proposed similarity measure to line (i.e. line similarity). And then we quantify constrictions within the previously detected tubular structures by using a newly proposed constriction measure. As a result, we obtain a spatial field of stenosis map, of which each voxel has a scalar value of its corresponding degree of constriction. Finally, the stenosis map is used in data classification in a way that the degree of constriction in the stenosis map is mapped to color and opacity. Such stenosis-based classification enables easy and intuitive adjustment of the visual appearance of constrictions within tubular structures.

The remainder of this paper is organized as follows. In the next section, we review previous researches. Section 3 introduces the analysis of localized structure, which is used to generate the stenosis map. The proposed method for the stenosis map computation and the stenosis-based classification and its implementation are described in Sections 4, 5, and 6, respectively. Section 7 presents experimental results using clinical datasets, followed by conclusion in Section 8.

@&#RELATED WORK@&#

DVR has been widely used for the visualization of volumetric data from CT or magnetic resonance imaging scanner in medicine. Although DVR has become a commodity, the design of transfer function is still a challenge. A 1D transfer function based on scalar data values is the most commonly used one. For more accurate classification, higher dimensional transfer functions were proposed [3–6] based on first- (e.g. gradient) [3,4] and second-order derivatives (e.g. curvature) [5,6]. However, as the dimension of transfer function increases, the specification of transfer function becomes more difficult. To resolve this problem, Kniss et al. [1] introduced a set of direct manipulation tools with interactions in volume data space and transfer function space. Tzeng et al. [13] provided a painting user interface that is used to automatically define high-dimensional classification functions. Roettger et al. [14] presented a method that groups spatially connected regions in the 2D histogram used for classification. Some approaches used spatial characteristics around a voxel instead of voxel's properties (e.g. intensity, gradient, and curvature) [2,7]. Caban and Rheingans [7] used textural properties to differentiate materials, and Correa and Ma [2] proposed size-based transfer functions that mapped the relative size of features to color and opacity. As discussed before, all those previous methods might not be successful in visualizing constricted tubular structures while inner constrictions are being distinguished from tubular structures.

There have been many approaches in the image segmentation field that tried to detect coronary artery stenosis automatically or semi-automatically. They can be categorized into two groups: feature- and segmentation-based methods. Feature-based methods detect stenoses using features computed along the centerline of a vessel [15,16]. Mittal et al. [15] designed a cylindrical sampling pattern with its axis aligned to the centerline of coronary artery and used rotation invariant features about this axis. Teßmann et al. [16] used intensity variance, entropy, and Haar-like features. These methods [15,16] used supervised schemes so that it is laborious to collect manually labeled data for all types of lesions. Segmentation-based methods detect stenoses by estimating a vessel diameter after lumen segmentation [17–19]. Wesarg et al. [17] proposed a tracking-based segmentation by iterative prediction and correction steps. However, this method required substantial user involvement. Saur et al. [18] employed a rule-based technique involving the extraction and registration of lesion candidates in both contrast-enhanced and non-contrast-enhanced CT images. Xu et al. [19] proposed a fuzzy segmentation method in which each voxel has the probability to belong to a target object. These segmentation-based methods [17–19] are highly dependent on the result of lumen segmentation. Unlike these previous methods [15–19] that usually require laborious manual data classification [15,16], or a lot of manual interactions [17–19], we analyze the localized structure for the efficient and accurate detection of coronary arteries and inner stenoses.

To classify the constrictions within tubular structures, we use local structural features in this paper. Let I(x) denote the density value at a point x
                     =(x
                     0, x
                     1, x
                     2) in input volume data. The local structure of I(x) in a neighborhood of x can be approximated by the Taylor expansion [20].
                        
                           (1)
                           
                              
                                 I
                                 (
                                 x
                                 +
                                 
                                    Δ
                                 
                                 x
                                 )
                                 =
                                 I
                                 (
                                 x
                                 )
                                 +
                                 
                                    Δ
                                 
                                 
                                    x
                                    T
                                 
                                 ∇
                                 I
                                 (
                                 x
                                 )
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    Δ
                                 
                                 
                                    x
                                    T
                                 
                                 H
                                 (
                                 x
                                 )
                                 
                                    Δ
                                 
                                 x
                                 ,
                              
                           
                        
                     where ∇I is the gradient vector and H(x) denotes the Hessian matrix, which is a matrix built of the second partial derivatives of I(x) as follows:
                        
                           (2)
                           
                              
                                 H
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         I
                                                      
                                                      
                                                         ∂
                                                         
                                                            x
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         I
                                                      
                                                      
                                                         ∂
                                                         x
                                                         ∂
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         I
                                                      
                                                      
                                                         ∂
                                                         x
                                                         ∂
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         I
                                                      
                                                      
                                                         ∂
                                                         y
                                                         ∂
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         I
                                                      
                                                      
                                                         ∂
                                                         
                                                            y
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         I
                                                      
                                                      
                                                         ∂
                                                         y
                                                         ∂
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         I
                                                      
                                                      
                                                         ∂
                                                         z
                                                         ∂
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         I
                                                      
                                                      
                                                         ∂
                                                         z
                                                         ∂
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         I
                                                      
                                                      
                                                         ∂
                                                         
                                                            z
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

At each voxel position x, we calculate the second derivatives and construct the Hessian matrix. By the eigenvalue decomposition of the Hessian matrix, we obtain three eigenvalues, λ
                     1, λ
                     2, and λ
                     3 (λ
                     1
                     ≥
                     λ
                     2
                     ≥
                     λ
                     3) and their corresponding eigenvectors, e
                     1, e
                     2, and e
                     3. The combination of these three eigenvalues, called as eigenvalue signature, characterizes the local morphologic structure of an object. Sheet, line, and blob structures can be classified using the conditions summarized in Table 1
                     , assuming that bright structures exist in a dark background [21]. Measurements of similarity to a specific localized structure can be derived from these basic conditions. Specially, this localized structure analysis has been successfully applied to detect tubular structures (e.g. vascular trees [22–24], or airway trees [25]).

In practice, the second derivatives are calculated after applying the Gaussian filter to input volume data. The Gaussian filter is specified by its standard deviation, called as Gaussian scale, and the Gaussian scale can be fixed for the detection of single-scale objects or ranged for the detection of multiple-scale objects. For the accurate localized structure analysis based on the Hessian matrix, it is important to use an optimal Gaussian scale at the stage of Gaussian prefiltering. The optimal value of Gaussian scale for a target object with a diameter d is proven to be d/4 [26]. Using this optimal Gaussian scale, the proposed method performs two steps of localized structure analysis targeting two different objects of a tubular structure and inner constrictions. Each analysis uses the optimal Gaussian scale corresponding to its target object.

The first step for classifying constricted tubular structures is the estimation of input volume data to encode the degree of constriction, resulting in the stenosis map. In the stenosis map, each voxel has a scalar value of its corresponding degree of constriction, understood as how constricted it is relative to surrounding tubular structures. The process of computing the stenosis map consists of the following two procedures. First, tubular structures are detected, which serve as the search space of the subsequent stenosis map computation. Second, from the previously detected tubular structures, inner constricted regions are detected, and their degrees of constriction are calculated, resulting in the stenosis map.

Interesting tubular structures in medicine, such as the vascular system, are typically small and tortuous and become gradually narrower as they go, covering only a few voxels in the distal part in CT or MR images. In addition, their neighboring structures often have similar intensity with them, making it more difficult to detect (or segment) tubular structures (e.g. aorta and heart chambers neighboring coronary arteries in CCTA).

Now, we elaborate on the computation of the stenosis map with exemplary application to coronary artery stenosis; however, its application to other tubular structures is straightforward with easy-to-follow parameter exploration (detailed in Section 7.5). Coronary artery stenoses (i.e. constrictions) within coronary arteries (i.e. tubular structures) are classified by the degree of blockage caused by coronary artery plaques including non-calcified, calcified, and mixed plaques. In CCTA, calcified plaques appear as small and bright regions, non-calcified plaques have low contrast, and mixed plaques literally have mixed texture of calcified and non-calcified plaques [15]. Because of such visual difference of these three plaques, it is elusive to detect various kinds of stenoses simultaneously. Such heterogeneous constrictions are not rare in medicine, making the radiologic diagnosis more difficult.

Prior to detecting coronary artery stenoses, we first find tubular structures of coronary arteries to restrict the search space of the subsequent constriction detection step. This search space restriction reduces false positive and improves accuracy in the constriction detection step. The tubular structures of coronary arteries are detected by using a similarity measure derived from the Hessian matrix.

As discussed before, the optimal Gaussian scale selection in the Gaussian prefiltering is important in the localized structure analysis based on the Hessian matrix. In this study, we use the mean diameter of the coronary artery when determining the optimal Gaussian scale for the coronary artery detection. The mean diameter of the coronary artery is calculated from the coronary angiography procedure that quantitatively measures coronary artery dimensions [27] (see Table 2
                        ). The severity of stenosis is assessed by the percentage of obstruction in the lumen diameter; a normal vessel is 0% stenosis. To differentiate the coronary artery stenosis with ≥20% obstruction in CCTA, the isotropic spatial resolution of CT should be at least 0.3mm [28]. Considering the anatomical information about the coronary artery [27,28], the diameter of a coronary artery is about 9–15 voxels in coronary CT data with a spatial resolution of 0.3mm. Therefore, the optimal Gaussian scale for the coronary artery is set to be less than 3.75 (=15/4). For the application to other tubular structures, the diameter for the given tubular structures can be used.

After the Gaussian prefiltering, the tubular structures of coronary arteries are detected by a proposed similarity measure to line. At each voxel position, we calculate a similarity measure to line SM
                        
                           line
                        , called as line similarity, given by:
                           
                              (3)
                              
                                 
                                    S
                                    
                                       M
                                       
                                          l
                                          i
                                          n
                                          e
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         
                                                            if
                                                             
                                                            
                                                               λ
                                                               3
                                                            
                                                            ≤
                                                            
                                                               λ
                                                               2
                                                            
                                                            ≤
                                                            
                                                               λ
                                                               1
                                                            
                                                            <
                                                            0
                                                             
                                                            and
                                                         
                                                      
                                                      
                                                         
                                                             
                                                             
                                                            
                                                               R
                                                               
                                                                  b
                                                                  l
                                                                  o
                                                                  b
                                                               
                                                            
                                                            <
                                                            
                                                               T
                                                               
                                                                  b
                                                                  l
                                                                  o
                                                                  b
                                                               
                                                            
                                                             
                                                            and
                                                         
                                                      
                                                      
                                                         
                                                             
                                                             
                                                            
                                                               R
                                                               
                                                                  s
                                                                  h
                                                                  e
                                                                  e
                                                                  t
                                                               
                                                            
                                                            <
                                                            
                                                               T
                                                               
                                                                  s
                                                                  h
                                                                  e
                                                                  e
                                                                  t
                                                               
                                                            
                                                             
                                                            and
                                                         
                                                      
                                                      
                                                         
                                                             
                                                             
                                                            
                                                               R
                                                               
                                                                  n
                                                                  o
                                                                  i
                                                                  s
                                                                  e
                                                               
                                                            
                                                            <
                                                            
                                                               T
                                                               
                                                                  n
                                                                  o
                                                                  i
                                                                  s
                                                                  e
                                                               
                                                            
                                                             
                                                            and
                                                         
                                                      
                                                      
                                                         
                                                             
                                                             
                                                            
                                                               G
                                                               
                                                                  
                                                                     λ
                                                                     1
                                                                  
                                                               
                                                            
                                                            <
                                                            
                                                               T
                                                               G
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where
                           
                              (4)
                              
                                 
                                    
                                       R
                                       
                                          b
                                          l
                                          o
                                          b
                                       
                                    
                                    =
                                    
                                       
                                          |
                                          
                                             λ
                                             1
                                          
                                          |
                                       
                                       
                                          
                                             
                                                |
                                                
                                                   λ
                                                   2
                                                
                                                
                                                   λ
                                                   3
                                                
                                                |
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       R
                                       
                                          s
                                          h
                                          e
                                          e
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          |
                                          
                                             λ
                                             2
                                          
                                          |
                                       
                                       
                                          |
                                          
                                             λ
                                             3
                                          
                                          |
                                       
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       R
                                       
                                          n
                                          o
                                          i
                                          s
                                          e
                                       
                                    
                                    =
                                    
                                       
                                          
                                             λ
                                             1
                                             2
                                          
                                          +
                                          
                                             λ
                                             2
                                             2
                                          
                                          +
                                          
                                             λ
                                             3
                                             2
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

The line similarity involves three measures, R
                        
                           blob
                        , R
                        
                           sheet
                        , and R
                        
                           noise
                         of Frangi et al. [29]. R
                        
                           blob
                         detects blob-like structure: it reaches its maximum value for a blob-like structure and is close to zero for line-like structure (λ
                        1
                        ≈0) or sheet-like structure (λ
                        2
                        ≈
                        λ
                        1
                        ≈0). R
                        
                           sheet
                         distinguishes between line- and sheet-like structures: when |λ
                        3|≫|λ
                        2|≈0 (R
                        
                           sheet
                         being smaller), the structure is more likely to be sheet-like rather than line-like. R
                        
                           noise
                         minimizes the influence of image noise: it gets small in the background where there is no structure; and it gets great in high-contrast regions when at least one of the eigenvalues is large. To detect coronary arteries having all types of plaques, the thresholds, T
                        
                           blob
                        , T
                        
                           sheet
                        , and T
                        
                           noise
                         are experimentally determined to be 0.35, 0.25, and 0.0035, respectively. Fig. 1
                         shows that the line similarity in (3) works well enough to restrict the search space of the subsequent constriction detection step.

In contrasted CT data for specific legions examination in tubular structures, the narrow linear region within the contrasted tubular structures has a high value of line similarity. However, the blob boundary also exhibits high line similarity, being falsely detected as a line. It is because the blob boundary, blurred by Gaussian prefiltering, is not regarded as a part of blob but as a line. To discriminate this, we analyze eigenvalue profiles along a line across the narrow linear and blob boundary regions (see Fig. 2
                        ). The narrow linear region has a high rate of change in λ
                        2 and λ
                        3 but a low rate of change in λ
                        1. In contrast, the blob boundary region has a high rate of change in all three eigenvalues. Therefore, we use the rate of change in λ
                        1 for discriminating these two regions: low (or high) change rate in λ
                        1 indicates the narrow linear region (or the blob boundary region). Thus, the regions with higher eigenvalue gradients, regarded as the blob boundary, are excluded from the coronary artery (see (3), where the regions with eigenvalue gradient magnitude 
                           
                              
                                 G
                                 
                                    
                                       λ
                                       1
                                    
                                 
                              
                           
                         lower than the optimal threshold T
                        
                           G
                         are regarded as a line). Figs. 3 and 4
                        
                         show that the eigenvalue gradient magnitude successfully discriminates the blob boundary regions from areas with high line similarity: the blob boundary falsely detected as a line in Fig. 3(c) (see the green regions in the left blob) and Fig. 4(a) (see the blue regions in the aorta) disappears in Figs. 3(d) and 4(b).

From the previously detected tubular structures (i.e. detected as a line), inner constricted regions (i.e. coronary artery stenosis) are detected. Constrictions are detected by using a constriction measure that is also derived from the Hessian matrix. In a similar manner as in the selection of optimal Gaussian scale for the coronary artery, we determine the optimal Gaussian scale for the stenosis. The severity of stenosis is assessed by the percentage of obstruction in the lumen diameter. The degree of stenosis severity – insignificant (<50%) and significant (≥50%) – determines the treatment of CAD [30]. As mentioned in Section 4.1, the diameter of the coronary artery is about 9–15 voxels in coronary CT data with a spatial resolution of 0.3mm. Significant stenoses are with at least 50% obstruction in the lumen diameter, and thus, the lumen with significant stenoses occupies at most 7.5 voxels (=15 voxels×50%). Therefore, we set the optimal Gaussian scale for the stenosis to be less than 1.875 (=7.5/4). For the application to other kinds of constrictions, relevant constriction threshold (e.g. 50% obstruction in CCTA) can be used.

For accurate detection of constrictions (i.e. stenosis) within the tubular structures (i.e. coronary arteries), we devise a constriction measure that quantifies how constricted compared to surrounding tubular structures. This constriction measure is applied only to the previously detected tubular structures. The stenosis is represented as a morphologically narrowed line. As described in Table 1, a line can be classified by λ
                        3
                        ≃
                        λ
                        2
                        ≪
                        λ
                        1
                        ≃0. As a structure becomes less likely to be a line, |λ
                        2|/|λ
                        3| decreases with negative λ
                        2 and λ
                        3. And as a line is getting morphologically narrowed, λ
                        1 increases and has a positive value [21]. Thus, the structure with λ
                        1
                        ≈0 is regarded as a normal line rather than a morphologically narrowed line. Considering all these conditions, we propose the constriction measure M
                        
                           constrict
                         as follows:
                           
                              (7)
                              
                                 
                                    
                                       M
                                       
                                          c
                                          o
                                          n
                                          s
                                          t
                                          r
                                          i
                                          c
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                         L
                                                      
                                                      ⋅
                                                      
                                                         F
                                                         N
                                                      
                                                   
                                                
                                                
                                                   
                                                      if
                                                       
                                                      
                                                         λ
                                                         1
                                                      
                                                      >
                                                      0
                                                       
                                                      and
                                                       
                                                      
                                                         λ
                                                         3
                                                      
                                                      ≤
                                                      
                                                         λ
                                                         2
                                                      
                                                      <
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        where
                           
                              (8)
                              
                                 
                                    
                                       F
                                       L
                                    
                                    =
                                    exp
                                    
                                       
                                          −
                                          
                                             
                                                
                                                   
                                                      (
                                                      1
                                                      −
                                                      |
                                                      
                                                         λ
                                                         2
                                                      
                                                      |
                                                      /
                                                      |
                                                      
                                                         λ
                                                         3
                                                      
                                                      |
                                                      )
                                                   
                                                   2
                                                
                                             
                                             
                                                2
                                                
                                                   α
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       F
                                       N
                                    
                                    =
                                    exp
                                    
                                       
                                          −
                                          
                                             
                                                
                                                   
                                                      (
                                                      1
                                                      −
                                                      |
                                                      
                                                         λ
                                                         1
                                                      
                                                      |
                                                      )
                                                   
                                                   2
                                                
                                             
                                             
                                                2
                                                
                                                   β
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     


                        Fig. 5
                         shows that the constriction measure in (7) quantifies the morphologically narrowed line well: constricted regions are detected and quantified by the proposed constriction measure, having scalar values of corresponding degree of constriction. The parameters α and β are experimentally set to be 0.115 and 0.185, respectively. As a result, we obtain the stenosis map in which each voxel has a scalar value (ranging from 0.0 to 1.0) of its corresponding degree of constriction M
                        
                           constrict
                        .

With the stenosis map, we have obtained the necessary information to apply a stenosis-based transfer function. Among various DVR techniques, we employ a ray-casting DVR wherein a ray casted from an image plane traverses the volume data while sampling the intensity at a uniform (or non-uniform [31]) interval and compositing colors and opacities evaluated by a transfer function. At each sampling position P
                     
                        i
                      along a viewing ray, the color c
                     
                        i
                      and opacity α
                     
                        i
                      are computed as follows [32]:
                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          c
                                          i
                                       
                                       =
                                       
                                          c
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       +
                                       (
                                       1
                                       −
                                       
                                          α
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       )
                                       ⋅
                                       
                                          α
                                          
                                             
                                                P
                                                i
                                             
                                          
                                       
                                       ⋅
                                       
                                          c
                                          
                                             
                                                P
                                                i
                                             
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          α
                                          i
                                       
                                       =
                                       
                                          α
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       +
                                       (
                                       1
                                       −
                                       
                                          α
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       )
                                       ⋅
                                       
                                          α
                                          
                                             
                                                P
                                                i
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                        
                     where c
                     
                        i−1 and α
                     
                        i−1 are the previously accumulated color and opacity, respectively. 
                        
                           
                              c
                              
                                 
                                    P
                                    i
                                 
                              
                           
                        
                      and 
                        
                           
                              α
                              
                                 
                                    P
                                    i
                                 
                              
                           
                        
                      are the color and opacity contributions at the position P
                     
                        i
                     , which are defined as follows:
                        
                           (11)
                           
                              
                                 
                                    
                                       
                                          c
                                          
                                             
                                                P
                                                i
                                             
                                          
                                       
                                       =
                                       T
                                       
                                          F
                                          c
                                       
                                       (
                                       
                                          f
                                          
                                             
                                                P
                                                i
                                             
                                          
                                       
                                       )
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          α
                                          
                                             
                                                P
                                                i
                                             
                                          
                                       
                                       =
                                       T
                                       
                                          F
                                          α
                                       
                                       (
                                       
                                          f
                                          
                                             
                                                P
                                                i
                                             
                                          
                                       
                                       )
                                       ,
                                    
                                 
                              
                           
                        
                     where TF
                     
                        c
                      and TF
                     
                        α
                      are transfer functions which assign color and opacity to the scalar value 
                        
                           
                              f
                              
                                 
                                    P
                                    i
                                 
                              
                           
                        
                      at each position P
                     
                        i
                     , respectively.

The stenosis map is rendered simultaneously with the input volume data by using multi-volume DVR. While a ray traverses both volume datasets simultaneously, it samples the intensity from the input volume data and the degree of constriction from the stenosis map at a uniform interval. And it accumulates the color and opacity that can be evaluated using a transfer function proposed in (12) and (13).

To visualize the constrictions saliently, we propose a transfer function that reflects the degree of constriction to color:
                        
                           (12)
                           
                              
                                 
                                    c
                                    
                                       
                                          P
                                          i
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                      
                                                         c
                                                         o
                                                         n
                                                         s
                                                         t
                                                         r
                                                         i
                                                         c
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   if
                                                    
                                                   
                                                      S
                                                      
                                                         m
                                                         a
                                                         p
                                                      
                                                   
                                                   (
                                                   
                                                      P
                                                      i
                                                   
                                                   )
                                                   >
                                                   
                                                      T
                                                      
                                                         c
                                                         o
                                                         n
                                                         s
                                                         t
                                                         r
                                                         i
                                                         c
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   T
                                                   
                                                      F
                                                      c
                                                   
                                                   (
                                                   
                                                      f
                                                      
                                                         
                                                            P
                                                            i
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                        
                     where S
                     
                        map
                     (P
                     
                        i
                     ) is the degree of constriction at position P
                     
                        i
                      in the stenosis map, S
                     
                        map
                     , and T
                     
                        constrict
                      is a threshold that influences the detection accuracy of constrictions. We optimally determine the threshold T
                     
                        constrict
                      so that only stenosis regions are rendered with a predefined constriction color C
                     
                        constrict
                     . The sampling positions except for stenosis regions are assigned with colors evaluated by a user-defined transfer function for the input volume data.

When rendering the contrasted tubular structures (i.e. contrasted coronary arteries in CCTA), they are displayed with high opacity, often blocking the constrictions inside them. As shown in Fig. 6(a) and (b), although the proposed method accurately detects the constrictions (i.e. stenosis), opaque vessels hide the inner constrictions. To resolve this problem, we propose constriction-magnitude-based opacity modulation, motivated by the gradient-magnitude-based opacity modulation [3] that modifies the opacity according to the gradient magnitude for the boundary enhancement. We modulate the opacity based on the degree of constriction stored in the stenosis map as follows:
                        
                           (13)
                           
                              
                                 
                                    α
                                    
                                       
                                          P
                                          i
                                       
                                    
                                 
                                 =
                                 T
                                 
                                    F
                                    α
                                 
                                 (
                                 
                                    f
                                    
                                       
                                          P
                                          i
                                       
                                    
                                 
                                 )
                                 ⋅
                                 m
                                 (
                                 
                                    P
                                    i
                                 
                                 )
                                 ,
                              
                           
                        
                     where
                        
                           (14)
                           
                              
                                 m
                                 (
                                 
                                    P
                                    i
                                 
                                 )
                                 =
                                 δ
                                 +
                                 (
                                 1
                                 −
                                 δ
                                 )
                                 ⋅
                                 
                                    S
                                    
                                       m
                                       a
                                       p
                                    
                                 
                                 (
                                 
                                    P
                                    i
                                 
                                 )
                              
                           
                        
                     
                  

The modulation factor m(P
                     
                        i
                     ) at position P
                     
                        i
                      is determined by the modulation base δ and the degree of constriction S
                     
                        map
                     (P
                     
                        i
                     ). By adjusting the modulation base δ, the users can interactively uncover occluded constrictions. Fig. 6(c) and (d) shows 3D renderings with two different values of δ. With smaller δ, areas inside the vessels are more revealed, the stenoses being more saliently visualized. This constriction-magnitude-based opacity modulation enables easy and intuitive adjustment of the transfer function when visualizing inner constrictions simultaneously with tubular structures.

Our method computes the stenosis map in the pre-processing stage and provides an interactive 3D volume rendering using this pre-computed stenosis map (see Fig. 7
                     ). Both stenosis map computation and data classification are implemented using GPU in separate HLSL programs (compute shader and pixel shader, respectively). To minimize the memory required by the stenosis map, we construct the stenosis map in a volume data of 8-bit float format. Although the 8-bit float has lower precision than 32-bit float, it preserves data precision enough to distinguish constricted tubular structures from other anatomical structures. The stenosis map computation is GPU-implemented by using a compute shader over two passes. The first pass computes eigenvalues for detecting tubular structures. The second pass detects tubular structures using the eigenvalues, and then computes the degree of constriction only for the voxels detected as tubular structures and stores them in the stenosis map. For multi-volume DVR, the stenosis map and the input volume data are both loaded in GPU memory. Data classification is done using both volume data by a GPU-based ray casting pixel shader. The proposed algorithms of stenosis map computation and data classification are implemented in Direct3D 11 and high level shading language on an NVIDIA GeForce GTX TITAN with 6GB of memory.

@&#EXPERIMENTAL RESULTS@&#

We evaluate the performance of the proposed method using ten clinical CCTA datasets from different patients. CT scanning was performed with a 256-row multi-detector CT scanner (iCT 256, Philips Medical Systems, Cleveland, OH). The number of images per scan ranged from 262 to 319. Each image has a matrix size of 512×512. The pixel size ranged from 0.29 to 0.42mm, and the slice interval was all 0.45mm.

For each CT dataset, a cardiac radiologist with 6 years of clinical experience manually specified coronary artery stenoses, assessed the degree of blockage of the coronary artery, and classified the type of plaque, which is the main cause of the blockage, into three types: non-calcified, calcified, and mixed plaques (Fig. 8
                        ) (Table 3
                        ). The purpose of the proposed method is to discriminatingly visualize coronary artery stenoses caused by all types of plaques. Thus, we evaluated the proposed method using the ten datasets that contain significant (≥50%) stenoses caused by at least one type of plaque.

We qualitatively evaluate the proposed constriction visualization method by comparing it with the conventional classification [34]. Fig. 9
                         shows the 3D renderings of a CCTA dataset (dataset #1) containing ≥80% coronary artery stenoses caused by both non-calcified and calcified plaques. Whereas the plaques are not distinguishable in the conventional method (Fig. 9(a)), the regions constricted by plaques are clearly visualized in a predefined color (blue) with the proposed method (Fig. 9(b)).


                        Fig. 10
                         shows the 3D renderings of a CCTA dataset (dataset #7) containing ≥70% coronary artery stenoses caused by mixed plaques. The stenoses are almost invisible in the conventional method (Fig. 10(a)). The proposed method detects the stenoses accurately; however, the contrast-enhanced vessels, which are opaquely rendered with a typical transfer function for the coronary artery visualization, usually hide the inner stenoses (see Fig. 10(b)). The proposed opacity modulation modifies the opacity based on the degree of constriction, delivering a clear visualization of the inner stenoses (Fig. 10(c)).

In the conventional classification, it is tedious or very difficult to specify an appropriate transfer function which visually distinguishes all features of interests. Not rarely, it is almost impossible to visualize a feature of interest (e.g. stenosis caused by non-calcified or mixed plaques) inside a structure that should be simultaneously rendered (e.g. coronary artery). In contrast, the proposed stenosis-based classification enables the salient visualization of constrictions within a tubular structure that have very poor visibility in the conventional classification.

We quantitatively validate how accurately the stenosis map encodes constrictions. As described in Section 7.1, a cardiac radiologist with 6 years of clinical experience manually specified coronary artery stenoses in each of the ten datasets. For each dataset, the radiologist manually identified stenoses with ≥50% blockage. In this way, we obtained the manually classified stenoses that serve as the ground truth for the accuracy assessment of the proposed method. The cardiac radiologist assessed the images twice to avoid intra-observer disagreement.

We evaluated the accuracy of the automatic stenosis classification of the proposed method in terms of two different factors as follows:
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             E
                                             
                                                F
                                                P
                                             
                                          
                                          =
                                          n
                                          u
                                          m
                                          {
                                          (
                                          
                                             Ω
                                             
                                                A
                                                l
                                                l
                                             
                                          
                                          −
                                          
                                             Ω
                                             
                                                M
                                                a
                                                n
                                                u
                                                a
                                                l
                                             
                                          
                                          )
                                          ∩
                                          
                                             Ω
                                             
                                                A
                                                u
                                                t
                                                o
                                             
                                          
                                          }
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             E
                                             
                                                F
                                                N
                                             
                                          
                                          =
                                          n
                                          u
                                          m
                                          {
                                          
                                             Ω
                                             
                                                M
                                                a
                                                n
                                                u
                                                a
                                                l
                                             
                                          
                                          ∩
                                          (
                                          
                                             Ω
                                             
                                                A
                                                l
                                                l
                                             
                                          
                                          −
                                          
                                             Ω
                                             
                                                A
                                                u
                                                t
                                                o
                                             
                                          
                                          )
                                          }
                                          ,
                                       
                                    
                                 
                              
                           
                        where Ω
                        
                           Manual
                         and Ω
                        
                           Auto
                         are the regions of manually and automatically classified stenosis and Ω
                        
                           All
                         is the whole regions of a CCTA dataset. The false positive error E
                        
                           FP
                         is the number of stenosis regions classified automatically but not classified manually, relating to the specificity. The false negative error E
                        
                           FN
                         is the number of stenosis regions classified manually but not classified automatically, relating to the sensitivity.


                        Table 3 summarizes the stenosis classification errors for the ten datasets. E
                        
                           FN
                         was 0 for all datasets, indicating that the proposed method did NOT miss any coronary artery stenosis. Although E
                        
                           FP
                         seemed to be relatively large, the number of regions incorrectly classified as stenosis was very small compared to that of whole regions in a CCTA dataset. In addition, about 30% of these incorrect regions were non-cardiovascular regions (e.g. aorta), and thus, they could be easily excluded. Therefore, the over-classification of stenosis did not degrade the overall diagnostic performance when cardiac radiologists diagnose coronary artery stenoses in CCTA.

Our method generates the stenosis map in the pre-processing step while computing the Hessian matrix and its eigenvalues at each voxel of a CCTA dataset. Such per-voxel computation was accelerated using parallel processing on a GPU in our implementation. The stenosis map computation time, averaged over multiple tests for all ten datasets, was 47.42±3.24s, and the average rendering speed was 42.6±1.22fps.

We compared the result of our method with those of 11 recently proposed methods, which were presented at MICCAI 2012 workshop, ‘3D Cardiovascular Imaging: a MICCAI segmentation challenge’ [35]. A database for this workshop consists of 48 multi-center multi-vendor CCTA datasets. Among of them, 18 CCTA datasets have reference standard quantification results obtained from the coronary angiography procedure and consensus reading of CCTA. We measured and compared the detection accuracy results using these 18 CCTA datasets with the corresponding reference standard from coronary angiography.

For the reference standard generation, one experienced cardiologist identified and analyzed all the coronary artery segments [35]. The stenosis detection method is evaluated using the metrics described in [35] – the sensitivity and the positive predictive value (PPV) as follows:
                           
                              (16)
                              
                                 
                                    Sensitivity
                                    =
                                    
                                       
                                          TP
                                       
                                       
                                          TP
                                          +
                                          FN
                                       
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    PPV
                                    =
                                    
                                       
                                          TP
                                       
                                       
                                          TP
                                          +
                                          FP
                                       
                                    
                                    ,
                                 
                              
                           
                        where the true positive TP means that both the reference standard and the algorithm stenosis/segment have a grade ≥50%. The false negative FN means that the reference standard stenosis/segment has a grade ≥50% while the algorithm stenosis/segment has a grade <50%. The false positive FP means that the reference standard stenosis/segment has a grade <50% while the algorithm stenosis/segment has a grade ≥50%.


                        Table 4
                         shows the accuracy comparison results of the proposed method with 11 previous methods whose accuracy was reported in [35]. The accuracy was measured using the identical 18 CCTA datasets. As shown in Table 4, the proposed method shows the highest sensitivity of 92% for the detection of stenosis among of them. Our method did not miss any coronary artery stenosis except the occluded stenosis. Although our method shows a relatively low PPV which indicates an increase in the number of false positives, considering the trade-off between sensitivity and specificity of a detection algorithm, the over-detection of lesions would benefit patients better than the miss of lesions.

The parameter study described in this section will show an easy-to-follow procedure to determine major parameters in the proposed method when applied to other constricted tubular structures. We evaluated the effects of major parameters on the constriction (i.e. stenosis) detection accuracy using another nine test datasets.

At the stage of Gaussian prefiltering, the optimal size of neighboring window is as important as the optimal Gaussian scale. The neighboring window size determines the local range for the localized structure analysis, and thus, it directly influences the constriction detection accuracy. The proposed method involves two steps of localized structure analysis with different target objects of coronary artery and stenosis. Each analysis uses the optimal Gaussian scale corresponding to its target object. For each of these two localized structure analyses, we evaluated the final constriction detection error, computed by averaging false positive errors E
                        
                           FP
                         and false negative errors E
                        
                           FN
                         across all the nine test datasets.

While varying the neighboring window size from 9×9×9 to 15×15×15 in the first step of coronary artery detection, the final constriction detection error was computed. The optimal neighboring window size was determined to be 13×13×13 with the smallest false negative error of 0.0 (see Table 5
                        ). Similarly, while varying the neighboring window size from 5×5×5 to 11×11×11, the optimal neighboring window size in the second step of stenosis detection was determined to be 9×9×9 with the smallest false negative error of 0.0 (see Table 6
                        ).

The parameters T
                        
                           blob
                        , T
                        
                           sheet
                        , and T
                        
                           noise
                         in (3) for the detection of tubular structures (i.e. coronary arteries) influence the final constriction detection since they determine the search space of the subsequent stenosis map computation. While varying each threshold, we assessed the final constriction detection error as in the previous optimal window size determination using the nine test datasets, and then determined an optimal value.

From 0.25 to 0.45, the threshold T
                        
                           blob
                         was optimally determined to be 0.35 with the smallest false positive error of 4.3 and the false negative error of 0.0 (see Table 7
                        ). Through the assessment of the threshold T
                        
                           sheet
                         from 0.15 to 0.9, T
                        
                           sheet
                         (smaller T
                        
                           sheet
                         leads to higher false positive) was found to minimally affect the constriction detection error. With T
                        
                           sheet
                         smaller than 0.75, the final constriction detection error was all identical as the blob boundary region removal using the eigenvalue gradient also removed the false positive regions possibly detected with T
                        
                           sheet
                         <0.75. With T
                        
                           sheet
                         >0.75, the false negative error increased. Thus, we set T
                        
                           sheet
                         to be 0.25, one value <0.75. From 0.0025 to 0.0045, the threshold T
                        
                           noise
                         was optimally determined to be 0.0035 with the smallest false positive error of 4.3 and the false negative error of 0.0 (see Table 8
                        ).

We introduced the eigenvalue gradient magnitude 
                           
                              
                                 G
                                 
                                    
                                       λ
                                       1
                                    
                                 
                              
                           
                         in (3) for excluding the blob boundary regions which are falsely detected as tubular structures. From 0.0005 to 0.003, the threshold T
                        
                           G
                         was optimally determined to be 0.001 with the smallest false positive error of 5.8 and the false negative error of 0.0 (see Table 9
                        ).

@&#CONCLUSION@&#

This paper proposes a new 3D spatial field for effective visualization of constricted tubular structures, called as a stenosis map. It successfully discriminates constrictions within a tubular structure without laborious prior-segmentation of them. In the stenosis map, every voxel has a scalar value representing the degree of constriction relative to surrounding tubular structures. The degree of constriction is computed by newly proposed measures (i.e. line similarity measure and constriction measure) using the localized structure analysis based on the Hessian matrix and its eigenvalue signature. In addition, we have proposed a stenosis-based classification that maps the degree of constriction stored in the stenosis map to color and opacity. This classification provides easy and intuitive adjustment of the visual appearance of constrictions within tubular structures.

We have explained the details of our method and its efficacy using an exemplary application to coronary artery stenoses. However, the proposed method can be directly applied to other constricted tubular structures only by the optimal selection of a few parameters. The performance evaluation using twenty eight clinical datasets shows that constricted regions are accurately encoded into the stenosis map and saliently visualized, demonstrating that our method can be an effective volume exploration tool in various, including but not limited to medicine, application fields of DVR.

None declared.

@&#ACKNOWLEDGMENTS@&#

This research was supported by Basic Science Research Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Science, ICT and future Planning (No. 2014R1A2A2A03002574 and No. NRF-2013R1A1A3006706), by Institute for Information & communications Technology Promotion (IITP) grant funded by the Korea government (MSIP) (No. R0101-15-0171, Development of Multi-modality Imaging and 3D Simulation-Based Integrative Diagnosis-Treatment Support Software System for Cardiovascular Diseases), and by Seoul National University Bundang Hospital Research Fund (No. 14-2015-005). Bohyoung Kim and Jeongjin Lee are the co-corresponding authors.

@&#REFERENCES@&#

