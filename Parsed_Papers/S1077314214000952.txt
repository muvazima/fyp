@&#MAIN-TITLE@&#Sampson distance based joint estimation of multiple homographies with uncalibrated cameras

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Practitioners typically estimate multiple homographies separately.


                        
                        
                           
                           Separate estimation does not enforce inter-homography constraints.


                        
                        
                           
                           We jointly estimate homographies so that all constraints are satisfied.


                        
                        
                           
                           Enforcing inter-homography constraints improves accuracy considerably.


                        
                        
                           
                           Our cost function operates directly on image points via the Sampson distance.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Multiple homographies

Parameter estimation

Maximum likelihood

Sampson distance

Latent variables

@&#ABSTRACT@&#


               
               
                  Two images of a scene consisting of multiple flat surfaces are related by a collection of homography matrices. Practitioners typically estimate these homographies separately thereby violating inherent inter-homography constraints that arise naturally out of the rigid geometry of the scene. We demonstrate that through a suitable choice of parametrisation multiple homographies can be jointly estimated in a manner so as to satisfy all inter-homography constraints. Unlike the cost functions used previously for solving this problem, our cost function does not correspond to fitting one set of homography matrices to another set of homography matrices. Instead, we utilise the Sampson distance for homography matrix estimation and operate directly on image data points. By using the Sampson distance and working directly on data points, we expedite the application of a vast amount of knowledge that already exists for Sampson-distance-based single homography or fundamental matrix estimation. The estimation framework reported in this paper establishes a new baseline for joint multiple homography estimation and at the same time raises intriguing new research questions. The work may be of interest to a broad range of researchers who require the estimation of homography matrices with uncalibrated cameras as part of their solution.
               
            

@&#INTRODUCTION@&#

Whether one is planning to autonomously land a spacecraft on a distant planet, generate three-dimensional maps of the earth, or augment the environment with virtual characters, one will need to understand how different images of the same scene are related. A fundamental result in multiple view geometry states that if a scene consists of a flat surface, then the coordinates of any pair of corresponding points in two images are related by a homography matrix 
                     [11]. If a scene consists of multiple flat surfaces, such as buildings in an urban environment, then multiple homography matrices (one for each plane) are needed to adequately relate corresponding points in two images (see Fig. 1
                     ).

When multiple homography matrices are required, practitioners typically estimate them separately [12]. This paper argues that multiple homography matrices should not be estimated separately, but rather should be estimated jointly. Estimating homography matrices separately fails to ensure that the matrices satisfy inter-homography constraints that arise naturally due to the rigidity of the planar scene. Through extensive experiments we show that estimating homography matrices jointly so that they satisfy all inter-homography constraints leads to considerably more accurate results.

@&#BACKGROUND@&#

Almost two decades ago Sashua and Avidan [16] reported that a collection of homography matrices induced by multiple planes between two views are inter-related. In particular, these authors revealed that, for a pair of images, a collection of five or more homography matrices resides in an at most four-dimensional subspace of the parameter space. The corresponding subspace constraint became known as the rank-four constraint. Zelnik-Manor and Irani [17] took Sashua and Avidan’s line of inquiry further and showed that homography rank constraints also exist that apply to a whole sequence of images. Both Sashua and Avidan as well as Zelnik-Manor and Irani advocated a straightforward procedure for enforcing rank constraints on a collection of homographies. The essence of their method is to form a composite matrix from vectorised versions of the homography matrices and to enforce the rank constraint using a singular value decomposition. The rank enforcement procedure can be understood as fitting a new set of homography matrices (that reside in a four-dimensional subspace) to an existing set of homography matrices using the Frobenius norm as a measure of distance.

Despite its simplicity the rank enforcement method has not been widely adopted, one reason for this being that it is difficult to detect interest points on more than five planar surfaces in a typical image. Subsequent studies also reported that in many instances the rank constraints were not producing any notable improvements in the accuracy of the underlying homographies. It was believed that the lack of consistent denoising may be due to the fact that singular value decomposition does not take homography covariance information into account.

Chen and Suter [2] extended the work of Sashua and Avidan by proposing an iterative weighted alternating least squares scheme for upgrading separately estimated homography matrices to consistent matrices. By incorporating homography covariance information into the cost function, Chen and Suter intended to surpass the limitations of rank constraint enforcement. Their iterative scheme needed a suitable initialisation and they were able to devise one that required three or more homographies. Regrettably, their cost function was deficient from a theoretical point of view in that it was not scale invariant. Homography matrices are defined only up to an unknown scale factor, yet multiplying the homographies by different scales could affect the solution and convergence of Chen and Suter’s iterative scheme. Nevertheless, Chen and Suter’s contribution was a valuable one, providing a benchmark against which new methods could be compared.

Another alternative to direct rank-four enforcement was reported by Eriksson and van den Hengel [8]. Like Chen and Suter, these authors also utilised homography covariance information. Unfortunately, they never devised a method to initialise their iterative scheme. Instead, they resorted to random initialisations which occasionally converged to poor solutions.

To overcome the limitations of the aforementioned methods, Chojnacki et al. [7] proposed a homography-covariance-based scale invariant cost function. They showed that by a suitable choice of latent variables all inter-homography constraints can be satisfied. They used the popular Levenberg–Marquardt scheme to optimise their cost function and also presented an algorithm that can be used to initialise the latent variables when there are two or more homography matrices. This meant that for the first time dependable improvements to homography matrix estimates could be observed in the minimal case of two homographies.

All of the methods that we have reviewed fit one set of homography matrices to another set of homography matrices. In this paper, we propose a departure from what has been attempted before and offer a method for jointly estimating multiple homographies that operates directly on the image points using the Sampson distance. We do not assume that the cameras are calibrated. To enforce all inter-homography constraints, we utilise the same parametrisation as proposed by Chojnacki et al. [7].

Our experiments will demonstrate the utility and superiority of our method, and, in the process, will open up new avenues for compelling future research. Our hope is that practitioners will see the benefit of estimating multiple homographies jointly, and will move away from rather inappropriate separate homography estimation.

We consider the following task:
                        Problem
                        Estimate a collection of 
                              
                                 3
                                 ×
                                 3
                              
                            matrices, representing planar homographies engendered by various planes in a 3D scene under common projections on two images, based on a collection of sets of image correspondences, each set being related to a separate homography.

A fundamental aspect of the above problem is that the homography matrices involved are interdependent. To get insight into the nature of the dependencies involved, consider two fixed uncalibrated cameras giving rise to two camera matrices 
                        
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 K
                              
                              
                                 1
                              
                           
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           [
                           
                              
                                 I
                              
                              
                                 3
                              
                           
                           ,
                           -
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ]
                        
                      and 
                        
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 K
                              
                              
                                 2
                              
                           
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           [
                           
                              
                                 I
                              
                              
                                 3
                              
                           
                           ,
                           -
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                           ]
                        
                     . Here the length-3 translation vector 
                        
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                        
                      and the 
                        
                           3
                           ×
                           3
                        
                      rotation matrix 
                        
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                        
                      represent the Euclidean transformation between the k-th 
                        
                           (
                           k
                           =
                           1
                           ,
                           2
                           )
                        
                      camera and the world coordinate system, 
                        
                           
                              
                                 K
                              
                              
                                 k
                              
                           
                        
                      is a 
                        
                           3
                           ×
                           3
                        
                      upper triangular calibration matrix encoding the internal parameters of the k-th camera, and 
                        
                           
                              
                                 I
                              
                              
                                 3
                              
                           
                        
                      denotes the 
                        
                           3
                           ×
                           3
                        
                      identity matrix. Suppose, moreover, that a set of I planes in a 3D scene have been selected. Given 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           I
                        
                     , let the i-th plane from the collection have a unit outward normal 
                        
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                        
                      and be situated at a distance 
                        
                           
                              
                                 d
                              
                              
                                 i
                              
                           
                        
                      from the origin of the world coordinate system. Then, for each 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           I
                        
                     , the i-th plane gives rise to a planar homography from view 
                        
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        
                      to 
                        
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                        
                      described by the 
                        
                           3
                           ×
                           3
                        
                      matrix
                        
                           (1)
                           
                              
                                 
                                    H
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              A
                              +
                              
                                 
                                    bv
                                 
                                 
                                    i
                                 
                                 
                                    ⊤
                                 
                              
                              ,
                           
                        
                     where
                        
                           (2)
                           
                              
                                 
                                    
                                    
                                       
                                          A
                                          =
                                          
                                             
                                                K
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                R
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                R
                                             
                                             
                                                1
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                K
                                             
                                             
                                                1
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                n
                                             
                                             
                                                i
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                t
                                             
                                             
                                                1
                                             
                                          
                                          -
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          b
                                          =
                                          
                                             
                                                K
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                R
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                1
                                             
                                          
                                          -
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          ,
                                          
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                K
                                             
                                             
                                                1
                                             
                                             
                                                -
                                                ⊤
                                             
                                          
                                          
                                             
                                                R
                                             
                                             
                                                1
                                             
                                             
                                                -
                                                ⊤
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                i
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     We note that in the case of calibrated cameras when one may assume that 
                        
                           
                              
                                 K
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 K
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 I
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           =
                           0
                           ,
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 I
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           =
                           R
                        
                     , system (2) reduces to
                        
                           (3)
                           
                              
                                 
                                    
                                    
                                       
                                          A
                                          =
                                          R
                                          ,
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          -
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          b
                                          =
                                          t
                                          ,
                                          
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                n
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     with 
                        
                           t
                           =
                           -
                           
                              
                                 Rt
                              
                              
                                 2
                              
                           
                        
                     , and equality (1) becomes the familiar direct nRt representation
                        
                           
                              
                                 
                                    H
                                 
                                 
                                    i
                                 
                              
                              =
                              -
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              R
                              +
                              
                                 
                                    tn
                                 
                                 
                                    i
                                 
                                 
                                    ⊤
                                 
                              
                           
                        
                     (cf. [1,14]). We stress that all of our subsequent analysis concerns the general uncalibrated case, with 
                        
                           A
                           ,
                           b
                           ,
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                        
                     ’s and 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        
                     ’s to be interpreted according to (2) rather than (3).

Let 
                        
                           H
                           =
                           [
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 H
                              
                              
                                 I
                              
                           
                           ]
                        
                      be the composite of all the homography matrices in question and let 
                        
                           H
                        
                      be the 
                        
                           9
                           ×
                           I
                        
                      matrix given by
                        
                           
                              H
                              =
                              [
                              
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              
                                 
                                    h
                                 
                                 
                                    I
                                 
                              
                              ]
                              ,
                              
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              =
                              vec
                              (
                              
                                 
                                    H
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                           
                        
                     where 
                        
                           vec
                        
                      denotes column-wise vectorisation [13]. With 
                        
                           a
                           =
                           vec
                           (
                           A
                           )
                        
                      and 
                        
                           ⊗
                        
                      denoting Kronecker product [13], we have
                        
                           (4)
                           
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              vec
                              (
                              A
                              )
                              +
                              vec
                              
                                 
                                    
                                       
                                          
                                             bv
                                          
                                          
                                             i
                                          
                                          
                                             ⊤
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              a
                              +
                              (
                              
                                 
                                    I
                                 
                                 
                                    3
                                 
                              
                              ⊗
                              b
                              )
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                        
                     for each 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           I
                        
                     . This can be concisely written as the matrix equality
                        
                           (5)
                           
                              H
                              =
                              ST
                              ,
                           
                        
                     where 
                        
                           S
                           =
                           [
                           
                              
                                 I
                              
                              
                                 3
                              
                           
                           ⊗
                           b
                           ,
                           a
                           ]
                        
                      is a 
                        
                           9
                           ×
                           4
                        
                      matrix and
                        
                           
                              T
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                …
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      I
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                …
                                             
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      I
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     is a 
                        
                           4
                           ×
                           I
                        
                      matrix. An immediate consequence of the representation (5) is that 
                        
                           H
                        
                      has rank at most four. Whenever 
                        
                           I
                           ⩾
                           5
                        
                      the requirement that 
                        
                           H
                        
                      should have rank no greater than four places a genuine constraint on 
                        
                           H
                        
                     , and hence also on 
                        
                           H
                        
                     . This constraint is the rank-four constraint of Shashua and Avidan mentioned in the Introduction. The rank-four constraint stipulates that the dimension of the set of all 
                        
                           H
                        
                     ’s is no greater than 
                        
                           4
                           I
                           +
                           20
                        
                      for 
                        
                           I
                           ⩾
                           5
                        
                     . The ensuing inequality 
                        
                           4
                           I
                           +
                           20
                           <
                           9
                           I
                        
                      for 
                        
                           I
                           ⩾
                           5
                        
                      makes it clear that 
                        
                           H
                        
                      resides in a proper subset of all a priori length-I composites of 
                        
                           3
                           ×
                           3
                        
                      matrices for 
                        
                           I
                           ⩾
                           5
                        
                     .

The dimensionality count for the 
                        
                           H
                        
                     ’s can be refined and the subsequent conclusions sharpened. Letting 
                        
                           η
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ⊤
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             ⊤
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             1
                                          
                                          
                                             ⊤
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             I
                                          
                                          
                                             ⊤
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             I
                                          
                                       
                                    
                                 
                              
                              
                                 ⊤
                              
                           
                        
                      and
                        
                           (6)
                           
                              Π
                              (
                              η
                              )
                              =
                              [
                              
                                 
                                    Π
                                 
                                 
                                    1
                                 
                              
                              (
                              η
                              )
                              ,
                              …
                              ,
                              
                                 
                                    Π
                                 
                                 
                                    I
                                 
                              
                              (
                              η
                              )
                              ]
                              ,
                              
                              
                                 
                                    Π
                                 
                                 
                                    i
                                 
                              
                              (
                              η
                              )
                              =
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              A
                              +
                              
                                 
                                    bv
                                 
                                 
                                    i
                                 
                                 
                                    ⊤
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           H
                        
                      can be represented as
                        
                           (7)
                           
                              H
                              =
                              Π
                              (
                              η
                              )
                              .
                           
                        
                     In this formulation, 
                        
                           η
                        
                      appears as the vector of latent variables that link all the constituent matrices together and provide a natural parametrisation of the set of all 
                        
                           H
                        
                     ’s. Since 
                        
                           η
                        
                      has a total of 
                        
                           4
                           I
                           +
                           12
                        
                      entries, the set of all matrices of the form 
                        
                           Π
                           (
                           η
                           )
                        
                      has dimension no greater than 
                        
                           4
                           I
                           +
                           12
                        
                     . A more refined argument shows that the set of all 
                        
                           Π
                           (
                           η
                           )
                        
                     ’s has in fact dimension equal to 
                        
                           4
                           I
                           +
                           7
                        
                      
                     [5,6]. Since 
                        
                           4
                           I
                           +
                           7
                           <
                           9
                           I
                        
                      whenever 
                        
                           I
                           ⩾
                           2
                        
                     , it follows that 
                        
                           H
                        
                      resides in a proper subset of all length-I composites of 
                        
                           3
                           ×
                           3
                        
                      matrices for 
                        
                           I
                           ⩾
                           2
                        
                     . This is an improvement over the previous similar statement which was valid only for 
                        
                           I
                           ⩾
                           5
                        
                     . It is now clear that the requirement that 
                        
                           H
                        
                      take the form as per (7) whenever 
                        
                           I
                           ⩾
                           2
                        
                      can be seen as an implicit constraint on 
                        
                           H
                        
                     , with the consequence that the 
                        
                           
                              
                                 H
                              
                              
                                 i
                              
                           
                        
                     ’s are all interdependent.

In what follows we shall exploit the parametrisation (7) as a handle on the inter-dependencies in the matrices 
                        
                           
                              
                                 H
                              
                              
                                 i
                              
                           
                        
                     . It is worth stressing that this parametrisation is not minimal in that if 
                        
                           H
                           =
                           Π
                           (
                           η
                           )
                        
                      holds for a particular vector 
                        
                           η
                        
                     , then we also have 
                        
                           H
                           =
                           Π
                           (
                           
                              
                                 η
                              
                              
                                 ′
                              
                           
                           )
                        
                      for any vector 
                        
                           
                              
                                 η
                              
                              
                                 ′
                              
                           
                        
                      of the form
                        
                           
                              
                                 
                                    η
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          vec
                                          (
                                          β
                                          A
                                          +
                                          
                                             
                                                bc
                                             
                                             
                                                ⊤
                                             
                                          
                                          )
                                          ,
                                          α
                                          b
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                1
                                             
                                          
                                          -
                                          
                                             
                                                α
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          c
                                          ,
                                          …
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                I
                                             
                                          
                                          -
                                          
                                             
                                                α
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          c
                                          ,
                                          
                                             
                                                β
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                β
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                I
                                             
                                          
                                       
                                    
                                 
                                 
                                    ⊤
                                 
                              
                              ,
                           
                        
                     where 
                        
                           α
                        
                      and 
                        
                           β
                        
                      are non-zero numbers, and 
                        
                           c
                        
                      is a length-3 vector. The arbitrariness in the choice of 
                        
                           α
                        
                     , 
                        
                           β
                        
                     , and 
                        
                           c
                        
                      reflects five degrees of parametrisation gauge freedom. In particular, if 
                        
                           H
                           =
                           Π
                           (
                           η
                           )
                        
                      holds for a particular vector 
                        
                           η
                        
                     , then it is not true that the entries 
                        
                           η
                        
                      have to be necessarily interpreted as ones satisfying (2) for the underlying values of 
                        
                           
                              
                                 K
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 i
                              
                           
                        
                     , and 
                        
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                        
                      
                     
                        
                           (
                           k
                           =
                           1
                           ,
                           2
                           ,
                           i
                           =
                           1
                           ,
                           …
                           ,
                           I
                           )
                        
                     . It is also worth stressing that the fact that the parametrisation (7) is not minimal is not a limitation—on the contrary, the parametrisation is perfectly suited to our purpose, as it enforces all underlying constraints on the 
                        
                           
                              
                                 H
                              
                              
                                 i
                              
                           
                        
                     ’s.

If a planar homography is represented by an invertible 
                        
                           3
                           ×
                           3
                        
                      matrix 
                        
                           H
                        
                      and if 
                        
                           
                              
                                 m
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 [
                                 
                                    
                                       u
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 1
                                 ]
                              
                              
                                 ⊤
                              
                           
                        
                      is the image of 
                        
                           m
                           =
                           
                              
                                 [
                                 u
                                 ,
                                 v
                                 ,
                                 1
                                 ]
                              
                              
                                 ⊤
                              
                           
                        
                      by that homography, then 
                        
                           
                              
                                 m
                              
                              
                                 ′
                              
                           
                           ≃
                           Hm
                        
                     , where 
                        
                           ≃
                        
                      denotes equality up to scale. This relation can equivalently be written as
                        
                           (8)
                           
                              
                                 
                                    [
                                    
                                       
                                          m
                                       
                                       
                                          ′
                                       
                                    
                                    ]
                                 
                                 
                                    ×
                                 
                              
                              Hm
                              =
                              0
                              ,
                           
                        
                     where, for a length-3 vector 
                        
                           a
                           =
                           
                              
                                 [
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       3
                                    
                                 
                                 ]
                              
                              
                                 ⊤
                              
                           
                           ,
                           
                              
                                 [
                                 a
                                 ]
                              
                              
                                 ×
                              
                           
                        
                      denotes the 
                        
                           3
                           ×
                           3
                        
                      anti-symmetric matrix given by
                        
                           
                              
                                 
                                    [
                                    a
                                    ]
                                 
                                 
                                    ×
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                -
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                -
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                -
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     With 
                        
                           θ
                           =
                           vec
                           (
                           H
                           )
                           ,
                           z
                           =
                           
                              
                                 [
                                 u
                                 ,
                                 v
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                                 ]
                              
                              
                                 ⊤
                              
                           
                        
                     , and 
                        
                           U
                           (
                           z
                           )
                           =
                           -
                           m
                           ⊗
                           
                              
                                 [
                                 
                                    
                                       m
                                    
                                    
                                       ′
                                    
                                 
                                 ]
                              
                              
                                 ×
                              
                           
                        
                     , we have 
                        
                           
                              
                                 [
                                 
                                    
                                       m
                                    
                                    
                                       ′
                                    
                                 
                                 ]
                              
                              
                                 ×
                              
                           
                           Hm
                           =
                           U
                           
                              
                                 (
                                 z
                                 )
                              
                              
                                 ⊤
                              
                           
                           θ
                        
                     , and so (8) can be restated as
                        
                           (9)
                           
                              U
                              
                                 
                                    (
                                    z
                                    )
                                 
                                 
                                    ⊤
                                 
                              
                              θ
                              =
                              0
                              .
                           
                        
                     Since the 
                        
                           9
                           ×
                           3
                        
                      matrix 
                        
                           U
                           (
                           z
                           )
                        
                      has rank 2, the three equations in (9) are linearly dependent and can be reduced—by deleting one of them—to a system of two equations. By leaving specifically the first two equations, the resulting system becomes
                        
                           
                              V
                              
                                 
                                    (
                                    z
                                    )
                                 
                                 
                                    ⊤
                                 
                              
                              θ
                              =
                              0
                              ,
                           
                        
                     where 
                        
                           V
                           (
                           z
                           )
                           =
                           U
                           (
                           z
                           )
                           
                              
                                 I
                              
                              
                                 3
                                 ×
                                 2
                              
                           
                        
                     , 
                        
                           
                              
                                 I
                              
                              
                                 3
                                 ×
                                 2
                              
                           
                           =
                           [
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                           ]
                           ,
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 [
                                 1
                                 ,
                                 0
                                 ,
                                 0
                                 ]
                              
                              
                                 ⊤
                              
                           
                        
                     , and 
                        
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 [
                                 0
                                 ,
                                 1
                                 ,
                                 0
                                 ]
                              
                              
                                 ⊤
                              
                           
                        
                     . This system of equations forms the foundation of an approximate maximum likelihood cost function which we describe in the next section.

Let 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ij
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 I
                              
                           
                        
                      be a collection of I sets of image correspondences. For each 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           I
                        
                      and each 
                        
                           j
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 J
                              
                              
                                 i
                              
                           
                        
                     , write 
                        
                           
                              
                                 m
                              
                              
                                 ij
                              
                           
                           =
                           
                              
                                 [
                                 
                                    
                                       u
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 1
                                 ]
                              
                              
                                 ⊤
                              
                           
                        
                      and 
                        
                           
                              
                                 m
                              
                              
                                 ij
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ij
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             ij
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       1
                                    
                                 
                              
                              
                                 ⊤
                              
                           
                        
                     , and let 
                        
                           
                              
                                 z
                              
                              
                                 ij
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ij
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             ij
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             ij
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             ij
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                              
                                 ⊤
                              
                           
                        
                     . Suppose that each pair 
                        
                           
                              
                                 m
                              
                              
                                 ij
                              
                           
                           ,
                           
                              
                                 m
                              
                              
                                 ij
                              
                              
                                 ′
                              
                           
                        
                      comes equipped with a pair of 
                        
                           2
                           ×
                           2
                        
                      respective covariance matrices 
                        
                           
                              
                                 Λ
                              
                              
                                 
                                    
                                       u
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ij
                                    
                                 
                              
                           
                           ,
                           
                              
                                 Λ
                              
                              
                                 
                                    
                                       u
                                    
                                    
                                       ij
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ij
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                     . Let
                        
                           
                              
                                 
                                    Λ
                                 
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ij
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Λ
                                                   
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      Λ
                                                   
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     Suppose that, for each 
                        
                           i
                           =
                           1
                           …
                           I
                        
                     , a homography estimate 
                        
                           
                              
                                 Θ
                              
                              
                                 i
                              
                           
                        
                      is to be evolved based on 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ij
                                          
                                       
                                       ,
                                       
                                          
                                             m
                                          
                                          
                                             ij
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 
                                    
                                       J
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                      in such a way that 
                        
                           Θ
                           =
                           [
                           
                              
                                 Θ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 Θ
                              
                              
                                 I
                              
                           
                           ]
                        
                      satisfies the implicit constraint 
                        
                           Θ
                           =
                           Π
                           (
                           η
                           )
                        
                      for some 
                        
                           η
                        
                     . For each 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           I
                        
                     , let 
                        
                           
                              
                                 θ
                              
                              
                                 i
                              
                           
                           =
                           vec
                           (
                           
                              
                                 Θ
                              
                              
                                 i
                              
                           
                           )
                        
                     . As it turns out, the approximate maximum likelihood cost function with which to fulfil the estimation task in a statistically meaningful way is given by
                        
                           
                              
                                 
                                    J
                                 
                                 
                                    AML
                                 
                              
                              (
                              Θ
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       I
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    ij
                                 
                              
                              
                                 
                                    Σ
                                 
                                 
                                    ij
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    ij
                                 
                                 
                                    ⊤
                                 
                              
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                              
                              ,
                           
                        
                     where
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                ij
                                             
                                          
                                          =
                                          V
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                ij
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                ij
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ⊗
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                ij
                                             
                                          
                                          (
                                          
                                             
                                                I
                                             
                                             
                                                2
                                             
                                          
                                          ⊗
                                          
                                             
                                                θ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                ij
                                             
                                          
                                          =
                                          
                                             
                                                ∂
                                             
                                             
                                                z
                                             
                                          
                                          vec
                                          (
                                          V
                                          (
                                          z
                                          )
                                          )
                                          
                                             
                                                |
                                             
                                             
                                                z
                                                =
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ij
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Λ
                                             
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ij
                                                   
                                                
                                             
                                          
                                          
                                             
                                                [
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      z
                                                   
                                                
                                                vec
                                                (
                                                V
                                                (
                                                z
                                                )
                                                )
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      z
                                                      =
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             
                                                ⊤
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     and, explicitly,
                        
                           
                              
                                 
                                    ∂
                                 
                                 
                                    z
                                 
                              
                              vec
                              (
                              V
                              (
                              z
                              )
                              )
                              =
                              -
                              [
                              vec
                              (
                              (
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                              ⊗
                              
                                 
                                    [
                                    
                                       
                                          m
                                       
                                       
                                          ′
                                       
                                    
                                    ]
                                 
                                 
                                    ×
                                 
                              
                              )
                              
                                 
                                    I
                                 
                                 
                                    3
                                    ×
                                    2
                                 
                              
                              )
                              ,
                              vec
                              (
                              (
                              
                                 
                                    e
                                 
                                 
                                    2
                                 
                              
                              ⊗
                              
                                 
                                    [
                                    
                                       
                                          m
                                       
                                       
                                          ′
                                       
                                    
                                    ]
                                 
                                 
                                    ×
                                 
                              
                              )
                              
                                 
                                    I
                                 
                                 
                                    3
                                    ×
                                    2
                                 
                              
                              )
                              ,
                              
                              vec
                              (
                              (
                              m
                              ⊗
                              
                                 
                                    [
                                    
                                       
                                          e
                                       
                                       
                                          1
                                       
                                    
                                    ]
                                 
                                 
                                    ×
                                 
                              
                              )
                              
                                 
                                    I
                                 
                                 
                                    3
                                    ×
                                    2
                                 
                              
                              )
                              ,
                              vec
                              (
                              (
                              m
                              ⊗
                              
                                 
                                    [
                                    
                                       
                                          e
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 
                                    ×
                                 
                              
                              )
                              
                                 
                                    I
                                 
                                 
                                    3
                                    ×
                                    2
                                 
                              
                              )
                              ]
                              .
                           
                        
                     Here each summand 
                        
                           
                              
                                 θ
                              
                              
                                 i
                              
                              
                                 T
                              
                           
                           
                              
                                 V
                              
                              
                                 ij
                              
                           
                           
                              
                                 Σ
                              
                              
                                 ij
                              
                              
                                 -
                                 1
                              
                           
                           
                              
                                 V
                              
                              
                                 ij
                              
                              
                                 ⊤
                              
                           
                           
                              
                                 θ
                              
                              
                                 i
                              
                           
                        
                      represents the Sampson distance between 
                        
                           
                              
                                 Θ
                              
                              
                                 i
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ij
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          ij
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        
                      
                     [11]. Upon introducing the function
                        
                           
                              
                                 
                                    J
                                 
                                 
                                    AML
                                 
                                 
                                    ′
                                 
                              
                              (
                              η
                              )
                              =
                              
                                 
                                    J
                                 
                                 
                                    AML
                                 
                              
                              (
                              Π
                              (
                              η
                              )
                              )
                              ,
                           
                        
                     the constrained optimisation problem in question reduces to that of optimising 
                        
                           
                              
                                 J
                              
                              
                                 AML
                              
                              
                                 ′
                              
                           
                        
                     , which is an unconstrained optimisation problem.

One way of optimising 
                        
                           
                              
                                 J
                              
                              
                                 AML
                              
                              
                                 ′
                              
                           
                        
                      is to use the Levenberg–Marquardt (LM) method. The starting point is to re-express 
                        
                           
                              
                                 J
                              
                              
                                 AML
                              
                              
                                 ′
                              
                           
                        
                      as
                        
                           (10)
                           
                              
                                 
                                    J
                                 
                                 
                                    AML
                                 
                                 
                                    ′
                                 
                              
                              (
                              η
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       I
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    ij
                                 
                                 
                                    ′
                                    2
                                 
                              
                              (
                              η
                              )
                              =
                              ‖
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              (
                              η
                              )
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                        
                     where, for each 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           I
                        
                      and each 
                        
                           j
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 J
                              
                              
                                 i
                              
                           
                        
                     ,
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ij
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          η
                                          )
                                          =
                                          
                                             
                                                r
                                             
                                             
                                                ij
                                             
                                          
                                          (
                                          
                                             
                                                π
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          η
                                          )
                                          )
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ij
                                             
                                          
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                      
                                                         
                                                            Σ
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                1
                                                /
                                                2
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                π
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          η
                                          )
                                          =
                                          vec
                                          (
                                          
                                             
                                                Π
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          η
                                          )
                                          )
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          η
                                          )
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            11
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      (
                                                      η
                                                      )
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                            
                                                               
                                                                  J
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      (
                                                      η
                                                      )
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            I
                                                            1
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      (
                                                      η
                                                      )
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            
                                                               
                                                                  IJ
                                                               
                                                               
                                                                  I
                                                               
                                                            
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      (
                                                      η
                                                      )
                                                   
                                                
                                             
                                             
                                                ⊤
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     The LM algorithm iteratively improves on an initial approximation 
                        
                           
                              
                                 η
                              
                              
                                 0
                              
                           
                        
                      to the minimiser of 
                        
                           
                              
                                 J
                              
                              
                                 AML
                              
                              
                                 ′
                              
                           
                        
                      by constructing new approximations with the aid of the update rule
                        
                           
                              
                                 
                                    η
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    η
                                 
                                 
                                    n
                                 
                              
                              -
                              
                                 
                                    [
                                    H
                                    (
                                    
                                       
                                          η
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          I
                                       
                                       
                                          4
                                          I
                                          +
                                          12
                                       
                                    
                                    ]
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    [
                                    
                                       
                                          ∂
                                       
                                       
                                          η
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    
                                       
                                          η
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    ]
                                 
                                 
                                    ⊤
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              (
                              
                                 
                                    η
                                 
                                 
                                    n
                                 
                              
                              )
                              ,
                           
                        
                     where 
                        
                           H
                           =
                           
                              
                                 (
                                 
                                    
                                       ∂
                                    
                                    
                                       η
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                              
                                 ⊤
                              
                           
                           
                              
                                 ∂
                              
                              
                                 η
                              
                           
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                        
                      and 
                        
                           
                              
                                 λ
                              
                              
                                 n
                              
                           
                        
                      is a non-negative scalar that dynamically changes from step to step [15]. Here 
                        
                           
                              
                                 ∂
                              
                              
                                 η
                              
                           
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                        
                      is the Jacobian matrix
                        
                           
                              
                                 
                                    ∂
                                 
                                 
                                    η
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                         
                                                         
                                                            η
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            11
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ⊤
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                         
                                                         
                                                            η
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                            
                                                               
                                                                  J
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ⊤
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                         
                                                         
                                                            η
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            I
                                                            1
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ⊤
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                         
                                                         
                                                            η
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            
                                                               
                                                                  IJ
                                                               
                                                               
                                                                  I
                                                               
                                                            
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ⊤
                                             
                                          
                                       
                                    
                                 
                                 
                                    ⊤
                                 
                              
                              .
                           
                        
                     To determine 
                        
                           
                              
                                 ∂
                              
                              
                                 η
                              
                           
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                        
                      explicitly, note that, for each 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           I
                        
                      and each 
                        
                           j
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 J
                              
                              
                                 i
                              
                           
                        
                     ,
                        
                           
                              
                                 
                                    ∂
                                 
                                 
                                    η
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    ij
                                 
                                 
                                    ′
                                 
                              
                              (
                              η
                              )
                              =
                              
                                 
                                    ∂
                                 
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    ij
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    i
                                 
                              
                              (
                              η
                              )
                              )
                              
                                 
                                    ∂
                                 
                                 
                                    η
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    i
                                 
                              
                              (
                              η
                              )
                           
                        
                     with
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                ij
                                             
                                          
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                (
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                θ
                                             
                                             
                                                i
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                (
                                                ij
                                                )
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                (
                                                ij
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                M
                                             
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                (
                                                ij
                                                )
                                             
                                          
                                          -
                                          
                                             
                                                N
                                             
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                (
                                                ij
                                                )
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                M
                                             
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                (
                                                ij
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                V
                                             
                                             
                                                ij
                                             
                                          
                                          
                                             
                                                Σ
                                             
                                             
                                                ij
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                ij
                                             
                                             
                                                ⊤
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                (
                                                ij
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         ij
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   ⊗
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         9
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                ij
                                             
                                          
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                ij
                                             
                                          
                                          ⊗
                                          
                                             
                                                I
                                             
                                             
                                                9
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                ij
                                             
                                          
                                          =
                                          
                                             
                                                Σ
                                             
                                             
                                                ij
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                ij
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                θ
                                             
                                             
                                                i
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     In the setup described by (6) and (7), we have, in accordance with (4),
                     
                        
                           
                              
                                 
                                    π
                                 
                                 
                                    i
                                 
                              
                              (
                              η
                              )
                              =
                              vec
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                       A
                                       +
                                       
                                          
                                             bv
                                          
                                          
                                             i
                                          
                                          
                                             ⊤
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              a
                              +
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              ⊗
                              b
                           
                        
                     for each 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           I
                        
                     . Taking into account that 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ⊗
                           b
                           =
                           (
                           
                              
                                 I
                              
                              
                                 3
                              
                           
                           ⊗
                           b
                           )
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           =
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ⊗
                           
                              
                                 I
                              
                              
                                 3
                              
                           
                           )
                           b
                        
                     , one readily verifies that
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                a
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                I
                                             
                                             
                                                9
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                ∂
                                             
                                             
                                                b
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          ⊗
                                          
                                             
                                                I
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                I
                                             
                                             
                                                3
                                             
                                          
                                          ⊗
                                          b
                                          ,
                                          
                                          
                                             
                                                ∂
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                j
                                             
                                          
                                          =
                                          0
                                          
                                          (
                                          i
                                          
                                          ≠
                                          
                                          j
                                          )
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          a
                                          ,
                                          
                                          
                                             
                                                ∂
                                             
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                j
                                             
                                          
                                          =
                                          0
                                          
                                          (
                                          i
                                          
                                          ≠
                                          
                                          j
                                          )
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Representing, for each 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           I
                           ,
                           
                              
                                 ∂
                              
                              
                                 η
                              
                           
                           
                              
                                 r
                              
                              
                                 ij
                              
                              
                                 ′
                              
                           
                        
                      as
                        
                           
                              
                                 
                                    ∂
                                 
                                 
                                    η
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    ij
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             ∂
                                          
                                          
                                             a
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             ij
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             ∂
                                          
                                          
                                             b
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             ij
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             ∂
                                          
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             ij
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       …
                                       
                                          
                                             ∂
                                          
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   I
                                                
                                             
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             ij
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             ∂
                                          
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             ij
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             ∂
                                          
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   I
                                                
                                             
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             ij
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     one finds furthermore that
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                a
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                ij
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                (
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                i
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                (
                                                ij
                                                )
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                b
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                ij
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                (
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                (
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                i
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                (
                                                ij
                                                )
                                             
                                          
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          ⊗
                                          
                                             
                                                I
                                             
                                             
                                                3
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                ij
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                (
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                (
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                i
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                (
                                                ij
                                                )
                                             
                                          
                                          (
                                          
                                             
                                                I
                                             
                                             
                                                3
                                             
                                          
                                          ⊗
                                          b
                                          )
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                ij
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          0
                                          
                                          (
                                          k
                                          
                                          ≠
                                          
                                          i
                                          )
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                ij
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                (
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                (
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                i
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                (
                                                ij
                                                )
                                             
                                          
                                          a
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                ij
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          0
                                          
                                          (
                                          k
                                          
                                          ≠
                                          
                                          i
                                          )
                                          .
                                       
                                    
                                 
                              
                           
                        
                     With 
                        
                           
                              
                                 ∂
                              
                              
                                 η
                              
                           
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                        
                      thus determined, all that is now needed is a means for determining a suitable initial value of 
                        
                           η
                        
                     .
                        Algorithm 1
                        InitialiseLatentVariables 
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                          /* Find initial values for 
                                                
                                                   A
                                                   ,
                                                   b
                                                   ,
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                              and 
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                              in Eq. (6) */
                                       
                                       
                                          
                                          
                                             Input: 
                                             
                                                
                                                   {
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             Output: 
                                             
                                                
                                                   η
                                                   =
                                                   
                                                      
                                                         [
                                                         vec
                                                         
                                                            
                                                               (
                                                               A
                                                               )
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               I
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               I
                                                            
                                                         
                                                         ]
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          1
                                          Set 
                                                
                                                   A
                                                   =
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                              
                                             /∗ definition of 
                                                
                                                   A
                                                
                                              
                                             ∗/
                                       
                                       
                                          2
                                          
                                             foreach 
                                             
                                                
                                                   i
                                                   ∈
                                                   {
                                                   2
                                                   ,
                                                   …
                                                   ,
                                                   I
                                                   }
                                                
                                              
                                             do
                                          
                                       
                                       
                                          3
                                          
                                             Compute eigenvalues: 
                                                
                                                   {
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   }
                                                   =
                                                   eig
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  H
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  H
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          4
                                          
                                             Find closest pair: 
                                                
                                                   {
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   }
                                                   =
                                                   arg
                                                   
                                                      
                                                         min
                                                      
                                                      
                                                         {
                                                         k
                                                         ,
                                                         l
                                                         }
                                                         
                                                         k
                                                         ≠
                                                         l
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               λ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               λ
                                                            
                                                            
                                                               l
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          5
                                          
                                             Compute average: 
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         i
                                                         1
                                                      
                                                   
                                                   =
                                                   (
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                   /
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          6
                                          
                                             end foreach
                                          
                                       
                                       
                                          7
                                          Set 
                                                
                                                   M
                                                   =
                                                   [
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         31
                                                      
                                                   
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         I
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          8
                                          Take for 
                                                
                                                   b
                                                
                                              the left singular vector of 
                                                
                                                   M
                                                
                                              corresponding to the largest singular value /* definition of 
                                                
                                                   b
                                                
                                              */
                                       
                                       
                                          9
                                          Set 
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           [
                                                                           0
                                                                           ,
                                                                           0
                                                                           ,
                                                                           0
                                                                           ]
                                                                        
                                                                        
                                                                           ⊤
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     for
                                                                     
                                                                     i
                                                                     =
                                                                     1
                                                                     ,
                                                                  
                                                               
                                                               
                                                                  
                                                                     ‖
                                                                     b
                                                                     
                                                                        
                                                                           ‖
                                                                        
                                                                        
                                                                           -
                                                                           2
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           (
                                                                           
                                                                              
                                                                                 μ
                                                                              
                                                                              
                                                                                 i
                                                                                 1
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 H
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           -
                                                                           
                                                                              
                                                                                 H
                                                                              
                                                                              
                                                                                 1
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                        
                                                                           ⊤
                                                                        
                                                                     
                                                                     b
                                                                  
                                                                  
                                                                     for
                                                                     
                                                                     i
                                                                     ∈
                                                                     {
                                                                     2
                                                                     ,
                                                                     …
                                                                     ,
                                                                     I
                                                                     }
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          /* definition of 
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                              */
                                          
                                       
                                       
                                          10
                                          Set 
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   1
                                                
                                              for 
                                                
                                                   i
                                                   ∈
                                                   {
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   I
                                                   }
                                                
                                              
                                             /* definition of 
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                              */
                                       
                                       
                                          11
                                          
                                             return 
                                             
                                                
                                                   η
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               vec
                                                               
                                                                  
                                                                     (
                                                                     A
                                                                     )
                                                                  
                                                                  
                                                                     ⊤
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     b
                                                                  
                                                                  
                                                                     ⊤
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     ⊤
                                                                  
                                                               
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     ⊤
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     I
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

One possible procedure for determining suitable initial values of 
                        
                           η
                        
                      is presented in Algorithm 1. In essence, the procedure first establishes relative scale factors between a collection of homography matrices using the fact that any homography of the form 
                        
                           
                              
                                 H
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                              
                              
                                 -
                                 1
                              
                           
                           
                              
                                 H
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                      has a double eigenvalue. Once the relative scales of the individual homography matrices are determined, singular value decomposition is next used to determine the latent variable 
                        
                           b
                        
                     . Finally, straightforward algebraic manipulations are applied to recover all remaining latent variables.

Employing the Huber loss function
                        
                           
                              C
                              (
                              r
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                if
                                                
                                                |
                                                r
                                                |
                                                <
                                                b
                                                ,
                                             
                                          
                                          
                                             
                                                2
                                                b
                                                |
                                                r
                                                |
                                                -
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                otherwise
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where b is a tunable positive constant, in place of the quadratic loss function 
                        
                           
                              
                                 r
                              
                              
                                 2
                              
                           
                        
                     , one can define a robust version of 
                        
                           
                              
                                 J
                              
                              
                                 AML
                              
                              
                                 ′
                              
                           
                        
                     , denoted 
                        
                           
                              
                                 J
                              
                              
                                 R
                                 -
                                 AML
                              
                              
                                 ′
                              
                           
                        
                     , as
                        
                           
                              
                                 
                                    J
                                 
                                 
                                    R
                                    -
                                    AML
                                 
                                 
                                    ′
                                 
                              
                              (
                              η
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       I
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              C
                              
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             ij
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       η
                                       )
                                    
                                 
                              
                              .
                           
                        
                     
                  

This function can be optimised with a suitable modification of the LM scheme presented in the foregoing section. To describe necessary changes, we first note that 
                        
                           C
                           (
                           r
                           )
                        
                      can be represented as 
                        
                           C
                           (
                           r
                           )
                           =
                           
                              
                                 D
                              
                              
                                 2
                              
                           
                           (
                           r
                           )
                        
                     , where
                        
                           
                              D
                              (
                              r
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                if
                                                
                                                |
                                                r
                                                |
                                                ⩽
                                                b
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      2
                                                      br
                                                      -
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                             
                                             
                                                if
                                                
                                                r
                                                >
                                                b
                                                ,
                                             
                                          
                                          
                                             
                                                -
                                                
                                                   
                                                      (
                                                      -
                                                      2
                                                      br
                                                      -
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                             
                                             
                                                if
                                                
                                                r
                                                <
                                                -
                                                b
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     The function D is continuously differentiable, with the derivative given by
                        
                           
                              
                                 
                                    d
                                    D
                                 
                                 
                                    d
                                    r
                                 
                              
                              (
                              r
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if
                                                
                                                |
                                                r
                                                |
                                                ⩽
                                                b
                                                ,
                                             
                                          
                                          
                                             
                                                b
                                                
                                                   
                                                      (
                                                      2
                                                      br
                                                      -
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      -
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                             
                                             
                                                if
                                                
                                                r
                                                >
                                                b
                                                ,
                                             
                                          
                                          
                                             
                                                b
                                                
                                                   
                                                      (
                                                      -
                                                      2
                                                      br
                                                      -
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      -
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                             
                                             
                                                if
                                                
                                                r
                                                <
                                                -
                                                b
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     Introducing the vector
                        
                           
                              d
                              (
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              (
                              η
                              )
                              )
                              =
                              
                                 
                                    
                                       
                                          D
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         11
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   (
                                                   η
                                                   )
                                                
                                             
                                          
                                          ,
                                          …
                                          ,
                                          D
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                         
                                                            
                                                               J
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   (
                                                   η
                                                   )
                                                
                                             
                                          
                                          ,
                                          …
                                          ,
                                          D
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         I
                                                         1
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   (
                                                   η
                                                   )
                                                
                                             
                                          
                                          ,
                                          …
                                          ,
                                          D
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         
                                                            
                                                               IJ
                                                            
                                                            
                                                               I
                                                            
                                                         
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   (
                                                   η
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    ⊤
                                 
                              
                              ,
                           
                        
                     we can rewrite 
                        
                           
                              
                                 J
                              
                              
                                 R
                                 -
                                 AML
                              
                              
                                 ′
                              
                           
                        
                      in a least-square form as
                        
                           
                              
                                 
                                    J
                                 
                                 
                                    R
                                    -
                                    AML
                                 
                                 
                                    ′
                                 
                              
                              (
                              η
                              )
                              =
                              ‖
                              d
                              (
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              (
                              η
                              )
                              )
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                              
                              .
                           
                        
                     With 
                        
                           d
                           (
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                           (
                           η
                           )
                           )
                        
                      taking the role of 
                        
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                           (
                           η
                           )
                        
                      in (10), all what is needed to set up an LM scheme for optimising 
                        
                           
                              
                                 J
                              
                              
                                 R
                                 -
                                 AML
                              
                              
                                 ′
                              
                           
                        
                      is an explicit expression for the Jacobian of 
                        
                           d
                           (
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                           (
                           η
                           )
                           )
                        
                     . But this is given by
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                η
                                             
                                          
                                          d
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ∂
                                                                     
                                                                     
                                                                        η
                                                                     
                                                                  
                                                                  D
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 r
                                                                              
                                                                              
                                                                                 11
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ∂
                                                                     
                                                                     
                                                                        η
                                                                     
                                                                  
                                                                  D
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 r
                                                                              
                                                                              
                                                                                 1
                                                                                 
                                                                                    
                                                                                       J
                                                                                    
                                                                                    
                                                                                       1
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ∂
                                                                     
                                                                     
                                                                        η
                                                                     
                                                                  
                                                                  D
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 r
                                                                              
                                                                              
                                                                                 I
                                                                                 1
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ∂
                                                                     
                                                                     
                                                                        η
                                                                     
                                                                  
                                                                  D
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 r
                                                                              
                                                                              
                                                                                 
                                                                                    
                                                                                       IJ
                                                                                    
                                                                                    
                                                                                       I
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ⊤
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                η
                                             
                                          
                                          D
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ij
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                d
                                                D
                                             
                                             
                                                d
                                                r
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ij
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          
                                             
                                                ∂
                                             
                                             
                                                η
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                ij
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          η
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                  

@&#EXPERIMENTAL DESIGN@&#

We compared our new homography estimation algorithm with established methods on synthetic and real data. Our investigation focused on the direct linear transform (DLT) [11], rank constraint enforcement (RANK) [16], weighted alternating least squares (WALS) [2], approximate maximum likelihood with homography covariances (AML-COV) [7], approximate maximum likelihood with Sampson distance (AML-SMPS), separate bundle adjustment for multiple homographies (BA-SEP), and joint bundle adjustment for multiple homographies (BA-JOINT). With the exception of DLT, data points for all homographies were jointly normalised before they were passed to the estimation methods [3,4,10]. DLT operated on separately normalised data points.

Because DLT is the prevailing method used to separately estimate homographies, we took it as the baseline in our experiments. Usually separate bundle adjustment (BA-SEP) is considered a gold standard benchmark for homography estimation. Separate bundle adjustment minimises the reprojection error
                        
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       I
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       d
                                       
                                          
                                             (
                                             
                                                
                                                   m
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ̲
                                                      
                                                   
                                                
                                                
                                                   ij
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       d
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ij
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               ̲
                                                            
                                                         
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 H
                              
                              
                                 i
                              
                           
                        
                      denotes the i-th homography matrix and 
                        
                           
                              
                                 {
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ̲
                                                
                                             
                                          
                                          
                                             ij
                                          
                                       
                                       }
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 I
                              
                           
                        
                      represents 2D points in the first image. However, as separate bundle adjustment does not enforce homography constraints, it should not really be granted gold standard status. In line with this, as a gold standard benchmark, we utilised joint bundle adjustment which is bundle adjustment employing the parametrisation given in (6) and (7) so that all inter-homography constraints are satisfied. Joint bundle adjustment minimises the gold standard reprojection error
                        
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       I
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       d
                                       
                                          
                                             (
                                             
                                                
                                                   m
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ̲
                                                      
                                                   
                                                
                                                
                                                   ij
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       d
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ij
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         Π
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   η
                                                   )
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               ̲
                                                            
                                                         
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     over all choices of parameter vectors 
                        
                           η
                        
                      and 2D points 
                        
                           
                              
                                 {
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ̲
                                                
                                             
                                          
                                          
                                             ij
                                          
                                       
                                       }
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 I
                              
                           
                        
                     . In all experiments we initialised separate bundle adjustment with DLT, and joint bundle adjustment with the procedure from Algorithm 1. In both cases we also seeded 
                        
                           
                              
                                 {
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ̲
                                                
                                             
                                          
                                          
                                             ij
                                          
                                       
                                       }
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 I
                              
                           
                        
                      with the data points extracted from the first image. A summary of the attributes of all the estimators that we examined is presented in Table 1
                     .

We distinguished between two types of synthetic scenes. In the first type of synthetic scene data points corresponding to different homographies overlapped minimally and formed clusters (see Fig. 2
                        a), whilst in the second type of synthetic scene data points corresponding to different homographies overlapped substantially (see Fig. 2b). The first type of synthetic scene was more realistic; however, the second type of synthetic scene was also of interest because it resulted in homography estimates that had spherical covariance matrices. By a spherical covariance matrix we mean a covariance matrices all of whose non-zero eigenvalues are almost equal.

Type 1 synthetic scenes with a specified number of homographies and ground truth correspondences were generated using the following steps:
                           
                              1.
                              Select a realistic stereo camera configuration and set intrinsic camera parameters thus forming two projection matrices.

Generate a plane situated at a random distance in front of the first camera plane.

Apply a random rotation and translation to the plane. This rotated and translated plane together with the projection matrices gives rise to a homography.

Generate a random sized rectangular region in the first image and sample a random number of points within this region.

Transfer the points within the rectangular region in the first image to the second image using the homography from step 3.

If insufficient points fall within the boundary of the second image, then discard the homography and repeat the procedure from step 2; otherwise proceed to step 7.

Add zero-mean Gaussian noise at a specified standard deviation to the corresponding points.

Output the ground truth homography, ground truth corresponding points, and noise perturbed points.

Steps 2 to 8 were repeated for each homography. The fourth step is important because if homographies span varying spatial regions, then they will also be estimated with varying levels of uncertainty. Type 2 synthetic scenes were generated using the same protocol, with the exception that the fourth step was modified so that the rectangular region always spanned the entire image. This modification ensured that homographies were estimated with similar levels of uncertainty.

To analyse the robust variant of our algorithm, we generated numerous type 1 synthetic scenes with two homographies per scene, and ensured that 
                           
                              10
                              %
                           
                         of corresponding points were outliers (false correspondences). Two planar structures were then automatically detected with the use of sequential RANSAC, resulting in two sets of noisy “inliers” per scene. Sequential RANSAC consists of (1) applying standard RANSAC on all data points to find an initial set of inliers, (2) removing these inliers from the dataset, and (3) applying RANSAC again on the remaining data points to find a second set of inliers. Although sequential RANSAC attempts to find inlier sets that are free of any false correspondences, it does not always succeed. The success of RANSAC depends on a suitable choice of threshold parameter to distinguish between inliers and outliers. If the threshold is too strict, very few points will be considered inliers. If the threshold is too liberal, false correspondences may be included. The Huber norm offers a partial remedy to the threshold dilemma. One can use a liberal RANSAC threshold so that many true inliers are correctly identified, followed by a strict Huber norm threshold so that any accidental false correspondences are down-weighted.

To complement our extensive synthetic experiments with experiments on real data, we collected several images of planar surfaces. Corresponding points between a pair of views were matched by correlation using a Harris corner detector [9]. Planar regions within the images were demarcated using polygons, and data points inside the polygons were grouped together. The number of polygons determined the number of homographies.

To further demonstrate the practical utility of our algorithm we utilised two views of Merton College from the Oxford dataset.
                           1
                           http://www.robots.ox.ac.uk/∼vgg/data.html.
                        
                        
                           1
                         We used a Harris corner detector to detect 147 interest points and matched corresponding points by correlation. We added a further 
                           
                              132
                              
                              (
                              47
                              %
                              )
                           
                         false correspondences (pure outliers). Two planar structures were then automatically detected with the aid of sequential RANSAC, resulting in two sets of inliers for two homographies.

On synthetic data the common distance used to quantify data-model discrepancies was the mean root-mean-square (RMS) reprojection error from truth
                        
                           
                              
                                 
                                    
                                       1
                                    
                                    
                                       I
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          I
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             4
                                             
                                                
                                                   J
                                                
                                                
                                                   i
                                                
                                             
                                             K
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                K
                                             
                                          
                                       
                                       
                                          
                                             
                                                min
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            ̲
                                                         
                                                      
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                d
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        m
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  ij
                                                               
                                                               
                                                                  (
                                                                  k
                                                                  )
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  
                                                                     
                                                                        m
                                                                     
                                                                     
                                                                        ̲
                                                                     
                                                                  
                                                               
                                                               
                                                                  ij
                                                               
                                                               
                                                                  (
                                                                  k
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                d
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        m
                                                                     
                                                                     
                                                                        ‾
                                                                     
                                                                  
                                                               
                                                               
                                                                  ij
                                                               
                                                               
                                                                  ′
                                                                  (
                                                                  k
                                                                  )
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  
                                                                     
                                                                        Θ
                                                                     
                                                                     
                                                                        ^
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        m
                                                                     
                                                                     
                                                                        ̲
                                                                     
                                                                  
                                                               
                                                               
                                                                  ij
                                                               
                                                               
                                                                  (
                                                                  k
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where K is the number of experiments, and, for each 
                           
                              k
                              =
                              1
                              ,
                              …
                              ,
                              K
                              ,
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            ′
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    I
                                 
                              
                           
                         are noiseless data and 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  ̲
                                                               
                                                            
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    I
                                 
                              
                           
                         are arbitrary 2D points over which the minimum is taken in the k-th experiment.

On real data we compared the quality of estimators by using the estimated homographies to transfer textures inside designated polygon regions from the first view to the second view. Imprecisely aligned textures demonstrate unreliable homographies.

@&#RESULTS AND DISCUSSION@&#

The results of our first experiments demonstrate that SVD-based rank constraint enforcement has limited practical value. Apart from the fact that rank constraints can only be applied when there are five or more underlying planar surfaces (a rare occurrence), the procedure only improves the quality of the homography estimates if the covariance matrices associated with the homographies are spherical. If the homographies are estimated with different degrees of uncertainty, then rank constraint enforcement leads to less accurate homography estimates. This assertion is supported by the results presented in Fig. 3
                     . Fig. 3a  together with Table 2
                     a  illustrate that when homography covariance matrices were far from spherical, rank constraint enforcement was consistently worse than DLT. On the other hand, Fig. 3b and Table 2b demonstrate that when the homography covariance matrices were all close to spherical, rank constraint enforcement led to improved homography estimates.

An assessment of all our simulations affirms that enforcing homography constraints using our latent variable parametrisation can considerably improve the quality of homography estimates. The results presented in Fig. 5
                      demonstrate close to 10% improvement in the estimation of two homographies for a range of noise levels for both type 1 and type 2 synthetic scenes. However, the experiments also revealed that for the more challenging type 1 synthetic scenes, BA-JOINT, AML-SMPS, and AML-COV occasionally failed to improve upon the BA-SEP estimate because they converged to poor local minima. For example, Table 4
                      shows that for a noise level of 
                        
                           σ
                           =
                           1
                        
                      pixels, BA-JOINT, and AML-SMPS improved the estimate in 
                        
                           97
                           %
                        
                      of trials, whilst AML-COV improved the estimate in 
                        
                           96
                           %
                        
                      of trials. At larger noise levels (
                        
                           σ
                           =
                           3
                        
                      pixels), BA-JOINT, and AML-SMPS improved the estimate in 
                        
                           94
                           %
                        
                      of trials, whilst AML-COV in 
                        
                           80
                           %
                        
                      of trials.

By introducing homography covariance information into their iterative WALS scheme, Chen and Suter hoped to overcome the limitations of SVD-based rank constraint enforcement. They succeeded partially in that WALS with their initialisation can be applied when there are three or more planar surfaces in the scene. However, whilst their scheme sometimes improves upon DLT and BA-SEP, it is prone to converging to poor minima. For example, Fig. 6
                      shows that even though WALS is better than DLT and BA-SEP, it is not as accurate as AML-COV or AML-SMPS. Moreover, the numerical instability of WALS is apparent in Table 5
                     , which shows that for four homographies and the noise level of 
                        
                           σ
                           =
                           5
                        
                      pixels, WALS only improved upon BA-SEP in 
                        
                           28
                           %
                        
                      of trials, whereas AML-SMPS achieved a 
                        
                           82
                           %
                        
                      success rate.

An astute reader may wonder why BA-JOINT occasionally fails to improve upon BA-SEP. The reason for the occasional failure of BA-JOINT has to do with Algorithm 1 which is used to initialise the latent variables in BA-JOINT. For type 2 synthetic scenes Algorithm 1 provides latent variables parametrising fully consistent homographies that also have low reprojection error (see Fig. 4a). For type 1 synthetic scenes the algorithm still provides latent variables parametrising fully consistent homographies, but these homographies no longer fit the corresponding points well and have a large reprojection error (see Fig. 4b). In the process of minimising a large reprojection error BA-JOINT occasionally converges to a poor local minimum.

Our examinations have also established that the mean root-mean-square reprojection error decreases as the number of homographies that are jointly estimated increases. This effect is evident in Fig. 7
                      and also in Table 8, where the percentage reduction in reprojection error is quantified. Table 8 shows that the accuracy of AML-SMPS was very close to that of BA-JOINT, ranging from a 
                        
                           23
                           %
                        
                      average error reduction with four homographies, to a 
                        
                           30
                           %
                        
                      average error reduction with eight homographies. We also noticed that as the number of homographies increases the chance of converging to a poor local minimum gradually increases (see Table 6).

Further analysis shows that the percentage reduction in reprojection error that can be achieved by enforcing inter-homography constraints is fairly independent of the number of data points. Fig. 8
                     
                      and Table 9 show that the percentage reduction in reprojection error fluctuated minimally as the number of data points was varied from 10 to 50. However, some of the algorithms are more prone to converging to poor minima when given only few data points. For example, Table 7
                      
                     
                      
                     shows that with only 10 data points WALS managed to improve upon the BA-SEP solution in only 
                        
                           30.2
                           %
                        
                      of trials, whereas BA-JOINT and AML-SMPS succeed in 
                        
                           98.2
                           %
                        
                      and 
                        
                           78.66
                           %
                        
                      of trials, respectively.

Results on synthetic data with outliers, given in Table 3, demonstrate that the robust variant of the AML cost function leads to superior results when compared to the commonly employed DLT-RANSAC+BA-SEP combination. This means that the theory developed in this paper can be incorporated into various real-world applications which typically rely on the DLT-RANSAC followed by BA-SEP workflow.

Examples of texture transfer on real-world data, depicted in Figs. 10–13
                     
                     
                     
                     , all demonstrate by the quality of the texture alignments that our method yields more accurate homography estimates. The definite improvement is also evident on the Merton College images in Fig. 14
                     .

Currently the main drawback of AML-SMPS is its running time. According to the running times listed in Table 10, AML-COV is by far the fastest, while AML-SMPS is the slowest. In principle, AML-SMPS should be faster than BA-JOINT because it solves a smaller optimisation problem (it does not optimise over corresponding points). However, for the AML-SMPS cost function the Levenberg–Marquardt algorithm takes very many iterations to converge when a current estimate is close to an optimal solution. Fig. 9 traces the reduction in cost function value for consecutive iterations of the LM scheme on a sample of 500 simulation trials. The plot shows that typically after approximately 20 iterations the cost function has essentially reached its minimum. For the remaining hundreds of iterations, the cost function plateaus and only decreases marginally between iterations. We believe this uncharacteristically poor performance of the LM algorithm near the minimum may have to do with a combination of factors including (1) the intrinsic rank deficiency of the Jacobian matrix at a local minimum, (2) inherent gauge freedom in the choice of parametrisation, and (3) the Sampson distance itself. We also believe that with an appropriate modification to the LM algorithm the stagnation problem can be overcome, but we leave the pursuit of the best optimisation strategy to future work.

@&#CONCLUSION@&#

After giving a comprehensive account of the historical developments in multiple homography estimation, we introduced a new multiple homography estimation method that utilises the dependable Sampson distance and operates directly on corresponding points. In contrast, all prior estimators fit a set of homography matrices to another set of homography matrices. Our experiments attest that jointly estimating multiple homographies yields considerable accuracy gains over separately estimated homographies.

@&#ACKNOWLEDGMENT@&#

This research was partially supported by the Australian Research Council.

@&#REFERENCES@&#

